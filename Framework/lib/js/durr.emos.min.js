/* durr.emos.js v1.2.4-1 | (c) 2018 DURR Systems GmbH | durr.com */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("emosWS requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(window,noGlobal){function SubscriberGroup(a,b){emosWS.topicNumber++,this.tag=a,this.tagId=this.getTagId(a,b),this.actualData=null,this.subscribers=[],this.tagType=b,this.live=!1,this.fromIDB=!1,this.callback=this.callback.bind(this),-1===[emosWS.tagType.Diagnosis,emosWS.tagType.IOObject].indexOf(b)&&(emosWS.badQualityTags[this.tagId]=this),emosWS.dispatchEvent({type:"HMIplc",message:this})}SubscriberGroup.prototype.getTagId=function(a,b){try{return a+b.id}catch(a){console.error("[SubscriberGroup getTagId] : "+a)}},SubscriberGroup.prototype.updateBadQualityTags=function(a){var b=!1;if(a)switch(a.type){case"dataChange":b="IndexedDB"!==a.source&&192===a.quality;break;case"diagnosisWindow":b="EMOSDEFAULT"!==a.value.OPCVersionID}b&&delete emosWS.badQualityTags[this.tagId],this.checkBadQualityTags()},SubscriberGroup.prototype.checkBadQualityTags=function(){var a=0===Object.keys(emosWS.badQualityTags).length;emosWS.dispatchEvent({type:"Quality",message:{good:a,list:emosWS.badQualityTags}})},SubscriberGroup.prototype.callback=function(a){try{this.updateBadQualityTags(a),"IndexedDB"!==a.source?(emosWS.idb.updatePLC({plctag:this.tagId,value:a}),this.active=!0,this.fromIDB=!1):(this.onIDB(a),this.fromIDB=!0),this.active^this.fromIDB&&(this.actualData=a,void 0!==a.classStateRec&&(a.classStateRec.ClassStateNew=intToBinary(a.classStateRec.ClassStateNew,32),a.classStateRec.ClassStateAck=intToBinary(a.classStateRec.ClassStateAck,32),a.newFault="0"===a.value&&"1"===a.classStateRec.ClassStateNew.charAt(30),a.newWarning="0"===a.value&&"1"===a.classStateRec.ClassStateNew.charAt(29),a.newEmergency="0"===a.value&&"1"===a.classStateRec.ClassStateNew.charAt(28),a.ackFault="1"===a.value&&"1"===a.classStateRec.ClassStateAck.charAt(30),a.ackWarning="1"===a.value&&"1"===a.classStateRec.ClassStateAck.charAt(29),a.ackEmergency="1"===a.value&&"1"===a.classStateRec.ClassStateAck.charAt(28),a.noFault="2"===a.value,a.newFault?a.classStateRec.state=0:a.ackFault?a.classStateRec.state=1:a.newEmergency?a.classStateRec.state=2:a.ackEmergency?a.classStateRec.state=3:a.newWarning?a.classStateRec.state=4:a.ackWarning?a.classStateRec.state=5:a.noFault?a.classStateRec.state=6:a.classStateRec.state=7),this.subscribers.forEach(function(b){if(b.callback)try{b.callback(a,b.param)}catch(a){console.error("[SubscriberGroup subscribers callback] failed: "+a)}}))}catch(a){console.error("[SubscriberGroup callback] failed: "+a)}},SubscriberGroup.prototype.getTagType=function(){return this.tagType.id},SubscriberGroup.prototype.register=function(a){try{this.subscribers.forEach(function(b){if(a.equals(b))return void(emosWS.animationData.stillInit||null!==this.actualData&&a.callback&&a.callback(this.actualData,a.param))}),this.subscribers.push(a),emosWS.animationData.stillInit||null!==this.actualData&&a.callback&&a.callback(this.actualData,a.param),1===this.subscribers.length&&this.advise()}catch(a){console.error("[SubscriberGroup register] : ",a)}},SubscriberGroup.prototype.unregister=function(a){this.subscribers.forEach(function(b,c){if(b.callback===a)return this.subscribers.splice(c,1),b=null,void(0===this.subscribers.length&&(this.unadvise(),delete emosWS.tagDestination[this.tagId],delete emosWS.badQualityTags[this.tagId]))}.bind(this))},SubscriberGroup.prototype.advise=function(){var a=emosWS.getPLCTag(this.tag);a&&this.adviseData(a),emosWS.idb.addPLC({plctag:this.tagId,value:{}}),emosWS.idb.getPLC(this.tagId,this.callback)},SubscriberGroup.prototype.unadvise=function(){},SubscriberGroup.prototype.onIDB=function(a){},SubscriberGroup.prototype.adviseData=function(){},SubscriberGroup.prototype.toString=function(){var a="",b=this.actualData;return b&&(a+="type:\t"+b.type+"\nid:\t"+b.id+"\ntag:\t"+b.tag+"\nts:\t"+b.ts+"\nvalue:\t"+b.value+"\nquality:\t"+b.quality+"\nsource:\t"+b.source+"\n"),"tagid:\t"+this.tagId+"\nlisteners:\t"+this.subscribers.length+"\n\nActual value\n"+a},SubscriberGroup.prototype.setValue=function(a){};function SubscriberGroupIO(a){SubscriberGroup.call(this,a,Definition.tagType.IO)}SubscriberGroupIO.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupIO.prototype.constructor=SubscriberGroupIO,SubscriberGroupIO.prototype.adviseData=function(a){emosWS.sendAdvise(a.plc,a.tag,this.callback)},SubscriberGroupIO.prototype.setValue=function(a){(a=String(a))!==this.actualData.value&&emosWS.poke(this.tag,a)};function SubscriberGroupIOAlarm(a){SubscriberGroup.call(this,a,Definition.tagType.IOAlarm)}SubscriberGroupIOAlarm.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupIOAlarm.prototype.constructor=SubscriberGroupIOAlarm,SubscriberGroupIOAlarm.prototype.adviseData=function(a){emosWS.sendAdvise(a.plc,a.tag+".Alarm",this.callback)};function SubscriberGroupAlarm(a){SubscriberGroup.call(this,a,Definition.tagType.Alarm)}SubscriberGroupAlarm.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupAlarm.prototype.constructor=SubscriberGroupAlarm,SubscriberGroupAlarm.prototype.adviseData=function(a){emosWS.sendAdviseAlarm(a.plc,a.tag,this.callback)};function SubscriberGroupAlarmText(a){SubscriberGroup.call(this,a,Definition.tagType.AlarmText)}SubscriberGroupAlarmText.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupAlarmText.prototype.constructor=SubscriberGroupAlarmText;function SubscriberGroupDiagnosis(a){SubscriberGroup.call(this,a,Definition.tagType.Diagnosis)}SubscriberGroupDiagnosis.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupDiagnosis.prototype.constructor=SubscriberGroupDiagnosis,SubscriberGroupDiagnosis.prototype.adviseData=function(){this.tag.replace(/(.*)::(.*)::(.*)/,function(a,b,c,d){emosWS.sendGetDiagnosisWindow(b,c,d,this.callback)}.bind(this))};function SubscriberGroupProperty(a){SubscriberGroup.call(this,a,Definition.tagType.Property)}SubscriberGroupProperty.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupProperty.prototype.constructor=SubscriberGroupProperty,SubscriberGroupProperty.prototype.adviseData=function(a){emosWS.sendAdviseProperty(a.plc,a.tag,this.callback)};function SubscriberGroupIOObjectPLC(a){this.messages={io:null,property:null},this.UNKOWN="???",this.UNDEFINED="UNDEFINED",this.Temperature={CELSIUS:{symbol:["C","\xbaC","\xb0C"],convertTo:{FAHRENHEIT:this.CtoF.bind(this),KELVIN:this.CtoK.bind(this),RANKINE:this.CtoR.bind(this),UNDEFINED:this.toItSelf}},FAHRENHEIT:{symbol:["F","\xbaF","\xb0F"],convertTo:{CELSIUS:this.FtoC.bind(this),KELVIN:this.FtoK.bind(this),RANKINE:this.FtoR.bind(this),UNDEFINED:this.toItSelf}},KELVIN:{symbol:["K","\xbaK","\xb0K"],convertTo:{CELSIUS:this.KtoC.bind(this),FAHRENHEIT:this.KtoF.bind(this),RANKINE:this.KtoR.bind(this),UNDEFINED:this.toItSelf}},RANKINE:{symbol:["R","\xbaR","\xb0R"],convertTo:{CELSIUS:this.RtoC.bind(this),FAHRENHEIT:this.RtoF.bind(this),KELVIN:this.RtoK.bind(this),UNDEFINED:this.toItSelf}},UNDEFINED:{symbol:[],convertTo:{CELSIUS:this.toItSelf,FAHRENHEIT:this.toItSelf,KELVIN:this.toItSelf,RANKINE:this.toItSelf,UNDEFINED:this.toItSelf}}};var b=this.Temperature;this.tempArray={ALL:b.CELSIUS.symbol.concat(b.FAHRENHEIT.symbol,b.KELVIN.symbol),METRIC:b.CELSIUS.symbol.concat(b.KELVIN.symbol),IMPERIAL:b.FAHRENHEIT.symbol},this.value=null,this.plcValue=null,this.unit=null,this.unitSymbol=null,this.valueWithSymbol=null,this.factor=1,this.precision=null,this.data={UnitPLC:null,FactorPLC:1,UnitMetric:null,FactorMetric:1,UnitImperial:null,FactorImperial:1,UnitLocale:null,FactorLocale:1,UnitDefault:null,Precision:null,TextKey:null,InputMin:null,InputMax:null},this.isTemperature=!1,this.setUnit(emosWS.getUnit()),this.onIO=this.onIO.bind(this),this.onUnitChange=this.onUnitChange.bind(this),this.onProperty=this.onProperty.bind(this),this.isIDB=!1,emosWS.addEventListener("unit",this.onUnitChange),SubscriberGroup.call(this,a,Definition.tagType.IOObjectPLC)}SubscriberGroupIOObjectPLC.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupIOObjectPLC.prototype.constructor=SubscriberGroupIOObjectPLC,SubscriberGroupIOObjectPLC.prototype.adviseData=function(){emosWS.advise(this.tag,this.onIO,"",Definition.tagType.IO),emosWS.advise(this.tag,this.onProperty,"",Definition.tagType.Property)},SubscriberGroupIOObjectPLC.prototype.areMessagesNull=function(){return null===this.messages.io&&null===this.messages.property},SubscriberGroupIOObjectPLC.prototype.onIO=function(a){this.messages.io=this.copy(a),this.plcValue=parseFloat("object"==typeof a.value?a.value.value:a.value),this.onDataChange()},SubscriberGroupIOObjectPLC.prototype.onIDB=function(a){this.areMessagesNull()&&(this.isIDB=!0,this.onIO(a),this.onProperty({value:a.properties}),this.isIDB=!1)},SubscriberGroupIOObjectPLC.prototype.onProperty=function(a){try{if(a.value){var b=this.messages.property=a.value,c=this.data;c.Precision=this.precision=parseInt(b.disp_prec),c.UnitMetric=b.met_baseunit,c.UnitImperial=b.imp_baseunit,c.UnitLocale=b.loc_baseunit,c.UnitPLC=b.plc_baseunit,c.FactorMetric=parseFloat(b.met_factor),c.FactorImperial=parseFloat(b.imp_factor),c.FactorLocale=parseFloat(b.loc_factor),c.FactorPLC=parseFloat(b.plc_factor),c.TextKey=b.textkey,c.InputMin=parseFloat(b.input_min),c.InputMax=parseFloat(b.input_max),this.isTemperature=this.checkTemperature(c.UnitMetric,c.UnitImperial),this.setUnit(this.unit),this.onDataChange()}}catch(a){console.error("[SubscriberGroupIOObjectPLC.prototype.onProperty] : "+a)}},SubscriberGroupIOObjectPLC.prototype.onUnitChange=function(a){a!==this.unit&&(this.setUnit(a),this.onDataChange(!0))},SubscriberGroupIOObjectPLC.prototype.copy=function(a){var b={};for(var c in a)b[c]=a[c];return b},SubscriberGroupIOObjectPLC.prototype.onDataChange=function(){this.fromIDB=!1;var a=this.messages.io;a&&(this.value=this.getValue(),a.value={isTemperature:this.isTemperature,value:this.value,plcValue:this.plcValue,unit:this.unit,unitSymbol:this.unitSymbol,valueWithSymbol:this.value+" "+this.unitSymbol,factor:this.factor,properties:this.messages.property},this.isIDB||this.callback(a))},SubscriberGroupIOObjectPLC.prototype.unadvise=function(){emosWS.unadvise(emosWS.getTagId(this.tag,Definition.tagType.IO),this.onIO),emosWS.unadvise(emosWS.getTagId(this.tag,Definition.tagType.Property),this.onProperty),emosWS.removeEventListener("unit",this.onUnitChange)},SubscriberGroupIOObjectPLC.prototype.setUnit=function(a){var b=this.data;switch(this.unit=a,this.unit){case emosWS.unitID.Metric:this.unitSymbol=b.UnitMetric,this.factor=b.FactorMetric;break;case emosWS.unitID.UnitImperial:this.unitSymbol=b.UnitImperial,this.factor=b.FactorImperial;break;case emosWS.unitID.UnitLocale:this.unitSymbol=b.UnitLocale,this.factor=b.FactorLocale;break;default:return""}},SubscriberGroupIOObjectPLC.prototype.checkTemperature=function(a,b){var c=this.tempArray;return null!==this.data.UnitPLC&&c.ALL.indexOf(this.data.UnitPLC)>-1||null===this.data.UnitPLC&&(c.METRIC.indexOf(a)>-1||c.IMPERIAL.indexOf(b)>-1)},SubscriberGroupIOObjectPLC.prototype.getTemperatureType=function(a){try{for(var b=Object.keys(this.Temperature),c=0,d=b.length;c<d;c++){var e=b[c];if(this.Temperature[e].symbol.indexOf(a)>-1)return e}return this.UNDEFINED}catch(a){return console.error("[SubscriberGroupIOObjectPLC.prototype.getTemperatureType] : "+a),this.UNDEFINED}},SubscriberGroupIOObjectPLC.prototype.getValue=function(){try{var a=this.data,b=null;return b=this.isTemperature?this.convertTemperature(this.plcValue,a.UnitPLC,this.unitSymbol):this.plcValue*a.FactorPLC*this.factor,isNaN(a.Precision)||null===a.Precision||(b=b.toFixed(a.Precision)),b}catch(a){console.error("[SubscriberGroupIOObjectPLC.prototype.getValue] : "+a)}},SubscriberGroupIOObjectPLC.prototype.getWriteValue=function(a){var b=this.data;return this.isTemperature?this.convertTemperature(a,this.unitSymbol,b.UnitPLC):a/(b.FactorPLC*this.factor)},SubscriberGroupIOObjectPLC.prototype.setValue=function(a){var b=String(this.getWriteValue(a));b!==this.plcValue&&emosWS.poke(this.tag,b)},SubscriberGroupIOObjectPLC.prototype.convertTemperature=function(a,b,c){try{var d=this.getTemperatureType(b),e=this.getTemperatureType(c);return d===e?a:this.Temperature[d].convertTo[e](a)}catch(b){return console.error("[SubscriberGroupIOObjectPLC.prototype.convertTemperature] : "+b),a}},SubscriberGroupIOObjectPLC.prototype.CtoF=function(a){return 1.8*a+32},SubscriberGroupIOObjectPLC.prototype.CtoK=function(a){return a+273.15},SubscriberGroupIOObjectPLC.prototype.CtoR=function(a){return this.KtoR(this.CtoK(a))},SubscriberGroupIOObjectPLC.prototype.FtoC=function(a){return(a-32)/1.8},SubscriberGroupIOObjectPLC.prototype.FtoK=function(a){return(a-32)/1.8+273.15},SubscriberGroupIOObjectPLC.prototype.FtoR=function(a){return this.KtoR(this.FtoK(a))},SubscriberGroupIOObjectPLC.prototype.KtoC=function(a){return a-273.15},SubscriberGroupIOObjectPLC.prototype.KtoF=function(a){return 1.8*(a-273.15)+32},SubscriberGroupIOObjectPLC.prototype.KtoR=function(a){return 9*a/5},SubscriberGroupIOObjectPLC.prototype.RtoK=function(a){return 5*a/9},SubscriberGroupIOObjectPLC.prototype.RtoC=function(a){return this.KtoC(this.RtoK(a))},SubscriberGroupIOObjectPLC.prototype.RtoF=function(a){return this.KtoF(this.RtoK(a))},SubscriberGroupIOObjectPLC.prototype.toItSelf=function(a){return a};function SubscriberGroupIOObject(a,b,c,d,e,f,g,h,i,j,k,l){this.tag=a,this.value=null,this.oValue=null,this.unit=null,this.unitSymbol=null,this.properties=null,this.IOObjectPLC=null,void 0===l?(this.offset=0,this.factor=1):(this.offset=l,this.factor=d),this.data={UnitPLC:null,UnitMetric:c,FactorMetric:parseFloat(d),UnitImperial:e,FactorImperial:parseFloat(f),UnitLocale:g,FactorLocale:parseFloat(h),UnitDefault:i,Precision:parseInt(j),Stretch:parseInt(k),TextKey:null,InputMin:null,InputMax:null},this.setUnit(emosWS.getUnit()),this.onDataChange=this.onDataChange.bind(this),SubscriberGroup.call(this,a,Definition.tagType.IOObject),this.tagId=this.getTagId(a,b,c,d,e,f,g,h,i,j,k,l),this.onDataChange()}SubscriberGroupIOObject.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupIOObject.prototype.constructor=SubscriberGroupIOObject,SubscriberGroupIOObject.prototype.getTagId=function(a,b,c,d,e,f,g,h,i,j,k,l){var m="";return[a,c,d,e,f,g,h,i,j,k,l].forEach(function(a){m+=void 0===a?"":a+"_"}),m+b.id},SubscriberGroupIOObject.prototype.adviseData=function(){this.IOObjectPLC=emosWS.advise(this.tag,this.onDataChange,"",Definition.tagType.IOObjectPLC)},SubscriberGroupIOObject.prototype.setUnit=SubscriberGroupIOObjectPLC.prototype.setUnit,SubscriberGroupIOObject.prototype.copy=SubscriberGroupIOObjectPLC.prototype.copy,SubscriberGroupIOObject.prototype.onDataChange=function(a){try{var b=null;if(a){var c=a.value;if(this.properties=c.properties,this.oValue=c.value,b=this.copy(a),this.properties){b.value=this.copy(a.value);var d=this.data;this.value=isNaN(d.Stretch)||null===d.Stretch?this.oValue:this.toStretch(parseFloat(this.oValue),d.Stretch),b.value.value=this.value}else this.setUnit(c.unit),this.value=this.getValue(),b=this.copy(a),b.value={isTemperature:!1,value:this.value,plcValue:c.plcValue,unit:this.unit,unitSymbol:this.unitSymbol,valueWithSymbol:this.value+" "+this.unitSymbol,factor:this.factor,properties:null}}else this.value=null,b={quality:0,value:{isTemperature:!1,value:this.value,plcValue:null,unit:this.unit,unitSymbol:this.unitSymbol,valueWithSymbol:this.value+" "+this.unitSymbol,factor:this.factor,properties:null}};try{this.callback(b)}catch(a){console.error("[SubscriberGroupIOObject onDataChange callback] : "+a)}}catch(a){console.error("[SubscriberGroupIOObject onDataChange] : "+a)}},SubscriberGroupIOObject.prototype.getValue=function(){try{var a=this.data,b=this.oValue*this.factor+this.offset;return isNaN(a.Precision)||null===a.Precision||(b=b.toFixed(a.Precision)),isNaN(a.Stretch)||null===a.Stretch||(b=this.toStretch(parseFloat(b),a.Stretch)),b}catch(a){console.error("[SubscriberGroupIOObject.getValue] : "+a)}},SubscriberGroupIOObject.prototype.setValue=function(a){if(this.properties)emosWS.pokeExt(this.tag,a);else{var b=this.data,c=(a-this.offset)/this.factor;emosWS.poke(this.tag,c)}},SubscriberGroupIOObject.prototype.unadvise=function(){emosWS.unadvise(emosWS.getTagId(this.tag,Definition.tagType.SubscriberGroupIOObject),this.onDataChange)},SubscriberGroupIOObject.prototype.toStretch=function(a,b){var c=a%1==0,d=a.toString();if(d.length-(c?0:1)>b){var e=parseInt(a);return e.toString().length>=b?e:parseFloat(d.substr(0,b+1))}return a};function SubscriberGroupText(a,b,c,d,e,f,g,h,i,j,k,l,m){this.param=m;var n=this.resolveTextId(a);this.textID=n.textID,this.type=n.type,SubscriberGroup.call(this,this.getId(a,m),Definition.tagType.Text),this.tagId=this.getTagId(a,b,c,d,e,f,g,h,i,j,k,l,m)}SubscriberGroupText.prototype=Object.create(SubscriberGroup.prototype),SubscriberGroupText.prototype.constructor=SubscriberGroupText,SubscriberGroupText.prototype.resolveTextId=function(a){var b={textID:a,type:"name"};return a.replace(/^(.+)\.(name|short|message|description)$/,function(a,c,d){b.textID=c,b.type=d}),b},SubscriberGroupText.prototype.getId=function(a,b){var c=this.resolveTextId(a),d=c.textID+"."+c.type;if(b&&b.plc){if(b.data){var e=b.data.OPCID;b.characterOfOPCLeaf="?",e&&e.replace(/^.*(.)\d{4}(_.*)?$/,function(a,c){b.characterOfOPCLeaf=c})}d+="["+b.plc+"]"+(b.characterOfOPCLeaf?"["+b.characterOfOPCLeaf+"]":"")}return d},SubscriberGroupText.prototype.getTagId=function(a,b,c,d,e,f,g,h,i,j,k,l,m){return this.getId(a,m)+b.id},SubscriberGroupText.prototype.adviseData=function(){emosWS.sendAdviseTextDirect(this.textID,this.type,this.callback,this.param)};var Definition={languageID:{DECP_German:{value:70,caption:"Deutsch",id:"de"},DECP_English:{value:71,caption:"English",id:"en"},DECP_Spanish:{value:72,caption:"Espa\xf1ol",id:"es"},DECP_Portuguese:{value:73,caption:"Portugu\xeas",id:"pt"},DECP_French:{value:74,caption:"Fran\xe7ais",id:"fr"},DECP_Chinese:{value:75,caption:"\u4e2d\u56fd",id:"cn"},DECP_Local1:{value:76,caption:"Local1",id:"l1"},DECP_Local2:{value:77,caption:"Local2",id:"l2"}},unitID:{Metric:0,UnitImperial:1,UnitLocale:2},tagType:{IO:{value:0,id:".IO",subscriberGroup:SubscriberGroupIO},IOAlarm:{value:1,id:".IOAlarm",subscriberGroup:SubscriberGroupIOAlarm},Alarm:{value:2,id:".Alarm",subscriberGroup:SubscriberGroupAlarm},AlarmText:{value:3,id:".AlarmText",subscriberGroup:SubscriberGroupAlarmText},Diagnosis:{value:4,id:".Diagnosis",subscriberGroup:SubscriberGroupDiagnosis},Property:{value:5,id:".Property",subscriberGroup:SubscriberGroupProperty},IOObject:{value:6,id:".Object",subscriberGroup:SubscriberGroupIOObject},Text:{value:7,id:".Text",subscriberGroup:SubscriberGroupText},IOObjectPLC:{value:8,id:".ObjectPLC",subscriberGroup:SubscriberGroupIOObjectPLC}}};function Subscriber(a,b){this.callback=a,this.param=b}Subscriber.prototype.equals=function(a){return this.callback===a.callback&&(this.param===a.param||void 0)},Subscriber.prototype.checkEqual=function(a,b){return this.callback===a&&(this.param===b||void 0)};function GlobalVariable(a){emosWS.gvNumber++,emosWS.globalVariables.push(this),this.myValue=a,this.name=null,this.subscribers=[],this.previousSubscriber=null,this.init(),emosWS.dispatchEvent({type:"HMIgv"})}GlobalVariable.prototype.init=function(){Object.defineProperty(this,"value",{get:this._getValue.bind(this),set:this._setValue.bind(this)})},GlobalVariable.prototype._getValue=function(){if(emosWS.animationData.stillInit){var a=new Subscriber(emosWS.animationData.callback.initialize,emosWS.animationData.param);this.register(a),this.previousSubscriber=a}return this.myValue},GlobalVariable.prototype._setValue=function(a){this.myValue=a,emosWS.animationData.globalVariablesSetCallBackAble&&(emosWS.animationData.stillInit||emosWS.addGlobalVariablesChange(this.informListeners.bind(this,emosWS.clickData.event)))},GlobalVariable.prototype.toString=function(){return this.myValue},GlobalVariable.prototype.toDebugString=function(){return"name:\t"+this.getName()+"\nvalue:\t"+this.myValue+"\nlisteners:\t"+this.subscribers.length+"\n"},GlobalVariable.prototype.informListeners=function(a){try{if(emosWS.currentGlobalVariable&&emosWS.currentGlobalVariable===this)return;for(var b=0,c=this.subscribers.length;b<c;b++){var d=this.subscribers[b];try{d.callback(this.myValue,d.param,a)}catch(a){console.error("[GlobalVariable informListeners] :",a)}}emosWS.currentGlobalVariable=null}catch(a){console.error("[GlobalVariable informListeners] :",a)}},GlobalVariable.prototype.register=function(a){try{for(var b=0,c=this.subscribers.length;b<c;b++){var d=this.subscribers[b];if(a.equals(d))return}this.subscribers.push(a)}catch(a){console.error("[GlobalVariable register] :",a)}},GlobalVariable.prototype.unregister=function(a){this.subscribers.forEach(function(b,c){if(b.callback===a)return this.subscribers.splice(c,1),void(b=null)}.bind(this))},GlobalVariable.prototype.getName=function(){if(this.name)return this.name;for(var a in window)try{if(window[a]===this)return this.name=a,a}catch(a){}return null},GlobalVariable.prototype.setValue=function(a){a=this.convertValue(a),this.setDirectValue(a)},GlobalVariable.prototype.setDirectValue=function(a){a!==this.myValue&&(emosWS.listenGlobalVariablesChange(),this.value=a,emosWS.callbackGlobalVariablesChange())},GlobalVariable.prototype.convertValue=function(a){var b=typeof this.myValue,c=typeof a;if(b===c)return a;switch(b){case"boolean":return"string"===c?GetAsBoolean(a):Boolean(a);case"number":return Number(a);default:return a}},window.GlobalVariable=GlobalVariable;function GlobalVariable(a){emosWS.gvNumber++,emosWS.globalVariables.push(this),this.myValue=a,this.name=null,this.subscribers=[],this.previousSubscriber=null,this.init(),emosWS.dispatchEvent({type:"HMIgv"})}GlobalVariable.prototype.init=function(){Object.defineProperty(this,"value",{get:this._getValue.bind(this),set:this._setValue.bind(this)})},GlobalVariable.prototype._getValue=function(){if(emosWS.animationData.stillInit){var a=new Subscriber(emosWS.animationData.callback.initialize,emosWS.animationData.param);this.register(a),this.previousSubscriber=a}return this.myValue},GlobalVariable.prototype._setValue=function(a){this.myValue=a,emosWS.animationData.globalVariablesSetCallBackAble&&(emosWS.animationData.stillInit||emosWS.addGlobalVariablesChange(this.informListeners.bind(this,emosWS.clickData.event)))},GlobalVariable.prototype.toString=function(){return this.myValue},GlobalVariable.prototype.toDebugString=function(){return"name:\t"+this.getName()+"\nvalue:\t"+this.myValue+"\nlisteners:\t"+this.subscribers.length+"\n"},GlobalVariable.prototype.informListeners=function(a){try{if(emosWS.currentGlobalVariable&&emosWS.currentGlobalVariable===this)return;for(var b=0,c=this.subscribers.length;b<c;b++){var d=this.subscribers[b];try{d.callback(this.myValue,d.param,a)}catch(a){console.error("[GlobalVariable informListeners] :",a)}}emosWS.currentGlobalVariable=null}catch(a){console.error("[GlobalVariable informListeners] :",a)}},GlobalVariable.prototype.register=function(a){try{for(var b=0,c=this.subscribers.length;b<c;b++){var d=this.subscribers[b];if(a.equals(d))return}this.subscribers.push(a)}catch(a){console.error("[GlobalVariable register] :",a)}},GlobalVariable.prototype.unregister=function(a){this.subscribers.forEach(function(b,c){if(b.callback===a)return this.subscribers.splice(c,1),void(b=null)}.bind(this))},GlobalVariable.prototype.getName=function(){if(this.name)return this.name;for(var a in window)try{if(window[a]===this)return this.name=a,a}catch(a){}return null},GlobalVariable.prototype.setValue=function(a){a=this.convertValue(a),this.setDirectValue(a)},GlobalVariable.prototype.setDirectValue=function(a){a!==this.myValue&&(emosWS.listenGlobalVariablesChange(),this.value=a,emosWS.callbackGlobalVariablesChange())},GlobalVariable.prototype.convertValue=function(a){var b=typeof this.myValue,c=typeof a;if(b===c)return a;switch(b){case"boolean":return"string"===c?GetAsBoolean(a):Boolean(a);case"number":return Number(a);default:return a}},window.GlobalVariable=GlobalVariable;function AppVariable(a,b,c){this.APP_VAR="$APPVAR",this.DATACHANGE_FROM_CODE=0,this.DATACHANGE_FROM_LOCALSTORAGE=1,this.DATACHANGE_FROM_SERVERSTORAGE=2,this.topic=a,this.key=b,this.defaultValue=c,this.keyLS=this.APP_VAR+"."+a+"."+b,this.type=typeof c,this.serverStorage=emosWS.getServerStorage(a),GlobalVariable.call(this,c)}AppVariable.prototype=Object.create(GlobalVariable.prototype),AppVariable.prototype.constructor=AppVariable,AppVariable.prototype.init=function(){Object.defineProperty(this,"value",{get:this._getValue.bind(this),set:this.setMyValue.bind(this)}),window.addEventListener("storage",this.onLocalStorageChange.bind(this),!1),this.myValue=void 0,this.setMyValue(this.getLocalStorageValue()||this.defaultValue),this.serverStorage.getItem(this.key,function(a){void 0===a?this.setServerStorageValue(this.myValue):this.onDataChange(a,this.DATACHANGE_FROM_SERVERSTORAGE),this.serverStorageValue=this.myValue}.bind(this))},AppVariable.prototype.onLocalStorageChange=function(a){a.key===this.keyLS&&this.onDataChange(a.newValue,this.DATACHANGE_FROM_LOCALSTORAGE)},AppVariable.prototype.onDataChange=function(a,b){console.log("datachangeFROM: "+b),console.log(a);var c=b===this.DATACHANGE_FROM_LOCALSTORAGE?this.getValueFromString(a):a;this.valuesEqual(c,this.myValue)||this.setMyValue(c,b)},AppVariable.prototype.valuesEqual=function(a,b){try{return"object"===this.type?JSON.stringify(a)===JSON.stringify(b):a===b}catch(a){console.log(a)}return!1},AppVariable.prototype.setMyValue=function(a,b){a!==this.myValue&&(this.setValue(a),b!==this.DATACHANGE_FROM_LOCALSTORAGE&&(this.setLocalStorageValue(a),b!==this.DATACHANGE_FROM_SERVERSTORAGE&&void 0!==this.serverStorageValue&&this.setServerStorageValue(a)))},AppVariable.prototype.setDirectValue=function(a){a!==this.myValue&&(emosWS.listenGlobalVariablesChange(),this._setValue(a),emosWS.callbackGlobalVariablesChange())},AppVariable.prototype.getValueFromString=function(a){switch(this.type){case"boolean":return"true"===a;case"number":return Number(a);case"object":return JSON.parse(a);default:return a}},AppVariable.prototype.getLocalStorageValue=function(){return this.getValueFromString(localStorage.getItem(this.keyLS))},AppVariable.prototype.setLocalStorageValue=function(a){"object"===this.type&&(a=JSON.stringify(a)),localStorage.setItem(this.keyLS,a)},AppVariable.prototype.setServerStorageValue=function(a){this.serverStorage.setItem(this.key,a)},AppVariable.prototype.shareFunctionsTo=function(a){try{["getLocalStorageValue","setLocalStorageValue","setDirectValue","getValueFromString","valuesEqual"].forEach(function(b){a[b]=this.constructor.prototype[b]}.bind(this))}catch(a){console.log(a)}},window.AppVariable=AppVariable;function SessionsVariable(a){this.SESSIONS_VAR="$SESSIONSVAR",this.defaultValue=a,this.type=typeof a,GlobalVariable.call(this,a)}SessionsVariable.prototype=Object.create(GlobalVariable.prototype),SessionsVariable.prototype.constructor=SessionsVariable,AppVariable.prototype.shareFunctionsTo(SessionsVariable.prototype),SessionsVariable.prototype.init=function(){Object.defineProperty(this,"value",{get:this._getValue.bind(this),set:this.setMyValue.bind(this)}),window.addEventListener("storage",this.onLocalStorageChange.bind(this),!1),setTimeout(function(){this.keyLS=this.SESSIONS_VAR+"."+this.getName(),this.myValue=void 0,this.setMyValue(this.getLocalStorageValue()||this.defaultValue)}.bind(this),1)},SessionsVariable.prototype.onLocalStorageChange=function(a){a.key===this.keyLS&&this.onDataChange(a.newValue,!0)},SessionsVariable.prototype.onDataChange=function(a,b){console.log("fromLocalStorage: "+b),console.log(a);var c=this.getValueFromString(a);this.valuesEqual(c,this.myValue)||this.setMyValue(c,b)},SessionsVariable.prototype.setMyValue=function(a,b){a!==this.myValue&&(this.setValue(a),b||this.setLocalStorageValue(a))},window.SessionsVariable=SessionsVariable;function varInOut(a){var b=a;this.toString=function(){return b},Object.defineProperty(this,"value",{get:function(){return b},set:function(a){b=a}})}function ClientTest(){}ClientTest.prototype.testSVGRender=function(a){try{console.log("[Received TestSVGRender] : "+a.value);var b=JSON.parse(a.value),c=b.id,d=b.width,e=b.height,f=b.svg;console.log("[         TestSVGRender] id="+c+" / width="+d+" / height="+e+" / svg="+f);var g=document.createElement("canvas");document.body.appendChild(g);var h=g.getContext("2d"),i=new Image;i.src=f;var j=function(a){var b={};b.type="general",b.key="SVGRenderResult",b.value=JSON.stringify({id:c,image:a}),document.body.removeChild(g),emosWS.send(b)},k=function(){try{h.canvas.width=720,h.canvas.height=540,h.font="30px Arial",h.strokeText("SVG file has error!",10,50);var a="";a=g.toDataURL("image/jpeg",1),j(a)}catch(a){console.log("onerror error: "+a)}};i.onload=function(){try{h.canvas.width=i.naturalWidth||d,h.canvas.height=i.naturalHeight||e,h.drawImage(i,0,0);var a="";try{a=g.toDataURL("image/jpeg",1)}catch(a){console.log("canvas.toDataURL error: "+a),k()}j(a)}catch(a){console.log("Image onload error: "+a),k()}},i.onerror=function(){k()}}catch(a){console.log("testSVGRender error: "+a)}};function EventDispatcher(){this._listeners={}}EventDispatcher.prototype.addEventListener=function(a,b,c){var d=this._listeners;void 0===d[a]&&(d[a]=[]),-1===d[a].indexOf(b)&&(c?d[a].unshift(b):d[a].push(b))},EventDispatcher.prototype.hasEventListener=function(a,b){var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)},EventDispatcher.prototype.removeEventListener=function(a,b){var c=this._listeners,d=c[a];if(void 0!==d){var e=d.indexOf(b);-1!==e&&d.splice(e,1)}},EventDispatcher.prototype.dispatchEvent=function(a){var b=this._listeners,c=b[a.type];if(void 0!==c){for(var d=[],e=c.length,f=0;f<e;f++)d[f]=c[f];for(var f=0;f<e;f++)try{d[f].call(this,a.message)}catch(a){console.error("[dispatchEvent] :"+a)}}};function BINDX(a){this.name=a,window[a]=this,this.SLastSource=[],this.SQuality=0,this.SSecurityGroupRF=null,this.SSecurityPlant=null,this.SSecurityUserRF=null,this.STextValue=null,this.SDataChange=null;var b=null;Object.defineProperty(this,"STagname",{get:function(){return b},set:function(a){b=a}});var c=null;Object.defineProperty(this,"STextKey",{get:function(){return c},set:function(a){c=a}});var d=null;Object.defineProperty(this,"SDiagLib",{get:function(){return d},set:function(a){d=a;var b=a.split(";");new emosWS.ESDiagnosisWindow({conditionFunction:function(){return{DiagnosisLibID:parseInt(b[0]),PLC:b[1],ID:b[2],DiagnosisControl:b[3],GroupRightIndex:parseInt(b[4]),Enabled:!0}},PLACEHOLDER_USEHAND:!0,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USEHIDE:!1,STDPLACEHOLDER_SHAPENAME:"DuMmY"}).onClick()}});var e=null;Object.defineProperty(this,"SValue",{get:function(){return e},set:function(a){e=a}});var f=null;Object.defineProperty(this,"SCommDiag",{get:function(){return f},set:function(a){f=a}})}BINDX.prototype.SAppendTag=function(a){},BINDX.prototype.SWriteTag=function(a,b,c,d,e){},BINDX.prototype.SReadTag=function(a,b,c,d){},BINDX.prototype.SAddHost=function(a,b,c,d){},BINDX.prototype.SRemoveHost=function(a,b,c,d){};function BlinkInterval(a){this.intervalLength=a,this.listeners=[],this.queueActive=[],this.queueInactive=[],this.interval=null,this.active=!0}BlinkInterval.prototype.addListener=function(a,b){-1===this.listeners.indexOf(a)&&-1===this.queueActive.indexOf(a)&&-1===this.queueInactive.indexOf(a)&&(b?this.queueActive.push(a):this.queueInactive.push(a)),this.refresh()},BlinkInterval.prototype.GBS=function(){return emosWS.animationData.stillInit&&emosWS.animationData.callback&&this.addListener(emosWS.animationData.callback.datachangeListener,!0),this.active},BlinkInterval.prototype.sync=function(){this.clearInterval(),this.setInterval()},BlinkInterval.prototype.setInterval=function(){var a=(new Date).getTime(),b=1e3*Math.ceil(a/1e3)-a;this.interval=a,setTimeout(function(){console.info("[BlinkInterval] started at: "+(new Date).getTime()),this.interval=setInterval(function(){this.active&&this.queueActive.length>0&&(this.listeners=this.listeners.concat(this.queueActive),this.queueActive=[]),!this.active&&this.queueInactive.length>0&&(this.listeners=this.listeners.concat(this.queueInactive),this.queueInactive=[]);for(var a=0,b=this.listeners.length;a<b;a++)this.listeners[a]();this.active=!this.active}.bind(this),this.intervalLength)}.bind(this),b)},BlinkInterval.prototype.clearInterval=function(){clearInterval(this.interval),this.interval=null,this.active=!0},BlinkInterval.prototype.refresh=function(){this.listeners.length+this.queueActive.length+this.queueInactive.length>0?this.interval||this.setInterval():this.clearInterval()},BlinkInterval.prototype.remove=function(a,b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},BlinkInterval.prototype.removeListener=function(a){this.remove(this.listeners,a),this.remove(this.queueActive,a),this.remove(this.queueInactive,a),this.refresh()};function AccessToken(a){this.data=a,this.token=a.access_token;var b=null;a.expires_in?(b=new Date,b.setMinutes(b.getMinutes()+a.expires_in)):a.expires_at&&(b=new Date(a.expires_at)),this.expireAt=b}AccessToken.prototype.getToken=function(){return this.token},AccessToken.prototype.getExpireIn=function(){return this.expireAt-Date.now()},AccessToken.prototype.getData=function(){return this.data},AccessToken.prototype.equals=function(a){return this.token===a.getToken()},AccessToken.prototype.toString=function(){return JSON.stringify({access_token:this.token,expires_at:this.expireAt})};function Cookie(){}Cookie.prototype.getItem=function(a){return a?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},Cookie.prototype.setItem=function(a,b,c,d,e,f){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toUTCString()}return document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":""),!0},Cookie.prototype.removeItem=function(a,b,c){return!!this.hasItem(a)&&(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(c?"; domain="+c:"")+(b?"; path="+b:""),!0)},Cookie.prototype.hasItem=function(a){return!!a&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},Cookie.prototype.keys=function(){for(var a=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),b=a.length,c=0;c<b;c++)a[c]=decodeURIComponent(a[c]);return a};function Cas(){this.WS_AUTH_STATUS_TEXT="EMOS_AUTH",this.WS_SESSION_COOKIE_TEXT="EMOS_WS_SESSION",this.ROUTE_COOKIE_TEXT="ROUTEID",this.CAS_ST_TICKET="CASSTTICKET",this.CAS_USER_LOGGED_IN="CASUSERLOGGEDIN",this.CAS_USER_LOGGED_OFF="CASUSERLOGGEDOFF",this.CAS_LOADED="CAS_LOADED",this.casServerURL="",this.checkCallbackURL="",this.trustedAppServers=window.trustedAppServers,this.cookie=new Cookie,this.currentCookie=null,this.hiddenIFrame=null,this.onCasLoaded=null,this.iframes={},this.ticketCallbackIndex=0,this.ticketCallbackMap={},this.TIMEOUT=4e3,this.init()}Cas.prototype.createTicketCallback=function(a){if(a){var b=this,c=this.ticketCallbackIndex,d=document.createElement("iframe");a.iframe=d,this.ticketCallbackMap[c]=a,d.style.display="none",d.src=this.getCASCallbackURL()+this.getCallbackURL(c),document.body.appendChild(d),setTimeout(function(){b.onTicketCallback(c)},this.TIMEOUT),this.ticketCallbackIndex++}},Cas.prototype.isReachable=function(a){if(a&&$(".emoslogin")[0]!==document.activeElement){var b=this,c=!1,d=$("<iframe style='display:none; pointer-events:none; tabindex:-1' src='"+this.getCASCallbackURL()+"'></iframe>"),e=function(){b.onCasLoaded=null,d.remove()},f=function(){c=!0,e(),a.success()},g=function(){e(),a.error()};this.onCasLoaded=f,$("body").append(d),setTimeout(function(){c||g()},this.TIMEOUT)}},Cas.prototype.getCallbackURL=function(a){return"?callback="+a},Cas.prototype.onTicketCallback=function(a,b){var c=this.ticketCallbackMap[a];if(c){var d=c.iframe;try{b?c.success&&c.success(b,this.checkCallbackURL+this.getCallbackURL(a)):c.error&&(c.error("Could not get CAS Service ticket"),delete this.ticketCallbackMap[a])}catch(a){console.error(a)}d.parentNode.removeChild(d),delete this.ticketCallbackMap[a]}},Cas.prototype.init=function(){window.addEventListener("load",function(){this.addHiddenIFrame()}.bind(this),!1),window.addEventListener("message",function(a){try{var b=JSON.parse(a.data);switch(b.type){case this.CAS_ST_TICKET:var c=b.callback;if(c)this.onTicketCallback(c,b.ticket);else{var d=function(){emosWS.sendLoginByKey(b.ticket,null,null,"ticket")}.bind(this);emosWS.getWebSocketStatus()?d():emosWS.addEventListener("open",d)}break;case this.CAS_USER_LOGGED_IN:if(!this.currentCookie){var e=this.cookie.getItem(this.WS_SESSION_COOKIE_TEXT);e&&(this.currentCookie=e,emosWS.sendLoginByKey(this.cookie.getItem(this.WS_SESSION_COOKIE_TEXT),null,null,"cookie"))}break;case this.CAS_USER_LOGGED_OFF:this.currentCookie&&emosWS.sendLogoff();break;case this.CAS_LOADED:this.onCasLoaded&&this.onCasLoaded()}}catch(a){}}.bind(this),!1),window.addEventListener("storage",this.onLocalStorageChange.bind(this),!1),this.monitorSSOCookie()},Cas.prototype.getUrlVars=function(a){for(var b=[],c,d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)c=d[e].split("="),b.push(c[0]),b[c[0]]=c[1];return b},Cas.prototype.onActiveCasServer=function(a){this.casServerURL=a.host,this.checkCallbackURL=a.service,this.casLoginURL=a.host+"/login?service="+a.service,this.cookie.getItem(this.WS_SESSION_COOKIE_TEXT)||this.tryToGetCASServiceTicketForLogin(),console.info(a)},Cas.prototype.validateTicket=function(a){var b=this.casServerURL+"/serviceValidate?service="+this.checkCallbackURL+"&ticket="+a;$.get(b,function(a){console.log("*******validateTicket result************\n"+(new XMLSerializer).serializeToString(a))})},Cas.prototype.addHiddenIFrame=function(){this.hiddenIFrame=document.createElement("iframe"),this.hiddenIFrame.style.display="none",document.body.appendChild(this.hiddenIFrame)},Cas.prototype.setAuthLocalStorages=function(a){try{this.trustedAppServers.forEach(function(b){var c=this.iframes[b];c||(c=document.createElement("iframe"),c.style.display="none",document.body.appendChild(c),this.iframes[b]=c),c.setAttribute("src",b+"/SetAuthLocalStorage.html?action="+a)}.bind(this)),this.setAuthLocalStorage(a)}catch(a){console.log("setAuthLocalStorage failed: "+a)}},Cas.prototype.setAuthLocalStorage=function(a){try{"add"===a?localStorage.setItem(this.WS_AUTH_STATUS_TEXT,1):"delete"===a&&localStorage.removeItem(this.WS_AUTH_STATUS_TEXT)}catch(a){console.log("setAuthLocalStorage failed: "+a)}},Cas.prototype.informTrustedApps=function(){this.setAuthLocalStorages(this.currentCookie?"add":"delete")},Cas.prototype.tryToGetCASServiceTicketForLogin=function(){var a=this.getCASCallbackURL();a&&this.hiddenIFrame.setAttribute("src",a)},Cas.prototype.getCASCallbackURL=function(){return this.casServerURL&&this.checkCallbackURL?this.casServerURL+"/login?service="+this.checkCallbackURL:null},Cas.prototype.getParameterByName=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+b+"=([^&#]*)"),d=c.exec(a);return null===d?"":decodeURIComponent(d[1].replace(/\+/g," "))},Cas.prototype.getCASServiceTicket=function(a){try{var b=this.getCASCallbackURL(),c=function(b){a.error&&a.error(b)};b?this.createTicketCallback(a):c("The authentication service is not available at the moment!")}catch(a){console.error(a)}},Cas.prototype.sendCASLogout=function(){var a=this.casServerURL+"/logout";this.hiddenIFrame.setAttribute("src",a)},Cas.prototype.onWSCookie=function(a){this.currentCookie=a,this.cookie.setItem(this.WS_SESSION_COOKIE_TEXT,a,null,"/"),emosWS.propagateMessage(JSON.stringify({type:this.CAS_USER_LOGGED_IN}))},Cas.prototype.onPassed=function(a){a.wscookie?(this.currentCookie=a.wscookie,this.cookie.setItem(this.WS_SESSION_COOKIE_TEXT,a.wscookie,null,"/"),this.setCookieForCurrentWSServer(a.wscookie),emosWS.propagateMessage(JSON.stringify({type:this.CAS_USER_LOGGED_IN}))):this.currentCookie="abc",this.setAuthLocalStorage("add"),this.informTrustedApps()},Cas.prototype.getHTTPURL=function(){var a={ws:"http",wss:"https"};return emosWS.getWSHostname().replace(/(.*)(:\/\/.*\/).*/,function(b,c,d){return a[c]+d+"setcookie.html"})},Cas.prototype.setCookieForCurrentWSServer=function(a){this.setCookieForDomain(this.getHTTPURL(),a)},Cas.prototype.deleteCookieForCurrentWSServer=function(){this.setCookieForDomain(this.getHTTPURL(),"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},Cas.prototype.setCookieForDomain=function(a,b){var c=document.createElement("iframe");c.className="abc",c.style.display="none",c.src=a+"?setcookie="+b,document.body.appendChild(c),setTimeout(function(){c.parentNode.removeChild(c)},this.TIMEOUT)},Cas.prototype.onFailed=function(a){switch(a.reason){case"Cookie":this.logoffSession(),this.tryToGetCASServiceTicketForLogin()}},Cas.prototype.onLogoff=function(){this.logoffSession(),this.logoffSSO(),this.informTrustedApps()},Cas.prototype.logoffSession=function(){this.currentCookie=null,this.cookie.removeItem(this.WS_SESSION_COOKIE_TEXT,"/"),this.deleteCookieForCurrentWSServer()},Cas.prototype.logoffSSO=function(){this.sendCASLogout(),emosWS.propagateMessage(JSON.stringify({type:this.CAS_USER_LOGGED_OFF}))},Cas.prototype.onLocalStorageChange=function(a){a.key===this.WS_AUTH_STATUS_TEXT&&(!this.currentCookie&&a.newValue?setTimeout(function(){var a=this.cookie.getItem(this.WS_SESSION_COOKIE_TEXT);a?(this.currentCookie=a,emosWS.sendLoginByKey(this.cookie.getItem(this.WS_SESSION_COOKIE_TEXT),null,null,"cookie")):this.getCASServiceTicket()}.bind(this),1):this.currentCookie&&!a.newValue&&(emosWS.sendLogoff(),this.logoffSession()))},Cas.prototype.monitorSSOCookie=function(){var a=3e4,b=(new Date).getTime()+a,c=!1,d=null,e=function(){try{c||(new Date).getTime()>b?(clearInterval(d),console.log("Stop monitoring SSO cookie !")):c||"PASSED"!==emosWS.login.au.status||$(".emoslogin")[0]===document.activeElement||emosWS.Cas.getCASServiceTicket({success:function(){c=!0},error:function(){"PASSED"===emosWS.login.au.status&&(c=!0,emosWS.sendLogoff())}})}catch(a){}};console.log("Monitoring SSO cookie..."),d=setInterval(e,1e3)};function Style(){this.fill=null,this.stroke=null,this["stroke-width"]=null,this.display=null,this.cursor=null}function Shape(a){emosWS.shapeNumber++,this.id=a,this.shape=null,this.shapeText=null,this.text=null,this.strokeWidth=null,this.scaleX=1,this.scaleY=1,this.deltaX=0,this.deltaY=0,this.animations=[],this.style=new Style,this.setShapes(a),this.inDebug=!1,this.ready=!1,this.JSJobs=[],this.ESJobs=[],emosWS.dispatchEvent({type:"HMIshape"})}Shape.prototype.add=function(a){return this.animations.push({animation:a,style:new Style})-1},Shape.prototype.executeJobs=function(a){this.ready&&(this.JSJobs.forEach(function(b){try{b(a)}catch(a){console.log("[Shape execute JSJobs]",a)}}),emosWS.listenGlobalVariablesChange(),this.ESJobs.forEach(function(b){try{b(a)}catch(a){console.log("[Shape execute ESJobs ]",a)}}),emosWS.callbackGlobalVariablesChange(),emosWS.clickData.event=null)},Shape.prototype.addJob=function(a,b,c){this.ready||setEvent(this.id,"click",this.executeJobs.bind(this),b?"pointer":"initial"),this.ready=!0,(c?this.JSJobs:this.ESJobs).push(a)},Shape.prototype.onContextMenu=function(a){emosWS.debug&&emosWS.debug.ctrlPressed&&emosWS.debug.animationTab&&(a.preventDefault(),emosWS.debug.animationTab.onShapeContextMenu(this))},Shape.prototype.setStyle=function(a,b){try{if(this.shape){var c=this.animations[b].style;for(var d in a){var e=d,f=a[d];c[e]=f;for(var g=0,h=this.animations.length;g<h;g++){if(null!==(f=this.animations[g].style[e])){this.style[e]=f,this.setStyleDeep(this.shape,e,f);break}}}this.inDebug&&(emosWS.debug.animationTab.onAnimationChange(b,c),emosWS.debug.animationTab.onAnimationChange(-1,this.style))}}catch(a){console.error("[Shape setStyle] : ",a)}},Shape.prototype.setStyleDeep=function(a,b,c){try{if("g"===a.tagName&&c)switch(b){case"fill":case"cursor":for(var d=0,e=a.childNodes.length;d<e;d++)this.setStyleDeep(a.childNodes[d],b,c);break;case"display":this.setVisibility(a,c);break;default:a.style[b]=c}else if(c&&void 0!==a.style)switch(b){case"fill":this.setFillColor(a,c);break;case"display":this.setVisibility(a,c);break;default:a.style[b]=c}}catch(a){console.error("[Shape setStyleDeep] : ",a)}},Shape.prototype.setFillColor=function(a,b){if(a.GradientStopColor||this.searchGradientStopColor(a),a.GradientStopColor)for(var c=0,d=a.GradientStopColor.length;c<d;c++)a.GradientStopColor[c].setAttribute("stop-color",b);else a.style.fill=b},Shape.prototype.setVisibility=function(a,b){a.style.display=b,void 0!==a.shapeText&&(a.shapeText.style.display=b),void 0!==a.shapeSub&&(a.shapeSub.style.display=b)},Shape.prototype.setShapes=function(a){if(!emosWS.attr.svg)return null;if(this.shape=emosWS.attr.svg.getElementById(a),this.shape){this.shape.addEventListener("contextmenu",this.onContextMenu.bind(this),!0);var b=this.shape.getAttribute("stroke-width");this.strokeWidth=null===b||""===b?1:Number(b)}this.searchGradientStopColor(this.shape),this.shapeText=emosWS.attr.svg.getElementById(a+".Text")||this.shape,this.shapeText&&(this.shape.shapeText=this.shapeText,this.tspans=this.shapeText.getElementsByTagName("tspan"),this.shapeTextContent=this.tspans[0]||this.shapeText,this.shapeTextContent&&(this.text=this.shapeTextContent.textContent)),this.shapeSub=emosWS.attr.svg.getElementById(a+".Sub"),this.shapeSub&&this.shape&&(this.shape.shapeSub=this.shapeSub)},Shape.prototype.setText=function(a){if(this.tspans)for(var b=0,c=this.tspans.length;b<c;b++)this.tspans[b].textContent="";this.shapeTextContent&&(this.text=this.shapeTextContent.textContent=a)},Shape.prototype.searchGradientStopColor=function(a){if(a){a.GradientStopColor=null;var b=a.getAttribute("fill");if(b){var c=b.match(/url\(#(.*)\)/);if(c){var d=emosWS.attr.svg.getElementById(c[1]);d.childNodes[1]&&(a.GradientStopColor=[],a.GradientStopColor.push(d.childNodes[1]),d.childNodes[5]&&a.GradientStopColor.push(d.childNodes[5]))}}}};function IDB(){this.version=2,this.databaseName="emos",this.isReady=!1,this.tasks=[],this.db=null,this.plcStore={name:"plc",keyPath:"plctag"},this.init()}IDB.prototype.init=function(){try{if(window.indexedDB){var a=window.indexedDB.open(this.databaseName,this.version);a.onerror=function(a){console.error(a)},a.onsuccess=function(a){this.db=a.target.result,this.isReady=!0,this.executeTasks()}.bind(this),a.onupgradeneeded=function(a){var b=this.db=a.target.result;b.createObjectStore(this.plcStore.name,{keyPath:this.plcStore.keyPath}).transaction.oncomplete=function(a){var c=this.plcStore.store=b.transaction(this.plcStore.name,"readwrite").objectStore(this.plcStore.name)}.bind(this)}.bind(this)}else console.info("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.")}catch(a){console.error("[IDB.prototype.init] : ",a)}},IDB.prototype.submitTask=function(a,b){this.isReady?a(b):this.tasks.push({callback:a,params:b})},IDB.prototype.executeTasks=function(){this.tasks.forEach(function(a){try{a.callback(a.params)}catch(a){console.error(a)}}),this.tasks=[]},IDB.prototype.addPLC=function(a){this.submitTask(function(a){try{if(this.db){a.value.init=!0;this.db.transaction(this.plcStore.name,"readwrite").objectStore(this.plcStore.name).add(a).onsuccess=function(a){}}}catch(a){console.error("[IDB.prototype.addPLC] : ",a)}}.bind(this),a)},IDB.prototype.updatePLC=function(a){this.submitTask(function(a){if(this.db){var b=this.db.transaction(this.plcStore.name,"readwrite").objectStore(this.plcStore.name).put(a);b.onerror=function(a){},b.onsuccess=function(a){}}}.bind(this),a)},IDB.prototype.getPLC=function(a,b){this.submitTask(function(a){var b=a.plc,c=a.callback;if(this.db){var d=this.db.transaction(this.plcStore.name,"readwrite").objectStore(this.plcStore.name).get(b);d.onerror=function(a){},d.onsuccess=function(a){var b=d.result.value;b.source="IndexedDB",void 0===b.init&&c(d.result.value)}}}.bind(this),{plc:a,callback:b})},IDB.prototype.deletePLC=function(a){this.submitTask(function(a){if(this.db){this.db.transaction(this.plcStore.name,"readwrite").objectStore(this.plcStore.name).delete(a).onsuccess=function(a){}}}.bind(this),a)};function Tab(a){this.tabIndex=a,this.active=!1,this.html="",this.init()}Tab.prototype.init=function(){console.info("[",this.constructor.name,"] init")},Tab.prototype.isActive=function(){var a=emosWS.debug;return a.activeTabId===this.tabIndex&&a.isOpen()},Tab.prototype.activate=function(){this.refresh()},Tab.prototype.setActive=function(){this.isActive()||emosWS.debug.dialog.emos.tabs.tabs({active:this.tabIndex})},Tab.prototype.setInactive=function(){},Tab.prototype.displayObject=function(a,b,c){["fill","stroke"].indexOf(b)>-1&&(c=c||"#FFFFFF",a.style["background-color"]=c,a.style.color=this.invertColor(c))},Tab.prototype.invertColor=function(a){var b=a;return b=b.substring(1),b=parseInt(b,16),b^=16777215,b=b.toString(16),b=("000000"+b).slice(-6),b="#"+b},Tab.prototype.deactivate=function(){},Tab.prototype.getHTML=function(){return""},Tab.prototype.onHTMLReady=function(){},Tab.prototype.refresh=function(){},Tab.prototype.getId=function(){return"EDebug"+this.name+this.index++},Tab.prototype.highlight=function(a){if(!a.inEMOSHighLight){a.inEMOSHighLight=!0;var b=a.style["background-color"],c=a.style.color;a.style["background-color"]="#4d90fe",a.style.color="white",setTimeout(function(){a.style["background-color"]=b,a.style.color=c,a.inEMOSHighLight=!1},250)}};function AnimationTab(a){this.name="Shape",this.index=0,this.shape=null,this.elements={gui:{html:null,id:this.getId()},div:{html:null,id:this.getId()},shapename:{html:null,id:this.getId()},animationNo:{html:null,id:this.getId()},head:{html:null,id:this.getId()},shape:{html:null,id:this.getId()},table:{html:null,id:this.getId()}},Tab.call(this,a)}AnimationTab.prototype=Object.create(Tab.prototype),AnimationTab.prototype.constructor=AnimationTab,AnimationTab.prototype.init=function(){this.html=this.getHTML()},AnimationTab.prototype.getHTML=function(){return'<div id="'+this.elements.gui.id+'">                <div id="'+this.elements.div.id+'">                    <table style="width:100%">                        <tr>                            <td width="20%">Shape name</td>                            <td width="60%"><input type="text" id="'+this.elements.shapename.id+'"/></td>                        </tr>                        <tr>                            <td width="20%">Animations</td>                            <td width="60%" id="'+this.elements.animationNo.id+'"></td>                        </tr>                    </table>                </div>                <div>                    <table class="DebugDataTable" style="width:100%">                        <thead>                            <tr id="'+this.elements.head.id+'" >                                <td>Animation</td>                            </tr>                            <tr id="'+this.elements.shape.id+'" >                                <td>&sum;</td>                            </tr>                        </thead>                        <tbody id="'+this.elements.table.id+'" ></tbody>                    </table>                </div>\n            </div>'},AnimationTab.prototype.onHTMLReady=function(){for(var a in this.elements){var b=this.elements[a];b.html=document.getElementById(b.id)}this.elements.shapename.html.addEventListener("change",function(){var a=emosWS.shapes[this.elements.shapename.html.value];a?this.onShapeContextMenu(a):this.elements.shapename.html.value=this.shape.id}.bind(this),!1),this.update()},AnimationTab.prototype.update=function(){this.updateShape()},AnimationTab.prototype.refresh=function(){this.update()},AnimationTab.prototype.deactivate=function(){this.shape&&(this.shape.inDebug=!1)},AnimationTab.prototype.updateShape=function(){if(this.isActive()&&this.shape){this.elements.gui.html.style.display="block",this.shape.inDebug=!0,this.elements.shapename.html.value=this.shape.id,this.elements.animationNo.html.textContent=this.shape.animations.length;var a=this.elements.table.html;while(a.rows.length>0)a.deleteRow(0);var b=this.elements.head.html,c=this.elements.shape.html;while(b.cells.length>1)b.deleteCell(1),c.deleteCell(1);Object.keys(this.shape.style).forEach(function(a,d){var e=b.insertCell(d+1),f=c.insertCell(d+1);e.textContent=a,f.textContent=this.shape.style[a],this.displayObject(f,a,f.textContent)}.bind(this)),this.shape.animations.forEach(function(b,c){var d=a.insertRow(c),e=d.insertCell(0);e.textContent=b.animation.constructor.name,e.title=b.animation.getDetail(),Object.keys(this.shape.style).forEach(function(a,c){var e=d.insertCell(c+1);e.textContent=b.style[a],this.displayObject(e,a,e.textContent)}.bind(this))}.bind(this))}else this.elements.gui.html.style.display="none"},AnimationTab.prototype.onShapeContextMenu=function(a){emosWS.debug.isOpen()&&(this.deactivate(),this.setActive(),this.shape=a,this.shape.inDebug=!0,this.updateShape(),this.debugShape(a))},AnimationTab.prototype.onAnimationChange=function(a,b){if(this.isActive()){var c=-1===a?this.elements.shape.html:this.elements.table.html.rows[a];Object.keys(b).forEach(function(a,d){var e=c.cells[d+1];e.textContent=b[a],this.displayObject(e,a,e.textContent)}.bind(this))}},AnimationTab.prototype.debugShape=function(a){console.info("[AnimationTab debugShape]",a)};function DataTab(a){this.name="Data",this.index=0,this.shape=null,this.modeAll=!1,this.activated=!1,this.display={groupInfo:{no:"No.",tag:"Tag",tagType:"Type",listeners:"Listeners"},value:{source:"Source",value:"Value",quality:"Quality",ts:"Time"}},this.elements={radioDiv:{html:null,id:this.getId()},radioAll:{html:null,id:this.getId()},radioCustom:{html:null,id:this.getId()},addDiv:{html:null,id:this.getId()},addInput:{html:null,id:this.getId()},addIO:{html:null,id:this.getId()},addAlarm:{html:null,id:this.getId()},ioHead:{html:null,id:this.getId()},ioTable:{html:null,id:this.getId()}},this.radioId=this.getId(),this.datachangeListener=this.datachangeListener.bind(this),Tab.call(this,a)}DataTab.prototype=Object.create(Tab.prototype),DataTab.prototype.constructor=DataTab,DataTab.prototype.init=function(){this.html=this.getHTML()},DataTab.prototype.getHTML=function(){return'<div>                    <div class="FloatLeft" id="'+this.elements.radioDiv.id+'">                        <input'+(this.modeAll?' checked="checked"':"")+' type="radio" id="'+this.elements.radioAll.id+'" name="'+this.radioId+'"><label for="'+this.elements.radioAll.id+'">All</label>                        <input'+(this.modeAll?"":' checked="checked"')+' type="radio" id="'+this.elements.radioCustom.id+'" name="'+this.radioId+'"><label for="'+this.elements.radioCustom.id+'">Custom</label>                    </div>                    <div class="FloatRight" id="'+this.elements.addDiv.id+'">                        <input type="text" id="'+this.elements.addInput.id+'">                        <button type="button" id="'+this.elements.addIO.id+'">+IO</button>                        <button type="button" id="'+this.elements.addAlarm.id+'">+AL</button>                    </div>                </div>                <div>                    <div class="debugDataTabFilter">                        Filter:                         <input class="DebugDataFilter" type="text" placeholder="any text to filter">                    </div>                    <table class="DebugDataTable DebugData" style="width:100%">                        <thead id="'+this.elements.ioHead.id+'" ></thead>                        <tbody id="'+this.elements.ioTable.id+'" ></tbody>                    </table>                </div>'},DataTab.prototype.refresh=function(){this.setMode(this.modeAll)},DataTab.prototype.showQualityBadTags=function(){$("#"+this.elements.radioAll.id).attr("checked",!0).button("refresh"),this.setMode(!0);var a="bad";$(".DebugDataFilter").val(a),$.uiTableFilter($(".DebugData"),a)},DataTab.prototype.insertTable=function(){this.setMode(this.modeAll)},DataTab.prototype.update=function(){this.activated=!0;var a=this.elements.ioTable.html;while(a.rows.length>0)a.deleteRow(0);this.modeAll&&Object.keys(emosWS.tagDestination).forEach(function(a){var b=emosWS.tagDestination[a];this.addRow(b)}.bind(this))},DataTab.prototype.addRow=function(a){var b=this.elements.ioTable.html.insertRow();this.updateRow(b,a),this.subscribe(b,a)},DataTab.prototype.updateRow=function(a,b,c){if(a.cells.length>0)while(a.cells.length>0)a.deleteCell(0);var d="debugBad",e=b.actualData;if(e)switch(e.type){case"dataChange":d="IndexedDB"===e.source?"debugCache":192===e.quality?"debugGood":"debugBad";break;case"diagnosisWindow":d="EMOSDEFAULT"===e.value.OPCVersionID?"debugBad":"debugGood"}a.className=d,Object.keys(this.display.groupInfo).forEach(function(c){var d=a.insertCell();switch(c){case"no":d.textContent=a.rowIndex;break;case"tagType":d.textContent=b.getTagType();break;case"listeners":d.textContent=b.subscribers.length;break;default:d.textContent=b[c]}}),Object.keys(this.display.value).forEach(function(c){var f=a.insertCell();switch(c){case"quality":f.textContent="debugGood"===d?"good":"bad";break;case"value":e&&this.processCell(f,b);default:if(e){f.textContent=e[c];break}}}.bind(this)),a.title=b.toString()},DataTab.prototype.processCell=function(a,b){a.contentEditable=CheckUserRight("sys_sr",2),a.addEventListener("blur",function(){b.setValue(a.textContent)},!1)},DataTab.prototype.onUserRightChange=function(){for(var a=CheckUserRight("sys_sr",2),b=this.elements.ioTable.html,c=0,d=b.rows.length;c<d;c++)for(var e=b.rows[c].cells,f=0,g=e.length;f<g;f++){var h=e[f];void 0!==h.contentEditable&&(h.contentEditable=a)}},DataTab.prototype.subscribe=function(a,b){var c=new Subscriber(this.datachangeListener,{row:a,sGroup:b});b.register(c),a.sGroup=b},DataTab.prototype.unsubscribeAll=function(){for(var a=this.elements.ioTable.html,b=0,c=a.rows.length;b<c;b++){a.rows[b].sGroup.unregister(this.datachangeListener)}},DataTab.prototype.datachangeListener=function(a,b){this.updateRow(b.row,b.sGroup),this.highlight(b.row)},DataTab.prototype.setMode=function(a){this.modeAll===a&&this.activated||(this.modeAll=a,this.elements.addDiv.html.style.visibility=a?"hidden":"visible",this.elements.addInput.html.value="",this.unsubscribeAll(),this.update())},DataTab.prototype.onHTMLReady=function(){for(var a in this.elements){var b=this.elements[a];b.html=document.getElementById(b.id)}$("#"+this.elements.radioDiv.id).buttonset();var c=this.elements.ioHead.html;Object.keys(this.display).forEach(function(a){var b=this.display[a];Object.keys(b).forEach(function(a,d){var e=c.appendChild(document.createElement("th"));e.textContent=e.title=b[a],"tag"===a&&(e.className="debugHalf")})}.bind(this)),this.elements.radioAll.html.addEventListener("click",this.setMode.bind(this,!0)),this.elements.radioCustom.html.addEventListener("click",this.setMode.bind(this,!1)),this.elements.addIO.html.addEventListener("click",this.onAddButtonClick.bind(this,Definition.tagType.IO)),this.elements.addAlarm.html.addEventListener("click",this.onAddButtonClick.bind(this,Definition.tagType.Alarm)),emosWS.addEventListener("HMIplc",this.onNewSGroup.bind(this));var d=$(".DebugData");$(".DebugDataFilter").keyup(function(){$.uiTableFilter(d,this.value)}),$("th").css({position:"relative"}).resizable({resizeHeight:!1,handles:"e, w",handleSelector:"",onDragStart:function(a,b,c){return!!$(a.target).hasClass("resizer")}}),emosWS.addEventListener("UserRight",this.onUserRightChange.bind(this))},DataTab.prototype.onAddButtonClick=function(a){var b=this.elements.addInput.html.value.replace(/ /g,""),c=b+a.id,d=emosWS.tagDestination[c];if(d){for(var e=this.elements.ioTable.html,f=0,g=e.rows.length;f<g;f++){if(e.rows[f].sGroup===d)return}this.elements.addInput.html.value=""}else d=new a.subscriberGroup(b,a),emosWS.tagDestination[c]=d;this.addRow(d)},DataTab.prototype.onNewSGroup=function(a){this.isActive()&&this.modeAll&&this.addRow(a)},DataTab.prototype.deactivate=function(){this.unsubscribeAll(),this.activated=!1};function LinkTab(a){this.name="Link",this.index=0,this.links={},this.elements={refreshButton:{html:null,id:this.getId()},linkTable:{html:null,id:this.getId()}},Tab.call(this,a)}LinkTab.prototype=Object.create(Tab.prototype),LinkTab.prototype.constructor=LinkTab,LinkTab.prototype.init=function(){this.html=this.getHTML()},LinkTab.prototype.getHTML=function(){return'<div>                    <table class="DebugDataTable" style="width:100%">                        <thead>                            <tr>                                <td width="10%"><button id="'+this.elements.refreshButton.id+'">Refresh</button></td>                                <td width="75%">URL</td>                                <td width="15%">Status</td>                            </tr>                        </thead>                        <tbody id="'+this.elements.linkTable.id+'" ></tbody>                    </table>                </div>'},LinkTab.prototype.onHTMLReady=function(){for(var a in this.elements){var b=this.elements[a];b.html=document.getElementById(b.id)}var c=this;$("#"+this.elements.refreshButton.id).button({icons:{primary:"ui-icon-refresh"},text:!1}).click(function(){c.updateLinkTable()})},LinkTab.prototype.refresh=function(){this.updateLinkTable()},LinkTab.prototype.updateLinkTable=function(){var a=this.elements.linkTable.html;this.links={};while(a.rows.length>0)a.deleteRow(0);emosWS.links.forEach(function(a){this.links[a.page]=null}.bind(this)),Object.keys(this.links).forEach(function(b){var c=a.insertRow(),d=c.insertCell(),e=c.insertCell(),f=document.createElement("a");f.href=b,f.innerHTML=b,f.target="_blank",e.appendChild(f);var g=c.insertCell();d.textContent=c.rowIndex,c.title=b,this.updateCasStatus(b,g)}.bind(this))},LinkTab.prototype.updateCasStatus=function(a,b){var c=this,d=function(){c.refreshURLStatus(!0,b)},e=function(){c.refreshURLStatus(!1,b)};$.ajax({url:a,type:"HEAD",timeout:1e3,cache:!1,success:d,error:e})},LinkTab.prototype.refreshURLStatus=function(a,b){b.textContent=String.fromCharCode(a?10004:10008),b.title=a?"reachable":"unreachable",b.style.color="white",b.style["background-color"]=a?"green":"red",b.style["text-align"]="center",this.casReachable=a};function OverviewTab(a){this.name="Overview",this.index=0,this.casReachable=null,this.elements={version:{html:null,id:this.getId()},diagnosisMode:{html:null,name:this.getId(),onclick:this.onDiagnosisModeClick},unit:{html:null,name:this.getId(),onclick:this.onUnitClick},allowPoke:{html:null,id:this.getId()},url:{html:null,id:this.getId()},urlparent:{html:null,id:this.getId()},wsServer:{html:null,id:this.getId()},wsStatus:{html:null,id:this.getId()},username:{html:null,id:this.getId()},login:{html:null,id:this.getId()},casCaption:{html:null,id:this.getId()},casServer:{html:null,id:this.getId()},casStatus:{html:null,id:this.getId()},plc:{html:null,id:this.getId()},shape:{html:null,id:this.getId()},animation:{html:null,id:this.getId()},text:{html:null,id:this.getId()},link:{html:null,id:this.getId()},gv:{html:null,id:this.getId()},glc:{html:null,id:this.getId()}},Tab.call(this,a)}OverviewTab.prototype=Object.create(Tab.prototype),OverviewTab.prototype.constructor=OverviewTab,OverviewTab.prototype.init=function(){this.html=this.getHTML()},OverviewTab.prototype.updateServersTooltip=function(){$("#dwspTooltip").prop("title",this.getServersTooltip())},OverviewTab.prototype.getServersTooltip=function(){var a="";return serverPool&&(a+="Server list:\n",serverPool.forEach(function(b){a+=b+"\n"})),a},OverviewTab.prototype.getHTML=function(){var a=window.location!==window.parent.location?document.referrer:document.location;return'<div>\n                    <p class="debugP"><b>Version</b></p>\n                    <table class="DebugDataTable" style="width:100%">\n                        <tr>\n                            <td width="20%">emos.js</td>\n                            <td width="80%" id="'+this.elements.version.id+'"></td>\n                        </tr>\n                    </table>\n                </div>\n                <div>\n                    <p class="debugP"><b>URL</b></p>\n                    <table class="DebugDataTable" style="width:100%">\n                        <tr>\n                            <td width="20%">URL</td>\n                            <td width="80%"><a target="_blank" href="'+window.location.href+'" id="'+this.elements.url.id+'">'+window.location.href+'</a></td>\n                        </tr>\n                        <tr>\n                            <td width="20%">URL parent</td>\n                            <td width="80%"><a target="_blank" href="'+a+'" id="'+this.elements.urlparent.id+'">'+a+'</a></td>\n                        </tr>\n                    </table>\n                </div>\n                <div>\n                    <p class="debugP"><b>Authentication & User rights</b></p>\n                    <table class="DebugDataTable" style="width:100%">\n                        <tr>\n                            <td width="20%">Username</td>\n                            <td width="60%" id="'+this.elements.username.id+'"></td>\n                            <td width="20%"><button class="debugLogin" id="'+this.elements.login.id+'">Login</button></td>\n                        </tr>\n                    </table>\n                </div>\n                <div>\n                    <p class="debugP"><b>WebSocket connection</b></p>\n                    <table class="DebugDataTable" style="width:100%">\n                        <tr>\n                            <td id="dwspTooltip" width="20%" title="'+this.getServersTooltip()+'">WS URI</td>\n                            <td width="60%" id="'+this.elements.wsServer.id+'"></td>\n                            <td width="20%" id="'+this.elements.wsStatus.id+'"></td>\n                        </tr>\n                    </table>\n                </div>\n                <div>\n                    <p class="debugP"><b>CAS Server</b></p>\n                    <table class="DebugDataTable" style="width:100%">\n                        <tr>\n                            <td width="20%" id="'+this.elements.casCaption.id+'">CAS URI</td>\n                            <td width="80%"><a target="_blank" href="" id="'+this.elements.casServer.id+'"></a></td>\n                            \x3c!--<td width="20%" id="'+this.elements.casStatus.id+'"></td>--\x3e\n                        </tr>\n                    </table>\n                </div>\n                \x3c!--<div>\n                    <p class="debugP"><b>DiagnosisWindowMode</b></p>\n                    <input type="radio" name="'+this.elements.diagnosisMode.name+'" value="0"> Built-in\n                    <input type="radio" name="'+this.elements.diagnosisMode.name+'" value="1"> Framework\n                    <input type="radio" name="'+this.elements.diagnosisMode.name+'" value="2"> Both\n                </div>--\x3e\n                <div>\n                    <p class="debugP"><b>Unit</b></p>\n                    <input type="radio" name="'+this.elements.unit.name+'" value="0"> Metric\n                    <input type="radio" name="'+this.elements.unit.name+'" value="1"> Imperial\n                    <input type="radio" name="'+this.elements.unit.name+'" value="2"> Locale\n                </div>\n                <div>\n                    <p class="debugP">\n                        <b>Allow poke</b>\n                        <input type="checkbox" id="'+this.elements.allowPoke.id+'">\n                    </p>\n                </div>\n                <div>\n                    <p class="debugP"><b>HMI</b></p>\n                    <table class="DebugDataTable" style="width:100%">\n                        <tr>\n                            <td title="Number of IO/Alarm topics" width="20%">PLC topics</td>\n                            <td width="60%" id="'+this.elements.plc.id+'"></td>\n                            <td></td>\n                        </tr>\n                        <tr>\n                            <td title="Number of animated shapes" width="20%">Shapes</td>\n                            <td width="60%" id="'+this.elements.shape.id+'"></td>\n                            <td></td>\n                        </tr>\n                        <tr>\n                            <td title="Number of Global animations" width="20%">Animations</td>\n                            <td width="60%" id="'+this.elements.animation.id+'"></td>\n                            <td></td>\n                        </tr>\n                        <tr>\n                            <td title="Number of language texts" width="20%">Texts</td>\n                            <td width="60%" id="'+this.elements.text.id+'"></td>\n                            <td></td>\n                        </tr>\n                        <tr>\n                            <td title="Number of links" width="20%">Links</td>\n                            <td width="60%" id="'+this.elements.link.id+'"></td>\n                            <td></td>\n                        </tr>\n                        <tr>\n                            <td title="Number of Global variables" width="20%">GV</td>\n                            <td width="60%" id="'+this.elements.gv.id+'"></td>\n                            <td></td>\n                        </tr>\n                        <tr>\n                            <td title="Number of Global line codes" width="20%">GLC</td>\n                            <td width="60%" id="'+this.elements.glc.id+'"></td>\n                            <td></td>\n                        </tr>\n                    </table>\n                </div>'},OverviewTab.prototype.onHTMLReady=function(){for(var a in this.elements){var b=this.elements[a];if(b.id)b.html=document.getElementById(b.id);else if(b.name){b.html=document.getElementsByName(b.name);for(var c=0;c<b.html.length;c++){var d=b.html[c];d.addEventListener("click",function(a){this.onclick(a.value)}.bind(b,d),!1)}}}this.update(),emosWS.addEventListener("connecting",this.updateWSStatus.bind(this)),emosWS.addEventListener("openWS",this.updateWSStatus.bind(this)),emosWS.addEventListener("close",this.updateWSStatus.bind(this)),emosWS.addEventListener("UserRight",this.updateUser.bind(this)),emosWS.addEventListener("unit",this.updateUnit.bind(this)),emosWS.addEventListener("HMIplc",this.updateHMIplc.bind(this)),emosWS.addEventListener("HMIshape",this.updateHMIshape.bind(this)),emosWS.addEventListener("HMIanimation",this.updateHMIanimation.bind(this)),emosWS.addEventListener("HMItext",this.updateHMItext.bind(this)),emosWS.addEventListener("HMIlink",this.updateHMIlink.bind(this)),emosWS.addEventListener("HMIgv",this.updateHMIgv.bind(this)),emosWS.addEventListener("HMIglc",this.updateHMIglc.bind(this)),emosWS.addEventListener("ActiveCasServerReady",this.updateCasCaption.bind(this)),this.elements.login.html.addEventListener("click",function(){emosWS.login.au.showDialog()}.bind(this),!1),this.elements.allowPoke.html.addEventListener("click",function(a){emosWS.attr.allowPoke=a.target.checked}.bind(this),!1)},OverviewTab.prototype.onDiagnosisModeClick=function(a){emosWS.attr.DiagnosisWindowMode=parseInt(a)},OverviewTab.prototype.onUnitClick=function(a){emosWS.setUnit(parseInt(a))},OverviewTab.prototype.update=function(){this.updateVersion(),this.updateUnit(),this.updateAllowPoke(),this.updateWSStatus(),this.updateCas(),this.updateCasCaption(),this.updateHMI()},OverviewTab.prototype.updateVersion=function(){this.elements.version.html.textContent=emosWS.version},OverviewTab.prototype.updateDiagnosisWindowMode=function(){try{this.elements.diagnosisMode.html[emosWS.attr.DiagnosisWindowMode].checked=!0}catch(a){console.error("[updateDiagnosisWindowMode] : "+a)}},OverviewTab.prototype.updateUnit=function(a){try{var b=void 0!==a?a:emosWS.getUnit();this.elements.unit.html[b].checked=!0}catch(a){console.error("[updateUnit] : "+a)}},OverviewTab.prototype.updateAllowPoke=function(){this.elements.allowPoke.html.checked=emosWS.attr.allowPoke},OverviewTab.prototype.updateHMI=function(){emosWS.debug.dialog&&(this.updateHMIplc(),this.updateHMIshape(),this.updateHMIanimation(),this.updateHMItext(),this.updateHMIlink(),this.updateHMIgv(),this.updateHMIglc())},OverviewTab.prototype.updateHMIplc=function(){this.isActive()&&(this.elements.plc.html.textContent=emosWS.topicNumber)},OverviewTab.prototype.updateHMIshape=function(){this.isActive()&&(this.elements.shape.html.textContent=emosWS.shapeNumber)},OverviewTab.prototype.updateHMIanimation=function(){this.isActive()&&(this.elements.animation.html.textContent=emosWS.animationNumber)},OverviewTab.prototype.updateHMItext=function(){this.isActive()&&(this.elements.text.html.textContent=emosWS.textNumber)},OverviewTab.prototype.updateHMIlink=function(){this.isActive()&&(this.elements.link.html.textContent=emosWS.linkNumber)},OverviewTab.prototype.updateHMIgv=function(){this.isActive()&&(this.elements.gv.html.textContent=emosWS.gvNumber)},OverviewTab.prototype.updateHMIglc=function(){this.isActive()&&(this.elements.glc.html.textContent=emosWS.glcNumber)},OverviewTab.prototype.updateWSStatus=function(a){this.elements.wsServer.html.textContent=emosWS.getWSHostname();var b=this.elements.wsStatus.html.textContent="connecting"===a?a:emosWS.getWebSocketStatus()?"connected":"closed";this.elements.wsStatus.html.style["background-color"]="connected"===b?"green":"red",this.elements.wsStatus.html.style.color="white"},OverviewTab.prototype.updateUser=function(a){this.elements.username.html.textContent=a.username;var b="";if(a.userright){var c=a.userright.rights;b="User rights:\n\n";for(var d in c)b+=d+" : \n"+c[d]+"\n\n"}this.elements.username.html.title=b,this.updateLogin(a)},OverviewTab.prototype.updateLogin=function(a){this.elements.login.html.textContent="in"===a.status?"Logout":"Login"},OverviewTab.prototype.updateCas=function(){this.updateCasStatus()},OverviewTab.prototype.updateCasCaption=function(){var a=emosWS.Cas,b="HMI callback URL : \n"+a.checkCallbackURL+"\n\n";b+="Trusted App Servers : \n",a.trustedAppServers.forEach(function(a){b+=a+"\n"}),this.elements.casCaption.html.title=b,this.elements.casServer.html.textContent=this.elements.casServer.html.href=emosWS.Cas.casServerURL},OverviewTab.prototype.refresh=function(){this.updateUnit(),this.updateAllowPoke(),this.updateCasStatus(),this.updateHMI()},OverviewTab.prototype.updateCasStatus=function(){},OverviewTab.prototype.refreshCasStatus=function(a){this.elements.casStatus.html.textContent=a?"reachable":"unreachable",this.elements.casStatus.html.style.color="white",this.elements.casStatus.html.style["background-color"]=a?"green":"red",this.casReachable=a,setTimeout(this.updateCasStatus.bind(this),3e3)};function VariableTab(a){this.name="Variable",this.index=0,this.modeAll=!1,this.activated=!1,this.elements={radioDiv:{html:null,id:this.getId()},radioAll:{html:null,id:this.getId()},radioCustom:{html:null,id:this.getId()},addDiv:{html:null,id:this.getId()},addInput:{html:null,id:this.getId()},add:{html:null,id:this.getId()},varTable:{html:null,id:this.getId()}},this.radioId=this.getId(),this.initialize=this.initialize.bind(this),Tab.call(this,a)}VariableTab.prototype=Object.create(Tab.prototype),VariableTab.prototype.constructor=VariableTab,VariableTab.prototype.init=function(){this.html=this.getHTML()},VariableTab.prototype.getHTML=function(){return'<div>                    <div class="FloatLeft" id="'+this.elements.radioDiv.id+'">                        <input'+(this.modeAll?' checked="checked"':"")+' type="radio" id="'+this.elements.radioAll.id+'" name="'+this.radioId+'"><label for="'+this.elements.radioAll.id+'">All</label>                        <input'+(this.modeAll?"":' checked="checked"')+' type="radio" id="'+this.elements.radioCustom.id+'" name="'+this.radioId+'"><label for="'+this.elements.radioCustom.id+'">Custom</label>                    </div>                    <div class="FloatRight" id="'+this.elements.addDiv.id+'">                        <input type="text" id="'+this.elements.addInput.id+'">                        <button type="button" id="'+this.elements.add.id+'">Add</button>                    </div>                </div>                <div>                    <table class="DebugDataTable" style="width:100%">                        <thead>                            <tr>                                <td width="10%">No.</button></td>                                <td width="30%">Name</td>                                <td width="45%">Value</td>                                <td width="15%">Listeners</td>                            </tr>                        </thead>                        <tbody id="'+this.elements.varTable.id+'" ></tbody>                    </table>                </div>'},VariableTab.prototype.onHTMLReady=function(){for(var a in this.elements){var b=this.elements[a];b.html=document.getElementById(b.id)}$("#"+this.elements.radioDiv.id).buttonset(),this.elements.radioAll.html.addEventListener("click",this.setMode.bind(this,!0)),this.elements.radioCustom.html.addEventListener("click",this.setMode.bind(this,!1)),this.elements.add.html.addEventListener("click",this.onAddButtonClick.bind(this))},VariableTab.prototype.setMode=function(a){this.modeAll===a&&this.activated||(this.modeAll=a,this.elements.addDiv.html.style.visibility=a?"hidden":"visible",this.elements.addInput.html.value="",this.unsubscribeAll(),this.update())},VariableTab.prototype.unsubscribeAll=function(){for(var a=this.elements.ioTable.html,b=0,c=a.rows.length;b<c;b++){a.rows[b].gv.unregister(this.initialize)}},VariableTab.prototype.update=function(){this.activated=!0;var a=this.elements.varTable.html;while(a.rows.length>0)a.deleteRow(0);this.modeAll&&emosWS.globalVariables.forEach(function(a){this.addRow(a)}.bind(this))},VariableTab.prototype.addRow=function(a){if(a.getName()){var b=this.elements.varTable.html.insertRow();this.updateRow(b,a),this.subscribe(b,a)}},VariableTab.prototype.updateRow=function(a,b){if(a.cells.length>0)while(a.cells.length>0)a.deleteCell(0);var c=a.insertCell(),d=a.insertCell(),e=a.insertCell(),f=a.insertCell();c.textContent=a.rowIndex,d.textContent=b.getName(),e.textContent=b.myValue,f.textContent=b.subscribers.length,a.title=b.toDebugString(),this.processCell(e,b)},VariableTab.prototype.processCell=function(a,b){a.contentEditable=!0,a.addEventListener("blur",function(){b.setValue(a.textContent)},!1)},VariableTab.prototype.subscribe=function(a,b){var c=new Subscriber(this.initialize,{row:a,gv:b});b.register(c),a.gv=b},VariableTab.prototype.unsubscribeAll=function(){for(var a=this.elements.varTable.html,b=0,c=a.rows.length;b<c;b++){a.rows[b].gv.unregister(this.initialize)}},VariableTab.prototype.initialize=function(a,b){this.updateRow(b.row,b.gv),this.highlight(b.row)},VariableTab.prototype.refresh=function(){this.setMode(this.modeAll)},VariableTab.prototype.onAddButtonClick=function(){var a=this.elements.addInput.html.value.replace(/ /g,""),b=window[a];if(b instanceof GlobalVariable){for(var c=this.elements.varTable.html,d=0,e=c.rows.length;d<e;d++){if(c.rows[d].gv===b)return}this.elements.addInput.html.value="",this.addRow(b)}},VariableTab.prototype.deactivate=function(){this.unsubscribeAll(),this.activated=!1};function Debug(){window.addEventListener("load",function(){emosWS.require({css:[],js:["/lib/js/jquery.uitablefilter.js"]},function(){emosWS.dispatchEvent({type:"DebugLibLoad"})})}.bind(this),!1);var a=0;this.SHOW_BADQUALITYTAGS=!0,this.overviewTab=new OverviewTab(a++),this.dataTab=new DataTab(a++),this.variableTab=new VariableTab(a++),this.animationTab=new AnimationTab(a++),this.linkTab=new LinkTab(a++),this.tabs=[this.overviewTab,this.dataTab,this.variableTab,this.animationTab,this.linkTab],this.activeTabId=null,this.dialog=null,this.symbol=null,this.ctrlPressed=!1,this.tabsUI=null,this.debugSymbolSettingVisibility=!0,this.init()}Debug.prototype.init=function(){window.addEventListener("load",function(){document.addEventListener("keydown",this.onkeydown.bind(this),!1),document.addEventListener("keyup",this.onkeyup.bind(this),!1),emosWS.addEventListener("ready",function(){emosWS.attr.svg&&(emosWS.attr.svg.addEventListener("keydown",this.onkeydown.bind(this),!1),emosWS.attr.svg.addEventListener("keyup",this.onkeyup.bind(this),!1),this.symbol=this.createSymbol()),this.allowContextMenu(!1)}.bind(this)),this.dialog=this.createWindow()}.bind(this),!1)},Debug.prototype.onkeydown=function(a){this.ctrlPressed=a.ctrlKey,a.shiftKey&&a.ctrlKey?this.show():49===a.keyCode&&a.ctrlKey&&(emosWS.attr.DiagnosisWindowMode=2===emosWS.attr.DiagnosisWindowMode?1:2,console.info("[DiagnosisWindowMode] = "+emosWS.attr.DiagnosisWindowMode))},Debug.prototype.onkeyup=function(a){this.ctrlPressed=!1},Debug.prototype.isOpen=function(){return!!this.dialog&&this.dialog.dialog("isOpen")},Debug.prototype.createWindow=function(){var a=this,b="emosdebug"+Math.floor(1e6*Math.random()+1),c=b+"-tab",d=0,e="",f="",g='<div id="'+b+'"><div id="'+c+'"><ul>';this.tabs.forEach(function(a,b){var d=c+b;e+='<li><a href="#'+d+'">'+a.name+"</a></li>",f+='<div id="'+d+'">'+a.html+"</p></div>"}),g+=e+"</ul>"+f+"</div></div>",$("body").append($(g));var h=$("#"+b).dialog({title:"Debug window",width:480,height:450,resizable:!0,autoOpen:!1,close:this.onDialogClose.bind(this),open:this.onDialogOpen.bind(this),resize:function(){emosWS.attr.svgobject&&(emosWS.attr.svgobject.style["pointer-events"]="none")}}).mouseleave(function(){emosWS.attr.svgobject&&(emosWS.attr.svgobject.style["pointer-events"]="auto")});return h.emos={tabs:$("#"+c).tabs({activate:function(b,c){a.onTabActive($(this).tabs("option","active"))}})},this.tabsUI=h.emos.tabs,this.activeTabId=h.emos.tabs.tabs("option","active"),this.tabs.forEach(function(a){a.onHTMLReady()}),this.onTabActive(this.activeTabId),h},Debug.prototype.onDialogClose=function(){this.allowContextMenu(!1),this.tabs.forEach(function(a){a.deactivate()})},Debug.prototype.onDialogOpen=function(){this.allowContextMenu(!0)},Debug.prototype.allowContextMenu=function(a){a?(document.removeEventListener("contextmenu",this.turnContextMenuOff),emosWS.attr.svg&&emosWS.attr.svg.removeEventListener("contextmenu",this.turnContextMenuOff)):(document.addEventListener("contextmenu",this.turnContextMenuOff),emosWS.attr.svg&&emosWS.attr.svg.addEventListener("contextmenu",this.turnContextMenuOff))},Debug.prototype.turnContextMenuOff=function(a){a.preventDefault()},Debug.prototype.onTabActive=function(a){this.activeTabId=a,this.tabs.forEach(function(b,c){c===a?b.activate():b.deactivate()})},Debug.prototype.createSymbol=function(){var a=null,b=3e3,c=function(a){this.dialog.dialog("isOpen")||this.show(a)}.bind(this),d=function(){console.log("ontouchstart"),a=setTimeout(c,b)},e=function(){a&&clearTimeout(a)},f="emosQualityBadSymbol"+Math.floor(1e6*Math.random()+1),g='<div class="debugSymbol" id="'+f+'">                    <span class="dsBackground"></span>                    <span class="dsIcon"></span>                </div>';$("body").append($(g));var h=document.getElementById(f);return h.addEventListener("click",c.bind(void 0,this.SHOW_BADQUALITYTAGS),!1),emosWS.attr.svg.addEventListener("touchstart",d,!1),emosWS.attr.svg.addEventListener("touchend",e,!1),emosWS.attr.svg.addEventListener("mousedown",d,!1),emosWS.attr.svg.addEventListener("mouseup",e,!1),emosWS.addEventListener("Quality",this.setDebugSymbolVisiblity.bind(this)),h},Debug.prototype.show=function(a){if(!this.isOpen()){this.dialog.dialog("open");var b=a?this.tabs.indexOf(this.dataTab):this.activeTabId;a&&(this.tabsUI.tabs({active:b}),this.dataTab.showQualityBadTags()),this.tabs[b].activate()}},Debug.prototype.setDebugSymbolVisiblity=function(a){if("object"!=typeof a&&(this.debugSymbolSettingVisibility=a),this.symbol){var b=0===Object.keys(emosWS.badQualityTags).length;this.symbol.style.display=b?"none":this.debugSymbolSettingVisibility?"block":"none"}};function RestAlarm(){this.path="alarms",this.pathTop="top",this.pathTopX="topX",this.pathChronology="history",this.pathFilter="filter",this.SYSTEM="$System",this.TYPE_ANY="any"}RestAlarm.prototype.top=function(a,b,c){a=this.getQuerryAlarmGroup(a);var d=parseInt(emosWS.getLanguage(),16),e=this.getPathTop()+"?alg="+a+"&max="+b+"&language="+d;$.getJSON(e,function(a){c(this.classifyAlarms(a))}.bind(this))},RestAlarm.prototype.topOfType=function(a){this.topType(a,this.getPathTop())},RestAlarm.prototype.topXOfType=function(a){this.topType(a,this.getPathTopX())},RestAlarm.prototype.topType=function(a,b){var c=void 0===a.alarmGroup?this.SYSTEM:this.getQuerryAlarmGroup(a.alarmGroup),d=void 0===a.first?0:a.first,e=void 0===a.max?100:a.max,f=a.success,g=void 0===a.type?this.TYPE_ANY:a.type,h=parseInt(emosWS.getLanguage(),16),i=b+"?alg="+c+"&first="+d+"&max="+e+"&language="+h+"&type="+g;$.ajax({url:i,type:"GET",success:function(a){f(this.classifyAlarms(a))}.bind(this),error:a.error,complete:a.complete})},RestAlarm.prototype.filter=function(a,b,c,d,e,f,g){a=this.getQuerryAlarmGroup(a);var h=parseInt(emosWS.getLanguage(),16),i=this.getPathFilter()+"?alg="+a+"&startDate="+b+"&endDate="+c+"&all="+(d?"true":"false")+"&first="+e+"&max="+f+"&language="+h;$.getJSON(i,function(a){g(this.classifyAlarms(a))}.bind(this))},RestAlarm.prototype.chronology=function(a){var b=void 0===a.alarmGroup?this.SYSTEM:this.getQuerryAlarmGroup(a.alarmGroup),c=void 0===a.max?20:a.max,d=parseInt(emosWS.getLanguage(),16),e=this.getPathChronology()+"?alg="+b+"&max="+c+"&language="+d;$.ajax({url:e,type:"GET",success:a.success,error:a.error,complete:a.complete})},RestAlarm.prototype.getQuerryAlarmGroup=function(a){return a.toString()},RestAlarm.prototype.getPath=function(){return emosWS.rest.getPath()+"/"+this.path},RestAlarm.prototype.getPathTop=function(){return this.getPath()+"/"+this.pathTop},RestAlarm.prototype.getPathTopX=function(){return this.getPath()+"/"+this.pathTopX},RestAlarm.prototype.getPathFilter=function(){return this.getPath()+"/"+this.pathFilter},RestAlarm.prototype.getPathChronology=function(){return this.getPath()+"/"+this.pathChronology},RestAlarm.prototype.classifyAlarms=function(a){return a.forEach(function(a){var b="NEW",c="OTHER";switch(a.ackDate&&(b="ACK"),a.endDate&&(b="GONE"),a.status=b,a.messageType){case"02":c="WARNING";break;case"00":case"01":case"03":c="ALARM"}a.type=c,a.class=a.messageType,delete a.messageType}),a};function RestEventParam(){this.path="events/params",this.pathTop="top",this.pathFilter="filter",this.SYSTEM="$System"}RestEventParam.prototype.top=function(a){var b=void 0===a.alarmGroup?this.SYSTEM:this.getQuerryAlarmGroup(a.alarmGroup),c=void 0===a.first?0:a.first,d=void 0===a.max?100:a.max,e=this.getPathTop()+"?io="+b+"&first="+c+"&max="+d;$.ajax({url:e,type:"GET",success:a.success,error:a.error,complete:a.complete})},RestEventParam.prototype.getQuerryAlarmGroup=function(a){return a.toString()},RestEventParam.prototype.getPath=function(){return emosWS.rest.getPath()+"/"+this.path},RestEventParam.prototype.getPathTop=function(){return this.getPath()+"/"+this.pathTop};function RestFramework(){this.MSG_DONT_HAVE_PERMISSION="The current user does not have an administrator right.",this.path="framework",this.pathFile="file",this.pathGenerateAppCache="generateAppCacheFile",this.pathRenewAppCache="renewAppCacheFiles"}RestFramework.prototype.getFileInfo=function(a){var b=this.getPathFile(a.server)+"?path="+encodeURIComponent(a.path);a.fromPath&&(b+="&fromPath="+encodeURIComponent(a.fromPath)),a.recursiveEnable&&(b+="&recursiveEnable="+a.recursiveEnable),a.fileExtensionFilter&&(b+="&fileExtensionFilter="+a.fileExtensionFilter.toString()),a.view&&(b+="&view="+a.view),$.ajax({url:b,type:"GET",success:a.success,error:a.error,complete:a.complete})},RestFramework.prototype.generateAppCacheFile=function(a){$.ajax({url:this.getPathGenerateAppCacheFile()+"?"+this.getCookieParam(),type:"GET",success:a.success,error:a.error,complete:a.complete})},RestFramework.prototype.renewAppCacheFiles=function(a){$.ajax({url:this.getPathRenewAppCacheFiles()+"?"+this.getCookieParam(),type:"GET",success:a.success,error:a.error,complete:a.complete})},RestFramework.prototype.deleteFile=function(a){this.ajaxAdminRequest(a,function(b){$.ajax({url:b,type:"DELETE",success:function(b){try{b.success?a.success():a.error(b.msg)}catch(a){console.error(a)}},error:a.error,complete:a.complete})})},RestFramework.prototype.uploadFile=function(a){this.ajaxAdminRequest(a,function(b){var c=new FormData;c.append("file",a.file),$.ajax({url:b,type:"POST",data:c,success:function(b){try{b.success?a.success():a.error(b.msg)}catch(a){console.error(a)}},error:a.error,complete:a.complete,contentType:!1,processData:!1})})},RestFramework.prototype.ajaxAdminRequest=function(a,b){if(emosWS.isAdmin())try{var c=function(){return a.path?"&path="+encodeURIComponent(a.path):""},d=this.getPathFile(a.server);a.server&&emosWS.getActiveServerName()!==a.server?emosWS.Cas.getCASServiceTicket({success:function(a,e){d+="?serviceTicket="+a+c()+"&serviceURL="+e,b(d)},error:function(b){a.error&&a.error(b)}}):(d+="?"+this.getCookieParam()+c(),b(d))}catch(b){a.error(b)}else a.error(this.MSG_DONT_HAVE_PERMISSION)},RestFramework.prototype.createTextFile=function(a){var b=new Blob([a.text],{type:"text/plain"});a.file=new File([b],a.path),this.uploadFile(a)},RestFramework.prototype.getPath=function(a){return emosWS.rest.getPath(a)+"/"+this.path},RestFramework.prototype.getPathFile=function(a){return this.getPath(a)+"/"+this.pathFile},RestFramework.prototype.getPathGenerateAppCacheFile=function(a){return this.getPath(a)+"/"+this.pathGenerateAppCache},RestFramework.prototype.getPathRenewAppCacheFiles=function(a){return this.getPath(a)+"/"+this.pathRenewAppCache},RestFramework.prototype.getCookieParam=function(){var a=emosWS.Cas;return a.WS_SESSION_COOKIE_TEXT+"="+a.cookie.getItem(a.WS_SESSION_COOKIE_TEXT)};function RestServerInfo(){this.path="info",this.pathVersion="version",this.pathJavaVersion="javaversion",this.pathCommLibVersion="commlibversion",this.pathOSVersion="osversion",this.pathConfiguration="configuration",this.pathPerformance="performance",this.pathCommlibInternalState="commlibInternalState",this.pathSession="sessions"}RestServerInfo.prototype.getPath=function(a){return emosWS.rest.getPath(a)+"/"+this.path},RestServerInfo.prototype.get=function(a,b){$.ajax({url:this.getPath(b.server)+"/"+a,type:"GET",success:b.success,error:b.error,complete:b.complete})},RestServerInfo.prototype.getVersion=function(a){this.get(this.pathVersion,a)},RestServerInfo.prototype.getJavaVersion=function(a){this.get(this.pathJavaVersion,a)},RestServerInfo.prototype.getCommLibVersion=function(a){this.get(this.pathCommLibVersion,a)},RestServerInfo.prototype.getOSVersion=function(a){this.get(this.pathOSVersion,a)},RestServerInfo.prototype.getConfiguration=function(a){this.get(this.pathConfiguration,a)},RestServerInfo.prototype.getPerformance=function(a){this.get(this.pathPerformance,a)},RestServerInfo.prototype.getCommlibInternalState=function(a){this.get(this.pathCommlibInternalState,a)},RestServerInfo.prototype.getSession=function(a){this.get(this.pathSession,a)};function RestConfiguration(){this.path="config",this.pathUpdate="update"}RestConfiguration.prototype.getConfiguration=function(a){$.ajax({url:this.getPath(a.server),type:"GET",success:a.success,error:a.error,complete:a.complete})},RestConfiguration.prototype.updateConfiguration=function(a){$.ajax({url:this.getPathUpdate(a.server),type:"POST",data:JSON.stringify(a.configuration),contentType:"application/json; charset=utf-8",dataType:"json",success:a.success,error:a.error,complete:a.complete})},RestConfiguration.prototype.addServer=function(a){$.ajax({url:this.getPath(a.server)+"?type="+a.serverType+"&name="+encodeURIComponent(a.serverName),type:"PUT",success:a.success,error:a.error,complete:a.complete})},RestConfiguration.prototype.removeServer=function(a){$.ajax({url:this.getPath(a.server)+"?type="+a.serverType+"&name="+encodeURIComponent(a.serverName),type:"DELETE",success:a.success,error:a.error,complete:a.complete})},RestConfiguration.prototype.getPath=function(a){return emosWS.rest.getPath(a)+"/"+this.path},RestConfiguration.prototype.getPathUpdate=function(a){return this.getPath(a)+"/"+this.pathUpdate};function RestTac(){this.path="tac",this.pathClientInfo="getClientInfo"}RestTac.prototype.getPath=function(a){return emosWS.rest.getPath(a)+"/"+this.path},RestTac.prototype.get=function(a,b){$.ajax({url:this.getPath(b.server)+"/"+a,type:"GET",success:b.success,error:b.error,complete:b.complete})},RestTac.prototype.getClientInfo=function(a){this.get(this.pathClientInfo,a)};function Rest(){this.path="ws/admin",this.alarm=new RestAlarm,this.eventParam=new RestEventParam,this.framework=new RestFramework,this.serverInfo=new RestServerInfo,this.configuration=new RestConfiguration,this.tac=new RestTac}Rest.prototype.getRootPath=function(a){return a?location.protocol+"//"+a:emosWS.getHostname()},Rest.prototype.getPath=function(a){return this.getRootPath(a)+"/"+this.path};function UserIdle(a,b,c){this.USER_EVENT_NAME="UserActivityDetected",this.emosEvent=a,this.duration=b,this.handlers=c,this.recurrent=void 0===c.recurrent||c.recurrent,this.eventNameList=["mousemove","mousedown","keydown","DOMMouseScroll","mousewheel","touchmove","MSPointerMove"],this.timeoutID=null,this.resetTimer=this.resetTimer.bind(this),this.goInactive=this.goInactive.bind(this),this.isReset=!1,this.isResetingTimer=!1,this.init()}UserIdle.prototype.init=function(){this.addEventListener(),this.startTimer()},UserIdle.prototype.startTimer=function(){this.timeoutID=window.setTimeout(this.goInactive,this.duration)},UserIdle.prototype.onSVGReady=function(){emosWS.attr.svg&&this.eventNameList.forEach(function(a){emosWS.attr.svg.addEventListener(a,this.resetTimer,!1)}.bind(this))},UserIdle.prototype.resetTimer=function(){var a=this;a.isResetingTimer||(a.isResetingTimer=!0,this.clearTimeout(),this.goActive(),this.propagateMessage(),setTimeout(function(){a.isResetingTimer=!1},1e3))},UserIdle.prototype.propagateMessage=function(){var a={type:this.USER_EVENT_NAME};emosWS.propagateMessage(JSON.stringify(a))},UserIdle.prototype.goInactive=function(){try{this.handlers.onInactive&&this.handlers.onInactive()}catch(a){console.error(a)}this.recurrent?(this.isReset=!0,this.resetTimer(),this.isReset=!1):this.removeEventListener()},UserIdle.prototype.goActive=function(){try{this.handlers.onActive&&!this.isReset&&this.handlers.onActive()}catch(a){console.error(a)}this.startTimer()},UserIdle.prototype.clearTimeout=function(){window.clearTimeout(this.timeoutID)},UserIdle.prototype.terminate=function(){this.clearTimeout(),this.removeEventListener()},UserIdle.prototype.addEventListener=function(){this.eventNameList.forEach(function(a){document.addEventListener(a,this.resetTimer,!1)}.bind(this)),this.emosEvent.addEventListener(this.USER_EVENT_NAME,this.resetTimer),emosWS&&emosWS.attr.svg?this.onSVGReady():this.emosEvent.addEventListener("ready",this.onSVGReady.bind(this))},UserIdle.prototype.removeEventListener=function(){this.eventNameList.forEach(function(a){document.removeEventListener(a,this.resetTimer,!1)}.bind(this)),emosWS.attr.svg&&this.eventNameList.forEach(function(a){emosWS.attr.svg.removeEventListener(a,this.resetTimer,!1)}.bind(this)),this.emosEvent.removeEventListener(this.USER_EVENT_NAME,this.resetTimer)};function UserIdleAction(a,b){this.init(b),this.userIdle=null,this.emosEvent=a,this.start()}UserIdleAction.prototype.init=function(a){},UserIdleAction.prototype.getDurationInMS=function(){},UserIdleAction.prototype.onInactive=function(){},UserIdleAction.prototype.start=function(){this.config.active&&this.initUserIdle()},UserIdleAction.prototype.setDuration=function(a){this.config.duration.default=a,this.userIdle&&this.initUserIdle()},UserIdleAction.prototype.initUserIdle=function(){this.clearCurrentUserIdle(),this.userIdle=new UserIdle(this.emosEvent,this.getDurationInMS(),{onInactive:this.onInactive.bind(this),recurrent:!1})},UserIdleAction.prototype.stop=function(){this.clearCurrentUserIdle()},UserIdleAction.prototype.clearCurrentUserIdle=function(){this.userIdle&&(this.userIdle.terminate(),this.userIdle=null)};function UserIdleActionLogout(a,b){UserIdleAction.call(this,a,b)}UserIdleActionLogout.prototype=Object.create(UserIdleAction.prototype),UserIdleActionLogout.prototype.constructor=UserIdleActionLogout,UserIdleActionLogout.prototype.init=function(a){this.config=a.userIdleAction.actionLogoff,this.waitingForLogoff=!1,this.onAuthentication=this.onAuthentication.bind(this)},UserIdleActionLogout.prototype.getDurationInMS=function(){return 6e4*this.config.duration.default},UserIdleActionLogout.prototype.onInactive=function(){emosWS.sendLogoff(),this.waitingForLogoff=!0},UserIdleActionLogout.prototype.start=function(){this.config.active&&(this.emosEvent.addEventListener("authentication",this.onAuthentication,!1),emosWS&&null!==emosWS.login.au.userName&&this.initUserIdle())},UserIdleActionLogout.prototype.stop=function(){this.emosEvent.removeEventListener("authentication",this.onAuthentication),this.clearCurrentUserIdle()},UserIdleActionLogout.prototype.onAuthentication=function(a){"PASSED"===a.status?this.onLogin():this.onLogoff()},UserIdleActionLogout.prototype.onLogin=function(){this.initUserIdle()},UserIdleActionLogout.prototype.onLogoff=function(){this.clearCurrentUserIdle(),this.waitingForLogoff&&(this.waitingForLogoff=!1,this.emosEvent.dispatchEvent({type:"Auto_Logoff_Reload"}))};function UserIdleActionReload(a,b){UserIdleAction.call(this,a,b)}UserIdleActionReload.prototype=Object.create(UserIdleAction.prototype),UserIdleActionReload.prototype.constructor=UserIdleActionReload,UserIdleActionReload.prototype.init=function(a){this.config=a.userIdleAction.actionLogoff},UserIdleActionReload.prototype.getDurationInMS=function(){return 36e5*this.config.duration.default},UserIdleActionReload.prototype.onInactive=function(){this.emosEvent.dispatchEvent({type:"4h_Reload"})};function Server(a){this.name=a,this.reachable=!1,this.active=!1}Server.prototype.getStatus=function(a){var b=this;b.active=b.name===emosWS.getActiveServerName(),emosWS.rest.serverInfo.getVersion({success:function(){b.reachable=!0},error:function(){b.reachable=!1},complete:function(){a({name:b.name,reachable:b.reachable,active:b.active})},server:b.name})};function ServerStorage(a,b){if(this.path=this.DEFAULT_PATH="/config/server_storage.json",a){if(a===this.DEFAULT_PATH)return;this.path=a}(b||emosWS.attr).storages[this.path]=this,this.data=null,this.readyListener=[],this.init()}ServerStorage.prototype.init=function(){var a=this;setTimeout(function(){a.getStorage(function(b){a.readyListener.forEach(function(a){try{a(b)}catch(a){console.error(a)}})})},1)},ServerStorage.prototype.getStorage=function(a){var b=this,c=emosWS.rest.getRootPath()+this.path,d=function(){$.ajax({url:c,dataType:"json",cache:!1,success:function(a){b.data=a},error:function(){b.data={}},complete:function(){a(b.data)}})};"undefined"!=typeof $?d():window.addEventListener("load",d)},ServerStorage.prototype.setStorage=function(a,b){this.data=this.data||{},emosWS.writeData(this.path,JSON.stringify(this.data,null,"\t"),a||b?{success:a,error:b}:null)},ServerStorage.prototype.addReadyListener=function(a){this.readyListener.push(a)},ServerStorage.prototype.getItem=function(a,b,c){var d=function(d){var e=c?d:d[a];try{b&&b(e)}catch(a){console.error(a)}return e};return this.data?d(this.data):(this.addReadyListener(d),null)},ServerStorage.prototype.get=function(a){return this.getItem(null,a,!0)},ServerStorage.prototype.setItem=function(a,b,c,d){var e={};e[a]=b,this.setItems(e,c,d)},ServerStorage.prototype.setItems=function(a,b,c){var d=this,e=function(e){try{for(var f in a)e[f]=a[f];d.setStorage(b,c)}catch(b){console.error("setItem failed, due to: "+b);for(var f in a)delete e[f];delete e[f]}};this.data?e(this.data):this.addReadyListener(e)},ServerStorage.prototype.removeItem=function(a,b,c){if(emosWS.isAdmin()){var d=this,e=function(e){delete e[a],d.setStorage(b,c)};this.data?e(this.data):this.addReadyListener(e)}else c("You don't have admin right to remove the server storage item!")},ServerStorage.prototype.clear=function(a,b){if(emosWS.isAdmin()){var c=this,d=function(){c.data={},c.setStorage(a,b)};this.data?d():this.addReadyListener(d)}else b("You don't have admin right to clear the server storage!")};function HighAvailability(a){this.MONITOR_INTERVAL=5e3,this.config=a||{},this.monitorInterval=this.MONITOR_INTERVAL||this.config.monitorInterval,this.idle=!0,this.monitor=null,this.ready=!1,this.wantToStopMonitor=!0,this.init()}HighAvailability.prototype.init=function(){"undefined"!=typeof serverPool&&(emosWS.addEventListener("connecting",this.onWSClose.bind(this)),emosWS.addEventListener("openWS",this.onWSOpen.bind(this)),emosWS.addEventListener("close",this.onWSClose.bind(this)))},HighAvailability.prototype.onWSClose=function(){this.wantToStopMonitor=!1,this.startMonitor()},HighAvailability.prototype.onWSOpen=function(){this.ready=!0,this.wantToStopMonitor=!0,this.runCheck()},HighAvailability.prototype.check=function(){var a=this,b=location.href;a.idle&&(a.idle=!1,a.checkIfURLIsReachable(b,function(b){b||a.onUnreachable(),a.idle=!0}))},HighAvailability.prototype.runCheck=function(){if(this.wantToStopMonitor&&location.href===this.getURLFromServer(emosWS.getActiveServerName()))return void this.stopMonitor();this.check()},HighAvailability.prototype.startMonitor=function(){this.ready&&null===this.monitor&&(this.runCheck(),this.monitor=setInterval(this.runCheck.bind(this),this.monitorInterval))},HighAvailability.prototype.stopMonitor=function(){clearInterval(this.monitor),this.monitor=null,this.idle=!0,this.wantToStopMonitor=!1},HighAvailability.prototype.onUnreachable=function(){var a=this,b=location.href,c=!1;serverPool.forEach(function(d){var e=a.getURLFromServer(d);e!==b&&a.checkIfURLIsReachable(e,function(a,b){a&&!c&&(c=!0,location.href=b)})})},HighAvailability.prototype.getURLFromServer=function(a){var b=null,c=location.href,d=location.protocol+"//";a=a.toLowerCase();for(var e=0,f=serverPool.length;e<f;e++){var g=serverPool[e].toLowerCase();if((b=c.replace(d+g,d+a))!==c)break}return b},HighAvailability.prototype.checkIfURLIsReachable=function(a,b){if("function"==typeof b){var c=function(c){b(c,a)};$.ajax({url:a,type:"HEAD",timeout:1e3,cache:!1,statusCode:{200:function(){c(!0)},400:function(){c(!1)},0:function(){c(!1)}}})}};var emosWS=function a(){var b="1.2.4-1",c=0,d=null,e=!1,f=!1,g=null,h=null,i=-1,j=3e3,k=-1,l={},m={},n={},o={},p={},q={},r={},s=Definition.languageID,t=Definition.unitID,u=Definition.tagType,v,w=3e3,x=void 0,y=null,z={au:null},A=void 0,B="",C=new ClientTest,D=new EventDispatcher,E=new Cas,F=new Rest,G=[],H=[],I=[],J=[],K={stillInit:!1,callback:null,param:null,globalVariablesSetCallBackAble:!1},L={event:null,param:null},M={onopen:[],onmessage:[],onclose:[],onerror:[],infoListener:[],systemInfoListener:[],languageListener:[]},N={storages:{},svgobject:null,svg:null,supportForeignObject:document.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1"),ready:!1,eventQueue:[],DiagnosisWindowMode:0,diagnosisMap:{},allowPoke:"undefined"==typeof emosAllowPoke||emosAllowPoke,siteSet:!1,siteSent:!1,siteCalledByFramework:!1,clientInfo:null,site:{type:"SiteProperties",AckALM:[],QuitALM:[],BreadcrumbLevel:0,Trends:[]},userIdleAction:{actionLogoff:{active:!0,duration:{min:.5,max:30,default:10}},actionReload:{active:!0,duration:{min:.5,max:96,default:4}}},propagatedMessages:{},dataFormatter:null},O=new ServerStorage(null,N),P=[],Q=new BlinkInterval(500),R={},S=new IDB,T=new Debug,U=new UserIdleActionLogout(D,N),V=new UserIdleActionReload(D,N),W=[],X=void 0,Y=void 0,Z=!1,_=-1;ba();function aa(a,b){var c=document.createElement("script");c.onload=function(){"function"==typeof b&&b()},c.src=a,document.head.appendChild(c)}function ba(){new BINDX("DS_STATIC_BINDX_READ"),new BINDX("DS_STATIC_BINDX_WRITE"),new BINDX("DS_STATIC_BINDX_SUBSCRIPTION"),window.addEventListener("message",ha),aa("/lib/js/data.format.js",function(){N.dataFormatter=new DataFormatter}),window.location!==window.parent.location&&"plants"===window.name&&(N.DiagnosisWindowMode=1);var a=window.applicationCache;a&&(a.addEventListener("updateready",function(){console.log("Reloading due to application is updated..."),location.reload(!0)},!1),setInterval(function(){a.status===a.IDLE&&(console.log("Checking if application is updated..."),a.update())},6e4))}function ca(a){var b=function(b){try{a&&a(b)}catch(a){}};N.clientInfo?b(N.clientInfo):D.addEventListener("ClientInfo",b)}function da(a){N.clientInfo=a,localStorage&&a.hostname&&""!==a.hostname&&(localStorage.emosClientInfo=JSON.stringify(a)),console.log(a),D.dispatchEvent({type:"ClientInfo",message:a})}function ea(){if(Z||N.clientInfo||100===_)return void(Z=!1);Z=!0,F.tac.getClientInfo({success:function(a){Z=!1,da(a)},error:function(){setTimeout(function(){Z=!1,ea()},1e3)}}),emosWS.requestedClientInfoAttempt++}function fa(){var a=function(a){console.error("_getClientInfo() failed: "+a)};try{if(!N.clientInfo){var b=null;if(localStorage&&localStorage.emosClientInfo)try{b=JSON.parse(localStorage.emosClientInfo)}catch(b){a(b)}b?da(b):(_=0,ea())}}catch(b){a(b)}}function ga(){serverPool&&0===W.length&&serverPool.forEach(function(a){W.push(new Server(a))})}function ha(a){try{var b=JSON.parse(a.data);if(na(b))return;switch(b.type){case"setLanguage":ya(b.languageID);break;case"setUnit":za(b.unitID);break;case"setDebugSymbolVisibility":Aa(b.visibility,b);break;case"access_token":Ca(b),D.dispatchEvent({type:"access_token",message:b});break;case"OpenDiagnosisWindow":D.dispatchEvent({type:"OpenDiagnosisWindow",message:b});break;case"SiteProperties":D.dispatchEvent({type:"SiteProperties",message:b});break;case"DiagnosisWindowClosed":ia(b),D.dispatchEvent({type:"DiagnosisWindowClosed",message:b});break;case"DiagnosisWindowMode":ka(b),D.dispatchEvent({type:"DiagnosisWindowMode",message:b});break;case"UserActivityDetected":D.dispatchEvent({type:"UserActivityDetected",message:null})}}catch(a){}}function ia(a){var b=N.diagnosisMap[a.id];b&&b.unhighlight()}function ja(a){N.site&&N.siteCalledByFramework&&(!N.siteSent||a)&&(N.site.Links=Yb(),oa(N.site),N.siteSent=!0)}function ka(a){N.DiagnosisWindowMode=a.mode,N.userIdleAction.actionLogoff.active=!1,N.userIdleAction.actionReload.active=!1,U.stop(),N.siteCalledByFramework=!0,setTimeout(function(){N.siteSet=!0,ja()},N.siteSet?0:2e3),a.serverPool&&la(a.serverPool),a.activeServer&&!e&&M.host&&a.activeServer.toLowerCase()!==M.host.toLowerCase()&&(Y=a.activeServer,d.close())}function la(a){a&&serverPool&&(a.forEach(function(a){for(var b=!1,c=0,d=serverPool.length;c<d;c++)if(a.toLowerCase()===serverPool[c].toLowerCase()){b=!0;break}b||(serverPool.push(a),W.length>0&&W.push(new Server(a)))}),T&&T.overviewTab.updateServersTooltip())}function ma(a){try{if(a=JSON.parse(a),void 0!==window.parent.postMessage&&!na(a)){void 0===a.uuid&&(a.uuid=gc()),N.propagatedMessages[a.uuid]=a;var b=JSON.stringify(a);window.parent.postMessage(b,location.href);for(var c=0,d=window.parent.frames.length;c<d;c++)window.parent.frames[c].postMessage(b,"*");var e=a.uuid;setTimeout(function(){delete N.propagatedMessages[e]},5e3)}}catch(a){console.error("propagateMessage() failed: "+a)}}function na(a){try{return!!a.uuid&&N.propagatedMessages[a.uuid]}catch(a){return!1}}function oa(a){try{void 0!==window.parent.postMessage&&window.parent.postMessage(JSON.stringify(a),"*")}catch(a){console.error("informFramework() failed: "+a)}}function pa(){N.eventQueue.forEach(function(a){a.o.addEventListener(a.event,a.listener,a.capture)}),N.ready=!0,N.eventQueue=[],N.highAvailability=N.highAvailability||new HighAvailability}function qa(){ya(ta())}function ra(){za(ua())}function sa(){try{Aa(Ba())}catch(a){console.error(a)}}function ta(){return void 0===x?"undefined"!=typeof defaultLanguage?defaultLanguage:"undefined"!=typeof localStorage&&void 0!==localStorage.emosLanguage?localStorage.emosLanguage:s.DECP_English.value:x}function ua(){return void 0===A?"undefined"!=typeof defaultUnit?defaultUnit:"undefined"!=typeof localStorage&&void 0!==localStorage.emosUnit?parseInt(localStorage.emosUnit):t.Metric:A}function va(){return g}function wa(){if(h)return h;try{return location.protocol+"//"+serverPool[0]}catch(a){console.error(a)}}function xa(){var a;try{var a=G_Params.language;if(a)for(var b in s){var c=s[b];if(c.id===a){a=c.value;break}}}catch(a){}return a}function ya(a){var b=xa();if(b&&(a=b),void 0!==a&&x!==a&&e){x=a,"undefined"!=typeof localStorage&&(localStorage.emosLanguage=a),yb(a),D.dispatchEvent({type:"language",message:a});var c=new Object;c.type="setLanguage",c.languageID=a,ma(JSON.stringify(c))}}function za(a){if(void 0!==a&&A!==a&&e){A=a,"undefined"!=typeof localStorage&&(localStorage.emosUnit=a),D.dispatchEvent({type:"unit",message:a});var b=new Object;b.type="setUnit",b.unitID=a,ma(JSON.stringify(b))}}function Aa(a,b){void 0!==a&&(X!==a&&(X=a,"undefined"!=typeof localStorage&&(localStorage.emosDebugSymbolVisibility=a),T.setDebugSymbolVisiblity(a)),ma(JSON.stringify(b||{type:"setDebugSymbolVisibility",visibility:a})))}function Ba(){return void 0===X?"undefined"==typeof localStorage||void 0===localStorage.emosDebugSymbolVisibility||"true"===localStorage.emosDebugSymbolVisibility:X}function Ca(a){void 0!==a&&z.au.onAccesToken(a)}function Da(a){return void 0!==a.quality&&192===a.quality}function Ea(a){try{if(D.addEventListener("openWS",function(){}),D.addEventListener("connecting",function(){}),D.addEventListener("unit",function(){}),D.addEventListener("ready",pa),D.addEventListener("DiagnosisWindowMode",function(){}),D.addEventListener("UserActivityDetected",function(){}),D.addEventListener("Auto_Logoff_Reload",function(){}),D.addEventListener("4h_Reload",function(){}),D.addEventListener("ActiveCasServer",E.onActiveCasServer.bind(E)),D.addEventListener("Quality",function(){}),D.addEventListener("ondatachange",function(){}),D.addEventListener("ClientInfo",Fa),"undefined"!=typeof mainsvg&&(N.svgobject=document.getElementById(mainsvg),N.svgobject)){N.svg=N.svgobject.getSVGDocument(),N.svgobject.style.visibility="visible";try{var b=N.svg.createElementNS("http://www.w3.org/1999/xhtml","link");b.setAttribute("href","/lib/css/durr.emos-svg.css"),b.setAttribute("type","text/css"),b.setAttribute("rel","stylesheet"),N.svg.documentElement.appendChild(b)}catch(a){console.error(a)}}if(z.au=window.LoginDialog||new LoginDialog,void 0!==a){if(void 0!==a.host&&(M.host=a.host),void 0!==a.onopen)try{a.onopen(),D.dispatchEvent({type:"ready"})}catch(a){console.error("[config.onopen] : ",a)}void 0!==a.onmessage&&D.addEventListener("message",a.onmessage),void 0!==a.onclose&&D.addEventListener("close",a.onclose),void 0!==a.onerror&&D.addEventListener("error",a.onerror),void 0!==a.infoListener&&D.addEventListener("info",a.infoListener),void 0!==a.systemInfoListener&&D.addEventListener("systemInfo",a.systemInfoListener),void 0!==a.languageListener&&D.addEventListener("language",a.languageListener)}else D.dispatchEvent({type:"ready"});void 0===M.host&&"undefined"!=typeof serverPool&&(M.host=Gb());var c=Hb(M.host);console.info("[",location.pathname,"] connecting to [",c,"]"),null===d||3===d.readyState?(g=c,h=location.protocol+"//"+M.host,D.dispatchEvent({type:"connecting",message:"connecting"}),d=new WebSocket(c),d.onopen=Ga,d.onmessage=Ha,d.onclose=Db,d.onerror=Eb):1===d.readyState&&void 0!==a.onopen&&a.onopen(),ga(),fa()}catch(a){console.error("[connect() failed] : ",a)}}function Fa(a){var b={_IP:"ip",_HostName:"hostname",_CanonicalHostName:"canonicalHostname"};try{for(var c in b)DS_HMI.SetVariable(c,a[b[c]],!0)}catch(a){console.log(a)}}function Ga(){try{e||(console.info("[",location.pathname,"] established a WS connection"),e=!0,Qb(),Kb(),v=!0,Lb(),qa(),ra(),sa(),D.dispatchEvent({type:"openWS"}),f&&Object.keys(p).length>0?$a():D.dispatchEvent({type:"open"}))}catch(a){console.error("onEmosOpen() failed: "+a)}}function Ha(a){try{v&&(v=!1);var b=JSON.parse(a.data),c;switch(b.type){case"dataChange":case"alarmText":case"trendInfo":case"trendPlantList":case"trendItemList":case"trendItemValueList":case"diagnosisWindow":if("diagnosisWindow"===b.type&&(b.value=JSON.parse(b.value)),void 0!==p[b.id]){var d=p[b.id];c=d.parameter,d.callback(b,c),D.dispatchEvent({type:"ondatachange",message:b})}break;case"systemInfo":D.dispatchEvent({type:"systemInfo",message:b});break;case"info":D.dispatchEvent({type:"info",message:b});break;case"general":switch(b.key){case"TestSVGRender":C.testSVGRender(b);break;case"Authentication":D.dispatchEvent({type:"authentication",message:JSON.parse(b.value)});break;case"ActiveCasServer":D.dispatchEvent({type:"ActiveCasServer",message:JSON.parse(b.value)}),D.dispatchEvent({type:"ActiveCasServerReady",message:JSON.parse(b.value)})}}D.dispatchEvent({type:"message",message:b})}catch(a){console.error("onEmosMessage() failed: "+a)}}function Ia(a,b,c,d,e,f,g,h,i,j,k,l,m){return b=b||u.IO.id,b.subscriberGroup.prototype.getTagId(a,b,c,d,e,f,g,h,i,j,k,l,m)}function Ja(a,b,c,d,e,f,g,h,i,j,k,l,n,o){try{if(!a||""===a||"."===a[0]||"."===a[a.length-1]||a.indexOf("..")>-1||a.indexOf("undefined")>-1||a.indexOf("#")>-1)return null;d=d||Definition.tagType.IO;var p=Ia(a,d,e,f,g,h,i,j,k,l,n,o,c),q=m[p];void 0===q&&(q=new d.subscriberGroup(a,d,e,f,g,h,i,j,k,l,n,o,c),m[p]=q);var r=new Subscriber(b,c);return q.register(r),q}catch(a){console.error("advise() error: "+a)}}function Ka(a){var b,c=a.lastIndexOf(".");return c>0&&(b=a.substring(c+1,a.length),a=a.substring(0,c)),Object.keys(u).forEach(function(a){if(u[a].id===b)return u[a]}),u.IO}function La(a,b){try{var c=m[a];c&&c.unregister(b)}catch(a){console.error("unAdvise() error: "+a)}}function Ma(a,b){var c=Sa(a,b);return c?c.value:null}function Na(a,b,c,d,e,f,g,h,i,j,k,l){var m=Ta(a,b,c,d,e,f,g,h,i,j,k,l);return m?m.value:null}function Oa(a,b,c){b=(b||"")+".name";var d=Ua(a,b,u.Text);return d?d.value:c||""}function Pa(a,b){try{var c=Ua(a,"",u.Alarm);if(c){b=b.toLowerCase();var d=!1,e=null;if(e=b.replace(/PrioMin(\d+)/i,function(a,b){return d=!0,b=parseInt(b),c.classStateRec.prioFrom[b]}),d)return e;if(e=b.replace(/PrioMax(\d+)/i,function(a,b){return d=!0,b=parseInt(b),c.classStateRec.prioTo[b]}),d)return e;if(e=b.replace(/State(\d+)/i,function(a,b){d=!0;var e=intToBinary(c.classStateRec.ClassStateNew,32);return"1"===e.charAt(31-b)?0:(e=intToBinary(c.classStateRec.ClassStateAck,32),"1"===e.charAt(31-b)?1:2)}),d)return e;if(e=b.replace(/State(New|Ack)/i,function(a,b){d=!0;var e="new"===b.toLowerCase()?c.classStateRec.ClassStateNew:c.classStateRec.ClassStateAck;return"string"==typeof e&&(e=parseInt(e,2)),e}),d)return e}return null}catch(a){return console.error("[getAlarmGroupProperty] failed: "+a),null}}function Qa(a,b){try{var c=Ua(a,"",u.Property);return c?c.value[b]:null}catch(a){return console.error("[getTagProperty] failed: "+a),null}}function Ra(a,b,c){var d=Sa(a,b);return d?192===d.quality:void 0!==c&&c}function Sa(a,b){return Ua(a,b,u.IO)}function Ta(a,b,c,d,e,f,g,h,i,j,k,l){return Ua(a,b,u.IOObject,c,d,e,f,g,h,i,j,k,l)}function Ua(a,b,c,d,e,f,g,h,i,j,k,l,n){try{if(!(a=void 0===b?a:a+b)||""===a||"."===a[0]||"."===a[a.length-1])return null;var o=m[Ia(a,c,d,e,f,g,h,i,j,k,l,n)];if(K.stillInit){var p=Ja(a,K.callback?K.callback.datachangeListener:null,K.param,c,d,e,f,g,h,i,j,k,l,n);return p?p.actualData:null}if(void 0===o){var p=Ja(a,emosWS.currentAnimation?emosWS.currentAnimation.datachangeListener:null,null,c,d,e,f,g,h,i,j,k,l,n);return p?p.actualData:null}return o.actualData}catch(a){console.error("getTag() error: "+a)}}function Va(a,b){try{var c=null;if(K.stillInit&&K.callback){var d=K.param;c=function(a){K.callback.datachangeListener(a,d)}}return emosWS.serverStorage.getItem(a,c,b)}catch(a){return console.error(a),null}}function Wa(a){return a=a?"storages/"+a:"server_storage",emosWS.attr.storages[a]||new ServerStorage("/config/"+a+".json")}function Xa(a,b,c){var f;try{"function"==typeof b&&(a.id=Ya(b,a,c)),f=JSON.stringify(a);var g=function(){d.send(f)};return e?g():D.addEventListener("open",g),a.id}catch(a){console.log("send failed: "+a)}}function Ya(a,b,c){try{b.id=++k;var d=new Object;return d.callback=a,d.parameter=c,d.message=b,p[k]=d,void 0!==c&&(l[c]=k),k}catch(a){console.error("addDatachangCallback failed: "+a)}}function Za(a){try{delete p[a]}catch(a){console.error("removeDatachangCallback failed: "+a)}}function $a(){console.log("readviseHistory");try{for(var a in p)Xa(p[a].message)}catch(a){console.error("readviseHistory failed: "+a)}}function _a(a,b,c,d){if(!a||""===a&&""===b)console.error("plc / tag is not valid: plc = "+a+" / tag = "+b);else{var e={};e.id="",e.type="advise",e.plc=a,e.tag=b,Xa(e,c,d)}}function ab(a,b,c,d){if(!a||""===a&&""===b)console.error("plc / tag is not valid: plc = "+a+" / tag = "+b);else{var e={};e.id="",e.type="adviseAlarm",e.plc=a,e.tag=b,Xa(e,c,d)}}function bb(a,b,c,d){if(a){var e={};return e.id="",e.type="adviseAlarmText",e.alarmGroup=a,e.languageID=b,Xa(e,c,d)}console.error("alarmGroup is not valid: alarmGroup = "+a)}function cb(a){try{if("*** tag not found ***"===a||""===a)return null;var b={};return props=a.split(";"),props.forEach(function(a){pair=a.split("="),pair&&(b[pair[0]]=pair[1])}),b}catch(a){return console.error("[convertPropertyStringToObject] failed: "+a),null}}function db(a,b,c,d){if(!a||""===a&&""===b)console.error("plc / tag is not valid: plc = "+a+" / tag = "+b);else{var e={};e.id="",e.type="adviseProperty",e.plc=a,e.tag=b,Xa(e,function(a,b){a.value=cb(a.value),c(a,b)},d)}}function eb(a,b){var c={};c.id="",c.type="trendRegister",Xa(c,a,b)}function fb(a,b,c){var d={};d.type="trendGetPlantList",d.trendId=a,Xa(d,b,c)}function gb(a,b,c,d){var e={};e.type="trendGetItemList",e.trendId=a,e.plc=b,Xa(e,c,d)}function hb(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r={};r.type="trendGetItemValueList",r.trendId=a,r.plc=b,r.tag=c,r.startYear=d,r.startMonth=e,r.startDay=f,r.startHour=g,r.startMinute=h,r.startSecond=i,r.endYear=j,r.endMonth=k,r.endDay=l,r.endHour=m,r.endMinute=n,r.endSecond=o,Xa(r,p,q)}function ib(a,b,c,d){var e={};e.id="",e.type="adviseText",e.textID=a,e.subID=b,Xa(e,c,d)}function jb(a,b,c,d){if(d&&d.plc&&d.characterOfOPCLeaf){a.replace(/^(T0[1,3,5]_)(&(.)_)?((\.)?.*\.)?([E,G])(7\d{3,})(_.*)?$/,function(a,e,f,g,h,i,j,k,l){h?i||(h+="."):h=".GP.";var m=d.plc+h+j+k+l;emosWS.advise(m,function(a){var h=f?g:"?"===d.characterOfOPCLeaf?j:d.characterOfOPCLeaf,i=e+h+a.value;["A","B","F","W"].indexOf(h)>-1&&(b="message"),ib(i,b,c,d)},"",emosWS.tagType.IO)})}ib(a,b,c,d)}function kb(a,b,c,d){emosWS.advise(a+"."+b,c,d,u.Text)}function lb(a,b,c){var d={},e=0;void 0!==c&&(e=l[c],Za(e)),d.type="unadvise",d.id=e,d.plc=a,d.tag=b,Xa(d)}function mb(a){if(void 0!==a){var b={};Za(a),b.type="unadvise",b.id=a,b.plc="",b.tag="",Xa(b)}}function nb(a,b,c,d){try{ob(a,b,c,document.getElementById(d).value)}catch(a){console.error("sendPokeByIdValue failed: "+a)}}function ob(a,b,c,d){if(N.allowPoke){var e={};e.type="poke",e.id=a,e.plc=b,e.tag=c,e.value=d,Xa(e)}}function pb(a,b,c,d){var e={};e.id="",e.type="login",e.username=a,e.password=b,Xa(e,c,d)}function qb(a,b,c,d){var e={};e.id="",e.type="loginByKey",e.key=a,e.keytype=d||"ticket",Xa(e,b,c)}function rb(a,b){var c={};c.id="",c.type="logoff",Xa(c,a,b)}function sb(a,b,c,d,e){Xa({id:"",type:"getDiagnosisWindow",lib:a,wintype:b,name:c},d,e)}function tb(a){try{if(a){var b=new Object;b.plc="",b.tag="";var c=a.indexOf(".");return c>0?(b.plc=a.substring(0,c),b.tag=a.substring(c,a.length)):(b.plc=a,b.tag=""),b}return null}catch(a){console.error("getPLCTag failed: "+a)}}function ub(a){try{if(a){var b=new Object;b.plc="",b.tag="";var c=a.lastIndexOf(".");return c>0?(b.plc=a.substring(0,c),b.tag=a.substring(c,a.length)):(b.plc=a,b.tag=""),b}return null}catch(a){console.error("getPLCTagLast() failed: "+a)}}function vb(a,b){try{if("string"==typeof a&&null!==b&&null!==a){var c=!1,d=function(){if(!c){var d=tb(a);ob("0",d.plc,d.tag,String(b)),c=!0}};if(a.indexOf(".Alarm")>-1)d();else{var e=Ia(a,u.IO);void 0===m[e]?Ja(a,d,"",u.IO):d()}}}catch(a){console.error("poke() failed: "+a)}}function wb(a,b){try{var c=xb(a,u.IOObjectPLC);void 0!==c&&c.setValue(b)}catch(a){console.error("[pokeExt()] failed: "+a)}}function xb(a,b){return m[Ia(a,b)]}function yb(a){var b={};b.type="setLanguage",b.languageID=a,Xa(b)}function zb(a,b,c,d){try{var f=0;void 0===d&&(d=500);var g=setInterval(function(){e?(f++,ob(0,b,c,f)):clearInterval(this)},d);o[a]=g}catch(b){console.error("autoPoke() failed: "+b),Ab(a)}}function Ab(a){try{clearInterval(o[a])}catch(a){console.error("stopAutoPoke failed: "+a)}}function Bb(){if(confirm("Be careful! This action will terminate the server service. Do you really want to do this?")){var a={};a.type="info",a.info="stopMainThread",Xa(a)}}function Cb(){if(confirm("Do you really want to reload the CommLib.dll at server?")){var a={};a.type="info",a.info="reloadCommLib",Xa(a)}}function Db(a){e=!1,console.log("The connection is disconnected!"),D.dispatchEvent({type:"close",message:a});try{Fb()}catch(a){console.error("onClose() failed: "+a)}}function Eb(a,b){console.log("The connection gets error: "+a.data+" readyState = "+d.readyState),D.dispatchEvent({type:"error",message:a})}function Fb(){try{f=!0,"undefined"==typeof serverPool?Ea():Y?(Ea({host:Y}),Y=void 0):Ea({host:Gb()})}catch(a){console.error("reconnect() failed: "+a)}}function Gb(){try{if("undefined"!=typeof serverPool)return i>serverPool.length-1?i=0:i++,serverPool[i]}catch(a){console.error("getNextServer() failed: "+a)}}function Hb(a){var b,c="https:"===location.protocol?"wss://":"ws://",d=""===document.location.port?"":":"+document.location.port,e="undefined"==typeof endpointName?"/emosweb":"/"+endpointName;if(void 0===a)a=document.location.hostname,b=c+(""===document.location.hostname?"localhost":document.location.hostname)+d+e;else{var f=a,g="",h=a.indexOf("/");h>0&&(f=a.substring(0,h),g=a.substring(h));var i="ws://"===c?serverPort:serverHttpsPort;void 0!==i&&(d=":"+i),b=c+f+d+g+e}return B=d,b}function Ib(){return"https://"+document.location.hostname+B+"/authentication.htm?url="+encodeURIComponent(document.location.href)+"&id="+Math.floor(1e9*Math.random()+1)}function Jb(){e&&(d.close(),e=!1)}function Kb(){try{setInterval(function(){if(e){var a={};a.type="info",a.info="alive",Xa(a)}else clearInterval(this)},j)}catch(a){console.error("sendAliveMessage() failed: "+a)}}function Lb(){try{setTimeout(function(){v&&d.close()},w)}catch(a){console.error("checkConnection() failed: "+a)}}function Mb(a){"function"==typeof a&&D.addEventListener("language",a)}function Nb(a,b){try{var c=0,d=a.length,e=function(){c===d&&b()};a.forEach(function(a){void 0===q[a]?$.when($.get(a)).done(function(a){$("head").append("<style>"+a+"</style>"),c++,e()}):d--}),e()}catch(a){console.error("getCSS() failed: "+a)}}function Ob(a,b){try{var c=0,d=a.length;$.ajaxSetup({cache:!0});var e=function(){c===d&&b()};a.forEach(function(a){void 0===r[a]?$.getScript(a,function(a,b,d){c++,e()}):d--}),e()}catch(a){console.error("getJS() failed: "+a)}}function Pb(a,b){try{var c=a.js,d=a.css,e=!0,f=!0,g=function(){e&&f&&b()};void 0!==c&&(f=!1,Ob(c,function(){f=!0,g()})),void 0!==d&&(e=!1,Nb(d,function(){e=!0,g()}))}catch(a){console.error("getJS() failed: "+a)}}function Qb(){try{var a={};a.type="general",a.key="UserAgent",a.value=navigator.userAgent,Xa(a)}catch(a){console.error("sendUserAgent() failed: "+a)}}function Rb(a){return stack=a?P.slice(-a):P,P=[],stack}function Sb(a){100===P.length&&(P=[]),P.push(a)}function Tb(){return e}function Ub(){K.globalVariablesSetCallBackAble=!0,K.stillInit=!1,K.callback=null}function Vb(a){H.push(a)}function Wb(){K.globalVariablesSetCallBackAble=!1;while(H.length>0)try{H.shift()()}catch(a){}H.length=0}function Xb(a,b){var c=null,d=null;if(b&&a){var c=R[b];c||(c=new Shape(b),R[b]=c),d=c.add(a)}return{shape:c,index:d}}function Yb(){var a=[],b={};return I.forEach(function(a){b[a.page]=null}),Object.keys(b).forEach(function(b){a.push(b)}),a}function Zb(a){try{a&&(Object.keys(N.site).forEach(function(b){void 0===a[b]&&(a[b]=N.site[b])}),N.site=a,setTimeout(function(){N.siteSet=!0,ja(!0)},1))}catch(a){console.error("setSiteProperties() failed: "+a)}}function $b(a,b,c){if(c)c.text=b,c.path=a,emosWS.rest.framework.createTextFile(c);else{var d={};d.type="general",d.key="WriteFrameworkConfiguration",d.value=JSON.stringify({path:a,configuration:b}),Xa(d)}}function _b(){return[{alg:"$System",text:"$System_Text"},{alg:"110_02F",text:"110_02F_Text"},{alg:"110_02V",text:"110_02V_Text"},{alg:"115_06V",text:"115_06V_Text"},{alg:"120_03V",text:"120_03V_Text"},{alg:"140_05V",text:"140_05V_Text"},{alg:"150_06V",text:"150_06V_Text"},{alg:"198_01V",text:"198_01V_Text"},{alg:"198_02V",text:"198_02V_Text"},{alg:"198_03V",text:"198_03V_Text"},{alg:"210_01V",text:"210_01V_Text"},{alg:"CT_CC01_319101",text:"CT_CC01_319101_Text"},{alg:"CT_CC02_319102",text:"CT_CC02_319102_Text"},{alg:"CT_CC03_319103",text:"CT_CC03_319103_Text"},{alg:"CT_CC04_319104",text:"CT_CC04_319104_Text"},{alg:"CT_CC05_319105",text:"CT_CC05_319105_Text"},{alg:"CT_DEMO_319101",text:"CT_DEMO_319101_Text"},{alg:"CT_PSP",text:"CT_PSP_Text"},{alg:"PT_ECO_312241",text:"PT_ECO_312241_Text"},{alg:"PT_ECP_312221",text:"PT_ECP_312221_Text"},{alg:"PT_ECR_312226",text:"PT_ECR_312226_Text"},{alg:"PT_PTP_312213",text:"PT_PTP_312213_Text"},{alg:"PT_WWP_310212",text:"PT_WWP_310212_Text"},{alg:"PT_DEMO_3316231",text:"PT_DEMO_3316231_Text"},{alg:"Benchmark_PLC1",text:"Benchmark_PLC1_Text"},{alg:"Benchmark_PLC2",text:"Benchmark_PLC2_Text"},{alg:"Benchmark_PLC3",text:"Benchmark_PLC3_Text"},{alg:"Benchmark_PLC4",text:"Benchmark_PLC4_Text"},{alg:"L1GHB1",text:"L1GHB1_Text"},{alg:"L1VFU1",text:"L1VFU1_Text"},{alg:"L1VHK1",text:"L1VHK1_Text"},{alg:"L1VKT1",text:"L1VKT1_Text"},{alg:"L1VTD1",text:"L1VTD1_Text"},{alg:"L1VTF1",text:"L1VTF1_Text"},{alg:"L1VTK1",text:"L1VTK1_Text"},{alg:"L1VVB1",text:"L1VVB1_Text"},{alg:"PT_DS1_316233",text:"PT_DS1_316233_Text"}]}function ac(a,b){return new UserIdle(D,a,b)}function bc(){return M.host}function cc(a){var b=[];W.forEach(function(c){c.getStatus(function(c){b.push(c),b.length===W.length&&a(b)})})}function dc(){return W}function ec(){return CheckUserRight("sys_sr",11)}function fc(){return CheckUserRight("sys_sr",4)}function gc(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function hc(a,b,c){var d=[],e=c,f=function(a){try{if(!a)return;if(a.value){var g=a.value,h=parseFloat(a.value);"true"===a.value?g=!0:"false"===a.value?g=!1:NaN!==h&&h.toString().length===a.value.length&&(g=h),d[a.tag]=g}var i=!1;for(var j in d)""===d[j]&&(i=!0);if(!i&&e){e=!1,b(d);for(var j in d)emosWS.unadvise(j+".IO",f)}else i||c||b(d)}catch(a){console.log(a)}};a.forEach(function(a){d[a]=""}),a.forEach(function(a){emosWS.advise(a,f,"",emosWS.tagType.IO)})}return{version:b,Subscriber:Subscriber,GlobalVariable:GlobalVariable,ServerStorage:ServerStorage,InOut:varInOut,languageID:s,unitID:t,tagType:u,animationData:K,globalID:c,globalStack:P,blinkInterval:Q,login:z,Cas:E,tagDestination:m,badQualityTags:n,shapes:R,callbacks:H,attr:N,clickData:L,idb:S,debug:T,gvNumber:0,glcNumber:0,textNumber:0,animationNumber:0,linkNumber:0,topicNumber:0,shapeNumber:0,links:I,globalVariables:J,rest:F,serverStorage:O,userIdleActionLogout:U,userIdleActionReload:V,servers:W,connect:Ea,advise:Ja,unadvise:La,unadviseById:mb,poke:vb,pokeExt:wb,getPLCTag:tb,getPLCTagLast:ub,getTagValue:Ma,getTagQualityAsBoolean:Ra,getTagData:Sa,getTagObject:Na,getTagProperty:Qa,getText:Oa,getAlarmGroupProperty:Pa,getTagId:Ia,getSubscriberGroup:xb,send:Xa,sendAdvise:_a,sendAdviseText:kb,sendAdviseTextCache:kb,sendAdviseTextDirect:jb,sendAdviseAlarm:ab,sendAdviseAlarmText:bb,sendAdviseProperty:db,sendUnadvise:lb,sendPokeByIdValue:nb,sendPoke:ob,sendSetLanguage:yb,sendTrendRegister:eb,sendTrendGetPlantList:fb,sendTrendGetItemList:gb,sendTrendGetItemValueList:hb,sendLogin:pb,sendLoginByKey:qb,sendLogoff:rb,sendGetDiagnosisWindow:sb,autoPoke:zb,stopAutoPoke:Ab,stopMainThread:Bb,reloadCommLib:Cb,getEndPointURI:Hb,closeWebSocket:Jb,getLanguage:ta,getUnit:ua,setLanguage:ya,setUnit:za,hasQualityGood:Da,addLanguageChangeListener:Mb,getCSS:Nb,getJS:Ob,require:Pb,getGlobalStack:Rb,pushGlobalStack:Sb,propagateMessage:ma,addEventListener:D.addEventListener.bind(D),removeEventListener:D.removeEventListener.bind(D),dispatchEvent:D.dispatchEvent.bind(D),getWebSocketStatus:Tb,listenGlobalVariablesChange:Ub,callbackGlobalVariablesChange:Wb,addGlobalVariablesChange:Vb,addAnimation:Xb,getWSHostname:va,getHostname:wa,informParent:oa,writeData:$b,setSiteProperties:Zb,getAlarmList:_b,setUserIdle:ac,getActiveServerName:bc,getServersStatus:cc,getServers:dc,getServerStorageItem:Va,getServerStorage:Wa,isAdmin:ec,isServerAdmin:fc,setDebugSymbolVisibility:Aa,getDebugSymbolVisibility:Ba,guid:gc,isMessageAlreadyPropagated:na,getClientInfo:ca,adviseIOGroup:hc}}();window.emosWS=emosWS,emosWS.EventDispatcher=EventDispatcher,emosWS.fn={getElementGlobalID:function(){return"EMOSUI"+emosWS.globalID++},formatNumber:function(a){return a<10?(100+a).toString().slice(-2):a.toString()},_openWindow:function(a,b,c){privateCallback("window",a,b,c)},_modelessDialog:function(a,b,c){privateCallback("modeless",a,b,c)},_modalDialog:function(a,b,c){privateCallback("modal",a,b,c)},getSVGElement:function(a){try{if(null===a)return;if("undefined"==typeof mainsvg)return document.getElementById(a);return document.getElementById(mainsvg).getSVGDocument().getElementById(a)}catch(a){console.log("getSVGElement failed: "+a)}},setStyle:function(a,b){try{if(null===a)return;if("undefined"==typeof mainsvg){var c=document.getElementById(a);for(var d in b)c.style[d]=b[d]}else{var e=document.getElementById(mainsvg).getSVGDocument(),f=e.getElementById(a);for(var d in b)setStyleDeep(f,d,b[d])}}catch(a){console.log("setStyle failed: "+a)}},setStyleDeep:function(a,b,c){if(null!==a)if("g"===a.tagName)for(var d=0,e=a.childNodes.length;d<e;d++)setStyleDeep(a.childNodes[d],b,c);else if(void 0!==a.style)switch(b){case"fill":var f=a.getAttribute("fill"),g=f.match(/url\(#(.*)\)/);if(g){var h=document.getElementById(mainsvg).getSVGDocument().getElementById(g[1]),i=h.childNodes[1];i.setAttribute("stop-color",c)}else a.style.fill=c;break;default:a.style[b]=c}},setFillColor:function(a,b){try{if("undefined"==typeof mainsvg)document.getElementById(a).style.backgroundColor=b;else{document.getElementById(mainsvg).getSVGDocument().getElementById(a).style.fill=b}}catch(a){console.log("setFillColor failed: "+a)}},setStrokeColor:function(a,b){try{if("undefined"==typeof mainsvg)document.getElementById(a).style.backgroundColor=b;else{document.getElementById(mainsvg).getSVGDocument().getElementById(a).style.stroke=b}}catch(a){console.log("setFillColor failed: "+a)}},setSize:function(a,b,c,d,e,f,g,h,i,j,k,l){try{if("undefined"!=typeof mainsvg){var m=document.getElementById(mainsvg).getSVGDocument(),n=m.getElementById(a),o=d-c;switch(b<c?b=c:b>d&&(b=d),l){case"Top":var p=(b-c)/o*i;k+=i-p,n.setAttribute("height",p),n.setAttribute("y",k);break;case"Bottom":var p=(b-c)/o*i;n.setAttribute("height",p);break;case"Right":var q=(b-c)/o*i;n.setAttribute("width",q);break;case"Left":var q=(b-c)/o*i;j+=i-q,n.setAttribute("width",q),n.setAttribute("x",j)}}}catch(a){console.log("setFillColor failed: "+a)}},setText:function(a,b){try{if("undefined"!=typeof mainsvg){var c=document.getElementById(mainsvg).getSVGDocument(),d=c.getElementById(a);if(d){var e=d.getElementsByTagName("tspan");if(e){for(var f=0,g=e.length;f<g;f++)e[f].textContent="";e[0].textContent=b}else d.textContent=b}}}catch(a){console.log("setText failed: "+a)}},setVisibility:function(a,b){try{if("undefined"==typeof mainsvg)document.getElementById(a).style.backgroundColor=color;else{document.getElementById(mainsvg).getSVGDocument().getElementById(a).style.display=b?"block":"none"}}catch(a){console.log("setFillColor failed: "+a)}},setEvent:function(a,b,c,d,e){try{var f=!1;if(null===a)return;if("undefined"==typeof mainsvg&&void 0===e)document.getElementById(a).addEventListener(b,c,f);else{var g=e?document:document.getElementById(mainsvg).getSVGDocument(),h=g.getElementById(a);if(null===h)return;h.style.cursor=d,h.addEventListener(b,c,f)}}catch(a){console.log("setEvent failed: "+a)}},MaxDouble:function(a,b){var c;try{c=Math.max(a,b)}catch(a){c=null}return c},MinDouble:function(a,b){var c;try{c=Math.min(a,b)}catch(a){c=null}return c},MaxInteger:function(a,b){return MaxDouble(a,b)},MinInteger:function(a,b){return MinDouble(a,b)},Modulo:function(a,b){var c;try{c=a%b}catch(a){c=null}return c},modulo:function(a,b){return Modulo(a,b)},AbsDouble:function(a){var b;try{b=Math.abs(a)}catch(a){b=null}return b},AbsInteger:function(a){return AbsDouble(a)},GetAsStringWithoutQuality:function(a,b){return GetAsString(a,b)},GetAsDoubleWithoutQuality:function(a,b){return GetAsDouble(a,b)},GetAsIntegerWithoutQuality:function(a,b){return GetAsInteger(a,b)},GetAsBooleanWithoutQuality:function(a,b){return GetAsBoolean(a,b)},GetDoubleAsFormattedString:function(a,b){try{switch(typeof b){case"number":return parseFloat(a).toFixed(b);case"string":try{if(emosWS.attr.dataFormatter&&void 0!==a&&null!==a){var c=b,d,e;return b.replace(/^(\S*)( .*)?$/,function(a,b,e){c=b,d=e}),e=emosWS.attr.dataFormatter.format(a,"Number",c).value,d&&(e+=d),e}}catch(a){console.log(a)}return a;default:return a}}catch(a){console.error("[GetDoubleAsFormattedString] :",a)}},RoundDouble:function(a,b){var c;try{c=Math.round(a)}catch(a){c=null}return c},RoundInteger:function(a,b){return RoundDouble(a)},GetRegularExpressionReplaced:function(a,b){try{return a+="","null"!==a?b.replace(/(.*)!(.*)/,function(b,c,d){return a.replace(new RegExp(c,"g"),d)}):null}catch(a){console.error("[GetRegularExpressionReplaced] :",a)}},GetRegularExpressionMatchTest:function(a,b){return new RegExp(b,"g").test(a)},GetSubStringAsString:function(a,b){return GetSubString(a,b)},getSubStringAsString:function(a,b){return GetSubStringAsString(a,b)},GetSubString:function(a,b){if("string"==typeof a){var c=/\[(R?)(\d+)([-,])(\d*)\]/;return b.replace(c,function(b,c,d,e,f){if(c){var g=a.length;return"-"===e?f?a.substring(g-f+1,g-d+2):a.substring(0,g-d):a.substr(g-d+2-f,g-d+2)}return"-"===e?f?a.substring(d-1,f):a.substring(d-1):a.substr(d-1,f)})}return null},AdviseTag:function(a,b){emosWS.animationData.stillInit=!0,emosWS.animationData.callback=null,emosWS.animationData.param=null,emosWS.getTagValue(a,b),emosWS.animationData.stillInit=!1},GetTagQualityAsBoolean:function(a,b){return emosWS.getTagQualityAsBoolean(a,b)},getTagQualityAsBoolean:function(a,b){return emosWS.getTagQualityAsBoolean(a,"",b)},getTagQualityAsString:function(a,b){return GetAsString(getTagQualityAsBoolean(a,b))},getTagLastSourceAsString:function(a,b){console.info("[API is not yet implemented] getTagLastSourceAsString")},getTagQualityAsNumber:function(a,b){return GetAsDouble(getTagQualityAsBoolean(a,b),0)},GetTagProperty:function(a,b){return emosWS.getTagProperty(a,b)},GetTagPropertyAsBoolean:function(a,b){var c=GetTagProperty(a,b);return GetAsBoolean(c)},GetTagPropertyAsInteger:function(a,b){var c=GetTagProperty(a,b);return GetAsInteger(c)},GetTagPropertyAsDouble:function(a,b){var c=GetTagProperty(a,b);return GetAsDouble(c)},GetTagPropertyAsString:function(a,b){var c=GetTagProperty(a,b);return GetAsString(c)},SetTagValue:function(a,b,c){void 0===c?SetTagValue(!0,a,b):a&&emosWS.poke(b,c)},ForceTagValue:function(a,b,c){SetTagValue(a,b,c)},SetBitInTagValue:function(a,b){console.info("[API is not yet implemented] SetBitInTagValue")},ResetBitInTagValue:function(a,b){console.info("[API is not yet implemented] ResetBitInTagValue")},ToggleBitInTagValue:function(a,b){console.info("[API is not yet implemented] ToggleBitInTagValue")},ForceSetBitInTagValue:function(a,b){SetBitInTagValue(a,b)},ForceResetBitInTagValue:function(a,b){ResetBitInTagValue(a,b)},ForceToggleBitInTagValue:function(a,b){ToggleBitInTagValue(a,b)},SetVariableAs:function(a,b,c){a&&(b instanceof varInOut?b.value=c:b instanceof GlobalVariable&&b.setDirectValue(c))},SetVariableAsString:function(a,b,c){SetVariableAs(a,b,c)},SetVariableAsDouble:function(a,b,c){SetVariableAs(a,b,c)},SetVariableAsInteger:function(a,b,c){SetVariableAs(a,b,c)},SetVariableAsBoolean:function(a,b,c){SetVariableAs(a,b,c)},SetJSVar:function(a,b,c){b&&a&&(window[a]=c)},SetJavaScriptVariable:function(a,b,c){SetJSVar(a,b,c)},SetJSVariableAsString:function(a,b,c){SetJSVar(a,b,c)},SetJSVariableAsDouble:function(a,b,c){SetJSVar(a,b,c)},SetJSVariableAsInteger:function(a,b,c){SetJSVar(a,b,c)},SetJSVariableAsBoolean:function(a,b,c){SetJSVar(a,b,c)},ForceJSVariableAsString:function(a,b,c){SetJSVar(a,b,c)},ForceJSVariableAsDouble:function(a,b,c){SetJSVar(a,b,c)},ForceJSVariableAsInteger:function(a,b,c){SetJSVar(a,b,c)},ForceJSVariableAsBoolean:function(a,b,c){SetJSVar(a,b,c)},GetText:function(a,b,c){return emosWS.getText(a,b,c)},gettext:function(a,b){return GetText(a,b)},GetAlarmGroupStateAsInteger:function(a,b){console.info("[API is not yet implemented] GetAlarmGroupStateAsInteger")},GetAlarmGroupsStateAsInteger:function(a,b){console.info("[API is not yet implemented] GetAlarmGroupsStateAsInteger")},GetAlarmGroupPropertyAsBoolean:function(a,b){return GetAsBoolean(emosWS.getAlarmGroupProperty(a,b))},GetAlarmGroupPropertyAsInteger:function(a,b){return GetAsInteger(emosWS.getAlarmGroupProperty(a,b))},GetAlarmGroupPropertyAsDouble:function(a,b){return GetAsDouble(emosWS.getAlarmGroupProperty(a,b))},GetAlarmGroupPropertyAsString:function(a,b){return GetAsString(emosWS.getAlarmGroupProperty(a,b))},AcknowledgeAlarmGroup:function(a,b){console.info("[API is not yet implemented] AcknowledgeAlarmGroup")},AcknowledgeAlarmGroups:function(a,b){console.info("[API is not yet implemented] AcknowledgeAlarmGroups")},Test:function(a){return!0===a.value},TST:function(a){return Test(a)},TestAndReset:function(a){return Test(a)},TAR:function(a){return TestAndReset(a)},Trigger:function(a){return TestAndReset(a)},GetBlinkState:function(a,b){return GBS(a,b)},GBS:function(a,b){return a&&emosWS.blinkInterval.GBS()},GetObjectPropertyAsString:function(a,b){console.info("[API is not yet implemented] GetObjectPropertyAsString")},GetTagObject:function(a,b,c,d,e,f,g,h,i,j,k,l){return emosWS.getTagObject(a,b,c,d,e,f,g,h,i,j,k,l)},GetTagValueAsBoolean:function(a,b){var c=emosWS.getTagValue(a,b);return GetAsBoolean(c)},GetTagValueasBoolean:function(a,b){return GetTagValueAsBoolean(a,b)},GetTagValueAsboolean:function(a,b){return GetTagValueAsBoolean(a,b)},getTagValueAsBoolean:function(a,b){return GetTagValueAsBoolean(a,b)},getTagValueasBoolean:function(a,b){var c=GetTagValueAsBoolean(a);return c||b},getTagValueAsBitByMask:function(a,b,c){console.info("[API is not yet implemented] getTagValueAsBitByMask")},GetTagValueAsInteger:function(a,b){var c=emosWS.getTagValue(a,b);return GetAsInteger(c)},GetTagValueAsiNTEGER:function(a,b){return GetTagValueAsInteger(a,b)},GetTAgValueASInteger:function(a,b){return GetTagValueAsInteger(a,b)},GetTagValueAsinteger:function(a,b){return GetTagValueAsInteger(a,b)},getTagValueAsInteger:function(a,b){return GetTagValueAsInteger(a,b)},getTagValueAsNumber:function(a,b){var c=GetTagValueAsDouble(a);return c||b},GetTagValueAsDouble:function(a,b){var c=emosWS.getTagValue(a,b);return GetAsDouble(c)},GetTagValueAsdouble:function(a,b){return GetTagValueAsDouble(a,b)},getTagValueAsDouble:function(a,b){return GetTagValueAsDouble(a,b)},GetTagValueAsString:function(a,b){var c=emosWS.getTagValue(a,b);return GetAsString(c)},gettagvalueasstring:function(a,b){return GetTagValueAsString(a,b)},getTagValueAsString:function(a,b){var c=GetTagValueAsString(a);return c||b},GetAsString:function(a,b){var c;try{c=String(a)}catch(a){c=GetAsString(b,null)}return c},getValueAsString:function(a,b){return GetAsString(a,b)},getValueAsNumber:function(a,b){console.info("[API is not yet implemented] getValueAsNumber")},GetServerStorageItem:function(a){return emosWS.getServerStorageItem(a)},GetServerStorage:function(){return emosWS.getServerStorageItem(null,!0)},SetServerStorageItem:function(a,b){emosWS.serverStorage.setItem(a,b)},RemoveServerStorageItem:function(a,b,c){emosWS.serverStorage.removeItem(a,b,c)},ClearServerStorage:function(a,b){emosWS.serverStorage.clear(a,b)},GetAsDouble:function(a,b){var c=parseFloat(a);return isNaN(c)&&(c=c?GetAsDouble(b):null),c},getValueAsDouble:function(a,b){return GetAsDouble(a,b)},GetAsInteger:function(a,b){var c=parseInt(a);return isNaN(c)&&(c=c?GetAsInteger(b):null),c},getValueAsInteger:function(a,b){return GetAsInteger(a,b)},GetAsBoolean:function(a,b){var c=String(a).toLowerCase();switch(c){case"true":case"1":case"-1":c=!0;break;case"false":case"0":c=!1;break;case"null":case"undefined":c=null;break;default:c=GetAsBoolean(b)}return c},getValueAsBoolean:function(a,b){return GetAsBoolean(a,b)},getValueAsBitByMask:function(a,b,c){console.info("[API is not yet implemented] getValueAsBitByMask")},getChildNodes:function(a,b){console.info("[API is not yet implemented] getChildNodes")},getElementByTagNameAndAttribute:function(a,b,c){console.info("[API is not yet implemented] getElementByTagNameAndAttribute")},getElementsFromObject:function(a,b,c){console.info("[API is not yet implemented] getElementsFromObject")},setElementsAttribute:function(a,b,c){console.info("[API is not yet implemented] setElementsAttribute")},setElementsStyleAttribute:function(a,b,c){console.info("[API is not yet implemented] setElementsStyleAttribute")},enrolFunctionToInterval:function(FunctionName,IntervalTime){isNaN(IntervalTime)&&(IntervalTime=500),setInterval(function(){try{eval(FunctionName)}catch(a){console.error("[enrolFunctionToInterval] : ",a)}},IntervalTime<100?100:IntervalTime)},stopFunctionEnrolledAtInterval:function(a){console.info("[API is not yet implemented] stopFunctionEnrolledAtInterval")},startFunctionEnrolledAtInterval:function(a){console.info("[API is not yet implemented] startFunctionEnrolledAtInterval")},enrolFunctionToTrigger:function(a){try{var b=a.replace("()",""),c=window[b];"function"==typeof c&&emosWS.addEventListener("ondatachange",c)}catch(a){console.error(a)}},enrolFunctionToReadyTrigger:function(a){console.info("[API is not yet implemented] enrolFunctionToReadyTrigger")},stopFunctionEnrolledAtTrigger:function(a){try{var b=a.replace("()",""),c=window[b];"function"==typeof c&&emosWS.removeEventListener("ondatachange",c)}catch(a){console.error(a)}},startFunctionEnrolledAtTrigger:function(a){console.info("[API is not yet implemented] startFunctionEnrolledAtTrigger")},appendTag4Reading:function(a,b){AdviseTag(a,b)},appendTag4ReadingByTag:function(a){AdviseTag(a)},getProcessData:function(a,b){console.info("[API is not yet implemented] getProcessData")},getProcessDataByTag:function(a){console.info("[API is not yet implemented] getProcessDataByTag")},browseFrameName:function(a,b){for(var c=0;c<a.frames.length;c++)if(a.frames[c].name===b)return a.frames[c];for(var d=null,c=0;c<a.frames.length;c++)if(d=browseFrameName(a.frames[c],b))return d;return null},loadHREF:function(a,b){var c=window,d=null;"_top"===b.toLowerCase()?c=top:""!==b&&(d=browseFrameName(top,b))&&(c=d),c.location.href=a},intToBinary:function(a,b){for(var c=a.toString(2),d=c.length,e=0;e<b-d;e++)c="0"+c;return c},getMainSVGDocument:function(a){var b=void 0===a?"mainsvg":a,c=null,d=document.getElementById(b);if(d&&d.contentDocument)c=d.contentDocument;else try{c=d.getSVGDocument()}catch(a){return console.log("getMainSVGDocument error: "+a),c}return c},emosExtend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},CheckUserRight:function(a,b){return emosWS.login.au.hasRight(a,b)},getVisibility:function(a){return"block"===a},getNumberAsFormattedString:function(a,b,c){console.info("[API is not yet implemented] getNumberAsFormattedString")},appendTag4Writing:function(a,b){console.info("[API is not yet implemented] appendTag4Writing")},appendTag4WritingByTag:function(a){console.info("[API is not yet implemented] appendTag4WritingByTag")},writeTagValue:function(a,b,c,d,e,f){console.info("[API is not yet implemented] writeTagValue")},writeTagValueByTag:function(a,b,c,d,e){SetTagValue(a,b)},GetSubstring:function(a,b){return GetSubString(a,b)},GetSubStringAsBoolean:function(a,b){return GetAsBoolean(GetSubString(a,b))},GetSubStringAsInteger:function(a,b){return GetAsInteger(GetSubString(a,b))},GetSubStringAsDouble:function(a,b){return GetAsDouble(GetSubString(a,b))},bitSet:function(a,b){return 0!=(a&1<<b)},bitNotSet:function(a,b){return bitSet(a,b)},getUrlVars:function(a){for(var b=[],c,d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)c=d[e].split("="),b.push({Name:c[0],Value:c[1]}),b[c[0]]=c[1];return b},ReadParametersFromDialogArguments:function(){return window.dialogArguments?getUrlVars(window.dialogArguments):[]},sortHashArray:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b.sort()},getFunctionFromESFuction:function(a){try{var b=!1,c=0,d=function(a,d){b=!0;var e="_tmpVar"+c++;return d.value+="var "+e+" = "+a+";\n",e},e="",f=a.toString().replace(/^function\s*\([^{]*\)\s*\n?{|}$/g,""),g={value:""};f=f.replace(/([$\w]*)\.value(?!\s*=[^=])/g,function(a,b){return window[b]instanceof GlobalVariable?d(a,g):a});var h=-1,i={value:""};if(f=f.replace(/Get(?:Tag|Text|AlarmGroup)[^\(]+\([^\)]*\)/gi,function(a,b){if(-1===h){h=0;while(b>0){if("\n"===f.charAt(b)){h=b+1;break}b--}}return d(a,i)}),b){if(h>0){var j=f.substring(0,h),k=j.lastIndexOf("var");if(-1!==k){k+=3;while(k<h){var l=f.charAt(k);if(k++,"\n"===l){e=f.substring(0,k),f=f.substring(k);break}}}}return new Function(g.value+e+i.value+f)}return a}catch(b){return console.log(b),a}}};for(var i in emosWS.fn)window[i]=emosWS.fn[i];window.G_Params=getUrlVars(window.location.search),window.G_DialogArgs=ReadParametersFromDialogArguments();var DS_HMI=function(){function a(a,b,c){try{if(c){var d=window[a.replace(".value","")];d&&d.setValue(b)}}catch(a){console.log("DS_HMI SetVariable() failed: "+a)}}function b(a){emosWS.debug.show()}function c(a){emosWS.debug.show()}function d(a){emosWS.debug.show()}function e(a){emosWS.debug.show()}function f(a){emosWS.debug.show()}function g(a){emosWS.debug.show()}function h(a){alert("Sorry, emos.js currently does not support DebugGlobalVariables!")}return{SetVariable:a,DebugJSCode:b,DebugIOTags:c,DebugCommLib:d,DebugCommLibData:e,DebugCommLibCalls:f,DebugMessages:g,DebugGlobalVariables:h}}();window.DS_HMI=DS_HMI,emosWS.DS_HMI=DS_HMI;function ESAnimation(){if(emosWS.animationNumber++,this.data=null,this.qualityGood=!1,this.badQualityTagList={},this.advisedTagList={},this.shape=null,this.shapeText=null,this.shapeTextContent=null,this.strokeWidthBad=1.5,void 0!==this.target){var a=emosWS.addAnimation(this,this.target);this.SHAPE=a.shape,this.index=a.index,this.shape=this.SHAPE.shape,this.shapeText=this.SHAPE.shapeText,this.shapeTextContent=this.SHAPE.shapeTextContent}this.datachangeListener=this.datachangeListener.bind(this),this.initialize=this.initialize.bind(this),this.conditionFunction&&(this.initConditionFunction=getFunctionFromESFuction(this.conditionFunction)),this.initialize(),emosWS.dispatchEvent({type:"HMIanimation"})}ESAnimation.prototype.updateTagList=function(a){void 0!==a&&(this.advisedTagList[a.tag]=0,emosWS.hasQualityGood(a)?void 0!==this.badQualityTagList[a.tag]&&delete this.badQualityTagList[a.tag]:this.badQualityTagList[a.tag]=0,this.qualityGood=0===Object.keys(this.badQualityTagList).length)},ESAnimation.prototype.checkQuality=function(){try{var a={};this.useQuality&&(a.stroke=this.qualityGood?this.strokeColorQualityGood:this.strokeColorQualityBad,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad),this.hideIfQualityBad&&!this.qualityGood&&(a.display="none"),this.setStyle(a)}catch(a){console.error("[",this.constructor.name,"] checkQuality failed: ",a)}},ESAnimation.prototype.setCallback=function(){emosWS.animationData.callback=this},ESAnimation.prototype.datachangeListener=function(a){try{emosWS.animationData.stillInit&&this.setCallback(),this.updateTagList(a),emosWS.currentAnimation=this,this.datachangeListenerMore(a),emosWS.currentAnimation=null}catch(a){console.log(this.constructor.name+": datachangeListener failed: "+a)}},ESAnimation.prototype.datachangeListenerMore=function(){},ESAnimation.prototype.initialize=function(){try{emosWS.animationData.stillInit=!0,this.setCallback(),this.unadvise(),this.initializeMore(),emosWS.animationData.stillInit=!1}catch(a){console.log(this.constructor.name+": initialize failed: "+a)}},ESAnimation.prototype.initializeMore=function(){},ESAnimation.prototype.unadvise=function(){try{for(var a in this.advisedTagList)emosWS.unadvise(a,this);this.badQualityTagList={},this.advisedTagList={},this.unadviseMore()}catch(a){console.log(this.constructor.name+": unadvise failed: "+a)}},ESAnimation.prototype.unadviseMore=function(){},ESAnimation.prototype.setStyle=function(a){this.SHAPE&&this.SHAPE.setStyle(a,this.index)},ESAnimation.prototype.getDetail=function(){return this.constructor.name+"\n\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\xaf\n"+this.toString()},ESAnimation.prototype.toString=function(){var a=this,b={};for(var c in a)a.hasOwnProperty(c)&&"object"!=typeof a[c]&&"function"!=typeof a[c]&&(b[c]=a[c]);return JSON.stringify(b)},emosWS.ESAnimation=ESAnimation;function ESAnimation2(){ESAnimation.call(this)}ESAnimation2.prototype=Object.create(ESAnimation.prototype),ESAnimation2.prototype.constructor=ESAnimation2,ESAnimation2.prototype.datachangeListenerMore=function(){try{this.condition=this.conditionFunction(),this.startAnimate()}catch(a){console.log(this.constructor.name+"datachangeListenerMore failed: "+a)}},ESAnimation2.prototype.initializeMore=function(){try{this.condition=this.initConditionFunction(),emosWS.animationData.stillInit=!1,null!==this.condition?this.startAnimate():this.checkQuality()}catch(a){console.log("initializeMore failed: "+a)}},emosWS.ESAnimation2=ESAnimation2;function ESAnimation3(){ESAnimation.call(this)}ESAnimation3.prototype=Object.create(ESAnimation.prototype),ESAnimation3.prototype.constructor=ESAnimation3,ESAnimation3.prototype.datachangeListenerMore=function(){try{this.doCondition(),this.startAnimate()}catch(a){console.log(this.constructor.name+": datachangeListenerMore failed: "+a)}},ESAnimation3.prototype.doCondition=function(){},ESAnimation3.prototype.initializeMore=function(){try{this.doCondition(),emosWS.animationData.stillInit=!1,null!==this.condition&&this.startAnimate()}catch(a){console.log("initializeMore failed: "+a)}};var EScriptGlobal=function(a){this.globalScript=a,this.timeout=100,this.timeoutJob=null,this.initialized=!1,this.index=1,this.globalFunction=function(){this.initialized?(null!==this.timeoutJob&&clearTimeout(this.timeoutJob),this.scheduleJob()):this.runGlobalScript()}.bind(this),ESAnimation.call(this)};EScriptGlobal.prototype=Object.create(ESAnimation.prototype),EScriptGlobal.prototype.constructor=EScriptGlobal,EScriptGlobal.prototype.scheduleJob=function(){this.timeoutJob=setTimeout(function(){this.runGlobalScript(),this.timeoutJob=null}.bind(this),this.timeout)},EScriptGlobal.prototype.runGlobalScript=function(){console.info("[Calling EScriptGlobal: ",this.index++,"]"),this.globalScript()},EScriptGlobal.prototype.datachangeListenerMore=function(){try{this.globalFunction()}catch(a){console.log(this.constructor.name+"datachangeListenerMore failed: "+a)}},EScriptGlobal.prototype.initialize=function(){try{emosWS.animationData.stillInit=!0,emosWS.animationData.callback=this,this.initializeMore()}catch(a){console.log(this.constructor.name+": initialize failed: "+a)}},EScriptGlobal.prototype.initializeMore=function(){try{this.globalFunction(),this.initialized=!0,emosWS.animationData.stillInit=!1}catch(a){console.log("initializeMore failed: "+a)}},window.EScriptGlobal=EScriptGlobal,emosWS.EScriptGlobal=EScriptGlobal;var TAlarmRecord=function(a,b,c){this.Name=a,this.Color=b,this.Actioncode=c};emosWS.AlarmRecord=TAlarmRecord;function AColorBlink(a){this.conditionFunction=a.conditionFunction,this.condition=!1,this.swapFillcolor=a.PLACEHOLDER_SWAP_FILLCOLOR,this.swapStrokecolor=a.PLACEHOLDER_SWAP_STROKECOLOR,this.swapVisibility=a.PLACEHOLDER_SWAP_VISIBILITY,this.useFalse=a.PLACEHOLDER_SWAP_USEFALSE,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.fillColorOn=a.PLACEHOLDER_FILLCOLORON,this.fillColorOff=a.PLACEHOLDER_FILLCOLOROFF,this.fillColorFalse=a.PLACEHOLDER_FILLCOLORFALSE,this.fillColor,this.strokeColor,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.strokeColorOn=a.PLACEHOLDER_STROKECOLORON,this.strokeColorOff=a.PLACEHOLDER_STROKECOLOROFF,this.strokeColorFalse=a.PLACEHOLDER_STROKECOLORFALSE,this.visibilityOn=a.PLACEHOLDER_VISIBILITYON,this.visibilityOff=a.PLACEHOLDER_VISIBILITYOFF,this.visibilityFalse=a.PLACEHOLDER_VISIBILITYFALSE,this.target=a.STDPLACEHOLDER_SHAPENAME,this.interval=0,this.trigger=function(){this.animate()}.bind(this),ESAnimation2.call(this)}AColorBlink.prototype=Object.create(ESAnimation2.prototype),AColorBlink.prototype.constructor=AColorBlink,AColorBlink.prototype.startAnimate=function(){this.condition?0===this.interval&&(this.interval=1,emosWS.blinkInterval.addListener(this.trigger,!0)):(0!==this.interval&&(emosWS.blinkInterval.removeListener(this.trigger),this.interval=0),this.animate(this))},AColorBlink.prototype.animate=function(){var a={fill:null,stroke:null,display:null};this.useQuality&&(a.stroke=this.qualityGood?this.strokeColorQualityGood:this.strokeColorQualityBad,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad),this.condition?emosWS.blinkInterval.active?(this.swapFillcolor&&(a.fill=this.fillColorOn),this.swapStrokecolor&&(a.stroke=this.strokeColorOn),this.swapVisibility&&(a.display=this.visibilityOn?"block":"none")):(this.swapFillcolor&&(a.fill=this.fillColorOff),this.swapStrokecolor&&(a.stroke=this.strokeColorOff),this.swapVisibility&&(a.display=this.visibilityOff?"block":"none")):this.useFalse&&(this.swapFillcolor&&(a.fill=this.fillColorFalse),this.swapStrokecolor&&(a.stroke=this.strokeColorFalse),this.swapVisibility&&(a.display=this.visibilityFalse?"block":"none")),this.setStyle(a)},AColorBlink.prototype.toString=function(){return"conditionFunction\n"+this.conditionFunction+"\n\ncondition = "+this.condition+"\n\nswapFillcolor = "+this.swapFillcolor+"\nswapStrokecolor = "+this.swapStrokecolor+"\nswapVisibility = "+this.swapVisibility+"\n\nuseFalse = "+this.useFalse+"\nuseQuality = "+this.useQuality+"\n\nfillColorOn = "+this.fillColorOn+"\nfillColorOff = "+this.fillColorOff+"\nfillColorFalse = "+this.fillColorFalse+"\n\nstrokeColorQualityGood = "+this.strokeColorQualityGood+"\nstrokeColorQualityBad = "+this.strokeColorQualityBad+"\nstrokeColorOff = "+this.strokeColorOff+"\nstrokeColorFalse = "+this.strokeColorFalse+"\n\nvisibilityOn = "+this.visibilityOn+"\nvisibilityOff = "+this.visibilityOff+"\nvisibilityFalse = "+this.visibilityFalse+"\n"},emosWS.ESColorBlink=AColorBlink;function AColorSwap(a){this.conditionFunction=a.conditionFunction,this.condition=!1,this.swapFillcolor=a.PLACEHOLDER_SWAP_FILLCOLOR,this.swapStrokecolor=a.PLACEHOLDER_SWAP_STROKECOLOR,this.swapVisibility=a.PLACEHOLDER_SWAP_VISIBILITY,this.useTrue=a.PLACEHOLDER_SWAP_USETRUE,this.useFalse=a.PLACEHOLDER_SWAP_USEFALSE,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.fillColorTrue=a.PLACEHOLDER_FILLCOLOR,this.fillColorFalse=a.PLACEHOLDER_FILLCOLORFALSE,this.fillColor,this.strokeColor,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.strokeColorTrue=a.PLACEHOLDER_STROKECOLOR,this.strokeColorFalse=a.PLACEHOLDER_STROKECOLORFALSE,this.visibilityTrue=a.PLACEHOLDER_VISIBILITY,this.visibilityFalse=a.PLACEHOLDER_VISIBILITYFALSE,this.hideIfQualityBad=a.PLACEHOLDER_SWAP_HIDEIFQUALITYBAD,this.target=a.STDPLACEHOLDER_SHAPENAME,ESAnimation2.call(this)}AColorSwap.prototype=Object.create(ESAnimation2.prototype),AColorSwap.prototype.constructor=AColorSwap,AColorSwap.prototype.startAnimate=function(){var a={fill:null,stroke:null,display:null};this.useQuality&&(a.stroke=this.qualityGood?this.strokeColorQualityGood:this.strokeColorQualityBad,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad),this.hideIfQualityBad&&(a.display=this.qualityGood?"block":"none"),this.condition?this.useTrue&&(this.swapFillcolor&&(a.fill=this.fillColorTrue),this.swapStrokecolor&&(a.stroke=this.strokeColorTrue),this.swapVisibility&&(a.display=this.visibilityTrue?"block":"none")):this.useFalse&&(this.swapFillcolor&&(a.fill=this.fillColorFalse),this.swapStrokecolor&&(a.stroke=this.strokeColorFalse),this.swapVisibility&&(a.display=this.visibilityFalse?"block":"none")),this.setStyle(a)},AColorSwap.prototype.toString=function(){return"conditionFunction\n"+this.conditionFunction+"\ninitConditionFunction\n"+this.initConditionFunction+"\ncondition = "+this.condition+"\nswapFillcolor = "+this.swapFillcolor+"\nswapStrokecolor = "+this.swapStrokecolor+"\nswapVisibility = "+this.swapVisibility+"\nuseTrue = "+this.useTrue+"\nuseFalse = "+this.useFalse+"\nuseQuality = "+this.useQuality+"\nfillColorTrue = "+this.fillColorTrue+"\nfillColorFalse = "+this.fillColorFalse+"\nfillColorFalse = "+this.fillColorFalse+"\nstrokeColorQualityGood = "+this.strokeColorQualityGood+"\nstrokeColorQualityBad = "+this.strokeColorQualityBad+"\nstrokeColorTrue = "+this.strokeColorTrue+"\nstrokeColorFalse = "+this.strokeColorFalse+"\nvisibilityTrue = "+this.visibilityTrue+"\nvisibilityFalse = "+this.visibilityFalse+"\nhideIfQualityBad = "+this.hideIfQualityBad+"\n"},emosWS.ESColorSwap=AColorSwap;function AFaultWarning(a){this.conditionFunction=a.conditionFunction,this.AlarmGroup="",this.previousAlarmGroup="",this.enabled=!0,this.enabledAck=!1,this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgElement=getSVGElement(this.target),this.svgElement&&(this.originalFillColor=this.svgElement.getAttribute("fill"),this.originalStrokeColor=this.svgElement.getAttribute("stroke")),this.newFaultEnabled=a.PLACEHOLDER_NEWFLT_ENABLED,this.newFaultFillcolor=a.PLACEHOLDER_NEWFLT_FILLCOLOR,this.newFaultVisible=a.PLACEHOLDER_NEWFLT_VISIBLE,this.newFaultBlinking=a.PLACEHOLDER_NEWFLT_BLINKING,this.newFaultProperty={Enabled:this.newFaultEnabled,Fillcolor:this.newFaultFillcolor,Visible:this.newFaultVisible,Blinking:this.newFaultBlinking},this.ackFaultEnabled=a.PLACEHOLDER_ACKFLT_ENABLED,this.ackFaultFillcolor=a.PLACEHOLDER_ACKFLT_FILLCOLOR,this.ackFaultVisible=a.PLACEHOLDER_ACKFLT_VISIBLE,this.ackFaultBlinking=a.PLACEHOLDER_ACKFLT_BLINKING,this.ackFaultProperty={Enabled:this.ackFaultEnabled,Fillcolor:this.ackFaultFillcolor,Visible:this.ackFaultVisible,Blinking:this.ackFaultBlinking},this.newEMSEnabled=a.PLACEHOLDER_NEWEMS_ENABLED,this.newEMSFillcolor=a.PLACEHOLDER_NEWEMS_FILLCOLOR,this.newEMSVisible=a.PLACEHOLDER_NEWEMS_VISIBLE,this.newEMSBlinking=a.PLACEHOLDER_NEWEMS_BLINKING,this.newEMSProperty={Enabled:this.newEMSEnabled,Fillcolor:this.newEMSFillcolor,Visible:this.newEMSVisible,Blinking:this.newEMSBlinking},this.ackEMSEnabled=a.PLACEHOLDER_ACKEMS_ENABLED,this.ackEMSFillcolor=a.PLACEHOLDER_ACKEMS_FILLCOLOR,this.ackEMSVisible=a.PLACEHOLDER_ACKEMS_VISIBLE,this.ackEMSBlinking=a.PLACEHOLDER_ACKEMS_BLINKING,this.ackEMSProperty={Enabled:this.ackEMSEnabled,Fillcolor:this.ackEMSFillcolor,Visible:this.ackEMSVisible,Blinking:this.ackEMSBlinking},this.newWRNEnabled=a.PLACEHOLDER_NEWWRN_ENABLED,this.newWRNFillcolor=a.PLACEHOLDER_NEWWRN_FILLCOLOR,this.newWRNVisible=a.PLACEHOLDER_NEWWRN_VISIBLE,this.newWRNBlinking=a.PLACEHOLDER_NEWWRN_BLINKING,this.newWRNProperty={Enabled:this.newWRNEnabled,Fillcolor:this.newWRNFillcolor,Visible:this.newWRNVisible,Blinking:this.newWRNBlinking},this.ackWRNEnabled=a.PLACEHOLDER_ACKWRN_ENABLED,this.ackWRNFillcolor=a.PLACEHOLDER_ACKWRN_FILLCOLOR,this.ackWRNVisible=a.PLACEHOLDER_ACKWRN_VISIBLE,this.ackWRNBlinking=a.PLACEHOLDER_ACKWRN_BLINKING,this.ackWRNProperty={Enabled:this.ackWRNEnabled,Fillcolor:this.ackWRNFillcolor,Visible:this.ackWRNVisible,Blinking:this.ackWRNBlinking},this.NOEnabled=a.PLACEHOLDER_NO_ENABLED,this.NOFillcolor=a.PLACEHOLDER_NO_FILLCOLOR,this.NOVisible=a.PLACEHOLDER_NO_VISIBLE,this.NOBlinking=a.PLACEHOLDER_NO_BLINKING,this.NOProperty={Enabled:this.NOEnabled,Fillcolor:this.NOFillcolor,Visible:this.NOVisible,Blinking:this.NOBlinking},this.fillcolorNoBlink=a.PLACEHOLDER_FILLCOLORNOBLINK,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.UnknownProperty={Enabled:!0,Fillcolor:this.originalFillColor,Visible:!0,Blinking:!1},this.useHand=a.PLACEHOLDER_USEHAND,this.useStroke=a.PLACEHOLDER_USESTROKE,this.useHide=a.PLACEHOLDER_USEHIDE,this.fillColor,this.interval=0,this.stateMap={0:this.newFaultProperty,1:this.ackFaultProperty,2:this.newEMSProperty,3:this.ackEMSProperty,4:this.newWRNProperty,5:this.ackWRNProperty,6:this.NOProperty,7:this.NOProperty},this.currentProperty=this.stateMap[0],this.alarmStateList={},this.alarmState=null,this.alarmValue=null,this.trigger=function(){this.animate()}.bind(this),ESAnimation.call(this),this.originalStrokeWidth=null,this.originalFill=null,this.shape&&(this.originalStrokeWidth=this.shape.getAttribute("stroke-width"),this.originalFill=this.shape.getAttribute("fill"))}AFaultWarning.prototype=Object.create(ESAnimation.prototype),AFaultWarning.prototype.constructor=AFaultWarning,AFaultWarning.prototype.updateAlarmStateList=function(a){try{if(void 0!==a&&void 0!==a.classStateRec){var b={value:parseInt(a.value),state:a.classStateRec.state};this.alarmStateList[a.tag]=b;var c=100,d=100;for(var e in this.alarmStateList)alarmItem=this.alarmStateList[e],alarmItem.value<d&&(d=alarmItem.value),alarmItem.state<c&&(c=alarmItem.state);this.alarmState=c,this.alarmValue=d}}catch(a){console.log("updateAlarmStateList failed: "+a)}},AFaultWarning.prototype.datachangeListenerMore=function(a){try{this.doCondition(),this.AlarmGroup&&this.AlarmGroup!==this.previousAlarmGroup&&this.adviseData(),void 0!==a&&void 0!==a.classStateRec&&(this.updateAlarmStateList(a),this.startAnimate(a))}catch(a){console.log("AFaultWarning datachangeListenerMore failed: "+a)}},AFaultWarning.prototype.startAnimate=function(a){try{this.currentProperty=this.stateMap[this.alarmState]||this.currentProperty,this.currentProperty.Blinking?0===this.interval&&(this.interval=1,emosWS.blinkInterval.addListener(this.trigger,!1)):this.animate()}catch(a){console.log("AFaultWarning startAnimate failed: "+a)}},AFaultWarning.prototype.animate=function(){try{var a={fill:null,stroke:null,display:null,cursor:null,"stroke-width":null};if(this.useQuality&&(a.stroke=this.qualityGood?this.strokeColorQualityGood:this.strokeColorQualityBad,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad),this.enabled){if(this.useHand&&(a.cursor="pointer"),this.useHide&&(a.display="block"),this.currentProperty.Blinking?emosWS.blinkInterval.active?this.currentProperty.Enabled&&(a.fill=this.currentProperty.Fillcolor):this.currentProperty.Enabled&&(a.fill=this.fillcolorNoBlink):this.currentProperty.Enabled&&(a.fill=this.currentProperty.Fillcolor),this.useStroke&&(a["stroke-width"]=3),this.useVisible||this.currentProperty.useVisible){var b=this.currentProperty.Visible?"block":"none";a.display=b,this.svgTextElement&&(this.svgTextElement.style.display=b)}}else this.useHand&&(a.cursor="auto"),this.useHide&&(a.display="none"),this.useStroke&&(a["stroke-width"]=this.originalStrokeWidth);this.setStyle(a)}catch(a){console.log("AFaultWarning animate failed: "+a)}},AFaultWarning.prototype.adviseData=function(){try{this.previousAlarmGroup=this.AlarmGroup;var a=this;emosWS.advise(this.AlarmGroup,this.datachangeListener,"",emosWS.tagType.Alarm)}catch(a){console.log("adviseData failed: "+a)}},AFaultWarning.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.AlarmGroup=this.getAlarmGroup(a.AlarmGroup),this.enabled=a.Enabled,this.enabledAck=a.EnabledAck}catch(a){console.log("doCondition failed: "+a)}},AFaultWarning.prototype.getAlarmGroup=function(a){return a?a.replace(/.alarm\s*\b/gi,""):null},AFaultWarning.prototype.initializeMore=function(){emosWS.blinkInterval.removeListener(this.trigger),this.interval=0;var a={fill:null,stroke:null,display:null,cursor:null,"stroke-width":null};this.setStyle(a),this.doCondition(),emosWS.animationData.stillInit=!1,this.doCondition(),this.adviseData(),this.startAnimate()},AFaultWarning.prototype.unadviseMore=function(){this.alarmStateList={}},AFaultWarning.prototype.toString=function(){return"AlarmGroup\n"+this.getAlarmGroupString()+"\nenabled = "+this.enabled+"\nenabledAck = "+this.enabledAck+"\n\nnewFaultEnabled = "+this.stateMap+"\nnewFaultFillcolor = "+this.newFaultFillcolor+"\nnewFaultVisible = "+this.newFaultVisible+"\nnewFaultBlinking = "+this.newFaultBlinking+"\n\nackFaultEnabled = "+this.ackFaultEnabled+"\nackFaultFillcolor = "+this.ackFaultFillcolor+"\nackFaultVisible = "+this.ackFaultVisible+"\nackFaultBlinking = "+this.ackFaultBlinking+"\n\nnewEMSEnabled = "+this.newEMSEnabled+"\nnewEMSFillcolor = "+this.newEMSEnabled+"\nnewEMSVisible = "+this.newEMSVisible+"\nnewEMSBlinking = "+this.newEMSBlinking+"\n\nackEMSEnabled = "+this.ackEMSEnabled+"\nackEMSFillcolor = "+this.ackEMSFillcolor+"\nackEMSVisible = "+this.ackEMSVisible+"\nackEMSBlinking = "+this.ackEMSBlinking+"\n\nnewWRNEnabled = "+this.newWRNEnabled+"\nnewWRNFillcolor = "+this.newWRNFillcolor+"\nnewWRNVisible = "+this.newWRNVisible+"\nnewWRNBlinking = "+this.newWRNBlinking+"\n\nackWRNEnabled = "+this.ackWRNEnabled+"\nackWRNFillcolor = "+this.ackWRNFillcolor+"\nackWRNVisible = "+this.ackWRNVisible+"\nackWRNBlinking = "+this.ackWRNBlinking+"\n\nNOEnabled = "+this.NOEnabled+"\nNOFillcolor = "+this.NOFillcolor+"\nNOVisible = "+this.NOVisible+"\nNOBlinking = "+this.NOBlinking+"\n\nfillcolorNoBlink = "+this.fillcolorNoBlink+"\nuseQuality = "+this.useQuality+"\nstrokeColorQualityGood = "+this.strokeColorQualityGood+"\nstrokeColorQualityBad = "+this.strokeColorQualityBad+"\nuseHand = "+this.useHand+"\nuseStroke = "+this.useStroke+"\nuseHide = "+this.useHide+"\n"},AFaultWarning.prototype.getAlarmGroupString=function(){return this.AlarmGroup},window.AFaultWarning=AFaultWarning,emosWS.ESFaultWarning=AFaultWarning;function AFaultsWarnings(a){this.alarmGroups=a.PLACEHOLDER_ALARMGROUPS.split("; "),this.trimAlarmGroups(),AFaultWarning.call(this,a)}AFaultsWarnings.prototype=Object.create(AFaultWarning.prototype),AFaultsWarnings.prototype.constructor=AFaultsWarnings,AFaultsWarnings.prototype.trimAlarmGroups=function(){try{for(var a=0;a<this.alarmGroups.length;a++)""===this.alarmGroups[a]?(this.alarmGroups.splice(a,1),a--):this.alarmGroups[a]=this.alarmGroups[a].replace(".Alarm","")}catch(a){console.log("AFaultsWarnings trimAlarmGroups failed: "+a)}},AFaultsWarnings.prototype.adviseData=function(){try{for(var a=0,b=this.alarmGroups.length;a<b;a++)emosWS.advise(this.alarmGroups[a],this.datachangeListener,"",emosWS.tagType.Alarm)}catch(a){console.log("adviseData failed: "+a)}},AFaultsWarnings.prototype.getAlarmGroupString=function(){var a="";return this.alarmGroups.forEach(function(b){a+=b+"\n"}),a},window.AFaultsWarnings=AFaultsWarnings,emosWS.ESFaultsWarnings=AFaultsWarnings;function AColorSwapMulti(a){this.conditionFunction=a.conditionFunction,this.condition1=!1,this.condition2=!1,this.condition3=!1,this.condition4=!1,this.condition5=!1,this.condition6=!1,this.condition7=!1,this.condition8=!1,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.useElse=a.PLACEHOLDER_SWAP_USEELSE,this.swapFillcolor=a.PLACEHOLDER_SWAP_FILLCOLOR,this.swapStrokecolor=a.PLACEHOLDER_SWAP_STROKECOLOR,this.swapVisibility=a.PLACEHOLDER_SWAP_VISIBILITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.fillColor1=a.PLACEHOLDER_FILLCOLOR1,this.fillColor2=a.PLACEHOLDER_FILLCOLOR2,this.fillColor3=a.PLACEHOLDER_FILLCOLOR3,this.fillColor4=a.PLACEHOLDER_FILLCOLOR4,this.fillColor5=a.PLACEHOLDER_FILLCOLOR5,this.fillColor6=a.PLACEHOLDER_FILLCOLOR6,this.fillColor7=a.PLACEHOLDER_FILLCOLOR7,this.fillColor8=a.PLACEHOLDER_FILLCOLOR8,this.fillColorElse=a.PLACEHOLDER_FILLCOLORELSE,this.strokeColor1=a.PLACEHOLDER_STROKECOLOR1,this.strokeColor2=a.PLACEHOLDER_STROKECOLOR2,this.strokeColor3=a.PLACEHOLDER_STROKECOLOR3,this.strokeColor4=a.PLACEHOLDER_STROKECOLOR4,this.strokeColor5=a.PLACEHOLDER_STROKECOLOR5,this.strokeColor6=a.PLACEHOLDER_STROKECOLOR6,this.strokeColor7=a.PLACEHOLDER_STROKECOLOR7,this.strokeColor8=a.PLACEHOLDER_STROKECOLOR8,this.strokeColorElse=a.PLACEHOLDER_STROKECOLORELSE,this.visibility1=a.PLACEHOLDER_VISIBILITY1,this.visibility2=a.PLACEHOLDER_VISIBILITY2,this.visibility3=a.PLACEHOLDER_VISIBILITY3,this.visibility4=a.PLACEHOLDER_VISIBILITY4,this.visibility5=a.PLACEHOLDER_VISIBILITY5,this.visibility6=a.PLACEHOLDER_VISIBILITY6,this.visibility7=a.PLACEHOLDER_VISIBILITY7,this.visibility8=a.PLACEHOLDER_VISIBILITY8,this.visibilityElse=a.PLACEHOLDER_VISIBILITYELSE,this.fillColor=null,this.strokeColor=null,this.visibility=!0,this.target=a.STDPLACEHOLDER_SHAPENAME,ESAnimation3.call(this)}AColorSwapMulti.prototype=Object.create(ESAnimation3.prototype),AColorSwapMulti.prototype.constructor=AColorSwapMulti,AColorSwapMulti.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.condition1=a.Condition1,this.condition2=a.Condition2,this.condition3=a.Condition3,this.condition4=a.Condition4,this.condition5=a.Condition5,this.condition6=a.Condition6,this.condition7=a.Condition7,this.condition8=a.Condition8}catch(a){console.log("doCondition failed: "+a)}},AColorSwapMulti.prototype.setColor=function(a,b,c){this.swapFillcolor&&(this.fillColor=a),this.swapStrokecolor&&(this.strokeColor=b),this.swapVisibility&&(this.visibility=c)},AColorSwapMulti.prototype.resetColor=function(){this.fillColor=null,this.strokeColor=null,this.visibility=null},AColorSwapMulti.prototype.startAnimate=function(){var a={};this.useQuality&&this.qualityGood&&(this.strokeColor=this.strokeColorQualityGood,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad),this.condition1?this.setColor(this.fillColor1,this.strokeColor1,this.visibility1):this.condition2?this.setColor(this.fillColor2,this.strokeColor2,this.visibility2):this.condition3?this.setColor(this.fillColor3,this.strokeColor3,this.visibility3):this.condition4?this.setColor(this.fillColor4,this.strokeColor4,this.visibility4):this.condition5?this.setColor(this.fillColor5,this.strokeColor5,this.visibility5):this.condition6?this.setColor(this.fillColor6,this.strokeColor6,this.visibility6):this.condition7?this.setColor(this.fillColor7,this.strokeColor7,this.visibility7):this.condition8?this.setColor(this.fillColor8,this.strokeColor8,this.visibility8):this.useElse?this.setColor(this.fillColorElse,this.strokeColorElse,this.visibilityElse):this.resetColor(),this.useQuality&&!this.qualityGood&&(this.strokeColor=this.strokeColorQualityBad),this.swapFillcolor&&(a.fill=this.fillColor),(this.swapStrokecolor||this.useQuality)&&(a.stroke=this.strokeColor),this.swapVisibility&&(a.display=this.visibility?"block":"none"),this.hideIfQualityBad&&!this.qualityGood&&(a.display="none"),this.setStyle(a)},emosWS.ESColorSwapMulti=AColorSwapMulti;function AColorState(a){new emosWS.ESColorSwapMulti({conditionFunction:function(){var b=a.conditionFunction();return{Condition1:b<a.PLACEHOLDER_LIMIT12,Condition2:b<a.PLACEHOLDER_LIMIT23,Condition3:b<a.PLACEHOLDER_LIMIT34,Condition4:b<a.PLACEHOLDER_LIMIT45,Condition5:b<a.PLACEHOLDER_LIMIT56,Condition6:b<a.PLACEHOLDER_LIMIT67,Condition7:b<a.PLACEHOLDER_LIMIT78,Condition8:!1}},PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITY,PLACEHOLDER_SWAP_USEELSE:!0,PLACEHOLDER_SWAP_FILLCOLOR:a.PLACEHOLDER_USEFILLCOLOR,PLACEHOLDER_SWAP_STROKECOLOR:a.PLACEHOLDER_USESTROKECOLOR,PLACEHOLDER_SWAP_VISIBILITY:a.PLACEHOLDER_USEVISIBILITY,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_STROKECOLORQUALITYGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_STROKECOLORQUALITYBAD,PLACEHOLDER_FILLCOLOR1:a.PLACEHOLDER_FILLCOLOR1,PLACEHOLDER_FILLCOLOR2:a.PLACEHOLDER_FILLCOLOR2,PLACEHOLDER_FILLCOLOR3:a.PLACEHOLDER_FILLCOLOR3,PLACEHOLDER_FILLCOLOR4:a.PLACEHOLDER_FILLCOLOR4,PLACEHOLDER_FILLCOLOR5:a.PLACEHOLDER_FILLCOLOR5,PLACEHOLDER_FILLCOLOR6:a.PLACEHOLDER_FILLCOLOR6,PLACEHOLDER_FILLCOLOR7:a.PLACEHOLDER_FILLCOLOR7,PLACEHOLDER_FILLCOLOR8:a.PLACEHOLDER_FILLCOLOR8,PLACEHOLDER_FILLCOLORELSE:a.PLACEHOLDER_FILLCOLOR8,PLACEHOLDER_STROKECOLOR1:a.PLACEHOLDER_STROKECOLOR1,PLACEHOLDER_STROKECOLOR2:a.PLACEHOLDER_STROKECOLOR2,PLACEHOLDER_STROKECOLOR3:a.PLACEHOLDER_STROKECOLOR3,PLACEHOLDER_STROKECOLOR4:a.PLACEHOLDER_STROKECOLOR4,PLACEHOLDER_STROKECOLOR5:a.PLACEHOLDER_STROKECOLOR5,PLACEHOLDER_STROKECOLOR6:a.PLACEHOLDER_STROKECOLOR6,PLACEHOLDER_STROKECOLOR7:a.PLACEHOLDER_STROKECOLOR7,PLACEHOLDER_STROKECOLOR8:a.PLACEHOLDER_STROKECOLOR8,PLACEHOLDER_STROKECOLORELSE:a.PLACEHOLDER_STROKECOLOR8,PLACEHOLDER_VISIBILITY1:a.PLACEHOLDER_VISIBILITY1,PLACEHOLDER_VISIBILITY2:a.PLACEHOLDER_VISIBILITY2,PLACEHOLDER_VISIBILITY3:a.PLACEHOLDER_VISIBILITY3,PLACEHOLDER_VISIBILITY4:a.PLACEHOLDER_VISIBILITY4,PLACEHOLDER_VISIBILITY5:a.PLACEHOLDER_VISIBILITY5,PLACEHOLDER_VISIBILITY6:a.PLACEHOLDER_VISIBILITY6,PLACEHOLDER_VISIBILITY7:a.PLACEHOLDER_VISIBILITY7,PLACEHOLDER_VISIBILITY8:a.PLACEHOLDER_VISIBILITY8,PLACEHOLDER_VISIBILITYELSE:a.PLACEHOLDER_VISIBILITY8,STDPLACEHOLDER_SHAPENAME:a.STDPLACEHOLDER_SHAPENAME})}emosWS.ESColorState=AColorState;function AColorScript(a){this.conditionFunction=a.conditionFunction,this.fillColor=null,this.strokeColor=null,this.visibility=!0,this.enabled=!0,this.swapFillcolor=a.PLACEHOLDER_SWAP_FILLCOLOR,this.swapStrokecolor=a.PLACEHOLDER_SWAP_STROKECOLOR,this.swapVisibility=a.PLACEHOLDER_SWAP_VISIBILITY,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.target=a.STDPLACEHOLDER_SHAPENAME,ESAnimation3.call(this)}AColorScript.prototype=Object.create(ESAnimation3.prototype),AColorScript.prototype.constructor=AColorScript,AColorScript.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.fillColor=a.Fillcolor,this.strokeColor=a.Strokecolor,this.visibility=a.Visibility,this.enabled=a.Enabled}catch(a){console.log("doCondition failed: "+a)}},AColorScript.prototype.startAnimate=function(){var a={},b=null,c=null,d=null;this.useQuality&&this.qualityGood&&(b=this.strokeColorQualityGood,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad),this.enabled&&(this.swapFillcolor&&this.fillColor&&(c=this.fillColor),this.swapStrokecolor&&this.strokeColor&&(b=this.strokeColor),this.swapVisibility&&null!==this.visibility&&(d=this.visibility?"block":"none")),this.useQuality&&!this.qualityGood&&(b=this.strokeColorQualityBad),c&&(a.fill=this.fillColor=c),b&&(a.stroke=this.strokeColor=b),d&&(a.block=this.visibility=d),this.setStyle(a)},emosWS.ESColorScript=AColorScript;function ASize(a){this.conditionFunction=a.conditionFunction,this.postFunction=a.postFunction,this.orientation=a.PLACEHOLDER_ORIENTATION;var b=a.PLACEHOLDER_DIRECTIONREVERSE;if("Top"===this.orientation&&0===b?this.orientation="Bottom":"Left"===this.orientation&&0===b&&(this.orientation="Right"),this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgElement=getSVGElement(this.target),this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.valueMin=0,this.valueMax=0,this.sizeFactorMin=0,this.sizeFactorMax=1,this.valueLimitMin=this.valueMin,this.valueLimitMax=this.valueMax,this.value=0,this.svgElement){var c=this.svgElement.style.display;this.svgElement.style.display="block",this.bbox=this.svgElement.getBBox(),this.transform=this.svgElement.getAttribute("transform")||"",this.svgElement.style.display=c}ESAnimation.call(this)}ASize.prototype=Object.create(ESAnimation.prototype),ASize.prototype.constructor=ASize,ASize.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.value=a.Value,this.valueMin=parseFloat(a.ValueMin),this.valueMax=parseFloat(a.ValueMax),this.sizeFactorMin=parseFloat(a.SizeFactorMin),this.sizeFactorMax=parseFloat(a.SizeFactorMax),this.valueLimitMin=parseFloat(a.ValueLimitMin),this.valueLimitMax=parseFloat(a.ValueLimitMax)}catch(a){console.log("ASize doCondition failed: "+a)}},ASize.prototype.datachangeListenerMore=function(){try{this.doCondition(),this.startAnimate(),this.postFunction()}catch(a){console.log("datachangeListenerMore failed: "+a)}},ASize.prototype.startAnimate=function(){try{if(this.useQuality){var a={};a.stroke=this.qualityGood?this.strokeColorQualityGood:this.strokeColorQualityBad,a["stroke-width"]=this.qualityGood?this.SHAPE.strokeWidth:this.strokeWidthBad,this.setStyle(a)}}catch(a){console.log("startAnimate failed: "+a)}this.startAnimateMore()},ASize.prototype.startAnimateMore=function(){try{this.isNumber(this.value)&&this.setSize(this.value,this.valueMin,this.valueMax,this.valueLimitMin,this.valueLimitMax,this.sizeFactorMin,this.sizeFactorMax,this.orientation)}catch(a){console.log("startAnimateMore failed: "+a)}},ASize.prototype.initializeMore=function(){try{this.doCondition(),emosWS.animationData.stillInit=!1,this.doCondition(),this.startAnimate()}catch(a){console.log("initializeMore failed: "+a)}},ASize.prototype.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},ASize.prototype.setSize=function(a,b,c,d,e,f,g,h){try{if(this.shape){a<b?a=b:a>c&&(a=c);var i=(a-b)/(c-b)*(g-f),j=1,k=1,l=this.SHAPE.deltaX,m=this.SHAPE.deltaY,n=this.bbox;if(isNaN(i))return;switch(h){case"Top":j=this.SHAPE.scaleX,k=this.SHAPE.scaleY=i,m=this.SHAPE.deltaY=n.height*(1-i);break;case"Bottom":j=this.SHAPE.scaleX,k=this.SHAPE.scaleY=i;break;case"Right":j=this.SHAPE.scaleX=i,k=this.SHAPE.scaleY;break;case"Left":j=this.SHAPE.scaleX=i,k=this.SHAPE.scaleY,l=this.SHAPE.deltaX=n.width*(1-i)}this.shape.setAttribute("transform","                    translate("+(n.x+l)+","+(n.y+m)+")                     scale("+j+","+k+")                     translate("+-n.x+","+-n.y+")                     "+this.transform)}}catch(a){console.log("setSize failed: "+a)}},emosWS.ESSize=ASize;function APosition(a){if(this.conditionFunction=a.conditionFunction,this.postFunction=a.postFunction,this.orientation=a.PLACEHOLDER_ORIENTATION,this.orientationR=a.PLACEHOLDER_ORIENTATIONR,this.orientationFlag=a.PLACEHOLDER_ORIENTATIONFLAG,this.expansion=a.PLACEHOLDER_EXPANSION,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.useHide=a.PLACEHOLDER_HIDEIFVALUEEXCESSIVE,this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgElement=getSVGElement(this.target),this.svgTextElement=this.svgElement&&"text"===this.svgElement.tagName?this.svgElement:getSVGElement(this.target+".Text"),this.valueMin=0,this.valueMax=0,this.positionMin=0,this.positionMax=0,this.valueLimitMin=this.valueMin,this.valueLimitMax=this.valueMax,this.value=0,this.svgElement&&(this.transform=this.svgElement.getAttribute("transform")||"",this.maxSize=parseFloat(this.svgElement.getAttribute("Top"===this.orientation||"Bottom"===this.orientation?"height":"width")),this.x=parseFloat(this.svgElement.getAttribute("x")),this.y=parseFloat(this.svgElement.getAttribute("y"))),this.svgTextElement){this.textY=parseFloat(this.svgTextElement.getAttribute("y"));var b=this.svgTextElement.getElementsByTagName("tspan");void 0!==b[0]&&(this.svgTextTSpanElement=b[0],this.svgTextTSpanElement&&(this.textX=parseFloat(this.svgTextTSpanElement.getAttribute("x"))))}ESAnimation.call(this)}APosition.prototype=Object.create(ESAnimation.prototype),APosition.prototype=emosWS.fn.emosExtend(APosition.prototype,ASize.prototype),APosition.prototype.constructor=APosition,APosition.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.value=a.Value,this.valueMin=parseFloat(a.ValueMin),this.valueMax=parseFloat(a.ValueMax),this.positionMin=parseFloat(a.PositionMin),this.positionMax=parseFloat(a.PositionMax),this.valueLimitMin=parseFloat(a.ValueLimitMin),this.valueLimitMax=parseFloat(a.ValueLimitMax),this.Enabled=a.Enabled}catch(a){console.log("APosition doCondition failed: "+a)}},APosition.prototype.startAnimateMore=function(){try{if(this.Enabled)if(this.value<this.valueLimitMin||this.value>this.valueLimitMax)this.useHide&&this.svgElement.setAttribute("display","none");else{this.useHide&&this.svgElement.setAttribute("display","block");var a=this.valueMax-this.valueMin,b=this.positionMax-this.positionMin,c,d,e,f;"Top"===this.orientation?(c="y",d=this.y,e=this.textY,f=this.svgTextElement):(c="x",d=this.x,e=this.textX,f=this.svgTextTSpanElement);var g=this.positionMin+(this.value-this.valueMin)/a*b,h=d+g,i=e+g;if(["g","path"].indexOf(this.svgElement.tagName)>-1){var j=0,k=0;"x"===c?j=g:k=g,isNaN(j)||isNaN(k)||this.svgElement.setAttribute("transform","translate("+j+","+k+") "+this.transform)}else isNaN(h)||this.svgElement.setAttribute(c,h),this.svgTextElement&&(isNaN(i)||f.setAttribute(c,i))}}catch(a){console.log("startAnimateMore failed: "+a)}},emosWS.ESPosition=APosition;function ARotation(a){if(this.conditionFunction=a.conditionFunction,this.postFunction=a.postFunction,this.useHide=a.PLACEHOLDER_HIDEIFVALUEEXCESSIVE,this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgElement=getSVGElement(this.target),this.svgTextElement=this.svgElement&&"text"===this.svgElement.tagName?this.svgElement:getSVGElement(this.target+".Text"),this.valueX=0,this.valueXMin=0,this.valueXMax=0,this.positionXMin=0,this.positionXMax=0,this.valueX=0,this.valueYMin=0,this.valueYMax=0,this.positionYMin=0,this.positionYMax=0,this.rotation=0,this.rotationPosX=0,this.rotationPosY=0,this.enabled=!0,this.svgElement&&(this.x=parseFloat(this.svgElement.getAttribute("x")),this.y=parseFloat(this.svgElement.getAttribute("y"))),this.svgTextElement){this.textY=parseFloat(this.svgTextElement.getAttribute("y"));var b=this.svgTextElement.getElementsByTagName("tspan");void 0!==b[0]&&(this.svgTextTSpanElement=b[0],this.svgTextTSpanElement&&(this.textX=parseFloat(this.svgTextTSpanElement.getAttribute("x"))))}ESAnimation.call(this)}ARotation.prototype=Object.create(ESAnimation.prototype),ARotation.prototype=emosWS.fn.emosExtend(ARotation.prototype,ASize.prototype),ARotation.prototype.constructor=ARotation,ARotation.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.valueX=a.ValueX,this.valueXMin=parseFloat(a.ValueXMin),this.valueXMax=parseFloat(a.ValueXMax),this.positionXMin=parseFloat(a.PositionXMin),this.positionXMax=parseFloat(a.PositionXMax),this.valueY=a.ValueY,this.valueYMin=parseFloat(a.ValueYMin),this.valueYMax=parseFloat(a.ValueYMax),this.positionYMin=parseFloat(a.PositionYMin),this.positionYMax=parseFloat(a.PositionYMax),this.rotation=parseFloat(a.Rotation),this.rotationPosX=parseFloat(a.RotationPosX),this.rotationPosY=parseFloat(a.RotationPosY),this.enabled=a.Enabled}catch(a){console.log("ARotation doCondition failed: "+a)}},ARotation.prototype.startAnimateMore=function(){try{if(this.value<this.valueMin||this.value>this.valueMax)this.useHide&&this.svgElement.setAttribute("display","none");else{this.useHide&&this.svgElement.setAttribute("display","block");var a=this.valueXMax-this.valueXMin,b=this.positionXMax-this.positionXMin,c=this.valueYMax-this.valueYMin,d=this.positionYMax-this.positionYMin,e=this.positionXMin+(this.valueX-this.valueXMin)/a*b,f=this.x+e,g=this.textX+e,h=this.positionYMin+(this.valueY-this.valueYMin)/c*d,i=this.y+h,j=this.textY+h;if(["g","path"].indexOf(this.svgElement.tagName)>-1){var k=isNaN(e)?0:e,l=isNaN(h)?0:h,m=isNaN(this.rotation)?0:this.rotation,n=isNaN(this.rotationPosX)?this.x:this.rotationPosX,o=isNaN(this.rotationPosY)?this.y:this.rotationPosY;this.svgElement.setAttribute("transform","translate("+k+","+l+") rotate("+m+" "+n+","+o+")")}else{isNaN(f)||this.svgElement.setAttribute("x",f),isNaN(i)||this.svgElement.setAttribute("y",i),this.svgTextElement&&(isNaN(g)||this.svgTextTSpanElement.setAttribute("x",g),isNaN(j)||this.svgTextElement.setAttribute("y",j));var n=isNaN(this.rotationPosX)?this.x+e:this.rotationPosX+e,o=isNaN(this.rotationPosY)?this.y+h:this.rotationPosY+h;isNaN(this.rotation)||this.svgElement.setAttribute("transform","rotate("+this.rotation+" "+n+","+o+")")}}}catch(a){console.log("startAnimateMore failed: "+a)}},emosWS.ESRotation=ARotation;function AAlarm(a){this.conditionFunction=a.conditionFunction,this.AlarmGroup="",this.enabled=!0,this.enabledAck=!1,this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgElement=getSVGElement(this.target),this.svgElement&&(this.originalFillColor=this.svgElement.getAttribute("fill"),this.originalStrokeColor=this.svgElement.getAttribute("stroke")),this.newEnabled=a.PLACEHOLDER_NEW_ENABLED,this.newFillcolor=a.PLACEHOLDER_NEW_FILLCOLOR,this.newBlinking=a.PLACEHOLDER_NEW_BLINKING,this.newVisible=a.PLACEHOLDER_NEW_VISIBLE,this.newProperty={Enabled:this.newEnabled,Fillcolor:this.newFillcolor,Visible:this.newVisible,Blinking:this.newBlinking},this.ackEnabled=a.PLACEHOLDER_ACK_ENABLED,this.ackFillcolor=a.PLACEHOLDER_ACK_FILLCOLOR,this.ackBlinking=a.PLACEHOLDER_ACK_BLINKING,this.ackVisible=a.PLACEHOLDER_ACK_VISIBLE,this.ackProperty={Enabled:this.ackEnabled,Fillcolor:this.ackFillcolor,Visible:this.ackVisible,Blinking:this.ackBlinking},this.NOEnabled=a.PLACEHOLDER_NO_ENABLED,this.NOFillcolor=a.PLACEHOLDER_NO_FILLCOLOR,this.NOBlinking=a.PLACEHOLDER_NO_BLINKING,this.NOVisible=a.PLACEHOLDER_NO_VISIBLE,this.NOProperty={Enabled:this.NOEnabled,Fillcolor:this.NOFillcolor,Visible:this.NOVisible,Blinking:this.NOBlinking},this.fillcolorNoBlink=a.PLACEHOLDER_FILLCOLORNOBLINK,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.useHand=a.PLACEHOLDER_USEHAND,this.useStroke=a.PLACEHOLDER_USESTROKE,this.useHide=a.PLACEHOLDER_USEHIDE,this.useVisible=a.useVisible,this.fillColor,this.swapState=0,this.interval=0,this.stateMap={0:this.newProperty,1:this.ackProperty,2:this.NOProperty},this.currentProperty=this.stateMap[2],this.stateMap={0:this.newProperty,1:this.ackProperty,2:this.newProperty,3:this.ackProperty,4:this.newProperty,5:this.ackProperty,6:this.NOProperty,7:this.NOProperty},this.currentProperty=this.stateMap[0],this.alarmStateList={},this.alarmState=null,this.alarmValue=null,this.trigger=function(){this.animate()}.bind(this),ESAnimation.call(this)}AAlarm.prototype=Object.create(ESAnimation.prototype),AAlarm.prototype=emosWS.fn.emosExtend(AAlarm.prototype,AFaultWarning.prototype),AAlarm.prototype.constructor=AAlarm,AAlarm.prototype.toString=function(){return"AlarmGroup\n"+this.getAlarmGroupString()+"\nenabled = "+this.enabled+"\nenabledAck = "+this.enabledAck+"\n\nnewEnabled = "+this.newEnabled+"\nnewFillcolor = "+this.newFillcolor+"\nnewVisible = "+this.newVisible+"\nnewBlinking = "+this.newBlinking+"\n\nackEnabled = "+this.ackEnabled+"\nackFillcolor = "+this.ackFillcolor+"\nackVisible = "+this.ackVisible+"\nackBlinking = "+this.ackBlinking+"\n\nNOEnabled = "+this.NOEnabled+"\nNOFillcolor = "+this.NOFillcolor+"\nNOVisible = "+this.NOVisible+"\nNOBlinking = "+this.NOBlinking+"\n\nfillcolorNoBlink = "+this.fillcolorNoBlink+"\nuseQuality = "+this.useQuality+"\nstrokeColorQualityGood = "+this.strokeColorQualityGood+"\nstrokeColorQualityBad = "+this.strokeColorQualityBad+"\nuseHand = "+this.useHand+"\nuseStroke = "+this.useStroke+"\nuseHide = "+this.useHide+"\nuseVisible = "+this.useVisible+"\nfillcolorNoBlink = "+this.fillcolorNoBlink+"\n"},emosWS.ESAlarm=AAlarm;function AAlarms(a){this.alarmGroups=a.PLACEHOLDER_ALARMGROUPS.split("; "),this.trimAlarmGroups(),AAlarm.call(this,a)}AAlarms.prototype=Object.create(AAlarm.prototype),AAlarms.prototype=emosWS.fn.emosExtend(AAlarms.prototype,AFaultsWarnings.prototype),AAlarms.prototype.constructor=AAlarms,emosWS.ESAlarms=AAlarms;function AAlarmPropertyMulti(a){this.configuration=a,this.conditionFunction=a.conditionFunction,this.conditionFunction=a.conditionFunction,this.fillcolorNoBlink=a.PLACEHOLDER_FILLCOLORNOBLINK,this.useElse=a.PLACEHOLDER_SWAP_USEELSE,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgElement=getSVGElement(this.target),this.svgTextElement=getSVGElement(this.target+".Text"),this.svgElement&&(this.originalFillColor=this.svgElement.getAttribute("fill"),this.originalStrokeColor=this.svgElement.getAttribute("stroke")),this.AlarmGroup="",this.enabled=!0,this.alarmActionList=[],this.alarmElseAction={},this.initAlarmActionList(),this.currentProperty={Enabled:!0,Fillcolor:this.originalFillColor,Visible:!0,Blinking:!1,useVisible:!0},this.swapState=0,this.interval=0,this.useStroke=!1,this.useHand=!1,this.useHide=!1,this.stateMap=[],this.alarmState=0,this.trigger=function(){this.animate()}.bind(this),ESAnimation.call(this)}AAlarmPropertyMulti.prototype=Object.create(ESAnimation.prototype),AAlarmPropertyMulti.prototype=emosWS.fn.emosExtend(AAlarmPropertyMulti.prototype,AFaultWarning.prototype),AAlarmPropertyMulti.prototype.constructor=AAlarmPropertyMulti,AAlarmPropertyMulti.prototype.initAlarmActionList=function(){for(var a=1;a<17;a++){var b={};-1!==this.configuration["PLACEHOLDER_P"+a+"_CLASS"]&&(b={class:this.configuration["PLACEHOLDER_P"+a+"_CLASS"],prioFrom:this.configuration["PLACEHOLDER_P"+a+"_PRIOFROM"],prioTo:this.configuration["PLACEHOLDER_P"+a+"_PRIOTO"],useAck:this.configuration["PLACEHOLDER_P"+a+"_USEACK"],useBlink:this.configuration["PLACEHOLDER_P"+a+"_USEBLINK"],useNew:this.configuration["PLACEHOLDER_P"+a+"_USENEW"],fillColor:this.configuration["PLACEHOLDER_P"+a+"_FILLCOLOR"],visibility:this.configuration["PLACEHOLDER_P"+a+"_VISIBILITY"]},this.alarmActionList.push(b))}this.alarmElseAction={useBlink:this.configuration.PLACEHOLDER_USEBLINKELSE,fillColor:this.configuration.PLACEHOLDER_FILLCOLORELSE,visibility:this.configuration.PLACEHOLDER_VISIBILITYELSE}},AAlarmPropertyMulti.prototype.updateAlarmStateList=function(a){try{if(void 0!==a&&void 0!==a.classStateRec){for(var b=this.useElse?this.alarmElseAction:null,c=0;c<this.alarmActionList.length;c++){var d=this.alarmActionList[c];if(d.useNew&&"1"===a.classStateRec.ClassStateNew.charAt(31-d.class)||d.useAck&&"1"===a.classStateRec.ClassStateAck.charAt(31-d.class)){var e=a.classStateRec.prioFrom[d.class];if(!(a.classStateRec.prioTo[d.class]<d.prioFrom||d.prioTo<e)){b=d;break}}}this.currentProperty=b?{Enabled:!0,Fillcolor:b.fillColor,Visible:b.visibility,Blinking:b.useBlink,useVisible:!0}:{Enabled:!0,Fillcolor:this.originalFillColor,Visible:!0,Blinking:!1,useVisible:!0}}}catch(a){console.log("updateAlarmStateList failed: "+a)}},AAlarmPropertyMulti.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.AlarmGroup=a.AlarmGroup,this.enabled=a.Enabled}catch(a){console.log("doCondition failed: "+a)}},emosWS.ESAlarmPropertyMulti=AAlarmPropertyMulti;function ADynamicText(a){this.conditionFunction=a.conditionFunction,this.Text="",this.Enabled=!0,this.useQuality=a.PLACEHOLDER_SWAP_USEQUALITY,this.strokeColorQualityGood=a.PLACEHOLDER_STROKECOLORQUALITYGOOD,this.strokeColorQualityBad=a.PLACEHOLDER_STROKECOLORQUALITYBAD,this.target=a.STDPLACEHOLDER_SHAPENAME,this.qualityGood=!1,this.prefix=a.PREFIX||"",this.suffix=a.SUFFIX||"",ESAnimation.call(this)}ADynamicText.prototype=Object.create(ESAnimation.prototype),ADynamicText.prototype.constructor=ADynamicText,ADynamicText.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();a.Text+="",this.Text=this.prefix+a.Text+this.suffix,this.Enabled=a.Enabled&&"null"!==a.Text}catch(a){console.log("DynamicText doCondition failed: "+a)}},ADynamicText.prototype.datachangeListenerMore=function(){try{this.doCondition(),this.startAnimate()}catch(a){console.log("datachangeListenerMore failed: "+a)}},ADynamicText.prototype.startAnimate=function(){try{if(this.Enabled){var a={};this.useQuality&&this.qualityGood&&(a.stroke=this.qualityGood?this.strokeColorQualityGood:this.strokeColorQualityBad),this.setStyle(a),this.setText(this.Text)}}catch(a){console.log("Dynamictext startAnimate failed: "+a)}},ADynamicText.prototype.initializeMore=function(){try{this.doCondition(),emosWS.animationData.stillInit=!1,this.doCondition(),this.startAnimate()}catch(a){console.log("initializeMore failed: "+a)}},ADynamicText.prototype.setText=function(a){this.shapeTextContent&&this.SHAPE.setText(a)},window.ADynamicText=ADynamicText,emosWS.ESDynamicText=ADynamicText;function AClickWrite(a){this.conditionFunction=a.conditionFunction,this.function=a.PLACEHOLDER_FUNCTION,this.useStroke=a.PLACEHOLDER_USESTROKE,this.useHand=a.PLACEHOLDER_USESHAND||a.PLACEHOLDER_USEHAND,this.useHide=a.PLACEHOLDER_USESHIDE||a.PLACEHOLDER_USEHIDE,this.target=a.STDPLACEHOLDER_SHAPENAME,this.Tag="",this.Value="",this.Enabled=!0,this.onClickNotInitialized=!0,this.setValue=this.setValue.bind(this),this.callback={datachangeListener:this.setValue},ESAnimation.call(this)}AClickWrite.prototype=Object.create(ESAnimation.prototype),AClickWrite.prototype.constructor=AClickWrite,AClickWrite.prototype.adviseData=function(){},AClickWrite.prototype.doCondition=function(){try{var a=this.conditionFunction();this.Tag=a.Tag,this.Value=String(a.Value),this.Enabled=a.Enabled}catch(a){console.log("doCondition failed: "+a)}},AClickWrite.prototype.datachangeListenerMore=function(){try{this.doCondition(),this.startAnimate()}catch(a){console.log("datachangeListenerMore failed: "+a)}},AClickWrite.prototype.setValue=function(){if(this.Enabled){var a=emosWS.tagDestination[this.Tag+".IO"];a?(a.unregister(this.callback.datachangeListener),a.setValue(this.Value)):(emosWS.animationData.stillInit=!0,emosWS.animationData.callback=this.callback,emosWS.animationData.param=null,emosWS.getTagValue(this.Tag),emosWS.animationData.stillInit=!1)}},AClickWrite.prototype.onClick=function(){this.doCondition(),this.setValue()},AClickWrite.prototype.handleOnClick=function(){setEvent(this.target,"click",function(a){this.onClick(a)}.bind(this),this.useHand?"pointer":"initial")},AClickWrite.prototype.initOnClick=function(){this.onClickNotInitialized&&(this.handleOnClick(),this.useStroke&&(setEvent(this.target,"mouseover",function(){setStyle(this.target,{"stroke-width":4})}.bind(this),this.useHand?"pointer":"default"),setEvent(this.target,"mouseout",function(){setStyle(this.target,{"stroke-width":1})}.bind(this),this.useHand?"pointer":"default")),this.onClickNotInitialized=!1)},AClickWrite.prototype.startAnimate=function(){try{var a=this;a.Enabled?a.useHide&&(setStyle(this.target,{display:"block"}),setStyle(this.target+".Text",{display:"block"})):(a.useHide&&(setStyle(this.target,{display:"none"}),setStyle(this.target+".Text",{display:"none"})),this.setClicked=!1)}catch(a){console.log("AClickWrite startAnimate failed: "+a)}},AClickWrite.prototype.initializeMore=function(){try{this.onClickNotInitialized&&(this.doCondition(),emosWS.animationData.stillInit=!1,this.doCondition(),this.adviseData(),this.initOnClick(),null!==this.Enable&&this.startAnimate())}catch(a){console.log("initializeMore failed: "+a)}},emosWS.ESClickWrite=AClickWrite;function AClickWriteBit(a){this.force=a.PLACEHOLDER_FORCE,this.bitMode=a.PLACEHOLDER_BITMODE,this.BitNr="",this.tagValue=null,AClickWrite.call(this,a)}AClickWriteBit.prototype=Object.create(AClickWrite.prototype),AClickWriteBit.prototype.constructor=AClickWriteBit,AClickWriteBit.prototype.adviseData=function(){try{var a=this;emosWS.advise(this.Tag,function(b){a.tagValue=parseInt(b.value)},"")}catch(a){console.log("adviseData failed: "+a)}},AClickWriteBit.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.Tag=a.Tag,this.BitNr=a.BitNr,this.Enabled=a.Enabled}catch(a){console.log("doCondition failed: "+a)}},AClickWriteBit.prototype.onClick=function(){try{if(!this.Enabled)return;var a,b=1<<this.BitNr;switch(this.bitMode){case"Set":a=this.tagValue|b;break;case"Reset":a=this.tagValue&~b;break;case"Toggle":a=this.tagValue^b}emosWS.poke(this.Tag,a),console.log("setTag "+this.Tag+" = "+a)}catch(a){console.log("AClickWriteBit onClick failed: "+a)}},emosWS.ESClickWriteBit=AClickWriteBit;function AClickSetESVariable(a){var b=a.PLACEHOLDER_VARIABLE;this.variableName=null,this.ESVariable=null,"string"==typeof b?(this.variableName=b.split(".")[0],this.ESVariable=window[this.variableName]):b instanceof GlobalVariable&&(this.ESVariable=b),AClickWrite.call(this,a)}AClickSetESVariable.prototype=Object.create(AClickWrite.prototype),AClickSetESVariable.prototype.constructor=AClickSetESVariable,AClickSetESVariable.prototype.doCondition=function(){try{var a=emosWS.animationData.stillInit?this.initConditionFunction():this.conditionFunction();this.Value=a.Value,this.Enabled=a.Enabled}catch(a){console.log("doCondition failed: "+a)}},AClickSetESVariable.prototype.handleOnClick=function(){this.SHAPE.addJob(function(a){this.onClick(a)}.bind(this),this.useHand)},AClickSetESVariable.prototype.onClick=function(a){try{var b=this.conditionFunction();this.ESVariable instanceof GlobalVariable?emosWS.clickData.event===a&&emosWS.clickData.param===this.ESVariable||b.Enabled&&(emosWS.clickData.event=a,emosWS.clickData.param=this.ESVariable,this.ESVariable.value=b.Value):this.ESVariable=b.Value}catch(a){console.error("AClickSetESVariable onClick failed: "+a)}},emosWS.ESClickSetESVariable=AClickSetESVariable;function AClickSetJSVariable(a){new AClickSetESVariable({conditionFunction:function(){var b=a.conditionFunction();return{Value:b.Value,Enabled:b.Value}},PLACEHOLDER_VARIABLE:a.PLACEHOLDER_VARIABLE,PLACEHOLDER_TYPE:a.PLACEHOLDER_TYPE,PLACEHOLDER_USESTROKE:a.PLACEHOLDER_USESTROKE,PLACEHOLDER_USEHAND:a.PLACEHOLDER_USEHAND,PLACEHOLDER_USEHIDE:a.PLACEHOLDER_USEHIDE,STDPLACEHOLDER_SHAPENAME:a.STDPLACEHOLDER_SHAPENAME})}emosWS.ESClickSetJSVariable=AClickSetJSVariable;var ADiagnosisCommon=function(){function a(a){return a.substr(a.indexOf("-")+1)}return{getObjectType:a}}();window.ADiagnosisCommon=ADiagnosisCommon;var AtimerTypes={Second:0,Minute:1,SiemensDate:3,SiemensTimeOfDay:4,SiemensTime:5,SiemensS5Time:6,SiemensDateAndTime:7};function AAlarmClient(a,b,c,d){this.parent=a,this.data=b,this.alarmGroup=c,this.tab=d,this.table=null,this.init()}AAlarmClient.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID();$("<div class='DiagnosisAlarmClient' id='"+a+"'><table class='DiagnosisAlarmTable' id='"+d+"'><col width='80%'><col width='20%'><tr><th id='"+b+"'> Text</th><th id='"+c+"'> Duration</th></tr></table></div>").appendTo(this.parent),this.table=document.getElementById(d),this.table.id=d;var e=document.getElementById(b),f=document.getElementById(c);this.getHeaderText("T04_Text",e),this.getHeaderText("T04_Duration",f),emosWS.sendAdviseAlarmText(this.alarmGroup,emosWS.getLanguage(),this.datachangeListener.bind(this),""),emosWS.addEventListener("language",this.onLanguage.bind(this))}catch(a){console.log("AlarmClient init failed: "+a)}},AAlarmClient.prototype.onLanguage=function(){this.clearTable()},AAlarmClient.prototype.clearTable=function(){for(var a=1;a<this.table.rows.length;a++)this.table.deleteRow(a)},AAlarmClient.prototype.getHeaderText=function(a,b){emosWS.sendAdviseText(a,"name",function(a,b){""!==a.value&&(b.textContent=a.value)},b)},AAlarmClient.prototype.getStyleClass=function(a){return"1"===a.classID?"alarmTable alarm":"alarmTable warning"},AAlarmClient.prototype.getTabStyleClass=function(a){return"1"===a.classID?"DiagnosisPageTextAlarm":"DiagnosisPageTextWarning"},AAlarmClient.prototype.datachangeListener=function(a){try{"alarmText"===a.type&&"internal"!==a.tagname?("3RTN"===a.alarmType?this.updateTable(a):this.addTableRow(a),1===this.table.rows.length&&(this.tab.className="DiagnosisPageTextNormal"),console.log("updateTable Table "+this.table.id+" / rows: "+this.table.rows.length)):a.type}catch(a){console.log("AlarmClient datachangeListener failed: "+a)}},AAlarmClient.prototype.updateTable=function(a){for(var b=1;b<this.table.rows.length;b++){var c=this.table.rows[b];c.msg.alarmGroup===a.alarmGroup&&"1NEW"===c.msg.alarmType&&this.table.deleteRow(b)}},AAlarmClient.prototype.addTableRow=function(a){var b=this.getLocalTime(a.date,a.time);a.date=b[0],a.time=b[1],a.dateTime=a.date+" "+a.time,a.beginTime=this.convertToTimestamp(a.date,a.time);var c=this.table.insertRow(1);c.className=this.getStyleClass(a),this.tab.className=this.getTabStyleClass(a);var d=c.insertCell(0),e=c.insertCell(1);d.textContent=a.alarmText,e.textContent=this.convertToDate(a.beginTime),c.msg=a},AAlarmClient.prototype.getLocalTime=function(a,b){try{if(""===a)return["",""];var c=a.split("."),d=b.split(":"),e=d[2].split(","),f=new Date(c[1]+"/"+c[0]+"/"+c[2]+" "+d[0]+":"+d[1]+":"+e[0]+" UTC"),g=f.getDate();g=g<10?"0"+g:g;var h=f.getMonth()+1;h=h<10?"0"+h:h;var i=f.getHours();i=i<10?"0"+i:i;var j=f.getMinutes();j=j<10?"0"+j:j;var k=f.getSeconds();k=k<10?"0"+k:k;return[f.getFullYear()+"-"+h+"-"+g,i+":"+j+":"+k+","+e[1]]}catch(a){console.log("getLocalTime() failed: "+a)}},AAlarmClient.prototype.convertToDate=function(a){try{if(""===a)return"";var b=(new Date).getTime(),c=parseInt((b-a)/1e3),d=parseInt(c/86400),e=parseInt(c/3600)%24,f=parseInt(c/60)%60,g=c%60;return d+":"+(e<10?"0"+e:e)+":"+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g)}catch(a){console.log("convertToDate() failed: "+a)}},AAlarmClient.prototype.convertToTimestamp=function(a,b){try{if(""===a)return"";var c=a.split("-"),d=b.split(":"),e=d[2].split(",");return new Date(c[1]+"/"+c[2]+"/"+c[0]+" "+d[0]+":"+d[1]+":"+e[0]).getTime()}catch(a){console.log("convertToTime() failed: "+a)}};var AGeneralElement=function(a,b){var c=getElementGlobalID();$("<div class='DiagnosisGerneralElement' id='"+c+"'><svg width='100%' height='20'><rect width='100%' height='20' style='fill:white;stroke-width:1;stroke:grey' /><text x='5' y='15' fill='black'>"+b.Text+"</text></svg></div>").appendTo(a)};function ADiagnosisElement(a){this.data=a.data,this.writable=a.writable,this.panel=null,this.visibleRight=parseInt(this.data.VisibleAtRight),this.visibleOPC=this.data.VisibleOPCID,this.userRight=parseInt(this.data.UserRight),this.UNKOWN="???",this.visible=!0,this.opcvisible=!0,this.hasPaintShopRight=!0,this.initialize()}ADiagnosisElement.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},ADiagnosisElement.prototype.updateView=function(){try{this.visibleRight&&(this.hasPaintShopRight=emosWS.login.au.hasPaintShopRight(this.visibleRight),this.setVisibility()),this.writable&&this.updateWrite()}catch(a){console.log(this.constructor.name+": updateView failed: "+a)}},ADiagnosisElement.prototype.initialize=function(){this.init(),this.afterInit()},ADiagnosisElement.prototype.init=function(){},ADiagnosisElement.prototype.updateWrite=function(){},ADiagnosisElement.prototype.unitListener=function(){},ADiagnosisElement.prototype.getValue=function(a){try{return a}catch(b){return console.error("[ADiagnosisElement getValue] : "+b),a}},ADiagnosisElement.prototype.adviseProperty=function(a,b,c){emosWS.advise(a,function(a,c){try{if(a.value){var d=a.value,e=this.data;e.Precision=d.disp_prec||e.Precision,d.met_baseunit!==this.UNKOWN&&(e.UnitMetric=d.met_baseunit||e.UnitMetric),d.imp_baseunit!==this.UNKOWN&&(e.UnitImperial=d.imp_baseunit||e.UnitImperial),d.loc_baseunit!==this.UNKOWN&&(e.UnitLocale=d.loc_baseunit||e.UnitLocale),e.FactorMetric=d.met_factor||e.FactorMetric,e.FactorImperial=d.imp_factor||e.FactorImperial,e.FactorLocale=d.loc_factor||e.FactorImperial,e.FactorPLC=d.plc_factor,e.TextKey=d.textkey,e.ByteInputMin&&(e.ByteInputMin=d.input_min||e.ByteInputMin),e.ByteInputMax&&(e.ByteInputMax=d.input_max||e.ByteInputMax),e.IntInputMin&&(e.IntInputMin=d.input_min||e.IntInputMin),e.IntInputMax&&(e.IntInputMax=d.input_max||e.IntInputMax),e.RealInputMin&&(e.RealInputMin=d.input_min||e.RealInputMin),e.RealInputMax&&(e.RealInputMax=d.input_max||e.RealInputMax),b(a,c)}}catch(a){console.error("[ADiagnosisElement adviseProperty callback] : "+a)}}.bind(this),c,emosWS.tagType.Property)},ADiagnosisElement.prototype.afterInit=function(){this.updateView(),isNaN(this.userRight)&&isNaN(this.visibleRight)||emosWS.addEventListener("UserRight",this.updateView.bind(this)),this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&this.parseVisibilityOPCTags(this.data.VisibleOPCID,function(a){this.opcvisible=GetAsBoolean(a.value),this.setVisibility()}.bind(this)),emosWS.addEventListener("unit",function(a){this.unit=a,this.unitListener(a)}.bind(this))},ADiagnosisElement.prototype.parseVisibilityOPCTags=function(s,callback){[[" & "," && "],[" | "," || "],["NOT ","! "]].forEach(function(a){s=s.split(a[0]).join(a[1])});var tagMap={};s.split(/[ &|!\(\)]/).forEach(function(a){""!==a&&(tagMap[a]=null)});var parseValues=function(itag,ivalue){tagMap[itag]=ivalue;for(var tag in tagMap)if(null===tagMap[tag])return;var parseString=s;for(var tag in tagMap)parseString=parseString.replace(tag,tagMap[tag]);var value=!0;try{value=eval(parseString),callback({value:value})}catch(a){}};for(var tag in tagMap)emosWS.advise(this.plc+"."+tag,function(a,b){parseValues(b,GetAsBoolean(a.value))},tag,emosWS.tagType.IO)},ADiagnosisElement.prototype.setVisibility=function(){this.visible=this.opcvisible&&this.hasPaintShopRight,this.panel.get(0).style.visibility=this.visible?"visible":"hidden"};function ADiagnosisText(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisText"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisText"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLong"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.dataText=""===this.data.Text?".":this.data.Text,this.plctag="",this.text="",ADiagnosisElement.call(this,{data:b})}ADiagnosisText.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisText.prototype.constructor=ADiagnosisText,ADiagnosisText.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();void 0!==this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&(this.plctag=""===this.data.VisibleOPCID?"":this.plc+"."+this.data.OPCID);var c=this.positionClass[this.data.Position];(this.panel=$("<div class='"+c.css+"' id='"+a+"'><p id='"+b+"'>"+this.dataText+"</p></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b),""!==this.plctag&&emosWS.advise(this.plctag,function(a){try{var b=GetAsBoolean(a.value);this.text.style.visibility=b?"visible":"hidden"}catch(a){console.log("DiagnosisText datachangeListener failed: "+a)}}.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisText init failed: "+a)}},emosWS.ADiagnosisText=ADiagnosisText;function APageControl(a,b,c){this.parent=a,this.data=b,this.diagnosisWindow=c,this.init()}APageControl.prototype.init=function(){try{var a=getElementGlobalID(),b=$("<div class='DiagnosisPageControl' id='"+a+"'><ul></ul></div>");b.appendTo(this.parent);for(var c=b.tabs(),d=c.find("ul"),e=0,f=sortHashArray(this.data),g=f.length-1;g>-1;g--){var h=f[g],i=this.data[h];if("object"==typeof i){e++;var j=getElementGlobalID(),k=ADiagnosisCommon.getObjectType(h),l="";switch(k){case"AddPageTab":l=i.Text;break;default:l=k,i.TextID="Messages"}var m=getElementGlobalID();$("<li><a href='#"+j+"'><span id='"+m+"'>"+l+"</span></a></li>").prependTo(d);var n=$("<div class='DiagnosisPageBlank' id='"+j+"'></div>");n.appendTo(c);var o=document.getElementById(m);emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+i.TextID,"name",function(a,b){""!==a.value&&(b.textContent=a.value)},o),i.Visible&&"2"!==i.Visible||this.diagnosisWindow.appendPage(n,i,o,parseInt(i.VisibleAtRight||"0"),e,c)}}c.tabs("refresh"),c.tabs({active:0})}catch(a){console.log("PageControl failed: "+a)}},emosWS.PageControl=APageControl;var AcolorList={G:"#00FF00",R:"red",X:"black",B:"blue",O:"lightgrey",P:"pink",Y:"yellow"};function ATopTextLED(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={M:"DiagnosisTopTextLEDMIDDLE",L:"DiagnosisTopTextLEDLEFT",R:"DiagnosisTopTextLEDRIGHT"},this.plctag=this.plc+"."+this.data.OPCID,this.led=this.border=this.text=null,ADiagnosisElement.call(this,{data:b})}ATopTextLED.prototype=Object.create(ADiagnosisElement.prototype),ATopTextLED.prototype.constructor=ATopTextLED,ATopTextLED.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID();(this.panel=$("<div class='"+this.positionClass[this.data.Position]+"' id='"+a+"'><svg width='100%' height='20'><rect id='"+c+"' width='100%' height='20' style='fill:white;stroke-width:1;stroke:grey' /><text id='"+d+"' x='5' y='15' fill='black'>"+this.data.Text+"</text><circle id='"+b+"' cx='93%' cy='10' r='7' stroke='black' stroke-width='1' fill='orange'/></svg></div>")).appendTo(this.parent),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("TopTextLED init failed: "+a)}},ATopTextLED.prototype.datachangeListener=function(a){try{var b=GetAsBoolean(a.value),c=AcolorList[b?this.data.OnLED:this.data.OffLED];this.led.setAttribute("fill",c)}catch(a){console.log("TopTextLED datachangeListener failed: "+a)}},emosWS.ATopTextLED=ATopTextLED;function ADiagnosisSetpointRampBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"DiagnosisBar"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"DiagnosisBar"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"DiagnosisBar"}},this.min=0,this.max=100,this.ymin=2,this.percent0=80,this.plctag=this.plc+"."+this.data.OPCID,this.plctagRamp=this.plc+"."+this.data.OPCRampID,this.visibleOPC=this.plc+"."+this.data.OPCRampVisibleID,this.opcvisible=!0,this.parentDiv=this.numberValue=this.bar=this.lineValue=this.lineValue2=this.lineValueR=this.lineValueR2=this.text=this.number=this.numberR=this.unitText=null,this.unit=emosWS.getUnit(),this.panel=null,this.init()}ADiagnosisSetpointRampBar.prototype.getBarValue=function(a){return a<this.min?a=this.min:a>this.max&&(a=this.max),this.ymin+(100-(a-this.min)/(this.max-this.min)*100)*this.percent0/100+"%"},ADiagnosisSetpointRampBar.prototype.getBarDegreeText=function(a){return"- "+(this.min+(this.max-this.min)*a/100)+this.unitText},ADiagnosisSetpointRampBar.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},ADiagnosisSetpointRampBar.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m=getElementGlobalID(),n=getElementGlobalID(),o=getElementGlobalID(),p=getElementGlobalID(),q=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var r=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol();(this.panel=$("<div class='"+r.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisRampBarTextSVG'><text id='"+e+"' x='50%' y='24px' fill='black' text-anchor='middle' font-weight='bold'>"+this.data.Text+"</text></svg><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisRampBarSVG' id='"+m+"'><rect class='DiagnosisRampBar' id='"+o+"' x='58%' y='"+this.ymin+"%' width='40%' height='"+this.percent0+"%' /><line id='"+p+"' x1='58.5%' y1='15%' x2='97.5%' y2='15%' style='stroke-width:5;stroke:#00FF00'/><line id='"+q+"' x1='58%' y1='15%' x2='98%' y2='15%' style='stroke-width:1;stroke:black'/><rect x='8%' width='90%' height='15' y='87%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+n+"' x='50%' y='93%' text-anchor='right' fill='orange'>"+this.numberValue+"</text></svg><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisRampBarSVG' id='"+b+"'><rect class='DiagnosisRampBar' id='"+d+"' x='1%' y='"+this.ymin+"%' width='40%' height='"+this.percent0+"%' /><line id='"+f+"' x1='1.5%' y1='15%' x2='40.5%' y2='15%' style='stroke-width:5;stroke:yellow'/><line id='"+g+"' x1='1%' y1='15%' x2='41%' y2='15%' style='stroke-width:1;stroke:black'/><rect x='1%' width='90%' height='15' y='87%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+c+"' x='3%' y='93%' text-anchor='left' fill='orange'>"+this.numberValue+"</text><text class='DiagnosisBarDegreeText' id='"+h+"' x='40%' y='83.5%'>"+this.getBarDegreeText(0)+"</text><text class='DiagnosisBarDegreeText' id='"+i+"' x='40%' y='63.5%'>"+this.getBarDegreeText(25)+"</text><text class='DiagnosisBarDegreeText' id='"+j+"' x='40%' y='43.5%'>"+this.getBarDegreeText(50)+"</text><text class='DiagnosisBarDegreeText' id='"+k+"' x='40%' y='23.5%'>"+this.getBarDegreeText(75)+"</text><text class='DiagnosisBarDegreeText' id='"+l+"' x='40%' y='3.5%'>"+this.getBarDegreeText(100)+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(c),this.numberR=document.getElementById(n),this.text=document.getElementById(e),this.bar=document.getElementById(d),this.lineValue=document.getElementById(f),this.lineValue2=document.getElementById(g),this.lineValueR=document.getElementById(p),this.lineValueR2=document.getElementById(q),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctagRamp,this.datachangeRampListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),emosWS.advise(this.visibleOPC,function(a){this.opcvisible=GetAsBoolean(a.value),this.setVisibility()}.bind(this),"",emosWS.tagType.IO)}catch(a){console.log("DiagnosisBar init failed: "+a)}},ADiagnosisSetpointRampBar.prototype.setVisibility=function(){this.panel.get(0).style.display=this.opcvisible?"block":"none"},ADiagnosisSetpointRampBar.prototype.datachangeListener=function(a){try{this.numberValue=GetAsInteger(a.value),this.number.setAttribute("fill","black"),this.number.textContent=this.numberValue+this.getUnitSymbol();var b=this.getBarValue(this.numberValue);this.lineValue.setAttribute("y1",b),this.lineValue.setAttribute("y2",b),this.lineValue2.setAttribute("y1",b),this.lineValue2.setAttribute("y2",b)}catch(a){console.log("DiagnosisSetpointRampBar datachangeListener failed: "+a)}},ADiagnosisSetpointRampBar.prototype.datachangeRampListener=function(a){try{var b=GetAsInteger(a.value);this.numberR.setAttribute("fill","black"),this.numberR.textContent=b+this.getUnitSymbol();var c=this.getBarValue(b);this.lineValueR.setAttribute("y1",c),this.lineValueR.setAttribute("y2",c),this.lineValueR2.setAttribute("y1",c),this.lineValueR2.setAttribute("y2",c)}catch(a){console.log("DiagnosisSetpointRampBar datachangeRampListener failed: "+a)}},emosWS.ADiagnosisSetpointRampBar=ADiagnosisSetpointRampBar;function ADiagnosisSetpointBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"DiagnosisBar"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"DiagnosisBar"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"DiagnosisBar"}},this.min=0,this.max=100,this.ymin=15,this.percent0=67,this.plctag=this.plc+"."+this.data.OPCID,this.parentDiv=this.numberValue=this.bar=this.lineValue=this.lineValue2=this.text=this.number=this.unitText=null,this.unit=emosWS.getUnit(),this.init()}ADiagnosisSetpointBar.prototype.getBarValue=function(){this.numberValue<this.min?this.numberValue=this.min:this.numberValue>this.max&&(this.numberValue=this.max);var a=this.ymin+(100-(this.numberValue-this.min)/(this.max-this.min)*100)*this.percent0/100+"%";return console.log("plctag="+this.plctag+" / bar value % = "+a),a},ADiagnosisSetpointBar.prototype.getBarDegreeText=function(a){return"- "+(this.min+(this.max-this.min)*a/100)+this.unitText},ADiagnosisSetpointBar.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},ADiagnosisSetpointBar.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var l=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol();$("<div class='"+l.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisBarSVG'><text id='"+d+"' x='50%' y='10%' fill='black' text-anchor='middle' font-weight='bold'>"+this.data.Text+"</text><rect id='"+c+"' x='40%' y='"+this.ymin+"%' width='20%' height='"+this.percent0+"%' style='fill:white;stroke-width:1;stroke:black' /><line id='"+e+"' x1='40.5%' y1='15%' x2='59.5%' y2='15%' style='stroke-width:5;stroke:yellow'/><line id='"+f+"' x1='40%' y1='15%' x2='60%' y2='15%' style='stroke-width:1;stroke:black'/><rect x='20%' width='60%' height='15' y='87%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+b+"' x='50%' y='92%' text-anchor='middle' fill='orange'>"+this.numberValue+"</text><text class='DiagnosisBarDegreeText' id='"+g+"' x='60%' y='83.5%'>"+this.getBarDegreeText(0)+"</text><text class='DiagnosisBarDegreeText' id='"+h+"' x='60%' y='66.75%'>"+this.getBarDegreeText(25)+"</text><text class='DiagnosisBarDegreeText' id='"+i+"' x='60%' y='50%'>"+this.getBarDegreeText(50)+"</text><text class='DiagnosisBarDegreeText' id='"+j+"' x='60%' y='33.25%'>"+this.getBarDegreeText(75)+"</text><text class='DiagnosisBarDegreeText' id='"+k+"' x='60%' y='16.5%'>"+this.getBarDegreeText(100)+"</text></svg></div>").appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.bar=document.getElementById(c),this.lineValue=document.getElementById(e),this.lineValue2=document.getElementById(f),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisBar init failed: "+a)}},ADiagnosisSetpointBar.prototype.datachangeListener=function(a){try{this.numberValue=GetAsInteger(a.value),this.number.setAttribute("fill","black"),this.number.textContent=this.numberValue+this.getUnitSymbol();var b=this.getBarValue();this.lineValue.setAttribute("y1",b),this.lineValue.setAttribute("y2",b),this.lineValue2.setAttribute("y1",b),this.lineValue2.setAttribute("y2",b)}catch(a){console.log("TopTextLED datachangeListener failed: "+a)}},emosWS.ADiagnosisSetpointBar=ADiagnosisSetpointBar;function ADiagnosisBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"DiagnosisBar"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"DiagnosisBar"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"DiagnosisBar"}},this.min=0,this.max=100,this.percent0=67,this.plctag=this.plc+"."+this.data.OPCID,this.parentDiv=this.numberValue=this.bar=this.barValue=this.text=this.number=this.unitText=null,this.unit=emosWS.getUnit(),this.init()}ADiagnosisBar.prototype.getBarValue=function(){return this.numberValue<this.min?this.numberValue=this.min:this.numberValue>this.max&&(this.numberValue=max),(100-(this.numberValue-this.min)/(this.max-this.min)*100)*this.percent0/100+"%"},ADiagnosisBar.prototype.getBarDegreeText=function(a){return"- "+(this.min+(this.max-this.min)*a/100)+this.unitText},ADiagnosisBar.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},ADiagnosisBar.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var k=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol();$("<div class='"+k.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisBarSVG'><text id='"+d+"' x='50%' y='10%' fill='black' text-anchor='middle' font-weight='bold'>"+this.data.Text+"</text><rect id='"+c+"' x='40%' y='15%' width='20%' height='67%' style='fill:red;stroke-width:1;stroke:black' /><rect id='"+e+"' x='40%' y='15%' width='20%' height='35%' style='fill:black'/><rect x='20%' width='60%' height='15' y='87%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+b+"' x='50%' y='92%' text-anchor='middle' fill='orange'>"+this.numberValue+"</text><text class='DiagnosisBarDegreeText' id='"+f+"' x='60%' y='83.5%'>"+this.getBarDegreeText(0)+"</text><text class='DiagnosisBarDegreeText' id='"+g+"' x='60%' y='66.75%'>"+this.getBarDegreeText(25)+"</text><text class='DiagnosisBarDegreeText' id='"+h+"' x='60%' y='50%'>"+this.getBarDegreeText(50)+"</text><text class='DiagnosisBarDegreeText' id='"+i+"' x='60%' y='33.25%'>"+this.getBarDegreeText(75)+"</text><text class='DiagnosisBarDegreeText' id='"+j+"' x='60%' y='16.5%'>"+this.getBarDegreeText(100)+"</text></svg></div>").appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.bar=document.getElementById(c),this.barValue=document.getElementById(e),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisBar init failed: "+a)}},ADiagnosisBar.prototype.datachangeListener=function(a){try{this.numberValue=GetAsInteger(a.value),this.number.setAttribute("fill","black"),this.number.textContent=this.numberValue+this.getUnitSymbol(),this.barValue.setAttribute("height",this.getBarValue())}catch(a){console.log("TopTextLED datachangeListener failed: "+a)}},emosWS.ADiagnosisBar=ADiagnosisBar;function ADiagnosisSpace(a,b){this.data=b,this.positionClass={L:{parent:a.LRLeft},R:{parent:a.LRRight},Long:{parent:a.LRLong}},this.init()}ADiagnosisSpace.prototype.init=function(){try{var a=this.positionClass[this.data.Position];$("<div class='DiagnosisSpace'></div>").appendTo(a.parent)}catch(a){console.log("DiagnosisSpace init failed: "+a)}},emosWS.ADiagnosisSpace=ADiagnosisSpace;var ADiagnosisTimer=function(a){this.data=null,this.setValue(a)};ADiagnosisTimer.prototype.setValue=function(a){this.data=this.decode(a)},ADiagnosisTimer.prototype.decode=function(a){return{value:a}},ADiagnosisTimer.prototype.encode=function(){return this.data.value},ADiagnosisTimer.prototype.getData=function(){return this.data},ADiagnosisTimer.prototype.toString=function(){return this.data.value},ADiagnosisTimer.prototype.formatNumber=function(a){return a<10?(100+a).toString().slice(-2):a.toString()};var ADiagnosisTimerSecond=function(a,b,c){this.plcBase=b,this.visuBase=c,ADiagnosisTimer.call(this,a)};ADiagnosisTimerSecond.prototype=Object.create(ADiagnosisTimer.prototype),ADiagnosisTimerSecond.prototype.constructor=ADiagnosisTimerSecond,ADiagnosisTimerSecond.prototype.decode=function(a){if("ms"===this.visuBase){var b=parseInt(a)*("ms"===this.plcBase?1:1e3),c=Math.floor(b/6e4);b-=6e4*c;var d=Math.floor(b/1e3);return b-=1e3*d,b=Math.round(b),{value:a,minute:c,second:d,msecond:b}}var d=parseInt(a)/("ms"===this.plcBase?1e3:1),e=Math.floor(d/3600);d-=3600*e;var c=Math.floor(d/60);return d-=60*c,d=Math.round(d),{value:a,hour:e,minute:c,second:d}},ADiagnosisTimerSecond.prototype.encode=function(a){return"ms"===this.visuBase?(this.data.minute=parseInt(a.minute),this.data.second=parseInt(a.second),this.data.msecond=parseInt(a.msecond),this.data.value=(6e4*this.data.minute+1e3*this.data.second+this.data.msecond)/("ms"===this.plcBase?1:1e3)):(this.data.hour=parseInt(a.hour),this.data.minute=parseInt(a.minute),this.data.second=parseInt(a.second),this.data.value=(3600*this.data.hour+60*this.data.minute+this.data.second)*("ms"===this.plcBase?1e3:1)),this.data.value},ADiagnosisTimerSecond.prototype.toString=function(){if("ms"===this.visuBase){var a="",b="";return 0!==this.data.minute&&(a+=this.formatNumber(this.data.minute)+":",b+="m:"),0===this.data.minute&&0===this.data.second||(a+=this.formatNumber(this.data.second)+":",b+="s:"),a+=this.formatNumber(this.data.msecond),b+="ms",a+" "+b}var a="",b="";return 0!==this.data.hour&&(a+=this.formatNumber(this.data.hour)+":",b+="h:"),0===this.data.hour&&0===this.data.minute||(a+=this.formatNumber(this.data.minute)+":",b+="m:"),a+=this.formatNumber(this.data.second),b+="s",a+" "+b};var ADiagnosisTimerMinute=function(a){ADiagnosisTimer.call(this,a)};ADiagnosisTimerMinute.prototype=Object.create(ADiagnosisTimer.prototype),ADiagnosisTimerMinute.prototype.constructor=ADiagnosisTimerMinute,ADiagnosisTimerMinute.prototype.decode=function(a){var b=parseInt(a),c=Math.floor(b/1440);b-=1440*c;var d=Math.floor(b/60);return b-=60*d,{value:a,day:c,hour:d,minute:b}},ADiagnosisTimerMinute.prototype.encode=function(a){return this.data.day=parseInt(a.day),this.data.hour=parseInt(a.hour),this.data.minute=parseInt(a.minute),this.data.value=1440*this.data.day+60*this.data.hour+this.data.minute,this.data.value},ADiagnosisTimerMinute.prototype.toString=function(){var a="",b="";return 0!==this.data.day&&(a+=formatNumber(this.data.day)+":",b+="d:"),0===this.data.day&&0===this.data.minute||(a+=formatNumber(this.data.hour)+":",b+="h:"),a+=formatNumber(this.data.minute),b+="m",a+" "+b};var ADiagnosisTimerSiemensDate=function(a){ADiagnosisTimer.call(this,a)};ADiagnosisTimerSiemensDate.prototype=Object.create(ADiagnosisTimer.prototype),ADiagnosisTimerSiemensDate.prototype.constructor=ADiagnosisTimerSiemensDate,ADiagnosisTimerSiemensDate.prototype.decode=function(a){try{var b=1989,c=12,d=30,e=/(.*?)-(.*?)-(.*?)$/,f=a.replace(e,function(a,e,f,g){b=parseInt(e),c=parseInt(f),d=parseInt(g)});return{value:a,year:b,month:c,day:d}}catch(e){return{value:a,year:b,month:c,day:d}}},ADiagnosisTimerSiemensDate.prototype.encode=function(a){return this.data.year=a.year,this.data.month=a.month,this.data.day=a.day,this.data.value=a.year+"-"+this.formatNumber(a.month)+"-"+this.formatNumber(a.day),this.data.value},ADiagnosisTimerSiemensDate.prototype.toString=function(){var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return(this.data.day<10?"0"+this.data.day:this.data.day)+" "+a[this.data.month-1]+" "+this.data.year};var ADiagnosisTimerSiemensTimeOfDate=function(a){ADiagnosisTimer.call(this,a)};ADiagnosisTimerSiemensTimeOfDate.prototype=Object.create(ADiagnosisTimer.prototype),ADiagnosisTimerSiemensTimeOfDate.prototype.constructor=ADiagnosisTimerSiemensTimeOfDate,ADiagnosisTimerSiemensTimeOfDate.prototype.decode=function(a){try{var b=12,c=0,d=0,e=/(.*?):(.*?):(.*?)\.(.*?)$/,f=a.replace(e,function(a,e,f,g,h){b=parseInt(e),c=parseInt(f),d=parseInt(g)});return{value:a,hour:b,minute:c,second:d}}catch(e){return{value:a,hour:b,minute:c,second:d}}},ADiagnosisTimerSiemensTimeOfDate.prototype.encode=function(a){return this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.value=a.hour+":"+a.minute+":"+a.second+".0",this.data.value},ADiagnosisTimerSiemensTimeOfDate.prototype.toString=function(){var a="AM",b=this.data.hour;return b>12&&(b-=12,a="PM"),b+":"+(this.data.minute<10?"0"+this.data.minute:this.data.minute)+":"+(this.data.second<10?"0"+this.data.second:this.data.second)+" "+a};var ADiagnosisTimerSiemensTime=function(a){ADiagnosisTimer.call(this,a)};ADiagnosisTimerSiemensTime.prototype=Object.create(ADiagnosisTimer.prototype),ADiagnosisTimerSiemensTime.prototype.constructor=ADiagnosisTimerSiemensTime,ADiagnosisTimerSiemensTime.prototype.decode=function(a){try{var b=0,c=0,d=0,e=0,f=0,g=/(\d+D)?(\d+H)?(\d+M)?(\d+S)?(\d+MS)?$/,h=this,i=a.replace(g,function(a,g,i,j,k,l){b=h.getNumberFromString(g),c=h.getNumberFromString(i),d=h.getNumberFromString(j),e=h.getNumberFromString(k),f=h.getNumberFromString(l)});return{value:a,day:b,hour:c,minute:d,second:e,ms:f}}catch(g){return{value:a,day:b,hour:c,minute:d,second:e,ms:f}}},ADiagnosisTimerSiemensTime.prototype.encode=function(a){return this.data.day=a.days,this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.ms=a.ms,this.data.value=a.days+"D"+a.hour+"H"+a.minute+"M"+a.second+"S"+a.ms+"MS",this.data.value},ADiagnosisTimerSiemensTime.prototype.toString=function(){var a="",b="",c=!1;if(0!==this.data.day&&(a+=this.data.day,b+="d",c=!0),!(0===this.data.day&&0===this.data.hour||0===this.data.hour&&0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.hour<10?"0"+this.data.hour:this.data.hour),b+=d+"h",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute||0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.minute<10?"0"+this.data.minute:this.data.minute),b+=d+"m",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute&&0===this.data.second||0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.second<10?"0"+this.data.second:this.data.second),b+=d+"s",c=!0}if(0!==this.data.day||0!==this.data.hour||0!==this.data.minute||0!==this.data.second||0!==this.data.ms){var d=c?":":"";a+=d+(this.data.ms<10?"0"+this.data.ms:this.data.ms),b+=d+"ms"}var e=a+" "+b;return" "===e?"0 s":e},ADiagnosisTimerSiemensTime.prototype.getNumberFromString=function(a){var b=0;try{if(void 0!==a){var c=/(\d+)/;b=parseInt(a.match(c)[0])}return b}catch(a){return b}};var ADiagnosisTimerSiemensS5Time=function(a){ADiagnosisTimerSiemensTime.call(this,a)};ADiagnosisTimerSiemensS5Time.prototype=Object.create(ADiagnosisTimerSiemensTime.prototype),ADiagnosisTimerSiemensS5Time.prototype.constructor=ADiagnosisTimerSiemensS5Time,ADiagnosisTimerSiemensS5Time.prototype.encode=function(a){return this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.ms=a.ms,this.data.value=a.hour+"H"+a.minute+"M"+a.second+"S"+a.ms+"MS",this.data.value},ADiagnosisTimerSiemensS5Time.prototype.toString=function(){var a="",b="",c=!1;if(this.data.day=0,!(0===this.data.day&&0===this.data.hour||0===this.data.hour&&0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.hour<10?"0"+this.data.hour:this.data.hour),b+=d+"h",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute||0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.minute<10?"0"+this.data.minute:this.data.minute),b+=d+"m",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute&&0===this.data.second||0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.second<10?"0"+this.data.second:this.data.second),b+=d+"s",c=!0}if(0!==this.data.day||0!==this.data.hour||0!==this.data.minute||0!==this.data.second||0!==this.data.ms){var d=c?":":"";a+=d+(this.data.ms<10?"0"+this.data.ms:this.data.ms),b+=d+"ms"}var e=a+" "+b;return" "===e?"0 s":e};var ADiagnosisTimerSiemensDateAndTime=function(a){ADiagnosisTimer.call(this,a)};ADiagnosisTimerSiemensDateAndTime.prototype=Object.create(ADiagnosisTimer.prototype),ADiagnosisTimerSiemensDateAndTime.prototype.constructor=ADiagnosisTimerSiemensDateAndTime,ADiagnosisTimerSiemensDateAndTime.prototype.decode=function(a){try{if(!a)return;var b=a.lastIndexOf("-"),c=a.substring(0,b),d=a.substring(b+1);this.date=new ADiagnosisTimerSiemensDate(c),this.time=new ADiagnosisTimerSiemensTimeOfDate(d);var e=this.date.getData(),f=this.time.getData(),g=$.extend({},e,f);return g.value=a,g}catch(a){console.log("DiagnosisTimerSiemensDateAndTime.prototype.decode failed: "+a)}},ADiagnosisTimerSiemensDateAndTime.prototype.encode=function(a){return this.data.year=a.year,this.data.month=a.month,this.data.day=a.day,this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.value=a.year+"-"+this.formatNumber(a.month)+"-"+this.formatNumber(a.day)+"-"+a.hour+":"+a.minute+":"+a.second+".0",this.data.value},ADiagnosisTimerSiemensDateAndTime.prototype.toString=function(){return this.date.toString()+" "+this.time.toString()};var AvalueTypes={Integer:0,Float:1,TimeInSecond:2,TimeInMinute:3,String:4,TimeInMSecond:5},ADiagnosisForm=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;window.addEventListener("load",y,!1);function y(){B()}function z(){switch(b.type){case AvalueTypes.TimeInMSecond:case AvalueTypes.TimeInMinute:case AvalueTypes.TimeInSecond:case AvalueTypes.TimeInMinute:var d=k.val(),e=l.val(),f=m.val(),g=n.val(),h=o.val();x=b.value.encode({day:d,hour:e,minute:f,second:g,msecond:h});break;case AvalueTypes.String:x=w.val();break;default:x=c.val()}b.onpoke?b.onpoke(x):emosWS.poke(b.plctag,x),a.dialog("close"),void 0!==b.callback&&b.callback(x)}function A(){return a}function B(){try{var b=getElementGlobalID(),d=getElementGlobalID(),x=getElementGlobalID(),y=getElementGlobalID(),A=getElementGlobalID(),B=getElementGlobalID(),C=getElementGlobalID(),D=getElementGlobalID(),E=getElementGlobalID(),F=getElementGlobalID(),G=getElementGlobalID(),H=getElementGlobalID(),I=getElementGlobalID(),J=getElementGlobalID(),K=getElementGlobalID(),L=getElementGlobalID(),M=getElementGlobalID(),N=getElementGlobalID(),O=getElementGlobalID(),P=getElementGlobalID(),Q=getElementGlobalID(),R="<div class='vertical controls' id='"+F+"'>   <span id='"+G+"'><input id='"+L+"'>d</span>   <span id='"+H+"'><input id='"+M+"'>h</span>   <span id='"+I+"'><input id='"+N+"'>m</span>   <span id='"+J+"'><input id='"+O+"'>s</span>   <span id='"+K+"'><input id='"+P+"'>ms</span></div>",S="<div class='DiagnosisStringEdit'><textarea rows='4' id='"+Q+"'</textarea></div>",T=$("<div id='"+b+"'>   <div class='DiagnosisExtraContent'>       <p id='"+d+"'>plc.tag</p>       <p id='"+x+"'>text</p>   <table style='width:100%; text-align:center'><tr>       <td id='"+y+"'>Min</td>       <td>..............</td>       <td id='"+A+"'>.</td>       <td>..............</td>       <td id='"+B+"'>Max</td>   <tr></table>   </div>   <form>       <div class='DiagnosisDatePickerContainer'>           <div class='DiagnosisDatePickerCenter'>               <span id='"+E+"'>                   <input name='numberValue' id='"+C+"' value='0'>                   <label id='"+D+"'>unit</label>               </span>"+R+"           </div>       </div>"+S+"       <input type='submit' tabindex='-1' style='position:absolute; top:-1000px'>   </form></div>");$("body").append(T),a=$("#"+b).dialog({modal:!0,autoOpen:!1,width:350,title:"Input dialog",buttons:{Cancel:function(){a.dialog("close")},OK:z},close:function(){U[0].reset()}}),c=$("#"+C).spinner(),e=$("#"+D),f=$("#"+y),g=$("#"+A),h=$("#"+B),i=$("#"+d),j=$("#"+x),k=$("#"+L).spinner({min:0,step:1,start:1}),l=$("#"+M).spinner({min:0,max:23,step:1,start:1}),m=$("#"+N).spinner({min:0,max:59,step:1,start:0}),n=$("#"+O).spinner({min:0,max:59,step:1,start:0}),o=$("#"+P).spinner({min:0,max:999,step:1,start:0}),q=$("#"+F),r=$("#"+G),s=$("#"+H),t=$("#"+I),u=$("#"+J),v=$("#"+K),p=$("#"+E),w=$("#"+Q);var U=a.find("form").on("submit",function(a){a.preventDefault(),z()})}catch(a){console.log("appendFormNumber failed: "+a)}}function C(c){switch(b=c,L(),D(),b.type){case AvalueTypes.TimeInMSecond:I(),J(),K(),g.text("ms"),a.dialog("open");break;case AvalueTypes.TimeInSecond:H(),I(),J(),g.text("s"),a.dialog("open");break;case AvalueTypes.TimeInMinute:G(),H(),I(),g.text("m"),a.dialog("open");break;case AvalueTypes.String:F(),a.dialog("open");break;default:E(),a.dialog("open")}}function D(){i.text(b.plctag),j.text(b.text),f.text("[  "+b.min),h.text(b.max+"  ]")}function E(){c.spinner("option","min",b.min),c.spinner("option","max",b.max),c.spinner("option","step",Math.pow(10,-1*(b.precision||0))),c.val(b.value),e.text(b.unit),p.show()}function F(){w.val(b.value),w.show()}function G(){r.show();var a=b.value.data;k.val(a.day)}function H(){s.show();var a=b.value.data;l.val(a.hour)}function I(){t.show();var a=b.value.data;m.val(a.minute)}function J(){u.show();var a=b.value.data;n.val(a.second)}function K(){v.show();var a=b.value.data;o.val(a.msecond)}function L(){p.hide(),r.hide(),s.hide(),t.hide(),u.hide(),v.hide(),w.hide(),g.text(".")}return{open:C,getFormNumberDialog:A}}(),ADiagnosisDateForm=function(){var a,b,c,d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g,h,i,j,k,l,m,n,o,p,q;window.addEventListener("load",r,!1);function r(){u()}function s(){console.log("Value is change");var d=g.datepicker("getDate"),e=d.getFullYear(),f=d.getMonth()+1,h=d.getDate(),n=i.val(),o=j.val(),p=k.val(),q=l.val(),r=m.val(),s=c.encode({year:e,month:f,day:h,days:n,hour:o,minute:p,second:q,ms:r});console.log(s),emosWS.poke(b.plctag,s),a.dialog("close"),void 0!==b.callback&&b.callback(c)}function t(){return a}function u(){try{var b=getElementGlobalID(),c=getElementGlobalID(),r=getElementGlobalID(),t=getElementGlobalID(),u=getElementGlobalID(),v=getElementGlobalID(),w=getElementGlobalID(),x=getElementGlobalID(),y=getElementGlobalID(),z="<div id='"+e+"'></div>",A="<div class='vertical controls' id='"+x+"'>   <span id='"+b+"'><input id='"+c+"'>d</span>   <input id='"+r+"'>h   <input id='"+t+"'>m   <input id='"+u+"'>s   <span id='"+w+"'><input style='width: 2em' id='"+v+"'>ms</span></div>",B=$("<div id='"+d+"'>   <div class='DiagnosisExtraContent'>       <p id='"+f+"'>plc.tag</p>       <p id='"+y+"'>Adjust Date</p>   </div>   <form><div class='DiagnosisDatePickerContainer'>   <div class='DiagnosisDatePickerCenter'>"+z+A+"   </div></div>           <input type='submit' tabindex='-1' style='position:absolute; top:-1000px'>   </form></div>");$("body").append(B),a=$("#"+d).dialog({modal:!0,autoOpen:!1,width:400,title:"Input dialog",buttons:{Cancel:function(){a.dialog("close")},OK:s},close:function(){}}),g=$("#"+e).datepicker({changeMonth:!0,changeYear:!0}),g.datepicker("option","firstDay",1),g.datepicker("option","yearRange","0:3000"),p=$("#"+b),i=$("#"+c).spinner({min:0,step:1,start:1}),j=$("#"+r).spinner({min:0,max:23,step:1,start:1}),k=$("#"+t).spinner({min:0,max:59,step:1,start:0}),l=$("#"+u).spinner({min:0,max:59,step:1,start:0}),m=$("#"+v).spinner({min:0,max:999,step:1,start:0}),q=$("#"+w),o=$("#"+x),h=$("#"+f),n=$("#"+y);var C=a.find("form").on("submit",function(a){a.preventDefault(),s()})}catch(a){console.log("appendFormNumber failed: "+a)}}function v(d){switch(b=d,c=b.value,h.text(b.plctag),w(),c.constructor){case ADiagnosisTimerSiemensDate:x(),n.text("Adjust date (Simens DATE):"),a.dialog("open");break;case ADiagnosisTimerSiemensTimeOfDate:n.text("Adjust time (Simens TIME_OF_DAY):"),y(),a.dialog("open");break;case ADiagnosisTimerSiemensTime:n.text("Adjust time (Simens TIME):"),z(),y(),A(),a.dialog("open");break;case ADiagnosisTimerSiemensS5Time:n.text("Adjust time (Simens S5TIME):"),y(),A(),a.dialog("open");break;case ADiagnosisTimerSiemensDateAndTime:n.text("Adjust date and time (Simens DATE/AND_TIME):"),x(),y(),a.dialog("open")}}function w(){g.hide(),p.hide(),o.hide(),q.hide()}function x(){g.show();var a=c.data,b=new Date(a.year,a.month-1,a.day);g.datepicker("setDate",b)}function y(){o.show();var a=c.data;j.val(a.hour),k.val(a.minute),l.val(a.second)}function z(){p.show();var a=c.data;i.val(a.day)}function A(){q.show();var a=c.data;m.val(a.ms)}return{open:v,getDialog:t}}();function ADiagnosisTextTimer(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.type=d,this.writable=e,this.diagnosisWindow=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextTimer",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextTimer",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextTimer",BorderWidth:"97.5%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",Number2X:"97%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag2=this.plc+"."+this.data.OPCID,this.border=this.text=this.number=this.writeRect=this.numberValue=this.timerValue=null,this.numberColor=this.writable?"blue":"black",this.type===AtimerTypes.Second?(this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s"):this.plcBase=this.visuBase=null,ADiagnosisElement.call(this,{data:b,writable:e})}ADiagnosisTextTimer.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisTextTimer.prototype.constructor=ADiagnosisTextTimer,ADiagnosisTextTimer.prototype.setTimerValue=function(){switch(this.type){case AtimerTypes.Second:this.timerValue=new ADiagnosisTimerSecond(0,this.plcBase,this.visuBase);break;case AtimerTypes.Minute:this.timerValue=new ADiagnosisTimerMinute;break;case AtimerTypes.SiemensDate:this.timerValue=new ADiagnosisTimerSiemensDate;break;case AtimerTypes.SiemensTimeOfDay:this.timerValue=new ADiagnosisTimerSiemensTimeOfDate;break;case AtimerTypes.SiemensTime:this.timerValue=new ADiagnosisTimerSiemensTime;break;case AtimerTypes.SiemensS5Time:this.timerValue=new ADiagnosisTimerSiemensS5Time;break;case AtimerTypes.SiemensDateAndTime:this.timerValue=new ADiagnosisTimerSiemensDateAndTime;break;default:this.timerValue=new ADiagnosisTimer}},ADiagnosisTextTimer.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];this.setTimerValue();(this.panel=$("<div class='"+f.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisTextDoubleSVG'><rect class='DiagnosisNumberLRRectBorderSVG' width='"+f.BorderWidth+"' height='20' id='"+c+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+f.WriteRectWidth+"' height='20' x='"+f.WriteRectX+"' id='"+e+"'/><text class='DiagnosisNumberLRTextTextSVG' x='"+f.TextX+"' y='"+f.TextY+"' id='"+d+"'>"+this.data.Text+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+f.Number2X+"' y='"+f.Number2Y+"' text-anchor='end' id='"+b+"'>"+this.numberValue+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.writeRect=document.getElementById(e),emosWS.advise(this.plctag2,this.datachange2Listener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.writeRect.style.cursor="pointer",this.number.setAttribute("pointer-events","none"),this.writeRect.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisTextTimer init failed: "+a)}},ADiagnosisTextTimer.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.number.style.fill=this.numberColor="blue"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.number.style.fill=this.numberColor="black")},ADiagnosisTextTimer.prototype.onClick=function(){switch(this.type){case AtimerTypes.Second:ADiagnosisForm.open({value:this.timerValue,plctag:this.plctag2,type:"s"===this.visuBase?AvalueTypes.TimeInSecond:AvalueTypes.TimeInMSecond,text:this.text.textContent,min:this.data.IntTimeMin,max:this.data.IntTimeMax});break;case AtimerTypes.SiemensDate:case AtimerTypes.SiemensTimeOfDay:case AtimerTypes.SiemensDateAndTime:case AtimerTypes.SiemensS5Time:case AtimerTypes.SiemensTime:ADiagnosisDateForm.open({value:this.timerValue,plctag:this.plctag2});break;default:ADiagnosisForm.open({value:this.numberValue,unit:"",min:this.data.IntTimeMin,max:this.data.IntTimeMax,plctag:this.plctag2,text:this.text.textContent})}},ADiagnosisTextTimer.prototype.datachange2Listener=function(a){try{this.number.style.fill=this.numberColor,this.timerValue.setValue(a.value),this.number.textContent=this.timerValue.toString()}catch(a){console.log("datachange2Listener datachangeListener failed: "+a)}},emosWS.ADiagnosisTextTimer=ADiagnosisTextTimer;function ADiagnosisTextDoubleTimer(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.valueInSecond=d,this.writable=e,this.diagnosisWindow=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextDoubleTimer",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"50%",NumberY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextDoubleTimer",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"50%",NumberY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextDoubleTimer",BorderWidth:"72%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",NumberX:"71.5%",NumberY:"15",Number2X:"97%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctag2=this.plc+"."+this.data.OPCID2,this.border=this.text=this.number=this.number2=this.rect=this.writeRect=this.numberValue=this.number2Value=this.timerValue=null,this.numberColor=this.writable?"blue":"black",d?(this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s"):this.plcBase=this.visuBase=null,ADiagnosisElement.call(this,{data:b,writable:e})}ADiagnosisTextDoubleTimer.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisTextDoubleTimer.prototype.constructor=ADiagnosisTextDoubleTimer,ADiagnosisTextDoubleTimer.prototype.setTimerValue=function(){this.timerValue=this.valueInSecond?new ADiagnosisTimerSecond(0,this.plcBase,this.visuBase):new ADiagnosisTimerMinute},ADiagnosisTextDoubleTimer.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=this.positionClass[this.data.Position];this.setTimerValue();(this.panel=$("<div class='"+g.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisTextDoubleSVG'><rect class='DiagnosisNumberLRRectBorderSVG' width='"+g.BorderWidth+"' height='20' id='"+d+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+g.WriteRectWidth+"' height='20' x='"+g.RectX+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+g.WriteRectWidth+"' height='20' x='"+g.WriteRectX+"' id='"+f+"'/><text class='DiagnosisNumberLRTextTextSVG' x='"+g.TextX+"' y='"+g.TextY+"' id='"+e+"'>"+this.data.Text+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+g.NumberX+"' y='"+g.NumberY+"' text-anchor='end' id='"+b+"'>"+this.numberValue+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+g.Number2X+"' y='"+g.Number2Y+"' text-anchor='end' id='"+c+"'>"+this.number2Value+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(b),this.number2=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.writeRect=document.getElementById(f),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag2,this.datachange2Listener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.writeRect.style.cursor="pointer",this.number2.setAttribute("pointer-events","none"),this.writeRect.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisTextDoubleTimer init failed: "+a)}},ADiagnosisTextDoubleTimer.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.number2.style.fill=this.numberColor="blue"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.number2.style.fill=this.numberColor="black")},ADiagnosisTextDoubleTimer.prototype.onClick=function(){ADiagnosisForm.open({value:this.timerValue,unit:"",min:this.data.IntTimeMin,max:this.data.IntTimeMax,plctag:this.plctag2,text:this.text.textContent,type:this.valueInSecond?"s"===this.visuBase?AvalueTypes.TimeInSecond:AvalueTypes.TimeInMSecond:AvalueTypes.TimeInMinute})},ADiagnosisTextDoubleTimer.prototype.datachangeListener=function(a){try{this.number.style.fill="black",this.timerValue.setValue(a.value),this.number.textContent=this.timerValue.toString()}catch(a){console.log("DiagnosisTextDoubleTimer datachangeListener failed: "+a)}},ADiagnosisTextDoubleTimer.prototype.datachange2Listener=function(a){try{this.number2.style.fill=this.numberColor,this.timerValue.setValue(a.value),this.number2.textContent=this.timerValue.toString()}catch(a){console.log("DiagnosisTextDoubleTimer datachange2Listener failed: "+a)}},emosWS.ADiagnosisTextDoubleTimer=ADiagnosisTextDoubleTimer;function ADiagnosisTextNumber(a,b,c,d,e){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextInteger",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextInteger",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextInteger",BorderWidth:"97.5%",WriteRectWidth:"25%",WriteRectX:"72.5%",TextX:"5",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.numberValue=this.border=this.text=this.number=this.writeRect=null,this.unit=emosWS.getUnit(),this.unitSymbol=this.getUnitSymbol(),this.IOObject=null,this.numberColor=this.writable?"blue":"black",this.sliderId=null,this.msg=null,ADiagnosisElement.call(this,{data:b,writable:d})}ADiagnosisTextNumber.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisTextNumber.prototype.constructor=ADiagnosisTextNumber,ADiagnosisTextNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];(this.panel=$("<div class='"+f.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisNumberLRSVG'><rect class='DiagnosisNumberLRRectBorderSVG' width='"+f.BorderWidth+"' height='20' id='"+c+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+f.WriteRectWidth+"' height='20' x='"+f.WriteRectX+"' id='"+e+"'/><text class='DiagnosisNumberLRTextTextSVG' x='"+f.TextX+"' y='"+f.TextY+"' id='"+d+"'>"+this.data.Text+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+f.NumberX+"' y='"+f.NumberY+"' text-anchor='end' id='"+b+"'>"+this.numberValue+this.unitSymbol+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.writeRect=document.getElementById(e),this.IOObject=emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.writeRect.style.cursor="pointer",this.number.setAttribute("pointer-events","none"),this.writeRect.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisTextNumber init failed: "+a)}},ADiagnosisTextNumber.prototype.poke=function(a){this.IOObject.setValue(a)},ADiagnosisTextNumber.prototype.getParams=function(){var a={value:this.numberValue,unitSymbol:this.unitSymbol,precision:this.data.Precision};try{var b=this.IOObject.IOObjectPLC;a.value=b.value,a.unitSymbol=b.unitSymbol,a.precision=b.precision}catch(a){console.log(a)}return a},ADiagnosisTextNumber.prototype.shareFunctionsTo=function(a){try{["poke","getParams","onClick","datachangeListener"].forEach(function(b){a[b]=this.constructor.prototype[b]}.bind(this))}catch(a){console.log(a)}},ADiagnosisTextNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.number.style.fill=this.numberColor="blue"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.number.style.fill=this.numberColor="black")},ADiagnosisTextNumber.prototype.onClick=function(){var a=this.getParams();ADiagnosisForm.open({value:a.value,unit:a.unitSymbol,min:this.data.RealInputMin||this.data.IntInputMin,max:this.data.RealInputMax||this.data.IntInputMax,plctag:this.plctag,text:this.text.textContent,precision:a.precision,onpoke:this.poke.bind(this)})},ADiagnosisTextNumber.prototype.datachangeListener=function(a){try{this.msg=a;var b=a.value;this.numberValue=b.value,this.unitSymbol=b.unitSymbol,this.number.style.fill=this.numberColor,this.number.textContent=b.valueWithSymbol}catch(a){console.log("DiagnosisTextNumber datachangeListener failed: "+a)}},emosWS.ADiagnosisTextNumber=ADiagnosisTextNumber;function ADiagnosisTextNumberNumber(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.dataType=d,this.writable=e,this.diagnosisWindow=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextNumberNumber",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextNumberNumber",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextNumberNumber",BorderWidth:"97.5%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",NumberX:"71.5%",NumberY:"15",Number2X:"96.5%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctag2=this.plc+"."+this.data.OPCID2,this.border=this.text=this.number=this.number2=this.rect=this.writeRect=this.numberValue=this.number2Value=this.min=this.max=null,this.unit=emosWS.getUnit(),this.unitSymbol=this.getUnitSymbol(),this.IOObject1=this.IOObject2=null,this.numberColor=this.writable?"blue":"black",this.msg1=this.msg2=null,ADiagnosisElement.call(this,{data:b,writable:e})}ADiagnosisTextNumberNumber.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisTextNumberNumber.prototype.constructor=ADiagnosisTextNumberNumber,ADiagnosisTextNumberNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID();switch(this.dataType){case this.diagnosisWindow.dataTypes.Integer:this.min=this.data.IntInputMin,this.max=this.data.IntInputMax;break;case this.diagnosisWindow.dataTypes.Real:this.min=this.data.RealInputMin,this.max=this.data.RealInputMax}var h=this.positionClass[this.data.Position];(this.panel=$("<div class='"+h.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisNumberLRSVG'><rect class='DiagnosisNumberLRRectBorderSVG' width='"+h.BorderWidth+"' height='20' id='"+d+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+h.WriteRectWidth+"' height='20' x='"+h.RectX+"' id='"+f+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+h.WriteRectWidth+"' height='20' x='"+h.WriteRectX+"' id='"+g+"'/><text class='DiagnosisNumberLRTextTextSVG' x='"+h.TextX+"' y='"+h.TextY+"' id='"+e+"'>"+this.data.Text+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+h.NumberX+"' y='"+h.NumberY+"' text-anchor='end' id='"+b+"'>"+this.numberValue+this.getUnitSymbol()+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+h.Number2X+"' y='"+h.Number2Y+"' text-anchor='end' id='"+c+"'>"+this.number2Value+this.getUnitSymbol()+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(b),this.number2=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.rect=document.getElementById(f),this.writeRect=document.getElementById(g),this.IOObject1=emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),this.IOObject2=emosWS.advise(this.plctag2,this.datachange2Listener.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.writeRect.style.cursor="pointer",this.number2.setAttribute("pointer-events","none"),this.writeRect.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisTextNumberNumber init failed: "+a)}},ADiagnosisTextNumberNumber.prototype.poke=function(a){this.IOObject2.setValue(a)},ADiagnosisTextNumberNumber.prototype.getParams=function(){var a={value:this.number2Value,unitSymbol:this.unitSymbol,precision:this.data.Precision};try{var b=this.IOObject2.IOObjectPLC;a.value=b.value,a.unitSymbol=b.unitSymbol,a.precision=b.precision}catch(a){console.log(a)}return a},ADiagnosisTextNumberNumber.prototype.shareFunctionsTo=function(a){try{["poke","getParams","onClick","datachangeListener","datachange2Listener"].forEach(function(b){a[b]=this.constructor.prototype[b]}.bind(this))}catch(a){console.log(a)}},ADiagnosisTextNumberNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.number2.style.fill=this.numberColor="blue"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.number2.style.fill=this.numberColor="black")},ADiagnosisTextNumberNumber.prototype.onClick=function(){var a=this.getParams();ADiagnosisForm.open({value:a.value,unit:a.unitSymbol,min:this.min||this.data.RealInputMin,max:this.max||this.data.RealInputMax,plctag:this.plctag2,text:this.text.textContent,precision:a.precision,onpoke:this.poke.bind(this)})},ADiagnosisTextNumberNumber.prototype.datachangeListener=function(a){try{this.msg1=a;var b=a.value;this.numberValue=b.value,this.unitSymbol=b.unitSymbol,this.number.style.fill="black",this.number.textContent=b.valueWithSymbol}catch(a){console.log("DiagnosisTextNumberNumber datachangeListener failed: "+a)}},ADiagnosisTextNumberNumber.prototype.datachange2Listener=function(a){try{this.msg2=a;var b=a.value;this.number2Value=b.value,this.unitSymbol=b.unitSymbol,this.number2.style.fill=this.numberColor,this.number2.textContent=b.valueWithSymbol}catch(a){console.log("DiagnosisTextNumberNumber datachange2Listener failed: "+a)}},emosWS.ADiagnosisTextNumberNumber=ADiagnosisTextNumberNumber;function ADiagnosisLedTextNumberNumber(a,b,c,d,e){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisLedText",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisLedText",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisLedText",BorderWidth:"92.4%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"27",TextY:"15",NumberX:"71.5%",NumberY:"15",Number2X:"96.5%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctag2=this.plc+"."+this.data.OPCID2,this.plctagLed=this.plc+"."+this.data.LEDOPCID,this.ledValue=this.border=this.led=this.text=this.number=this.number2=this.writeRect=this.numberValue=this.number2Value=null,this.unit=emosWS.getUnit(),this.unitSymbol=this.getUnitSymbol(),this.IOObject1=this.IOObject2=null,this.numberColor=this.writable?"blue":"black",this.msg1=this.msg2=null,ADiagnosisElement.call(this,{data:b,writable:d})}ADiagnosisLedTextNumberNumber.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisLedTextNumberNumber.prototype.constructor=ADiagnosisLedTextNumberNumber,ADiagnosisTextNumberNumber.prototype.shareFunctionsTo(ADiagnosisLedTextNumberNumber.prototype),ADiagnosisLedTextNumberNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=this.positionClass[this.data.Position];(this.panel=$("<div class='"+h.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisNumberLRSVG'><rect width='20' height='20' style='fill:white;stroke-width:1;stroke:grey' /><circle id='"+b+"' cx='10' cy='10' r='7' stroke='black' stroke-width='1' fill='orange'/><rect class='DiagnosisNumberLRRectBorderSVG' x='22' width='"+h.BorderWidth+"' height='20' id='"+e+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+h.WriteRectWidth+"' height='20' x='"+h.RectX+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+h.WriteRectWidth+"' height='20' x='"+h.WriteRectX+"' id='"+g+"'/><text class='DiagnosisNumberLRTextTextSVG' x='"+h.TextX+"' y='"+h.TextY+"' id='"+f+"'>"+this.data.Text+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+h.NumberX+"' y='"+h.NumberY+"' text-anchor='end' id='"+c+"'>"+this.numberValue+this.getUnitSymbol()+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+h.Number2X+"' y='"+h.Number2Y+"' text-anchor='end' id='"+d+"'>"+this.number2Value+this.getUnitSymbol()+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(c),this.number2=document.getElementById(d),this.text=document.getElementById(f),this.border=document.getElementById(e),this.writeRect=document.getElementById(g),this.led=document.getElementById(b),this.IOObject1=emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),this.IOObject2=emosWS.advise(this.plctag2,this.datachange2Listener.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.advise(this.plctagLed,this.datachangeLedListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.writeRect.style.cursor="pointer",this.number2.setAttribute("pointer-events","none"),this.writeRect.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisTextInteger init failed: "+a)}},ADiagnosisLedTextNumberNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.number2.style.fill=this.numberColor="blue"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.number2.style.fill=this.numberColor="black")},ADiagnosisLedTextNumberNumber.prototype.datachangeLedListener=function(a){try{this.msg1=a,this.ledValue=GetAsBoolean(a.value);var b=AcolorList[this.ledValue?this.data.OnLED:this.data.OffLED];this.led.setAttribute("fill",b)}catch(a){console.log("DiagnosisLedTextNumberNumber datachangeLedListener failed: "+a)}},emosWS.ADiagnosisLedTextNumberNumber=ADiagnosisLedTextNumberNumber;function ADiagnosisLedTextNumber(a,b,c,d,e){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisLedText",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisLedText",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisLedText",BorderWidth:"92.4%",WriteRectWidth:"12.5%",WriteRectX:"85%",TextX:"27",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctagLed=this.plc+"."+this.data.LEDOPCID,this.numberValue=this.ledValue=this.border=this.led=this.text=this.number=this.writeRect=this.numberValue=null,this.unit=emosWS.getUnit(),this.unitSymbol=this.getUnitSymbol(),this.IOObject=null,this.numberColor=this.writable?"blue":"black",this.msg=null,ADiagnosisElement.call(this,{data:b,writable:d})}ADiagnosisLedTextNumber.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisLedTextNumber.prototype.constructor=ADiagnosisLedTextNumber,ADiagnosisTextNumber.prototype.shareFunctionsTo(ADiagnosisLedTextNumber.prototype),ADiagnosisLedTextNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=this.positionClass[this.data.Position];(this.panel=$("<div class='"+g.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisNumberLRSVG'><rect width='20' height='20' style='fill:white;stroke-width:1;stroke:grey' /><circle id='"+b+"' cx='10' cy='10' r='7' stroke='black' stroke-width='1' fill='orange'/><rect class='DiagnosisNumberLRRectBorderSVG' x='22' width='"+g.BorderWidth+"' height='20' id='"+d+"'/><rect class='DiagnosisNumberLRRectwriteRectSVG' width='"+g.WriteRectWidth+"' height='20' x='"+g.WriteRectX+"' id='"+f+"'/><text class='DiagnosisNumberLRTextTextSVG' x='"+g.TextX+"' y='"+g.TextY+"' id='"+e+"'>"+this.data.Text+"</text><text class='DiagnosisNumberLRTextNumberSVG' x='"+g.NumberX+"' y='"+g.NumberY+"' text-anchor='end' id='"+c+"'>"+this.numberValue+this.getUnitSymbol()+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.writeRect=document.getElementById(f),this.led=document.getElementById(b),this.IOObject=emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.advise(this.plctagLed,this.datachangeLedListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.writeRect.style.cursor="pointer",this.number.setAttribute("pointer-events","none"),this.writeRect.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisLedTextNumber init failed: "+a)}},ADiagnosisLedTextNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.number.style.fill=this.numberColor="blue"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.number.style.fill=this.numberColor="black")},ADiagnosisLedTextNumber.prototype.datachangeLedListener=function(a){try{this.ledValue=GetAsBoolean(a.value);var b=AcolorList[this.ledValue?this.data.OnLED:this.data.OffLED];this.led.setAttribute("fill",b)}catch(a){console.log("DiagnosisLedTextNumber datachangeLedListener failed: "+a)}},emosWS.ADiagnosisLedTextNumber=ADiagnosisLedTextNumber;function ADiagnosisBrowserPage(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisBrowserPage"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisBrowserPage"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisBrowserPage"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.OPCID=this.data.OPCID,this.url=this.data.URL,this.plctag=this.plc,this.iframe=null,this.init()}ADiagnosisBrowserPage.prototype.init=function(){try{var a=getElementGlobalID(),b=this.positionClass[this.data.Position];$("<div class='"+b.css+"'><iframe class='DiagnosisBrowserIFrame' id='"+a+"' src='"+this.url+"'></iframe></div>").appendTo(this.parentDiv),this.iframe=document.getElementById(a),this.url.indexOf("$")>=0&&""!==this.OPCID&&emosWS.advise(this.plc+"."+this.data.OPCID,this.datachangeListener.bind(this),"",emosWS.tagType.IO)}catch(a){console.log("DiagnosisControlNetArray init failed: "+a)}},ADiagnosisBrowserPage.prototype.datachangeListener=function(a){var b=this.url;this.iframe.src=b.replace("$",a.value)},emosWS.ADiagnosisBrowserPage=ADiagnosisBrowserPage;function ADiagnosisControlNetArray(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisControlNetArray",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisControlNetArray",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisControlNetArray",BorderWidth:"92.4%",WriteRectWidth:"12.5%",WriteRectX:"85%",TextX:"27",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.aOPCIA=this.data.AOPCID,this.aOPCMidID=this.data.AOPCMidID,this.aOPCEndID=this.data.AOPCEndID,this.sOPCIA=this.data.SOPCID,this.sOPCMidID=this.data.SOPCMidID,this.sOPCEndID=this.data.SOPCEndID,this.start=parseInt(this.data.Start),this.stop=parseInt(this.data.Stop),this.elements=this.stop-this.start+1,this.rows=Math.floor(this.elements/11),this.plctag=this.plc,this.controls={},this.rowElements=11,this.init()}ADiagnosisControlNetArray.prototype.init=function(){try{for(var a=getElementGlobalID(),b=this.start,c=this.stop+1;b<c;b++)this.controls[b]={id:getElementGlobalID(),alarmValue:null,statusValue:null,rect:null};for(var d=this.positionClass[this.data.Position],e="",f=0,g=0,h=35,i=40,j=20,k=25,l=k*this.rows,b=0;b<this.rows;b++){for(var c=b===this.rows-1?this.elements-b*this.rowElements:this.rowElements,m=0;m<c;m++){var n=b*this.rowElements+m+this.start;e+="<rect class='DiagnosisControlRectSVG' x='"+(f+m*i)+"' y='"+g+"' width='"+h+"' height='"+j+"' id='"+this.controls[n].id+"'/><text text-anchor='middle' class='DiagnosisControlTextSVG' x='"+(f+h/2+m*i)+"' y='"+(g+15)+"'>"+n+"</text>"}g+=k}$("<div class='"+d.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='"+l+"' class='DiagnosisControlArraySVG'>"+e+"</svg></div>").appendTo(this.parentDiv);for(var b=this.start,c=this.stop+1;b<c;b++)this.controls[b].rect=document.getElementById(this.controls[b].id),emosWS.advise(this.getAlarmPlctag(b),this.datachangeAlarmListener.bind(this),b,emosWS.tagType.IO),emosWS.advise(this.getStatusPlctag(b),this.datachangeStatusListener.bind(this),b,emosWS.tagType.IO)}catch(a){console.log("DiagnosisControlNetArray init failed: "+a)}},ADiagnosisControlNetArray.prototype.getAlarmPlctag=function(a){var b=(100+a).toString().substring(1);return this.plctag+"."+this.aOPCIA+b+this.aOPCMidID+a+this.aOPCEndID},ADiagnosisControlNetArray.prototype.getStatusPlctag=function(a){var b=(100+a).toString().substring(1);return this.plctag+"."+this.sOPCIA+b+this.sOPCMidID+a+this.sOPCEndID},ADiagnosisControlNetArray.prototype.datachangeAlarmListener=function(a,b){try{var c=this.controls[b];c.alarmValue=GetAsBoolean(a.value),c.alarmValue?c.rect.style.fill=AcolorList.R:c.statusValue||(c.rect.style.fill=AcolorList.O)}catch(a){console.log("DiagnosisControlNetArray datachangeAlarmListener failed: "+a)}},ADiagnosisControlNetArray.prototype.datachangeStatusListener=function(a,b){try{var c=this.controls[b];c.statusValue=GetAsBoolean(a.value),c.alarmValue||(c.statusValue?c.rect.style.fill=AcolorList.G:c.rect.style.fill=AcolorList.O)}catch(a){console.log("DiagnosisControlNetArray datachangeStatusListener failed: "+a)}},emosWS.ADiagnosisControlNetArray=ADiagnosisControlNetArray;function ADiagnosisBitBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisBitBar",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisBitBar",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisBitBar",BorderWidth:"92.4%",WriteRectWidth:"12.5%",WriteRectX:"85%",TextX:"27",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.numberValue=null,this.barBytes=2,this.leds={},ADiagnosisElement.call(this,{data:b})}ADiagnosisBitBar.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisBitBar.prototype.constructor=ADiagnosisBitBar,ADiagnosisBitBar.prototype.init=function(){try{for(var a=getElementGlobalID(),b=0,c=8*this.barBytes;b<c;b++)this.leds[b]={id:getElementGlobalID(),value:null,svg:null};for(var d=this.positionClass[this.data.Position],e="",f=0,g=10,h=10,i=12,j=6,b=0;b<this.barBytes;b++){for(var k=0;k<8;k++){var l=8*(this.barBytes-b-1)+(7-k);e+="<text class='DiagnosisNumberNumberTextSVG' x='"+(f+k*g)+"' y='"+h+"'>"+(7-k)+"</text><rect class='DiagnosisBitSVG' x='"+(f+k*g)+"' y='"+i+"' width='"+j+"' height='"+j+"' id='"+this.leds[l].id+"'/>"}f+=9*g}(this.panel=$("<div class='"+d.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisBitBarSVG'>"+e+"</svg></div>")).appendTo(this.parentDiv);for(var b=0,c=8*this.barBytes;b<c;b++)this.leds[b].svg=document.getElementById(this.leds[b].id);emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO)}catch(a){console.log("DiagnosisBitBar init failed: "+a)}},ADiagnosisBitBar.prototype.datachangeListener=function(a){try{this.numberValue=GetAsInteger(a.value);for(var b=4294967296,c=(b+this.numberValue).toString(2),d=0,e=8*this.barBytes;d<e;d++){this.leds[d].value=c[c.length-d-1];var f="1"===this.leds[d].value?AcolorList.G:AcolorList.O;this.leds[d].svg.style.fill=f}}catch(a){console.log("DiagnosisBitBar datachangeListener failed: "+a)}},emosWS.ADiagnosisBitBar=ADiagnosisBitBar;function ADiagnosisTextLED(a,b,c,d,e){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.led=this.border=this.text=this.LEDValue=null,ADiagnosisElement.call(this,{data:b,writable:d})}ADiagnosisTextLED.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisTextLED.prototype.constructor=ADiagnosisTextLED,ADiagnosisTextLED.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position],g=this.writable?"<rect  id='"+e+"' width='"+f.writeRectWidth+"' height='"+f.rectHeight+"' x='"+f.writeRectX+"' style='fill:lightgrey;'/>":"";this.panel=$("<div class='"+f.css+"' id='"+a+"'><svg width='100%' height='20'><rect id='"+c+"' width='"+f.rectWidth+"' height='"+f.rectHeight+"' style='fill:white;stroke-width:1;stroke:grey' />"+g+"<text id='"+d+"' x='5' y='15' fill='black'>"+this.data.Text+"</text><circle id='"+b+"' cx='"+f.ledX+"' cy='"+f.ledY+"' r='"+f.ledR+"' stroke='black' stroke-width='1' fill='orange'/></svg></div>"),this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.writeRect=document.getElementById(e),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.writable&&(this.led.style.cursor="pointer",this.led.addEventListener("click",function(){emosWS.poke(this.plctag,this.LEDValue?"0":"-1")}.bind(this)))}catch(a){console.log("DiagnosisTextLED init failed: "+a)}},ADiagnosisTextLED.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.visibility="visible",this.led.style.cursor="pointer",this.led.style.pointerEvents="auto"):(this.writeRect.style.visibility="hidden",this.led.style.cursor="auto",this.led.style.pointerEvents="none")},ADiagnosisTextLED.prototype.datachangeListener=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=AcolorList[this.LEDValue?this.data.OnLED:this.data.OffLED];this.led.setAttribute("fill",b)}catch(a){console.log("DiagnosisTextLED datachangeListener failed: "+a)}},emosWS.ADiagnosisTextLED=ADiagnosisTextLED;function ADiagnosisDoubleText(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisDoubleText"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisDoubleText"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisDoubleText"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.text=this.text2=null,ADiagnosisElement.call(this,{data:b})}ADiagnosisDoubleText.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisDoubleText.prototype.constructor=ADiagnosisDoubleText,ADiagnosisDoubleText.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID();void 0!==this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&(this.plctag=""===this.data.VisibleOPCID?"":this.plc+"."+this.data.OPCID);var d=this.positionClass[this.data.Position];(this.panel=$("<div class='"+d.css+"' id='"+a+"'><div class='DiagnosisDoubleTextDiv' id='"+c+"'>"+this.data.Text2+"</div><div class='DiagnosisDoubleTextDiv' id='"+b+"'>"+this.data.Text+"</div></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b),this.text2=document.getElementById(c),""!==this.plctag&&emosWS.advise(this.plctag,function(a){try{var b=GetAsBoolean(a.value);this.text.style.visibility=b?"visible":"hidden",this.text2.style.visibility=b?"visible":"hidden"}catch(a){console.log("DiagnosisDoubleText datachangeListener failed: "+a)}}.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this)),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID2,"name",function(a){""!==a.value&&(this.text2.textContent=a.value)}.bind(this))}catch(a){console.log("DiagnosisDoubleText init failed: "+a)}},emosWS.ADiagnosisDoubleText=ADiagnosisDoubleText;function ADiagnosisString(a,b,c,d,e){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisString"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisString"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisString"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.callForString=!1,this.OPCID=this.data.OPCID,this.data.OPCID.replace(/^([^\[\]]*)((\[(.*))?\])?$/,function(a,b,c,d,e){this.OPCID=b,this.callForString=void 0!==c}.bind(this)),this.plctagVisible=this.textValue="",this.plctag=this.plc+"."+this.OPCID,this.text=null,this.textColor=this.writable?"blue":"black",this.strLen=parseInt(this.data.StrLen),this.strStart=parseInt(this.data.StrStart),ADiagnosisElement.call(this,{data:b,writable:d})}ADiagnosisString.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisString.prototype.constructor=ADiagnosisString,ADiagnosisString.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();void 0!==this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&(this.plctagVisible=""===this.data.VisibleOPCID?"":this.plc+"."+this.data.VisibleOPCID);var c=this.positionClass[this.data.Position];(this.panel=$("<div class='"+c.css+"' id='"+a+"'><input class='DiagnosisStringText' type='text' id='"+b+"' readonly></p></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b);var d=function(a,b){this.text.style["background-color"]="white",this.text.style.color=this.textColor,this.textValue=a,b&&(this.text.value=this.textValue)}.bind(this);if(this.callForString)for(var e=[],f="2"===this.diagnosisWindow.PLCType,g=0;g<this.strLen;g++)emosWS.advise(this.plctag+"["+(this.strStart+g)+"]",function(a,b){e[b]=f?String.fromCharCode(a.value):a.value,d(e.join(""),!0)}.bind(this),g);else emosWS.advise(this.plctag,function(a){""!==a.value&&(this.strStart&&this.strLen?this.text.value=a.value.substr(this.strStart-1,this.strLen):this.text.value=a.value,d(a.value))}.bind(this));this.writable&&(this.text.style.cursor="pointer",this.text.addEventListener("click",this.onClick.bind(this)))}catch(a){console.log("DiagnosisString init failed: "+a)}},ADiagnosisString.prototype.onClick=function(){ADiagnosisForm.open({value:this.textValue,unit:"",min:this.data.StrStart,max:this.data.StrLen,plctag:this.plctag,text:this.textValue,type:AvalueTypes.String})},ADiagnosisString.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.text.style.cursor="pointer",this.text.style.pointerEvents="auto",this.text.style.color=this.textColor="blue"):(this.text.style.cursor="auto",this.text.style.pointerEvents="none",this.text.style.color=this.textColor="black")},emosWS.ADiagnosisString=ADiagnosisString;function ADiagnosisStringField(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisString"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisString"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisString"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.text=null,this.textValue="",ADiagnosisElement.call(this,{data:b})}ADiagnosisStringField.prototype=Object.create(ADiagnosisElement.prototype),ADiagnosisStringField.prototype.constructor=ADiagnosisStringField,ADiagnosisStringField.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=this.positionClass[this.data.Position];(this.panel=$("<div class='"+c.css+"' id='"+a+"'><textarea class='DiagnosisStringFieldTextArea' rows='4' id='"+b+"' readonly></p></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b),emosWS.advise(this.plctag,function(a){""!==a.value&&(this.text.value=a.value,this.text.style["background-color"]="white",this.textValue=a.value)}.bind(this))}catch(a){console.log("DiagnosisString init failed: "+a)}},emosWS.DiagnosisStringField=ADiagnosisStringField;function ADiagnosisChildWindow(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisText"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisText"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLong"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.dataText=""===this.data.Text?".":this.data.Text,this.plctag="",this.text="",this.init()}ADiagnosisChildWindow.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=this.data.Name+" "+this.data.Comment+" - ",d="TextID: "+this.data.TextID;$("<div class='DiagnosisGerneralElement'><svg id='"+a+"' width='100%' height='20'><rect width='100%' height='20' style='fill:white;stroke-width:1;stroke:grey' /><text id='"+b+"' x='5' y='15' fill='black'>"+c+d+"</text></svg></div>").appendTo(this.parentDiv),this.text=document.getElementById(b),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=c+a.value)}.bind(this),this),new emosWS.ESDiagnosisWindow({conditionFunction:function(){return{DiagnosisLibID:this.diagnosisWindow.DiagnosisLibID,PLC:this.diagnosisWindow.PLC,ID:this.diagnosisWindow.ID+this.data.OPCID,DiagnosisControl:this.data.Name,GroupRightIndex:this.diagnosisWindow.GroupRightIndex,Enabled:!0}}.bind(this),PLACEHOLDER_USEHAND:!0,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USEHIDE:!1,STDPLACEHOLDER_SHAPENAME:a,svgTarget:a})}catch(a){console.log("DiagnosisChildWindow init failed: "+a)}},emosWS.ADiagnosisChildWindow=ADiagnosisChildWindow;function ADiagnosisWindow(a){this.conditionFunction=a.conditionFunction,this.condition=!1,this.useHand=a.PLACEHOLDER_USEHAND,this.useStroke=a.PLACEHOLDER_USESTROKE,this.useHide=a.PLACEHOLDER_USEHIDE,this.target=a.STDPLACEHOLDER_SHAPENAME,this.svgTarget=a.svgTarget,this.DiagnosisLibID=null,this.PLC=null,this.ID=null,this.DiagnosisControl=null,this.childWindows=null,this.childWindowsData={},this.appendedChildData=!1,this.GroupRightIndex=null,this.Enabled=null,this.divTypes={None:0,LRLeft:1,LRRight:2,Long:3,LMRLeft:4,LMRMiddle:5,LMRRight:6},this.dataTypes={Integer:0,Real:1},this.windowData=null,this.qualityGood=!1,this.badQualityTagList={},this.winName="",this.OPCVersionID="",this.OPCVersion="",this.versionList=[],this.rootVersion=null,this.plcVersion="",this.shape=getSVGElement(this.target),this.fill=null,this.fillHighLight="rgb(255, 255, 26)",this.rid=null,this.textPrefixList={1:"T01_",3:"T03_",5:"T05_"},this.PLCType=null,this.initialize()}ADiagnosisWindow.prototype.updateTagList=function(a){void 0!==a&&(emosWS.hasQualityGood(a)?void 0!==this.badQualityTagList[a.tag]&&delete this.badQualityTagList[a.tag]:this.badQualityTagList[a.tag]=0,this.qualityGood=0===Object.keys(this.badQualityTagList).length)},ADiagnosisWindow.prototype.getTextPrefix=function(){return this.textPrefixList[this.DiagnosisLibID]},ADiagnosisWindow.prototype.datachangeListener=function(a,b){},ADiagnosisWindow.prototype.appendWindow=function(a){try{this.appendChildData();var b=this,c=$("<div class='DiagnosisWindow' id='"+a+"'><div class='DiagnosisHeadOld'></div><div class='DiagnosisBodyOld'></div></div>"),d="Name: \t"+this.winName+"\nXML: \t"+this.rootVersion.replace(/(..)-(..)/,"__  $1 $2")+"\nPLC: \t"+this.plcVersion.replace(/(.)(..)(..)/,"0$1 $2 $3"),e='<a href="#" title="'+d+'" class="myDialogBtn"><span class="ui-icon ui-icon-alert"></span></a>';$("body").append(c);var f=$("#"+a).dialog({title:this.winName+" : "+this.PLC+this.ID,width:480,height:400,resizable:!0,close:function(a,c){$(this).dialog("destroy").remove(),b.terminate()},create:function(){$(this).prev(".ui-dialog-titlebar").find(".ui-dialog-title").after(e)},resize:function(){emosWS.attr.svgobject&&(emosWS.attr.svgobject.style["pointer-events"]="none")}}).mouseleave(function(){emosWS.attr.svgobject&&(emosWS.attr.svgobject.style["pointer-events"]="auto")}),g=f.find("div");this.appendHead(g[0]),this.appendBody(g[1])}catch(a){console.log("appendWindow failed: "+a)}},ADiagnosisWindow.prototype.appendHead=function(a){try{var b=this.windowData.Head;for(var c in b){var d=b[c];if("object"==typeof d){switch(ADiagnosisCommon.getObjectType(c)){case"TopTextLED":new ATopTextLED(a,d,this.PLC+this.ID,this)}}}}catch(a){console.log("appendHead failed: "+a)}},ADiagnosisWindow.prototype.appendBody=function(a){this.appendPageControl(a,this.windowData.PageControl)},ADiagnosisWindow.prototype.appendPageControl=function(a,b){try{new APageControl(a,b,this)}catch(a){console.log("appendPageControl failed: "+a)}},ADiagnosisWindow.prototype.appendPage=function(a,b,c,d,e,f){try{var a=a,b=b,d=d;a.LRLeft=null,a.LRRight=null,a.LRLong=null,a.LMRLeft=null,a.LMRMiddle=null,a.LMRRight=null,a.getDiv=function(b){switch(b){case this.divTypes.LRLeft:if(!a.LRLeft){var c=getElementGlobalID(),d=$("<div class='DiagnosisLRLeft' id='"+c+"'></div>");d.appendTo(a),a.LRLeft=document.getElementById(c),a.LRLong=null}return a.LRLeft;case this.divTypes.LRRight:if(!a.LRRight){var e=getElementGlobalID(),d=$("<div class='DiagnosisLRRight' id='"+e+"'></div>");d.appendTo(a),a.LRRight=document.getElementById(e),a.LRLong=null}return a.LRRight;case this.divTypes.Long:if(!a.LRLong){var f=getElementGlobalID(),d=$("<div class='DiagnosisLong' id='"+f+"'></div>");d.appendTo(a),a.LRLong=document.getElementById(f),a.LRLeft=null,a.LRRight=null,a.LMRLeft=null,a.LMRMiddle=null,a.LMRRight=null}return a.LRLong;case this.divTypes.LMRLeft:if(!a.LMRLeft){var g=getElementGlobalID(),d=$("<div class='DiagnosisLMRLeft' id='"+g+"'></div>");d.appendTo(a),a.LMRLeft=document.getElementById(g),a.LRLong=null}return a.LMRLeft;case this.divTypes.LMRMiddle:if(!a.LMRMiddle){var h=getElementGlobalID(),d=$("<div class='DiagnosisLMRMiddle' id='"+h+"'></div>");d.appendTo(a),a.LMRMiddle=document.getElementById(h),a.LRLong=null}return a.LMRMiddle;case this.divTypes.LMRRight:if(!a.LMRRight){var i=getElementGlobalID(),d=$("<div class='DiagnosisLMRRight' id='"+i+"'></div>");d.appendTo(a),a.LMRRight=document.getElementById(i),a.LRLong=null}return a.LMRRight;default:return null}}.bind(this);var g=function(){emosWS.login.au.hasPaintShopRight(d)?a.get(0).style.display="block":a.get(0).style.display="none"};sortHashArray(b).forEach(function(d){var e=b[d];if("object"==typeof e){var f=ADiagnosisCommon.getObjectType(d);switch(f){case"AlarmClient":new AAlarmClient(a,e,this.PLC+this.ID,c);break;case"AddText":new ADiagnosisText(a,e,this.PLC+this.ID,this);break;case"AddString":new ADiagnosisString(a,e,this.PLC+this.ID,!1,this);break;case"AddStringInput":new ADiagnosisString(a,e,this.PLC+this.ID,!0,this);break;case"AddStringLong":e.Position="Long",new ADiagnosisString(a,e,this.PLC+this.ID,!1,this);break;case"AddStringInputLong":e.Position="Long",new ADiagnosisString(a,e,this.PLC+this.ID,!0,this);break;case"AddStringFieldLong":e.Position="Long",new ADiagnosisStringField(a,e,this.PLC+this.ID,this);break;case"AddTextLong":case"AddHeadLine":e.Position="Long",new ADiagnosisText(a,e,this.PLC+this.ID,this);break;case"AddTextLED":new ADiagnosisTextLED(a,e,this.PLC+this.ID,!1,this);break;case"AddTextLEDLong":e.Position="Long",new ADiagnosisTextLED(a,e,this.PLC+this.ID,!1,this);break;case"AddTextInputLED":new ADiagnosisTextLED(a,e,this.PLC+this.ID,!0,this);break;case"AddTextLEDInputLong":e.Position="Long",new ADiagnosisTextLED(a,e,this.PLC+this.ID,!0,this);break;case"AddTextLEDNiveau":new ADiagnosisTextLED(a,e,this.PLC+this.ID,!1,this);break;case"AddTextInteger":case"AddTextReal":new ADiagnosisTextNumber(a,e,this.PLC+this.ID,!1,this);break;case"AddTextIntegerLong":case"AddTextRealLong":e.Position="Long",new ADiagnosisTextNumber(a,e,this.PLC+this.ID,!1,this);break;case"AddTextIntegerInput":case"AddTextRealInput":case"AddTextRealInputNiveau":new ADiagnosisTextNumber(a,e,this.PLC+this.ID,!0,this);break;case"AddTextIntegerInputLong":case"AddTextRealInputLong":e.Position="Long",new ADiagnosisTextNumber(a,e,this.PLC+this.ID,!0,this);break;case"AddTextIntegerIntegerLong":e.Position="Long",new ADiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Integer,!1,this);break;case"AddTextRealRealLong":e.Position="Long",new ADiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Real,!1,this);break;case"AddTextIntegerIntegerInputLong":e.Position="Long",new ADiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Integer,!0,this);break;case"AddTextRealRealInputLong":e.Position="Long",new ADiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Real,!0,this);break;case"AddLEDTextIntegerLong":case"AddTextLEDIntegerLong":case"AddLEDTextRealLong":e.Position="Long",new ADiagnosisLedTextNumber(a,e,this.PLC+this.ID,!1,this);break;case"AddLEDTextIntegerInputLong":case"AddTextLEDIntegerInputLong":case"AddLEDTextRealInputLong":e.Position="Long",new ADiagnosisLedTextNumber(a,e,this.PLC+this.ID,!0,this);break;case"AddLEDTextRealRealLong":e.Position="Long",new ADiagnosisLedTextNumberNumber(a,e,this.PLC+this.ID,!1,this);break;case"AddLEDTextRealRealInputLong":e.Position="Long",new ADiagnosisLedTextNumberNumber(a,e,this.PLC+this.ID,!0,this);break;case"AddSpace":new ADiagnosisSpace(a,e);break;case"AddSpaceLong":e.Position="Long",new ADiagnosisSpace(a,e);break;case"AddBar":new ADiagnosisBar(a,e,this.PLC+this.ID,this);break;case"AddBitBar":new ADiagnosisBitBar(a,e,this.PLC+this.ID,this);break;case"CreateControlNetArray":e.Position="Long",new ADiagnosisControlNetArray(a,e,this.PLC+this.ID,this);break;case"AddBrowserPage":e.Position="Long",new ADiagnosisBrowserPage(a,e,this.PLC+this.ID,this);break;case"AddSetpointBar":new ADiagnosisSetpointBar(a,e,this.PLC+this.ID,this);break;case"AddSetpointRampBar":e.Position="M",new ADiagnosisSetpointRampBar(a,e,this.PLC+this.ID,this);break;case"AddPageControl":new APageControl(a,e,this);break;case"AddDoubleTextLong":e.Position="Long",new ADiagnosisDoubleText(a,e,this.PLC+this.ID,this);break;case"AddTextTimerLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.Second,!1,this);break;case"AddTextTimerInputLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.Second,!0,this);break;case"AddTextSiemensDateLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensDate,!1,this);break;case"AddTextSiemensDateInputLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensDate,!0,this);break;case"AddTextSiemensTimeLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensTimeOfDay,!1,this);break;case"AddTextSiemensTimeInputLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensTimeOfDay,!0,this);break;case"AddTextSiemens_TIME_TimerLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensTime,!1,this);break;case"AddTextSiemens_TIME_TimerInputLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensTime,!0,this);break;case"AddTextSiemens_S5TIME_TimerLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensS5Time,!1,this);break;case"AddTextSiemens_S5TIME_TimerInputLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensS5Time,!0,this);break;case"AddTextSiemens_DATE_AND_TIME_TimerLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensDateAndTime,!1,this);break;case"AddTextSiemens_DATE_AND_TIME_TimerInputLong":e.Position="Long",new ADiagnosisTextTimer(a,e,this.PLC+this.ID,AtimerTypes.SiemensDateAndTime,!0,this);break;case"AddTextDoubleTimerLong":e.Position="Long",new ADiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!0,!1,this);break;case"AddTextDoubleTimerInputLong":e.Position="Long",new ADiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!0,!0,this);break;case"AddTextDoubleTimerLongMin":e.Position="Long",new ADiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!1,!1,this);break;case"AddTextDoubleTimerInputLongMin":e.Position="Long",new ADiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!1,!0,this);break;case"AddChildWindow":e.Position="Long",new ADiagnosisChildWindow(a,e,this.PLC+this.ID,this);break;default:new AGeneralElement(a,{Text:f},this)}}}.bind(this)),g(),emosWS.addEventListener("UserRight",g)}catch(a){console.log("appendPage failed: "+a)}},ADiagnosisWindow.prototype.appendElement=function(a,b){try{var c=getElementGlobalID(),d=$("<div id='"+c+"'><ul></ul></div>");d.appendTo(a);var e=d.tabs(),f=e.find("ul");sortHashArray(b).forEach(function(a){if("object"==typeof b[a]){console.info("[appendElement] "+a);var d=c+a;$("<li><a href='#"+d+"'>"+d+"</a></li>").appendTo(f);var g=$("<div id='"+d+"'></div>");g.appendTo(e),this.appendElement(g,b[a])}else $("<p>"+a+" = "+b[a]+"</p>").appendTo(e)}.bind(this)),e.tabs("refresh")}catch(a){console.log("appendElement failed: "+a)}},ADiagnosisWindow.prototype.getNewJSON=function(a){try{var b=a,c=[],d={},e={type:"DiagnosisWindow",params:d,elements:c};for(var f in b){var g=!1,h=null,i=b[f];"object"==typeof i&&(b[f]=i=this.getNewJSON(i)),["Head","PageControl"].indexOf(f)>-1?(g=!0,h=f):f.replace(/\d*-(.*)/,function(a,b){g=!0,h=b}),g?(i.type=h,c.push(i)):d[f]=i}return e}catch(a){console.log("convertToNewJSON failed: "+a)}},ADiagnosisWindow.prototype.createDiagnosisWindow=function(){try{if(this.windowData){var a=getElementGlobalID();this.appendWindow(a)}}catch(a){console.log("createDiagnosisWindow failed: "+a)}},ADiagnosisWindow.prototype.informParent=function(){var a=(new Date).getUTCMilliseconds()+"";this.rid=a,emosWS.attr.diagnosisMap[a]=this,emosWS.informParent({type:"OpenDiagnosisWindow",id:a,PLC:this.PLC,Tag:this.ID,DiagnosisLibID:this.DiagnosisLibID,DiagnosisControl:this.DiagnosisControl,GroupRightIndex:this.GroupRightIndex,testURL:this.testURL,data:{childWindows:this.childWindows,childWindowsData:this.childWindowsData,windowData:this.windowData,winName:this.winName}})},ADiagnosisWindow.prototype.animate=function(){},ADiagnosisWindow.prototype.getTag=function(){return this.DiagnosisLibID+"::Name::"+this.DiagnosisControl},ADiagnosisWindow.prototype.getTagByCode=function(a){var b=this.DiagnosisLibID+"::Code::";return a.replace(/([a-zA-Z]*)/,function(a,c){b+=c}),b},ADiagnosisWindow.prototype.adviseDiagnosisData=function(a,b){try{if(this.DiagnosisControl.indexOf("null")>-1)return;if(this.setDiagnosisControl0(a),1===emosWS.attr.DiagnosisWindowMode)return;if(this.adviseChildWindows(),-1===[1,3,5].indexOf(parseInt(this.DiagnosisLibID))&&b)return void b();emosWS.advise(this.getTag(),function(c){this.winName=this.DiagnosisControl,this.windowData=c.value,this.rootVersion=this.windowData.Version,this.setDiagnosisControl0(a),b&&setTimeout(function(){b()},100),emosWS.advise(this.PLC+this.ID+"."+this.windowData.OPCVersionID,function(c){var d=c.value;this.plcVersion=d,this.PLCType=d.replace(/(.)..../,"$1"),d.replace(/.(\d\d)../,function(c,d){var e="."+d;emosWS.advise(this.getTag()+e,function(c){"EMOSDEFAULT"!==c.value.OPCVersionID&&(this.windowData=c.value,this.winName=this.windowData.Name,this.rootVersion=this.windowData.Version,this.setDiagnosisControl0(a)),b&&b()}.bind(this),"",emosWS.tagType.Diagnosis)}.bind(this))}.bind(this),"")}.bind(this),"",emosWS.tagType.Diagnosis)}catch(a){console.log("ADiagnosisWindow adviseDiagnosisData failed: "+a)}},ADiagnosisWindow.prototype.doCondition=function(){try{var a=this.conditionFunction();this.DiagnosisLibID=a.DiagnosisLibID,this.PLC=a.PLC,this.ID=a.ID,this.DiagnosisControl=a.DiagnosisControl,this.GroupRightIndex=a.GroupRightIndex,this.Enabled=a.Enabled,this.adviseDiagnosisData(a.DiagnosisControl)}catch(a){console.log("ADiagnosisWindow doCondition failed: "+a)}},ADiagnosisWindow.prototype.setDiagnosisControl0=function(a){try{a.match(/.htm/)||void 0===a||a.replace(/(\w*)([,;.:].+)?/,function(a,b,c){this.DiagnosisControl=b;var d=[];c&&c.replace(/([,;.:])(([a-zA-Z\d]+)(=([^,;.:]+))?)/g,function(a,b,c,e,f,g){if(c&&e)switch(b){case".":g?d.push(c):d=d.concat(e.match(/([a-zA-Z]+\d*)/g));break;case":":c="."+c;default:d.push(c)}}),d.length>0&&(this.childWindows=d)}.bind(this))}catch(a){console.log("ADiagnosisWindow setDiagnosisControl failed: "+a)}},ADiagnosisWindow.prototype.adviseChildWindows=function(){try{this.childWindows&&this.childWindows.forEach(function(a){var b=a,c=null,d=!1,e=a.replace(/([.])?([a-zA-Z\d]+)(=(.+))?/g,function(a,e,f,g,h){return c=h,b=h||f,d=!!e,(e||"")+f}),f=d?null:this.ID.substr(1)+e,g=function(c){if(d){if(-1!==c.indexOf("_"))emosWS.advise(this.PLC+this.ID+"."+b+".GP."+c,function(b){this.childWindowsData[a].TextID="G"+b.value}.bind(this),"",emosWS.tagType.IO);else{var e={1:"3",3:"6",5:"7"},f=e[this.DiagnosisLibID]||"7";c.replace(/FU(\d+)/i,function(c,d){emosWS.advise(this.PLC+this.ID+"."+b+".GP.E"+f+d+"_FB",function(b){this.childWindowsData[a].TextID="E"+b.value}.bind(this),"",emosWS.tagType.IO)}.bind(this))}}}.bind(this);c&&(this.childWindowsData[a]={OPCID:e,Name:c,Comment:a,TextID:f},d&&g(c)),emosWS.advise(this.getTagByCode(b),function(b){var c=b.value;this.childWindowsData[a]={OPCID:e,Name:c.Name,Comment:c.Comment,TextID:f},d&&g(c.Name)}.bind(this),"",emosWS.tagType.Diagnosis)}.bind(this))}catch(a){console.log("ADiagnosisWindow adviseChildWindows failed: "+a)}},ADiagnosisWindow.prototype.appendChildData=function(){try{if(this.childWindows&&this.childWindows.length>0&&this.windowData&&!this.appendedChildData){var a=1e3,b=this.windowData.PageControl[a+++"-AddPageTab"]={Text:"Options",TextID:"Options"};this.childWindows.forEach(function(c){b[a+++"-AddChildWindow"]=this.childWindowsData[c]}.bind(this)),this.appendedChildData=!0}}catch(a){console.log("ADiagnosisWindow adviseChildWindows failed: "+a)}},ADiagnosisWindow.prototype.startAnimate=function(){try{setEvent(this.target,"click",this.onClick.bind(this),"pointer",this.svgTarget)}catch(a){console.log("startAnimate failed: "+a)}},ADiagnosisWindow.prototype.onClick=function(){try{this.doCondition();var a=this;this.Enabled&&([1,2].indexOf(emosWS.attr.DiagnosisWindowMode)>-1&&setTimeout(function(){a.informParent()},300),[0,2].indexOf(emosWS.attr.DiagnosisWindowMode)>-1&&setTimeout(function(){a.createDiagnosisWindow()},a.windowData?0:300))}catch(a){console.log("ADiagnosisWindow onClick failed: "+a)}},ADiagnosisWindow.prototype.initialize=function(){try{this.doCondition(),this.startAnimate()}catch(a){console.log("ADiagnosisWindow initialize failed: "+a)}},ADiagnosisWindow.prototype.highlight=function(){this.shape.style.fill!==this.fillHighLight&&(this.fill=this.shape.style.fill),this.shape.style.fill=this.fillHighLight},ADiagnosisWindow.prototype.unhighlight=function(){this.shape.style.fill===this.fillHighLight&&(this.shape.style.fill=this.fill)},ADiagnosisWindow.prototype.terminate=function(){},emosWS.ESDiagnosisWindow=ADiagnosisWindow;function LanguageText(a){emosWS.textNumber++,this.textID=a.textID,this.target=a.target,this.initialize(),emosWS.dispatchEvent({type:"HMItext"})}LanguageText.prototype.datachangeListener=function(a){try{setText(this.target,a.value)}catch(a){console.log("datachangeListener failed: "+a)}},LanguageText.prototype.initialize=function(){getSVGElement(this.target)||(this.target+=".Text");var a=this;emosWS.sendAdviseText(this.textID,"name",function(b){a.datachangeListener(b)})},window.LanguageText=LanguageText,emosWS.LanguageText=LanguageText;var ALink=function(a){emosWS.linkNumber++,emosWS.links.push(this);var b=a.page,c=a.shape;this.page=b,setEvent(c,"click",function(){loadHREF(b,"")},"pointer"),emosWS.dispatchEvent({type:"HMIlink"})};window.ALink=ALink,emosWS.ESLink=ALink;var ALinkFrame=function(a){var b=a.page,c=a.target,d=a.shape;setEvent(d,"click",function(){loadHREF(b,c)},"pointer")};window.ALinkFrame=ALinkFrame,emosWS.ESLinkFrame=ALinkFrame;var ALinkDialog=function(a){var b=a.page,c=a.target,d=a.shape;setEvent(d,"click",e,"pointer");function e(){privateCallback=f,c()}function f(a,c,d,e){var f=g(d);switch(a){case"window":window.open(b,c,f,e);break;case"modeless":i(b,c,!1,f);break;case"modal":i(b,c,!0,f)}}function g(a){var b={dialogHeight:["height","string"],dialogWidth:["width","string"],resizable:["resizable","boolean"],dialogHide:["hide","boolean"]};if(a&&""!==a){var c=a.replace(/ |px/g,"").split(";");a={},c.forEach(function(c){var d=c.split(":");if(2===d.length){var e=d[0],f=d[1],g=b[e];g&&(a[g[0]]="boolean"===g[1]?h(f):f)}})}return a}function h(a){return["yes","on","1"].indexOf(a)>-1}function i(a,b,c,d){var e=(new Date).getUTCMilliseconds(),f=$("<div id='"+e+"'> <iframe style='position:absolute; top:0px; left:0px; width:100%; height:100%; overflow:hidden; background-color: #EEE;border: 0px;display: block; scrolling:no;' src='"+a+"'> </iframe></div>");$("body").append(f);var g={modal:c,title:b};for(var h in d)g[h]=d[h];$("#"+e).dialog(g)}};window.ALinkDialog=ALinkDialog,emosWS.ESLinkDialog=ALinkDialog;var ALinkJavaScript=function(a){var b=a.javascript,c=a.shape;setEvent(c,"click",b,"pointer")};window.ALinkJavaScript=ALinkJavaScript,emosWS.ESLinkJavaScript=ALinkJavaScript;var JSMouseOver=function(a){};emosWS.JSMouseOver=JSMouseOver;var JSMouseMove=function(a){var b=a.PLACEHOLDER_MOUSEOVER,c=a.PLACEHOLDER_MOUSEOUT,d=a.PLACEHOLDER_USEMOUSEOVER,e=a.PLACEHOLDER_USEMOUSEOUT,f=a.PLACEHOLDER_USEMOUSEOUT,g=a.shape;d&&setEvent(g,"mouseover",b,"default"),e&&setEvent(g,"mouseout",c,"default")};emosWS.JSMouseMove=JSMouseMove;function JSDiagnosisWindow(a){var b=a.conditionFunction();new ADiagnosisWindow({conditionFunction:function(){return{DiagnosisLibID:a.PLACEHOLDER_DLLID,PLC:b.PLC,ID:b.ID,DiagnosisControl:b.DCONTROL,GroupRightIndex:a.PLACEHOLDER_GROUPRF,Enabled:!0}},PLACEHOLDER_USEHAND:!0,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USEHIDE:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSDiagnosisWindow=JSDiagnosisWindow;function JSMouseClick(a){this.onMouseClick=a.PLACEHOLDER_MOUSECLICK,this.enableCondition=a.PLACEHOLDER_ENABLECONDITION,this.useEnable=a.PLACEHOLDER_USEENABLECONDITION,this.resolveGroup=a.PLACEHOLDER_RESOLVEGROUP,this.target=a.shape,this.enabled=!0,ESAnimation.call(this)}JSMouseClick.prototype=Object.create(ESAnimation.prototype),JSMouseClick.prototype.constructor=JSMouseClick,JSMouseClick.prototype.mouseClickFunction=function(a,b){try{this.onMouseClick(a,b)}catch(a){console.error(a)}},JSMouseClick.prototype.enableConditionFunction=function(a,b){try{return this.enableCondition(a,b)}catch(a){return console.error("[JSMouseClick enableConditionFunction] : "+a),!1}},JSMouseClick.prototype.initializeMore=function(){if(this.useEnable){var a=emosWS.shapes[this.target];this.enabled=a?this.enableConditionFunction(a,[a]):this.enableConditionFunction(null,[null])}if(this.enabled){var a=emosWS.shapes[this.target];a?a.addJob(this.mouseClickFunction.bind(this,a,[a]),!0,!0):setEvent(this.target,"click",this.mouseClickFunction.bind(this),"pointer")}emosWS.animationData.stillInit=!1},emosWS.JSMouseClick=JSMouseClick;function JSDynamicText(a){new ADynamicText({conditionFunction:function(){return{Text:a.conditionFunction(),Enabled:!0}},PLACEHOLDER_SWAP_USEQUALITY:!0,PLACEHOLDER_STROKECOLORQUALITYGOOD:"#000000",PLACEHOLDER_STROKECOLORQUALITYBAD:"#FF8000",PREFIX:a.PLACEHOLDER_PREFIX,SUFFIX:a.PLACEHOLDER_SUFFIX,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSDynamicText=JSDynamicText;function JSColorSwap(a){new AColorSwap({conditionFunction:a.conditionFunction,PLACEHOLDER_SWAP_FILLCOLOR:a.PLACEHOLDER_SWAP_FILLCOLOR,PLACEHOLDER_SWAP_STROKECOLOR:a.PLACEHOLDER_SWAP_STROKECOLOR,PLACEHOLDER_SWAP_VISIBILITY:a.PLACEHOLDER_SWAP_VISIBILITY,PLACEHOLDER_SWAP_USETRUE:!0,PLACEHOLDER_SWAP_USEFALSE:a.PLACEHOLDER_SWAP_USEELSE,PLACEHOLDER_SWAP_USEQUALITY:!1,PLACEHOLDER_FILLCOLOR:a.PLACEHOLDER_FILLCOLOR,PLACEHOLDER_FILLCOLORFALSE:a.PLACEHOLDER_FILLCOLORELSE,PLACEHOLDER_STROKECOLORQUALITYGOOD:"",PLACEHOLDER_STROKECOLORQUALITYBAD:"",PLACEHOLDER_STROKECOLOR:a.PLACEHOLDER_STROKECOLOR,PLACEHOLDER_STROKECOLORFALSE:a.PLACEHOLDER_STROKECOLORELSE,PLACEHOLDER_VISIBILITY:a.PLACEHOLDER_VISIBILITY,PLACEHOLDER_VISIBILITYFALSE:a.PLACEHOLDER_VISIBILITYELSE,PLACEHOLDER_SWAP_HIDEIFQUALITYBAD:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSColorSwap=JSColorSwap;function JSColorRange(a){new AColorState({conditionFunction:a.conditionFunction,PLACEHOLDER_USEFILLCOLOR:a.PLACEHOLDER_SWAP_FILLCOLOR,PLACEHOLDER_FILLCOLOR1:a.PLACEHOLDER_FILLCOLOR1,PLACEHOLDER_FILLCOLOR2:a.PLACEHOLDER_FILLCOLOR2,PLACEHOLDER_FILLCOLOR3:a.PLACEHOLDER_FILLCOLOR3,PLACEHOLDER_FILLCOLOR4:a.PLACEHOLDER_FILLCOLOR4,PLACEHOLDER_FILLCOLOR5:a.PLACEHOLDER_FILLCOLOR5,PLACEHOLDER_FILLCOLOR6:a.PLACEHOLDER_FILLCOLOR5,PLACEHOLDER_FILLCOLOR7:a.PLACEHOLDER_FILLCOLOR5,PLACEHOLDER_FILLCOLOR8:a.PLACEHOLDER_FILLCOLOR5,PLACEHOLDER_USESTROKECOLOR:a.PLACEHOLDER_SWAP_STROKECOLOR,PLACEHOLDER_STROKECOLOR1:a.PLACEHOLDER_STROKECOLOR1,PLACEHOLDER_STROKECOLOR2:a.PLACEHOLDER_STROKECOLOR2,PLACEHOLDER_STROKECOLOR3:a.PLACEHOLDER_STROKECOLOR3,PLACEHOLDER_STROKECOLOR4:a.PLACEHOLDER_STROKECOLOR4,PLACEHOLDER_STROKECOLOR5:a.PLACEHOLDER_STROKECOLOR5,PLACEHOLDER_STROKECOLOR6:a.PLACEHOLDER_STROKECOLOR5,PLACEHOLDER_STROKECOLOR7:a.PLACEHOLDER_STROKECOLOR5,PLACEHOLDER_STROKECOLOR8:a.PLACEHOLDER_STROKECOLOR5,PLACEHOLDER_USEVISIBILITY:a.PLACEHOLDER_SWAP_VISIBILITY,PLACEHOLDER_VISIBILITY1:getVisibility(a.PLACEHOLDER_VISIBILITY1),PLACEHOLDER_VISIBILITY2:getVisibility(a.PLACEHOLDER_VISIBILITY2),PLACEHOLDER_VISIBILITY3:getVisibility(a.PLACEHOLDER_VISIBILITY3),PLACEHOLDER_VISIBILITY4:getVisibility(a.PLACEHOLDER_VISIBILITY4),PLACEHOLDER_VISIBILITY5:getVisibility(a.PLACEHOLDER_VISIBILITY5),PLACEHOLDER_VISIBILITY6:getVisibility(a.PLACEHOLDER_VISIBILITY5),PLACEHOLDER_VISIBILITY7:getVisibility(a.PLACEHOLDER_VISIBILITY5),PLACEHOLDER_VISIBILITY8:getVisibility(a.PLACEHOLDER_VISIBILITY5),PLACEHOLDER_LIMIT12:a.PLACEHOLDER_LIMIT12,PLACEHOLDER_LIMIT23:a.PLACEHOLDER_LIMIT23,PLACEHOLDER_LIMIT34:a.PLACEHOLDER_LIMIT34,PLACEHOLDER_LIMIT45:a.PLACEHOLDER_LIMIT45,PLACEHOLDER_LIMIT56:a.PLACEHOLDER_LIMIT45,PLACEHOLDER_LIMIT67:a.PLACEHOLDER_LIMIT45,PLACEHOLDER_LIMIT78:a.PLACEHOLDER_LIMIT45,PLACEHOLDER_USEQUALITY:!1,PLACEHOLDER_STROKECOLORQUALITYGOOD:"#000000",PLACEHOLDER_STROKECOLORQUALITYBAD:"#FF8000",STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSColorRange=JSColorRange;function JSIOPosition(a){var b=a.conditionFunction();new emosWS.ESPosition({conditionFunction:function(){var a=GetTagValueAsDouble(b.TAGNAME),c=b.VALUEMIN,d=b.VALUEMAX;return{Value:a,ValueMin:c,ValueMax:d,ValueLimitMin:c,ValueLimitMax:d,PositionMin:b.POSITIONMIN,PositionMax:b.POSITIONMAX,Enabled:!0}},postFunction:function(){},PLACEHOLDER_ORIENTATION:b.HORIZONTAL?"Left":"Top",PLACEHOLDER_ORIENTATIONR:b.HORIZONTAL?"Right":"Bottom",PLACEHOLDER_ORIENTATIONFLAG:"X",PLACEHOLDER_EXPANSION:b.HORIZONTAL?"Width":"Height",PLACEHOLDER_SWAP_USEQUALITY:!1,PLACEHOLDER_STROKECOLORQUALITYGOOD:"#000000",PLACEHOLDER_STROKECOLORQUALITYBAD:"#FF8000",PLACEHOLDER_HIDEIFVALUEEXCESSIVE:!1,PLACEHOLDER_COMMENT_X:"",PLACEHOLDER_COMMENT_Y:"//",STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOPosition=JSIOPosition;function JSAPTValveState(a){new AColorSwap({conditionFunction:function(){return a.conditionFunction().VALVESTATE},PLACEHOLDER_SWAP_FILLCOLOR:!0,PLACEHOLDER_SWAP_STROKECOLOR:!1,PLACEHOLDER_SWAP_VISIBILITY:!1,PLACEHOLDER_SWAP_USETRUE:!0,PLACEHOLDER_SWAP_USEFALSE:!0,PLACEHOLDER_SWAP_USEQUALITY:!1,PLACEHOLDER_FILLCOLOR:a.PLACEHOLDER_VALVECOLOR,PLACEHOLDER_FILLCOLORFALSE:a.PLACEHOLDER_VALVECOLORELSE,PLACEHOLDER_STROKECOLORQUALITYGOOD:"",PLACEHOLDER_STROKECOLORQUALITYBAD:"",PLACEHOLDER_STROKECOLOR:"",PLACEHOLDER_STROKECOLORFALSE:"",PLACEHOLDER_VISIBILITY:"",PLACEHOLDER_VISIBILITYFALSE:"",PLACEHOLDER_SWAP_HIDEIFQUALITYBAD:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSAPTValveState=JSAPTValveState;function JSAPTState(a){new AColorState({conditionFunction:a.conditionFunction,PLACEHOLDER_USEFILLCOLOR:!0,PLACEHOLDER_FILLCOLOR1:a.PLACEHOLDER_FILLCOLOR1,PLACEHOLDER_FILLCOLOR2:a.PLACEHOLDER_FILLCOLOR2,PLACEHOLDER_FILLCOLOR3:a.PLACEHOLDER_FILLCOLOR3,PLACEHOLDER_FILLCOLOR4:a.PLACEHOLDER_FILLCOLOR4,PLACEHOLDER_FILLCOLOR5:a.PLACEHOLDER_FILLCOLOR5,PLACEHOLDER_FILLCOLOR6:a.PLACEHOLDER_FILLCOLOR6,PLACEHOLDER_FILLCOLOR7:a.PLACEHOLDER_FILLCOLOR7,PLACEHOLDER_FILLCOLOR8:a.PLACEHOLDER_FILLCOLOR8,PLACEHOLDER_USESTROKECOLOR:!1,PLACEHOLDER_STROKECOLOR1:"",PLACEHOLDER_STROKECOLOR2:"",PLACEHOLDER_STROKECOLOR3:"",PLACEHOLDER_STROKECOLOR4:"",PLACEHOLDER_STROKECOLOR5:"",PLACEHOLDER_STROKECOLOR6:"",PLACEHOLDER_STROKECOLOR7:"",PLACEHOLDER_STROKECOLOR8:"",PLACEHOLDER_USEVISIBILITY:!0,PLACEHOLDER_VISIBILITY1:!0,PLACEHOLDER_VISIBILITY2:!0,PLACEHOLDER_VISIBILITY3:!0,PLACEHOLDER_VISIBILITY4:!0,PLACEHOLDER_VISIBILITY5:!0,PLACEHOLDER_VISIBILITY6:!0,PLACEHOLDER_VISIBILITY7:!0,PLACEHOLDER_VISIBILITY8:!0,PLACEHOLDER_LIMIT12:a.PLACEHOLDER_LIMIT12,PLACEHOLDER_LIMIT23:a.PLACEHOLDER_LIMIT23,PLACEHOLDER_LIMIT34:a.PLACEHOLDER_LIMIT34,PLACEHOLDER_LIMIT45:a.PLACEHOLDER_LIMIT45,PLACEHOLDER_LIMIT56:a.PLACEHOLDER_LIMIT56,PLACEHOLDER_LIMIT67:a.PLACEHOLDER_LIMIT67,PLACEHOLDER_LIMIT78:a.PLACEHOLDER_LIMIT78,PLACEHOLDER_USEQUALITY:!1,PLACEHOLDER_STROKECOLORQUALITYGOOD:"#000000",PLACEHOLDER_STROKECOLORQUALITYBAD:"#FF8000",STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSAPTState=JSAPTState;function JSIOBit(a){var b=a.conditionFunction();function c(){var c=GetTagValueAsBoolean(b);return""===a.PLACEHOLDER_TAGINVERTING?c:!c}a.PLACEHOLDER_BLINKACTIVE?new AColorBlink({conditionFunction:c,PLACEHOLDER_SWAP_FILLCOLOR:a.PLACEHOLDER_SWAP_FILLCOLOR,PLACEHOLDER_SWAP_STROKECOLOR:!1,PLACEHOLDER_SWAP_VISIBILITY:a.PLACEHOLDER_SWAP_VISIBILITY,PLACEHOLDER_SWAP_USEFALSE:!0,PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITYPROPERTY,PLACEHOLDER_FILLCOLORON:a.PLACEHOLDER_FILLCOLORON,PLACEHOLDER_FILLCOLOROFF:a.PLACEHOLDER_FILLCOLOROFF,PLACEHOLDER_FILLCOLORFALSE:a.PLACEHOLDER_FILLCOLORNOBLINK,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_QUALITYCOLORGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_QUALITYCOLORBAD,PLACEHOLDER_STROKECOLORON:"",PLACEHOLDER_STROKECOLOROFF:"",PLACEHOLDER_STROKECOLORFALSE:"",PLACEHOLDER_VISIBILITYON:getVisibility(a.PLACEHOLDER_VISIBILITYON),PLACEHOLDER_VISIBILITYOFF:getVisibility(a.PLACEHOLDER_VISIBILITYOFF),PLACEHOLDER_VISIBILITYFALSE:getVisibility(a.PLACEHOLDER_VISIBILITYNOBLINK),STDPLACEHOLDER_SHAPENAME:a.shape}):new AColorSwap({conditionFunction:c,PLACEHOLDER_SWAP_FILLCOLOR:a.PLACEHOLDER_SWAP_FILLCOLOR,PLACEHOLDER_SWAP_STROKECOLOR:!1,PLACEHOLDER_SWAP_VISIBILITY:a.PLACEHOLDER_SWAP_VISIBILITY,PLACEHOLDER_SWAP_USETRUE:!0,PLACEHOLDER_SWAP_USEFALSE:!0,PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITYPROPERTY,PLACEHOLDER_FILLCOLOR:a.PLACEHOLDER_FILLCOLORON,PLACEHOLDER_FILLCOLORFALSE:a.PLACEHOLDER_FILLCOLOROFF,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_QUALITYCOLORGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_QUALITYCOLORBAD,PLACEHOLDER_STROKECOLOR:"",PLACEHOLDER_STROKECOLORFALSE:"",PLACEHOLDER_VISIBILITY:getVisibility(a.PLACEHOLDER_VISIBILITYON),PLACEHOLDER_VISIBILITYFALSE:getVisibility(a.PLACEHOLDER_VISIBILITYOFF),PLACEHOLDER_SWAP_HIDEIFQUALITYBAD:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOBit=JSIOBit;function JSBlink(a){new AColorBlink({conditionFunction:a.conditionFunction,PLACEHOLDER_SWAP_FILLCOLOR:a.PLACEHOLDER_SWAP_FILLCOLOR,PLACEHOLDER_SWAP_STROKECOLOR:a.PLACEHOLDER_SWAP_STROKECOLOR,PLACEHOLDER_SWAP_VISIBILITY:a.PLACEHOLDER_SWAP_VISIBILITY,PLACEHOLDER_SWAP_USEFALSE:!0,PLACEHOLDER_SWAP_USEQUALITY:!1,PLACEHOLDER_FILLCOLORON:a.PLACEHOLDER_FILLCOLORON,PLACEHOLDER_FILLCOLOROFF:a.PLACEHOLDER_FILLCOLOROFF,PLACEHOLDER_FILLCOLORFALSE:a.PLACEHOLDER_FILLCOLORNOBLINK,PLACEHOLDER_STROKECOLORQUALITYGOOD:"",PLACEHOLDER_STROKECOLORQUALITYBAD:"",PLACEHOLDER_STROKECOLORON:a.PLACEHOLDER_STROKECOLORON,PLACEHOLDER_STROKECOLOROFF:a.PLACEHOLDER_STROKECOLOROFF,PLACEHOLDER_STROKECOLORFALSE:a.PLACEHOLDER_STROKECOLORNOBLINK,PLACEHOLDER_VISIBILITYON:a.PLACEHOLDER_VISIBILITYON,PLACEHOLDER_VISIBILITYOFF:a.PLACEHOLDER_VISIBILITYOFF,PLACEHOLDER_VISIBILITYFALSE:a.PLACEHOLDER_VISIBILITYNOBLINK,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSBlink=JSBlink;function JSIOAlarm(a){new AAlarm({conditionFunction:function(){return{AlarmGroup:a.conditionFunction(),Enabled:!0,EnabledAck:!1}},PLACEHOLDER_NEW_ENABLED:!0,PLACEHOLDER_NEW_FILLCOLOR:a.PLACEHOLDER_ALARMCOLOR0,PLACEHOLDER_NEW_BLINKING:a.PLACEHOLDER_ALARMBLINK0,PLACEHOLDER_NEW_VISIBLE:!0,PLACEHOLDER_ACK_ENABLED:!0,PLACEHOLDER_ACK_FILLCOLOR:a.PLACEHOLDER_ALARMCOLOR1,PLACEHOLDER_ACK_BLINKING:a.PLACEHOLDER_ALARMBLINK1,PLACEHOLDER_ACK_VISIBLE:!0,PLACEHOLDER_NO_ENABLED:!0,PLACEHOLDER_NO_FILLCOLOR:a.PLACEHOLDER_ALARMCOLOR2,PLACEHOLDER_NO_BLINKING:a.PLACEHOLDER_ALARMBLINK2,PLACEHOLDER_NO_VISIBLE:!0,PLACEHOLDER_FILLCOLORNOBLINK:a.PLACEHOLDER_ALARMCOLORBACKGROUND,PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITYPROPERTY,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_QUALITYCOLORGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_QUALITYCOLORBAD,PLACEHOLDER_USEHAND:!1,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USEHIDE:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOAlarm=JSIOAlarm;function JSIOMultiAlarm(a){for(var b=a.conditionFunction(),c="",d=0,e=b.length;d<e;d++)c+=b[d]+"; ";new emosWS.ESAlarms({conditionFunction:function(){return{Enabled:!0,EnabledAck:!1}},PLACEHOLDER_ALARMGROUPS:c,PLACEHOLDER_NEW_ENABLED:!0,PLACEHOLDER_NEW_FILLCOLOR:a.PLACEHOLDER_ALARMCOLOR0,PLACEHOLDER_NEW_BLINKING:a.PLACEHOLDER_ALARMBLINK0,PLACEHOLDER_NEW_VISIBLE:!0,PLACEHOLDER_ACK_ENABLED:!0,PLACEHOLDER_ACK_FILLCOLOR:a.PLACEHOLDER_ALARMCOLOR1,PLACEHOLDER_ACK_BLINKING:a.PLACEHOLDER_ALARMBLINK1,PLACEHOLDER_ACK_VISIBLE:!0,PLACEHOLDER_NO_ENABLED:!0,PLACEHOLDER_NO_FILLCOLOR:a.PLACEHOLDER_ALARMCOLOR2,PLACEHOLDER_NO_BLINKING:a.PLACEHOLDER_ALARMBLINK2,PLACEHOLDER_NO_VISIBLE:!0,PLACEHOLDER_FILLCOLORNOBLINK:a.PLACEHOLDER_ALARMCOLORBACKGROUND,PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITYPROPERTY,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_QUALITYCOLORGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_QUALITYCOLORBAD,PLACEHOLDER_USEHAND:!1,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USEHIDE:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOMultiAlarm=JSIOMultiAlarm;var JSIOMultiAlarmPriority=function(a){};emosWS.JSIOMultiAlarmPriority=JSIOMultiAlarmPriority;function JSIOAlarmShow(a){var b=getSVGElement(a.shape);if(this.svgElement)var c=this.svgElement.getAttribute("fill");new AAlarm({conditionFunction:function(){return{AlarmGroup:a.conditionFunction(),Enabled:!0,EnabledAck:!1}},PLACEHOLDER_NEW_ENABLED:!0,PLACEHOLDER_NEW_FILLCOLOR:c,PLACEHOLDER_NEW_BLINKING:!1,PLACEHOLDER_NEW_VISIBLE:getVisibility(a.PLACEHOLDER_VISIBILITY0),PLACEHOLDER_ACK_ENABLED:!0,PLACEHOLDER_ACK_FILLCOLOR:c,PLACEHOLDER_ACK_BLINKING:!1,PLACEHOLDER_ACK_VISIBLE:getVisibility(a.PLACEHOLDER_VISIBILITY1),PLACEHOLDER_NO_ENABLED:!0,PLACEHOLDER_NO_FILLCOLOR:c,PLACEHOLDER_NO_BLINKING:!1,PLACEHOLDER_NO_VISIBLE:getVisibility(a.PLACEHOLDER_VISIBILITY2),PLACEHOLDER_FILLCOLORNOBLINK:c,PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITYPROPERTY,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_QUALITYCOLORGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_QUALITYCOLORBAD,PLACEHOLDER_USEHAND:!1,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USEHIDE:!1,useVisible:!0,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOAlarmShow=JSIOAlarmShow;function JSIORead(a){var b=a.conditionFunction();new ADynamicText({conditionFunction:function(){return{Text:GetTagValueAsString(b.TAGNAME),Enabled:!0}},PLACEHOLDER_SWAP_USEQUALITY:a.PLACEHOLDER_USEQUALITYPROPERTY,PLACEHOLDER_STROKECOLORQUALITYGOOD:a.PLACEHOLDER_QUALITYCOLORGOOD,PLACEHOLDER_STROKECOLORQUALITYBAD:a.PLACEHOLDER_QUALITYCOLORBAD,PREFIX:b.PREFIX,SUFFIX:b.SUFFIX,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIORead=JSIORead;function JSIOClickWrite(a){var b=a.conditionFunction();new AClickWrite({conditionFunction:function(){return{Tag:b.TAGNAME,Value:b.VALUE,Enabled:!0}},PLACEHOLDER_FUNCTION:"",PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USESHAND:!0,PLACEHOLDER_USESHIDE:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOClickWrite=JSIOClickWrite;function JSIOClickWriteBit(a){var b=a.conditionFunction();new AClickWriteBit({conditionFunction:function(){return{Tag:b,BitNr:a.PLACEHOLDER_BITNUMBER,Enabled:!0}},PLACEHOLDER_FORCE:"",PLACEHOLDER_BITMODE:a.PLACEHOLDER_BITOPERATION,PLACEHOLDER_USESTROKE:!1,PLACEHOLDER_USESHAND:!0,PLACEHOLDER_USESHIDE:!1,STDPLACEHOLDER_SHAPENAME:a.shape})}emosWS.JSIOClickWriteBit=JSIOClickWriteBit;function JSIOAPTClick(a){var b=a.actionFunction,c=a.shape;a.conditionFunction()&&setEvent(c,"click",b,"pointer")}emosWS.JSIOAPTClick=JSIOAPTClick;var JSIOSize=function(a){var b=a.conditionFunction(),c=a.PLACEHOLDER_USEWIDTH?"Width":"Height",d=a.PLACEHOLDER_USEWIDTH?a.PLACEHOLDER_DIRLEFTUP?"Left":"Right":a.PLACEHOLDER_DIRLEFTUP?"Top":"Bottom";new ASize({conditionFunction:function(){var a=GetTagValueAsDouble(b.TAGNAME),c=b.VALUEMIN,d=b.VALUEMAX;return{Value:a,ValueMin:c,ValueMax:d,ValueLimitMin:c,ValueLimitMax:d,SizeFactorMin:b.SIZEFACTORMIN,SizeFactorMax:b.SIZEFACTORMAX,Enabled:!0}},postFunction:function(){},PLACEHOLDER_ORIENTATION:d,PLACEHOLDER_ORIENTATIONFLAG:"X",PLACEHOLDER_DIMENSION:c,PLACEHOLDER_DIRECTIONREVERSE:0,PLACEHOLDER_SWAP_USEQUALITY:!1,PLACEHOLDER_STROKECOLORQUALITYGOOD:"#000000",PLACEHOLDER_STROKECOLORQUALITYBAD:"#ff8000",STDPLACEHOLDER_SHAPENAME:a.shape})};emosWS.JSIOSize=JSIOSize;var JSDummy=function(a){};emosWS.JSDummy=JSDummy;function GLC(a){emosWS.glcNumber++,this.linecode=a,this.initLineCode=getFunctionFromESFuction(a),this.lastEvent=null,this.init=!0,this.datachangeListener=this.datachangeListener.bind(this),this.initialize=this.initialize.bind(this),this.datachangeListener=this.datachangeListener.bind(this),this.initialize(),emosWS.dispatchEvent({type:"HMIglc"})}GLC.prototype.datachangeListener=function(a){try{if("function"==typeof this.linecode){emosWS.listenGlobalVariablesChange();try{this.linecode()}catch(a){console.log(a)}emosWS.callbackGlobalVariablesChange()}}catch(a){console.log(this.constructor.name+": datachangeListener failed: "+a)}},GLC.prototype.initialize=function(a,b,c){try{if(emosWS.currentGLC&&emosWS.currentGLC===this)return console.log("GLC detected recursive then stop"),void console.log(this);emosWS.currentGLC=this,emosWS.animationData.stillInit=this.init,emosWS.animationData.callback=this;try{emosWS.animationData.stillInit?this.initLineCode():(emosWS.listenGlobalVariablesChange(),this.initLineCode(),emosWS.callbackGlobalVariablesChange())}catch(c){console.log(c)}emosWS.animationData.stillInit=this.init=!1,emosWS.currentGLC=null}catch(a){console.log(this.constructor.name+": initialize failed: "+a)}},emosWS.GLC=GLC;function HFaultWarning(a){this.id=a.id;var b=a.alarmGroup;this.alarmGroups=Array.isArray(b)?b:[b],this.newFaultClass=a.newFaultClass||"alert";var c=a.newFaultEnabled;this.newFaultEnabled=void 0===c||c;var d=a.newFaultBlinking;this.newFaultBlinking=void 0===d||d,this.newFaultProperty={Enabled:this.newFaultEnabled,Blinking:this.newFaultBlinking,Class:this.newFaultClass},this.ackFaultClass=a.ackFaultClass||"alert";var e=a.ackFaultEnabled;this.ackFaultEnabled=void 0===e||e;var f=a.ackFaultBlinking;this.ackFaultBlinking=void 0!==f&&f,this.ackFaultProperty={Enabled:this.ackFaultEnabled,Blinking:this.ackFaultBlinking,Class:this.ackFaultClass},this.newEMSClass=a.newEMSClass||"warn";var g=a.newEMSEnabled;this.newEMSEnabled=void 0!==g&&g;var h=a.newEMSBlinking;this.newEMSBlinking=void 0!==h&&h,this.newEMSProperty={Enabled:this.newEMSEnabled,Blinking:this.newEMSBlinking,Class:this.newEMSClass},this.ackEMSClass=a.ackEMSClass||"warn";var i=a.ackEMSEnabled;this.ackEMSEnabled=void 0!==i&&i;var j=a.ackEMSBlinking;this.ackEMSBlinking=void 0!==j&&j,this.ackEMSProperty={Enabled:this.ackEMSEnabled,Blinking:this.ackEMSBlinking,Class:this.ackEMSClass},this.newWRNClass=a.newWRNClass||"warn";var k=a.newWRNEnabled;this.newWRNEnabled=void 0===k||k;var l=a.newWRNBlinking;this.newWRNBlinking=void 0===l||l,this.newWRNProperty={Enabled:this.newWRNEnabled,Blinking:this.newWRNBlinking,Class:this.newWRNClass},this.ackWRNClass=a.ackWRNClass||"warn";var m=a.ackWRNEnabled;this.ackWRNEnabled=void 0===m||m;var n=a.ackWRNBlinking;this.ackWRNBlinking=void 0!==n&&n,this.ackWRNProperty={Enabled:this.ackWRNEnabled,Blinking:this.ackWRNBlinking,Class:this.ackWRNClass},this.NOClass=a.NOClass||"fine";var o=a.NOEnabled;this.NOEnabled=void 0===o||o;var p=a.NOBlinking;this.NOBlinking=void 0!==p&&p,this.NOProperty={Enabled:this.NOEnabled,Blinking:this.NOBlinking,Class:this.NOClass},this.stateMap={0:this.newFaultProperty,1:this.ackFaultProperty,2:this.newEMSProperty,3:this.ackEMSProperty,4:this.newWRNProperty,5:this.ackWRNProperty,6:this.NOProperty,7:this.NOProperty},this.currentProperty=this.stateMap[0],this.$htmlElement=$("#"+this.id),this.lastClass="",this.alarmStateList={},this.alarmState=null,this.alarmValue=null,this.interval=0,this.trigger=function(){this.animate()}.bind(this),this.datachangeListener=this.datachangeListener.bind(this),this.initialize()}HFaultWarning.prototype.initialize=function(){this.adviseData()},HFaultWarning.prototype.updateAlarmStateList=function(a){try{if(void 0!==a&&void 0!==a.classStateRec){var b={value:parseInt(a.value),state:a.classStateRec.state};this.alarmStateList[a.tag]=b;var c=100,d=100;for(var e in this.alarmStateList){var f=this.alarmStateList[e];f.value<d&&(d=f.value),f.state<c&&(c=f.state)}this.alarmState=c,this.alarmValue=d}}catch(a){console.log("updateAlarmStateList failed: "+a)}},HFaultWarning.prototype.datachangeListener=function(a){void 0!==a&&void 0!==a.classStateRec&&(this.updateAlarmStateList(a),this.startAnimate(a))},HFaultWarning.prototype.changeClass=function(a){this.$htmlElement.removeClass(this.lastClass).addClass(a),this.lastClass=a},HFaultWarning.prototype.startAnimate=function(a){try{this.currentProperty=this.stateMap[this.alarmState]||this.currentProperty,this.currentProperty.Blinking?0===this.interval&&(this.interval=1,emosWS.blinkInterval.addListener(this.trigger,!1)):this.animate()}catch(a){console.log("HFaultWarning startAnimate failed: "+a)}},HFaultWarning.prototype.animate=function(){try{this.currentProperty.Blinking?emosWS.blinkInterval.active?this.changeClass(this.currentProperty.Class):this.changeClass(""):this.changeClass(this.currentProperty.Class)}catch(a){console.log("HFaultWarning animate failed: "+a)}},HFaultWarning.prototype.adviseData=function(){this.alarmGroups.forEach(function(a){emosWS.advise(a,this.datachangeListener,"",emosWS.tagType.Alarm)}.bind(this))},HFaultWarning.prototype.terminate=function(){emosWS.unadvise(this.alarmGroup+".Alarm",this.datachangeListener),emosWS.blinkInterval.removeListener(this.trigger),this.changeClass("")},emosWS.HTMLFaultWarning=HFaultWarning;function HSwap(a){this.id=a.id;var b=a.plctag;this.plctags=Array.isArray(b)?b:[b],this.values={};var c=a.trueBlinking,d=a.falseBlinking;this.trueProperty={Blinking:void 0!==c&&c,Class:a.trueClass||"fine"},this.falseProperty={Blinking:void 0===d||d,Class:a.falseClass||"warn"},this.$htmlElement=$("#"+this.id),this.currentProperty=this.falseProperty,this.interval=0,this.lastClass="",this.trigger=function(){this.animate()}.bind(this),this.datachangeListener=this.datachangeListener.bind(this),this.initialize()}HSwap.prototype.initialize=function(){this.adviseData()},HSwap.prototype.datachangeListener=function(a,b){if(void 0!==a){this.values[b]=emosWS.fn.GetAsBoolean(a.value),this.currentProperty=this.trueProperty;for(var c=Object.keys(this.values),d=0,e=c.length;d<e;d++)if(!this.values[c[d]]){this.currentProperty=this.falseProperty;break}this.startAnimate(a)}},HSwap.prototype.changeClass=function(a){this.$htmlElement.removeClass(this.lastClass).addClass(a),this.lastClass=a},HSwap.prototype.startAnimate=function(){try{this.currentProperty.Blinking?0===this.interval&&(this.interval=1,emosWS.blinkInterval.addListener(this.trigger,!1)):this.animate()}catch(a){console.log("HFaultWarning startAnimate failed: "+a)}},HSwap.prototype.animate=function(){try{this.currentProperty.Blinking?emosWS.blinkInterval.active?this.changeClass(this.currentProperty.Class):this.changeClass(""):this.changeClass(this.currentProperty.Class)}catch(a){console.log("HFaultWarning animate failed: "+a)}},HSwap.prototype.adviseData=function(){this.plctags.forEach(function(a){this.values[a]=null,emosWS.advise(a,this.datachangeListener,a,emosWS.tagType.IO)}.bind(this))},HSwap.prototype.terminate=function(){this.plctags.forEach(function(a){emosWS.unadvise(a+".IO",this.datachangeListener)}),emosWS.blinkInterval.removeListener(this.trigger),this.changeClass("")},emosWS.HTMLSwap=HSwap;function HSwaps(a){a.plctag=a.plctags,HSwap.call(this,a)}HSwaps.prototype=Object.create(HSwap.prototype),HSwaps.prototype.constructor=HSwaps,emosWS.HTMLSwaps=HSwaps;var DiagnosisCommon=function(){function a(a){return a.substr(a.indexOf("-")+1)}return{getObjectType:a}}();window.DiagnosisCommon=DiagnosisCommon;var timerTypes={Second:0,Minute:1,SiemensDate:3,SiemensTimeOfDay:4,SiemensTime:5,SiemensS5Time:6,SiemensDateAndTime:7};function AlarmClient(a,b,c,d,e,f,g,h){this.onAlarmReady=g,this.parent=a,this.data=b,this.alarmGroup=c,this.big=f,this.id=d,this.tab=e,this.tableId=h,this.table=null,this.alarmRefId=[],this.intervalId=null,$(this.parent)[0].intervalID=[],this.init()}AlarmClient.prototype.init=function(){try{var a=this,b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID();this.alarmId=getElementGlobalID();var j,k="",l="string"==typeof this.alarmGroup?[this.alarmGroup]:this.alarmGroup,m;if(this.tableId)m=this.tableId;else{m=getElementGlobalID(),this.big?j="<tr style='display:none'><th class='tdBegin' style='width: 7%;' id='"+d+"'> Date</th><th class='tdText' style='width: 30%;' id='"+c+"'> Text</th><th class='tdAlarmgroup' style='width: 12%;' id='"+f+"'> Alarmgroup</th><th class='tdTagname' style='width: 12%;' id='"+i+"'> Tagname</th><th class='tdPriority' style='width: 3.5%;' id='"+h+"'> Priority</th><th class='tdClassID' style='width: 11%;' id='"+g+"'> ClassID</th><th class='tdDuration' style='width: 6%;' id='"+e+"'> Duration</th>":(k="<table style='width: 329px;' class='DiagnosisAlarmTableHead'><col width='73%'><col width='27%'><tr><th id='"+c+"'>Text</th><th id='"+e+"'>Duration</th></tr></table>",j="<col width='73%'><col width='27%'><tr><th>Text</th><th>Duration</th>");var n=$("<div class='DiagnosisAlarmClient' id='"+b+"'>"+k+"<table style='width: calc(100% + 4px)' class='DiagnosisAlarmTable Groupbox' id='"+m+"'>"+j+"</tr></table></div>");$("<span/>",{class:"emosbutton quit "+"",click:function(){if(!$(this).hasClass("noAction"))for(var a=0;a<l.length;a++)emosWS.poke(l[a]+this.id+".Alarm",1)}}).appendTo(n),n.appendTo(this.parent);var o=document.getElementById(c),p=document.getElementById(e);this.getHeaderText("T04_Text",o),this.getHeaderText("T04_Duration",p)}this.table=document.getElementById(m);for(var q=0;q<l.length;q++)this.alarmRefId[q]=emosWS.sendAdviseAlarmText(l[q]+this.id,emosWS.getLanguage(),this.datachangeListener.bind(this),"");emosWS.addEventListener("language",this.onLanguage.bind(this)),this.parent.on("remove",function(){a.terminate()})}catch(a){console.log("AlarmClient init failed: "+a)}},AlarmClient.prototype.onLanguage=function(){this.clearTable()},AlarmClient.prototype.terminate=function(){clearInterval(this.intervalId);for(var a=0;a<this.alarmRefId.length;a++)emosWS.unadviseById(this.alarmRefId[a])},AlarmClient.prototype.clearTable=function(){for(var a=1;a<this.table.rows.length;a++)this.table.deleteRow(a)},AlarmClient.prototype.getHeaderText=function(a,b){emosWS.sendAdviseText(a,"name",function(a){""!==a.value&&(b.textContent=a.value)})},AlarmClient.prototype.getStyleClass=function(a){var b="alarmTable";switch("1NEW"===a.alarmType?b+=" NEW":"2ACK"===a.alarmType&&(b+=" ACK"),a.classID){case"1":b+=" alarm";break;case"2":b+=" warning";break;case"3":b+=" alarm"}return b},AlarmClient.prototype.getTabStyleClass=function(a){return"1"===a.classID?"DiagnosisPageTextAlarm":"DiagnosisPageTextWarning"},AlarmClient.prototype.updateInterval=function(){0===this.table.rows.length?this.intervalId&&clearInterval(this.intervalId):this.intervalId||(this.intervalId=setInterval(this.updateDurationColumn.bind(this),1e3))},AlarmClient.prototype.updateDurationColumn=function(){for(var a=1,b=this.table.rows.length;a<b;a++){var c=this.table.rows[a],d=c.msg,e=c.durationCell;e&&(e.textContent=this.convertToDate(d.beginTime))}},AlarmClient.prototype.datachangeListener=function(a){try{"alarmText"===a.type&&"internal"!==a.tagname&&(this.updateTable(a),this.big||this.updateInterval())}catch(a){console.log("AlarmClient datachangeListener failed: "+a)}},AlarmClient.prototype.updateTable=function(a){for(var b=this.table.rows.length;b>0;b--){var c=b-1,d=this.table.rows[c],e=d.msg;if(e&&e.alarmGroup===a.alarmGroup&&e.tagname===a.tagname){this.table.deleteRow(c);break}}"3RTN"!==a.alarmType&&this.addTableRow(a)},AlarmClient.prototype.addTableRow=function(a){var b=this.getLocalTime(a.date,a.time);a.date=b[0],a.time=b[1],a.dateTime=a.date+" "+a.time,a.beginTime=this.convertToTimestamp(a.date,a.time);var c=this.table.insertRow(1);if(c.className=this.getStyleClass(a),this.big){var d=c.insertCell(0),e=c.insertCell(1),f=c.insertCell(2),g=c.insertCell(3),h=c.insertCell(4),i=c.insertCell(5);d.textContent=a.date+", "+a.time.split(",")[0],e.textContent=a.alarmText,f.textContent=a.alarmGroup,g.textContent=a.tagname,h.textContent=a.priority,d.className="tdBegin",e.className="tdText",f.className="tdArea",g.className="tdTagname",h.className="tdPriority",i.className="tdClass C"+(a.classID.length>1?a.classID:"0"+a.classID)+" big"}else{this.parent[0].actMessages=!0;var d=c.insertCell(0),e=c.insertCell(1);d.textContent=a.alarmText+"\n"+a.alarmGroup,d.className="C"+(a.classID.length>1?a.classID:"0"+a.classID),c.durationCell=e}if(this.onAlarmReady)try{this.onAlarmReady()}catch(a){}c.msg=a,this.big||(c.durationCell.textContent=this.convertToDate(a.beginTime))},AlarmClient.prototype.getLocalTime=function(a,b){try{if(""===a)return["",""];var c=a.split("."),d=b.split(":"),e=d[2].split(","),f=new Date(c[1]+"/"+c[0]+"/"+c[2]+" "+d[0]+":"+d[1]+":"+e[0]+" UTC"),g=f.getDate(),h=f.getMonth()+1,i=f.getHours();i=i<10?"0"+i:i;var j=f.getMinutes();j=j<10?"0"+j:j;var k=f.getSeconds();k=k<10?"0"+k:k;return[g+"."+h+"."+f.getFullYear(),i+":"+j+":"+k+","+e[1]]}catch(a){console.log("getLocalTime() failed: "+a)}},AlarmClient.prototype.convertToDate=function(a,b){try{if(""===a)return"";var c=(new Date).getTime(),d=parseInt((c-a)/1e3),e=parseInt(d/86400),f=parseInt(d/3600)%24,g=parseInt(d/60)%60,h=d%60;return b?(f<10?"0"+f:f)+":"+(g<10?"0"+g:g)+":"+(h<10?"0"+h:h):e+":"+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g)+":"+(h<10?"0"+h:h)}catch(a){console.log("convertToDate() failed: "+a)}},AlarmClient.prototype.convertToTimestamp=function(a,b){try{if(""===a)return"";var c=a.split("."),d=b.split(":"),e=d[2].split(",");return new Date(c[1]+"/"+c[0]+"/"+c[2]+" "+d[0]+":"+d[1]+":"+e[0]).getTime()}catch(a){console.log("convertToTime() failed: "+a)}},emosWS.AlarmClient=AlarmClient;function RestAlarmClient(a,b,c,d,e){this.parent=a,this.onRestAlarmReady=c,this.data=b,this.motherTable=d,$(this.parent)[0].AlarmingtdPriority=[],$(this.parent)[0].AlarmingtdClass=[],$(this.parent)[0].AlarmingtdArea=[],$(this.parent)[0].OperatingtdPriority=[],$(this.parent)[0].OperatingtdClass=[],$(this.parent)[0].OperatingtdArea=[],this.tableId=e,this.init()}RestAlarmClient.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID();this.alarmId=getElementGlobalID();var j=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m;if(this.tableId)m=this.tableId;else{m=getElementGlobalID();var n;n="<tr style='display:none;'><th class='tdBegin' style='width: 6%;' id='"+c+"'> </th><th class='tdEnd' style='width: 6%;' id='"+e+"'> </th><th class='tdShift' style='width: 3%;' id='"+f+"'> </th><th class='tdText' style='width: 33%;' id='"+b+"'> </th><th class='tdArea' style='width: 12%;' id='"+i+"'> </th><th class='tdPriority' style='width: 3%;' id='"+h+"'> </th><th class='tdClass' style='width: 3%;' id='"+g+"'> </th><th class='tdDuration' style='width: 5%;' id='"+d+"'> </th><th class='tdComment' style='width: 12%;' id='"+j+"'> </th><th class='tdEditor' style='width: 12%;' id='"+k+"'> </th><th class='tdCount' style='width: 5%;' id='"+l+"'> </th>";$("<div class='DiagnosisRestAlarmClient' id='"+a+"'><table style='width: 100%' class='DiagnosisRestAlarmTable Groupbox' id='"+m+"'>"+n+"</tr></table></div>").appendTo(this.parent)}this.table=document.getElementById(m),this.addTableRow()}catch(a){console.log("RestAlarmClient init failed: "+a)}},RestAlarmClient.prototype.convertDateUTCToLocal=function(a){return new Date(a.getTime()-6e4*a.getTimezoneOffset())},RestAlarmClient.prototype.addTableRow=function(){var a=this,b=a.table.rows.length;if($.each(this.data,function(c,d){var e=a.table.insertRow(b);e.className="alarmTable "+d.type+" "+d.status;var f=e.insertCell(0),g=e.insertCell(1),h=e.insertCell(2),i=e.insertCell(3),j=e.insertCell(4),k=e.insertCell(5),l=e.insertCell(6),m=e.insertCell(7),n=e.insertCell(8),o=e.insertCell(9),p=e.insertCell(10),q;d.beginDate&&(q=a.convertDateUTCToLocal(new Date(d.beginDate)));var r;d.endDate?(r=a.convertDateUTCToLocal(new Date(d.endDate)),r=r.toLocaleDateString(myLocalTime)+", "+r.toLocaleTimeString(myLocalTime)):r="";var s=d.text;"N/A"===s&&d.comment&&(s=checkAPTPattern(d.comment)?d.comment+" \u25bc":d.text);var t=d.duration.split(":"),u=(t[0]<10?"0"+t[0]:t[0])+":"+(t[1]<10&&1===t[1].length?"0"+t[1]:t[1])+":"+(t[2]<10&&1===t[2].length?"0"+t[2]:t[2]);if(f.textContent=q.toLocaleDateString(myLocalTime)+", "+q.toLocaleTimeString(myLocalTime),g.textContent=r,h.textContent=d.shift,i.textContent=s,j.textContent=d.area,k.textContent=d.priority,l.textContent=d.class,m.textContent=u,n.textContent=d.comment,o.textContent=d.lastEdit,f.className="tdBegin",g.className="tdEnd",h.className="tdShift",i.className="tdText",j.className="tdArea",k.className="tdPriority",l.className="tdClass C"+d.class+" big",m.className="tdDuration",n.className="tdComment",o.className="tdEditor",p.className="tdCount",d.count){var v=100*d.count/a.data[0].count,w="<div class='topTenStatus' style='position: absolute; margin-top:2px;'><div class='maintenanceProgress'><div class='topTenBar topTenGrey' style='width:"+v+"%; color:black;'>"+ +d.count+"</div></div></div>";$(w).appendTo(p)}var x=Number(d.class);x>=10&&x<=19?(a.parent[0].OperatingtdPriority.push(d.priority),a.parent[0].OperatingtdClass.push(d.class),a.parent[0].OperatingtdArea.push(d.area)):(a.parent[0].AlarmingtdPriority.push(d.priority),a.parent[0].AlarmingtdClass.push(d.class),a.parent[0].AlarmingtdArea.push(d.area)),b++}),this.onRestAlarmReady)try{this.onRestAlarmReady(this.motherTable)}catch(a){console.log(a)}},emosWS.RestAlarmClient=RestAlarmClient;function RestParametrizingClient(a,b,c,d){this.parent=a,this.onRestParamReady=c,this.data=b,this.motherTable=d,$(this.parent)[0].ParametrizingtdIONode=[],$(this.parent)[0].ParametrizingtdIOItem=[],this.init()}RestParametrizingClient.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID();this.alarmId=getElementGlobalID();var k=getElementGlobalID(),l=getElementGlobalID(),m;m="<tr style='display:none;'><th class='tdDTOriginal' style='width: 6%;' id='"+c+"'> </th><th class='tdDTLogged' style='width: 6%;' id='"+f+"'> </th><th class='tdApplication' style='width: 3%;' id='"+g+"'> </th><th class='tdIONode' style='width: 33%;' id='"+b+"'> </th><th class='tdIOItem' style='width: 12%;' id='"+j+"'> </th><th class='tdOldValue' style='width: 3%;' id='"+i+"'> </th><th class='tdNewValue' style='width: 3%;' id='"+h+"'> </th><th class='tdComment' style='width: 12%;' id='"+k+"'> </th><th class='tdUser' style='width: 12%;' id='"+l+"'> </th>";$("<div class='DiagnosisRestParamClient' id='"+a+"'><table style='width: 100%' class='DiagnosisRestParamTable Groupbox' id='"+e+"'>"+m+"</tr></table></div>").appendTo(this.parent),this.table=document.getElementById(e),this.addTableRow()}catch(a){console.log("RestParamClient init failed: "+a)}},RestParametrizingClient.prototype.addTableRow=function(){var a=1,b=this;if($.each(this.data,function(c,d){var e=b.table.insertRow(a);e.className="alarmTable ";var f=e.insertCell(0),g=e.insertCell(1),h=e.insertCell(2),i=e.insertCell(3),j=e.insertCell(4),k=e.insertCell(5),l=e.insertCell(6),m=e.insertCell(7),n=e.insertCell(8),o;d.utcDts&&(o=new Date(d.utcDts));var p;d.logDts?(p=new Date(d.logDts),p=p.toLocaleDateString(myLocalTime)+", "+p.toLocaleTimeString(myLocalTime,{hour12:show12hTime})):p="",f.textContent=o.toLocaleDateString(myLocalTime)+", "+o.toLocaleTimeString(myLocalTime,{hour12:show12hTime}),g.textContent=p,h.textContent=d.application,i.textContent=d.ionode,j.textContent=d.ioitem,k.textContent=d.oldValue,l.textContent=d.newValue,m.textContent=d.comment,n.textContent=d.userid,f.className="tdDTOriginal",g.className="tdDTLogged",h.className="tdApplication",i.className="tdIONode",j.className="tdIOItem",k.className="tdOldValue",l.className="tdNewValue",m.className="tdComment",n.className="tdUser",b.parent[0].ParametrizingtdIONode.push(d.ionode),b.parent[0].ParametrizingtdIOItem.push(d.ioitem),a++}),this.onRestParamReady)try{this.onRestParamReady(this.motherTable)}catch(a){console.log(a)}},emosWS.RestParametrizingClient=RestParametrizingClient;var GeneralElement=function(a,b){var c=getElementGlobalID();$("<div class='DiagnosisGerneralElement' id='"+c+"'><svg width='100%' height='20'><rect width='100%' height='20' style='fill:white;stroke-width:1;stroke:grey' /><text x='5' y='15' fill='black'>"+b.Text+"</text></svg></div>").appendTo(a)};function DiagnosisElement(a){this.data=a.data,this.writable=a.writable,this.panel=null,this.visibleRight=parseInt(this.data.VisibleAtRight),this.visibleOPC=this.data.VisibleOPCID,this.userRight=parseInt(this.data.UserRight),this.UNKOWN="???",this.visible=!0,this.opcvisible=!0,this.hasPaintShopRight=!0,this.initialize()}DiagnosisElement.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},DiagnosisElement.prototype.setInputRange=function(a,b){a&&b&&(b.InputMin=a.input_min,b.InputMax=a.input_max,b.IntInputMin?(b.IntInputMin=b.InputMin,b.IntInputMax=b.InputMax):b.RealInputMin?(b.RealInputMin=b.InputMin,b.RealInputMax=b.InputMax):b.IntTimeMin&&(b.IntTimeMin=b.InputMin,b.IntTimeMax=b.InputMax))},DiagnosisElement.prototype.updateView=function(){try{this.visibleRight&&(this.hasPaintShopRight=emosWS.login.au.hasPaintShopRight(this.visibleRight),this.setVisibility()),this.writable&&this.updateWrite()}catch(a){console.log(this.constructor.name+": updateView failed: "+a)}},DiagnosisElement.prototype.initialize=function(){this.init(),this.afterInit()},DiagnosisElement.prototype.init=function(){},DiagnosisElement.prototype.updateWrite=function(){},DiagnosisElement.prototype.unitListener=function(){},DiagnosisElement.prototype.getValue=function(a){try{return a}catch(b){return console.error("[DiagnosisElement getValue] : "+b),a}},DiagnosisElement.prototype.afterInit=function(){this.updateView(),isNaN(this.userRight)&&isNaN(this.visibleRight)||emosWS.addEventListener("UserRight",this.updateView.bind(this)),this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&this.parseVisibilityOPCTags(this.data.VisibleOPCID,function(a){this.opcvisible=GetAsBoolean(a.value),this.setVisibility()}.bind(this)),emosWS.addEventListener("unit",function(a){this.unit=a,this.unitListener(a)}.bind(this))},DiagnosisElement.prototype.parseVisibilityOPCTags=function(s,callback){[[" = "," === "],[" <> "," !== "],[" & "," && "],[" | "," || "],["NOT ","! "]].forEach(function(a){s=s.split(a[0]).join(a[1])});var tagMap={},tags=s.match(/[\w.]+(?!\s*')(?![\w.])/g);tags&&tags.forEach(function(a){isNaN(a)&&["true","false"].indexOf(a.toLowerCase())<0&&(tagMap[a]=null)});var parseValues=function(itag,ivalue){void 0!==itag&&(tagMap[itag]=ivalue);for(var tag in tagMap)if(null===tagMap[tag])return;var parseString=s;for(var tag in tagMap)parseString=parseString.replace(new RegExp("\\b"+tag+"\\b","g"),tagMap[tag]);var value=!0;try{value=GetAsBoolean(eval(parseString)),callback({value:value})}catch(a){}};for(var tag in tagMap)emosWS.advise(this.plc+"."+tag,function(a,b){parseValues(b,a.value)},tag,emosWS.tagType.IO);parseValues()},DiagnosisElement.prototype.adviseProperty=function(a,b,c){emosWS.advise(a,function(a,c){try{if(a.value){var d=a.value,e=this.data;e.Precision=d.disp_prec||e.Precision,d.met_baseunit!==this.UNKOWN&&(e.UnitMetric=d.met_baseunit||e.UnitMetric),d.imp_baseunit!==this.UNKOWN&&(e.UnitImperial=d.imp_baseunit||e.UnitImperial),d.loc_baseunit!==this.UNKOWN&&(e.UnitLocale=d.loc_baseunit||e.UnitLocale),e.FactorMetric=d.met_factor||e.FactorMetric,e.FactorImperial=d.imp_factor||e.FactorImperial,e.FactorLocale=d.loc_factor||e.FactorImperial,e.FactorPLC=d.plc_factor,e.TextKey=d.textkey,e.ByteInputMin&&(e.ByteInputMin=d.input_min||e.ByteInputMin),e.ByteInputMax&&(e.ByteInputMax=d.input_max||e.ByteInputMax),e.IntInputMin&&(e.IntInputMin=d.input_min||e.IntInputMin),e.IntInputMax&&(e.IntInputMax=d.input_max||e.IntInputMax),e.RealInputMin&&(e.RealInputMin=d.input_min||e.RealInputMin),e.RealInputMax&&(e.RealInputMax=d.input_max||e.RealInputMax),b(a,c)}}catch(a){console.error("[DiagnosisElement adviseProperty callback] : "+a)}}.bind(this),c,emosWS.tagType.Property)},DiagnosisElement.prototype.setVisibility=function(){this.visible=this.opcvisible&&this.hasPaintShopRight;try{this.panel.get(0).classList.contains("priv")||(this.panel.get(0).classList.contains("DiagnosisText")?this.panel.get(0).parentNode.style.display=this.visible?"block":"none":this.panel.get(0).style.display=this.visible?"block":"none")}catch(a){console.error("[DiagnosisElement setVisibility] : "+a)}};function DiagnosisText(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.data.VisibleAtRight||(this.data.VisibleAtRight="0"),this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.Groupbox,css:"DiagnosisText"},R:{parent:this.diagnosisWindow.divTypes.Groupbox,css:"DiagnosisText"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisText"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.dataText=""===this.data.Text?".":this.data.Text,this.plctag="",this.text="",DiagnosisElement.call(this,{data:b})}DiagnosisText.prototype=Object.create(DiagnosisElement.prototype),DiagnosisText.prototype.constructor=DiagnosisText,DiagnosisText.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();void 0!==this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&(this.plctag=""===this.data.VisibleOPCID?"":this.plc+"."+this.data.OPCID);var c=this.positionClass[this.data.Position],d=this.panel=$("<div style='clear:both;' class='"+c.css+"' id='"+a+"'><p id='"+b+"'>"+this.dataText+"</p></div>");!0===this.data.showHide?($(this.parentDiv).addClass("showBlock"),$(this.parentDiv).find(".showhideblockbutton").addClass("closeBlock")):!1===this.data.showHide?($(this.parentDiv).addClass("hideBlock"),$(this.parentDiv).find(".showhideblockbutton").addClass("openBlock")):($(this.parentDiv).addClass("showBlock"),$(this.parentDiv).find(".showhideblockbutton").addClass("closeBlock")),d.appendTo(this.parentDiv),this.text=document.getElementById(b),""!==this.plctag&&emosWS.advise(this.plctag,function(a){try{var b=GetAsBoolean(a.value);this.text.style.visibility=b?"visible":"hidden"}catch(a){console.log("DiagnosisText datachangeListener failed: "+a)}}.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisText init failed: "+a)}},emosWS.DiagnosisText=DiagnosisText;function PageControl(a,b,c,d){this.parent=a,this.data=b,this.diagnosisWindow=c,this.diagnosisWindow.plcVersion="",this.subtabs=d,this.tabs="",this.ul="",this.tabData="",this.tabid=0,this.pageHead="",this.tabTitle="",this.init()}PageControl.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();this.pageHead=b;var c=getElementGlobalID(),d=$("<div class='DiagnosisPageControl diatabs' id='"+a+"'><div class='pager'><span class='pagerHead' id='"+b+"'><input maxlength='15' id='"+c+"' class='pagerHeadLine getKeypad keyboardInputInitiator' disabled></span></div><ul><br class='cl' /></ul></div>");d.appendTo(this.parent),this.tabs=d.tabs(),this.ul=this.tabs.find("ul");var e=this;if(this.diagnosisWindow.Private||(this.diagnosisWindow.Private="true"),this.diagnosisWindow.Summary||(this.diagnosisWindow.Summary="true"),"privateOverlay"!==this.diagnosisWindow.additionalClass)try{"true"===this.diagnosisWindow.Private&&(e.data["1999990-AddPageTab"]={"1999991-AddPageControl":{"1999992-AddPageTab":{Text:"Private1",TextID:"Private1"}},Text:"Private",TextID:"Private"}),"statusWelcome"!==this.diagnosisWindow.additionalClass&&"statusWelcome act"!==this.diagnosisWindow.additionalClass&&"true"===this.diagnosisWindow.Summary&&(e.data["1999993-AddPageTab"]={"1999994-AddPageControl":{"1999995-AddPageTab":{Text:"Summaries",TextID:"Summaries"}},Text:"Duerr",TextID:"Duerr"})}catch(a){console.log(a)}for(var f=sortHashArray(this.data),g=f.length-1;g>-1;g--){this.tabData=null;var h=f[g];if(this.tabData=this.data[h],"1000-AddPageTab"===h){$(this.parent).closest(".diagnose").find(".copyTab").addClass("childWin");break}if("object"==typeof this.tabData){this.tabid++;var i=DiagnosisCommon.getObjectType(h),j=!1,k=!1;switch(this.tabData.Visible=!1,i){case"AddPageTab":this.tabTitle=this.tabData.Text;var l=this.tabData.VisibleAtRight?parseInt(this.tabData.VisibleAtRight):0,m=!0;l&&(m=emosWS.login.au.hasPaintShopRight(l)),this.tabData.VisibleOPCID&&""!==this.tabData.VisibleOPCID?e.parseVisibilityOPCTags(this.tabData.VisibleOPCID,function(a){(k=null!==GetAsBoolean(a.value)&&GetAsBoolean(a.value))&&m||(this.tabData.Visible=!0,this.tabid--,this.buildTab())}.bind(this.tabData)):m?this.buildTab():(this.tabData.Visible=!0,this.tabid--,this.buildTab());break;default:this.tabTitle=i,this.tabData.TextID="Messages",this.buildTab()}}}this.tabs.tabs("refresh"),this.tabs.tabs({active:0})}catch(a){console.log("PageControl failed: "+a)}},PageControl.prototype.buildTab=function(){var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID();if("Private"!==this.tabTitle&&"Chronology"!==this.tabTitle&&"Duerr"!==this.tabTitle?this.tabData.Visible||$("<li style='background-image:url(svg/tabicons/"+this.tabTitle+".svg), linear-gradient(#fff, #d1d7e0);' id='"+c+"' title='"+this.tabTitle+"' class='emosbutton "+this.tabTitle+" tab"+this.tabid+"'><a href='#"+b+"'></a><span><span class='warn_image'></span></span></li>").prependTo(this.ul):$("<li id='"+c+"' title='"+this.tabTitle+"' class='emosbutton "+this.tabTitle+" tab"+this.tabid+"'><a href='#"+b+"'></a><span><span class='warn_image'></span></span></li>").prependTo(this.ul),"Messages"===this.tabTitle&&new emosWS.HTMLFaultWarning({id:c,alarmGroup:this.diagnosisWindow.PLC+this.diagnosisWindow.ID}),this.parent.parents("#center").length>0&&"Private"===this.tabTitle&&$("#"+this.pageHead).append('<div class="radiobox hideme"><span class="emosbutton showPrivate">show Private</span></div>'),"Chronology"===this.tabTitle){var d=$("<div/>",{class:"placeholderBtn"}).appendTo(this.tabs);$("<span/>",{class:"emosbutton quitChrono",click:function(){$(this).closest(".DiagnosisPageControl").find(".DiagnosisPageBlank.dPage.Chronology").find(".DiagnosisAlarmClient").remove(),new ChronologyHistory($(this).parent().find(".DiagnosisPageBlank.dPage.Chronology"),!0)}}).appendTo(d)}if(!this.tabData.Visible){var e=$("<div/>",{class:"DiagnosisPageBlank dPage "+this.tabTitle,id:b});"statusWelcome"===this.diagnosisWindow.additionalClass&&"Messages"===this.tabTitle?($(e)[0].head="Actual Alarms",$(e)[0].headId="T04_ActualAlarms"):"statusWelcome"===this.diagnosisWindow.additionalClass&&"Chronology"===this.tabTitle?($(e)[0].head="Chronology",$(e)[0].headId="T04_Chronology"):($(e)[0].head=this.tabTitle,$(e)[0].headId=this.diagnosisWindow.getTextPrefix()+this.tabData.TextID),$(e)[0].tabNum=this.tabid,e.appendTo(this.tabs);var f=document.getElementById(a);if(!this.tabData.Visible||"2"===this.tabData.Visible){this.diagnosisWindow.appendPage(e,this.tabData,f,parseInt(this.tabData.VisibleAtRight||"0"),this.tabid,this.tabs);var g="";e.children(".diasubtabs").length>0&&e.closest(".DiagnosisFooter").addClass("subpage")}}},PageControl.prototype.parseVisibilityOPCTags=function(s,callback){[[" = "," === "],[" <> "," !== "],[" & "," && "],[" | "," || "],["NOT ","! "]].forEach(function(a){s=s.split(a[0]).join(a[1])});var tagMap={},tags=s.match(/[\w.]+(?!\s*')(?![\w.])/g);tags&&tags.forEach(function(a){isNaN(a)&&["true","false"].indexOf>-1&&(tagMap[a]=null)});var parseValues=function(itag,ivalue){void 0!==itag&&(tagMap[itag]=ivalue);for(var tag in tagMap)if(null===tagMap[tag])return;var parseString=s;for(var tag in tagMap)parseString=parseString.replace(new RegExp("\\b"+tag+"\\b","g"),tagMap[tag]);var value=!0;try{value=GetAsBoolean(eval(parseString)),callback({value:value})}catch(a){}};for(var tag in tagMap)emosWS.advise(this.plc+"."+tag,function(a,b){parseValues(b,a.value)},tag,emosWS.tagType.IO);parseValues()},emosWS.PageControl=PageControl;function SubPageControl(a,b,c,d,e){this.parent=a,this.data=b,this.diagnosisWindow=c,this.subtabs=d,this.plcversion=e,this.myText=c.myText?c.myText:"",this.tabs="",this.tabData="",this.tabid=0,this.pageHead="",this.tabTitle="",this.init()}SubPageControl.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=$("<div class='DiagnosisPageControl diasubtabs' id='"+a+"'></div>");$(d)[0].tabNumbers=Object.keys(this.data).length,$(d)[0].myText=this.myText;var e="hideme",f=this;if(this.parent[0].classList.contains("DiagnosisSubPageBlank")){$(d).addClass("subsubPage");var g=this.parent.find($(".Groupbox:visible:last"));g.append(d)}else if(this.parent[0].classList.contains("overlayContentElements")){$(d).addClass("subsubPage");var g=this.parent.find($(".Groupbox:last"));g.append(d)}else d.appendTo(this.parent);this.tabs=d;var h=sortHashArray(this.data),i=$('<div class="DiagnosisFooter"><span class="footerHead"></span><spanclass="scrollLeft"></span><span class="scrollRight"></span><span class="scrollUp"></span><span class="scrollDown active"></span></div>)');this.len=h.length;for(var j=0,k=h.length;j<k;j++){var l=h[j],m=!1;if(this.tabData=this.data[l],"object"==typeof this.tabData){this.tabid++;var n=DiagnosisCommon.getObjectType(l);this.tabTitle="";var o=!1;switch(this.tabData.Visible=!1,n){case"AddPageTab":this.tabTitle=this.tabData.Text;var p=this.tabData.VisibleAtRight?parseInt(this.tabData.VisibleAtRight):0,q=!0;p&&(q=emosWS.login.au.hasPaintShopRight(p)),this.tabData.VisibleOPCID&&""!==this.tabData.VisibleOPCID?f.parseVisibilityOPCTags(this.tabData.VisibleOPCID,function(a){(o=null!==GetAsBoolean(a.value)&&GetAsBoolean(a.value))&&q||(this.tabData.Visible=!0,this.tabid--,this.buildTab(j))}.bind(this.tabData)):q?this.buildTab(j):(this.tabData.Visible=!0,this.tabid--,this.buildTab(j));break;default:this.tabTitle=n,this.tabData.TextID="Messages",this.buildTab(j)}}}}catch(a){console.log("SubPageControl failed: "+a)}},SubPageControl.prototype.buildTab=function(a){var b=getElementGlobalID(),c,d,e,f=this.tabTitle,g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j="hideme",k;k=this.parent[0].classList.contains("DiagnosisSubPageBlank")?$("<div class='emosbutton subPageOverlay subsubPage' id='"+g+"' data-pos='"+f+"'><span>"+this.tabTitle+"</span><div class='subsubpageOverlay'><div class='blindHead'></div><div class='overlayContent'><div class='closeTabs closeSubTabs emosbutton'></div><div class='pagerHead pagerHeadLine'>"+this.tabTitle+"</div><div class='overlayContentElements'></div></div>"):this.parent[0].classList.contains("overlayContentElements")?$("<div class='emosbutton subPageOverlay subsubsubPage' id='"+g+"' data-pos='"+f+"'><span>"+this.tabTitle+"</span><div class='subsubsubpageOverlay'><div class='blindHead'></div><div class='overlayContent'><div class='closeTabs closeSubTabs emosbutton'></div><div class='pagerHead pagerHeadLine'>"+this.tabTitle+"</div><div class='overlayContentElements'></div></div>"):$("<div class='DiagnosisSubPageBlank dPage' id='"+g+"' data-pos='"+f+"'></div>");var l="";if(this.tabTitle.includes("Private")||this.tabTitle.includes("Public")||"privateOverlay"===this.diagnosisWindow.additionalClass)$("#contextMenu").empty(),$('<li class="subContext contextlast context"><a href="#">Copy to new private Tab</a></li>').appendTo("#contextMenu"),$('<li class="subContext elementdelete"><a href="#">delete element from Tab</a></li>').appendTo("#contextMenu"),$('<li class="subContext context"><a class="first" href="#'+g+'">Copy to Tab '+f+"</a></li>").insertBefore("#contextMenu .contextlast"),e="privateOverlay"===this.diagnosisWindow.additionalClass?$('<div class="radio"><label><input type="radio" name="view" value="compact" onchange="emosWS.SubPageControl.prototype.changeOverlayView(this);" checked="checked">comfort</label><label><input type="radio" name="view" value="comfort" onchange="emosWS.SubPageControl.prototype.changeOverlayView(this);">compact</label></div>'):$('<div class="radio"><label><input type="radio" name="view" value="compact" onchange="emosWS.SubPageControl.prototype.changeView(this);" checked="checked">compact</label><label><input type="radio" name="view" value="comfort" onchange="emosWS.SubPageControl.prototype.changeView(this);">comfort</label></div>'),c=$("<table cellspacing='0' class='privTable' id='"+i+"'><colgroup><col width='210'><col width='70'><col width='70'></colgroup><tbody class='tBody'><tr class='noBorder'><th>Name</th><th>Format</th><th>Value</th></tr></tbody></table>"),this.tabData.MyPlace&&"privateOverlay"===this.tabData.MyPlace?0===this.tabData.PosCounter?e.appendTo(k):$('<div class="radio empty"></div>').appendTo(k):e.appendTo(k),k.append('<label class="publishcheck '+j+'"><input class="plantcheckbox privatecheckbox" type="checkbox" name="topublish" value="" ><span></span></label>'),c.appendTo(k);else if("Summaries"===this.tabTitle){var m=$("<div/>",{class:"Groupbox "});m.append('<div class="DiagnosisText">Diagnose</div>'),m.append('<span class="xtext1">PLC</span><span class="xtext2">'+this.diagnosisWindow.PLC+"</span><br>"),m.append('<span class="xtext1">ID</span><span class="xtext2">'+this.diagnosisWindow.ID+"</span><br>"),m.append('<span class="xtext1">FU</span><span class="xtext2">'+this.diagnosisWindow.winName+"</span><br>"),m.append('<span class="xtext1">PLC Version</span><span class="xtext2 plcversion"></span><br>'),m.append('<span class="xtext1">HMI Versions</span><span class="xtext2 hmiversions">'+this.diagnosisWindow.windowData.Version.replace(/(..)-(..)/,"__  $1 $2")+"</span><br>");var n=$("<div/>",{class:"emosbutton welcome ",text:"i",click:function(){emosWS.debug.show()}});n.appendTo(m),m.append('<span class="infobuttontext">Communication Diagnosis</span>'),m.appendTo(k)}if(!this.tabData.Visible){$(k)[0].head=this.tabTitle,$(k)[0].headId=this.diagnosisWindow.getTextPrefix()+this.tabData.TextID,$(k)[0].tabNum=this.tabid,k.appendTo(this.tabs);var o=document.getElementById(b);this.tabData.Visible&&"2"!==this.tabData.Visible||(k.hasClass("subsubPage")?this.diagnosisWindow.appendPage(k.find(".subsubpageOverlay .overlayContentElements"),this.tabData,o,parseInt(this.tabData.VisibleAtRight||"0"),this.tabid,this.tabs):k.hasClass("subsubsubPage")?this.diagnosisWindow.appendPage(k.find(".subsubsubpageOverlay .overlayContentElements"),this.tabData,o,parseInt(this.tabData.VisibleAtRight||"0"),this.tabid,this.tabs):this.diagnosisWindow.appendPage(k,this.tabData,o,parseInt(this.tabData.VisibleAtRight||"0"),this.tabid,this.tabs),1===this.tabid||k.hasClass("subsubPage")||k.hasClass("subsubsubPage")?$("#"+k.attr("id")).show():$("#"+k.attr("id")).css({display:"none",right:-500})),k.hasClass("subsubPage")&&a===this.len-1&&this.tabs.find(".subsubpageOverlay .overlayContent").append('<div class="subFooter"><span class="scrollUp"></span><span class="scrollDown active"></span></div></div></div>')}},SubPageControl.prototype.changeView=function(a){$(".comfort").toggle(),$("input[value="+a.value+"]").prop("checked",!0)},SubPageControl.prototype.changeOverlayView=function(a){$(".compact").toggle(),$(".subcompact").toggle(),$("input[value="+a.value+"]").prop("checked",!0)},SubPageControl.prototype.parseVisibilityOPCTags=function(s,callback){[[" = "," === "],[" <> "," !== "],[" & "," && "],[" | "," || "],["NOT ","! "]].forEach(function(a){s=s.split(a[0]).join(a[1])});var tagMap={},tags=s.match(/[\w.]+(?!\s*')(?![\w.])/g);tags&&tags.forEach(function(a){isNaN(a)&&["true","false"].indexOf>-1&&(tagMap[a]=null)});var parseValues=function(itag,ivalue){void 0!==itag&&(tagMap[itag]=ivalue);for(var tag in tagMap)if(null===tagMap[tag])return;var parseString=s;for(var tag in tagMap)parseString=parseString.replace(new RegExp("\\b"+tag+"\\b","g"),tagMap[tag]);var value=!0;try{value=GetAsBoolean(eval(parseString)),callback({value:value})}catch(a){}};for(var tag in tagMap)emosWS.advise(this.plc+"."+tag,function(a,b){parseValues(b,a.value)},tag,emosWS.tagType.IO);parseValues()},emosWS.SubPageControl=SubPageControl;function AddSubTab(a,b,c){this.parent=a,this.myName=b,this.myText=c,this.init()}AddSubTab.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=this.parent.find(".DiagnosisSubPageBlank").length+1,e="",f="",g="hideme";this.myName&&"undefined"!==this.myName||(this.myName="Private"+d);var h='<div class="radio"><label><input type="radio" name="view'+d+'" value="compact" onchange="emosWS.SubPageControl.prototype.changeView(this);" checked="checked">compact</label><label><input type="radio" name="view'+d+'" value="comfort" onchange="emosWS.SubPageControl.prototype.changeView(this);">comfort</label></div>',i='<label class="publishcheck '+g+'"><input class="plantcheckbox privatecheckbox" type="checkbox" name="topublish" value=""><span></span></label>',j=$("<div class='DiagnosisSubPageBlank dPage' id='"+a+"' data-pos='"+this.myName+"'>"+h+i+"<table cellspacing='0' class='privTable' id='"+c+"'><colgroup><col width='210'><col width='70'><col width='70'></colgroup><tr class='noBorder'><th>Name</th><th>Format</th><th>Value</th></tr></table></div>");$(this.parent)[0].tabNumbers=d,$(j)[0].head=this.myName,$(j)[0].headId="Private"+d,$(j)[0].tabNum=d,j.appendTo(this.parent),$("#"+a).css({display:"none",right:-500});var k=!1,l=this;$.each($("#contextMenu li"),function(a,b){$(b).text()==="Copy to Tab "+l.myName&&(k=!0)}),(emosWS.isAdmin()&&"Private"===f&&!k||emosWS.isAdmin()&&!k)&&$('<li class="subContext context"><a href="#'+a+'">Copy to Tab '+this.myName+"</a></li>").insertBefore("#contextMenu .contextlast")}catch(a){console.log("AddTab failed: "+a)}},emosWS.AddSubTab=AddSubTab;var DiagnosisTimer=function(a){this.data=null,this.setValue(a)};DiagnosisTimer.prototype.setValue=function(a){this.data=this.decode(a)},DiagnosisTimer.prototype.decode=function(a){return{value:a}},DiagnosisTimer.prototype.encode=function(){return this.data.value},DiagnosisTimer.prototype.getData=function(){return this.data},DiagnosisTimer.prototype.toString=function(){return this.data.value},DiagnosisTimer.prototype.formatNumber=function(a){return a<10?(100+a).toString().slice(-2):a.toString()};var DiagnosisTimerSecond=function(a,b,c){this.plcBase=b,this.visuBase=c,DiagnosisTimer.call(this,a)};DiagnosisTimerSecond.prototype=Object.create(DiagnosisTimer.prototype),DiagnosisTimerSecond.prototype.constructor=DiagnosisTimerSecond,DiagnosisTimerSecond.prototype.decode=function(a){if("ms"===this.visuBase){var b=parseInt(a)*("ms"===this.plcBase?1:1e3),c=Math.floor(b/6e4);b-=6e4*c;var d=Math.floor(b/1e3);return b-=1e3*d,b=Math.round(b),{value:a,minute:c,second:d,msecond:b}}var d=parseInt(a)/("ms"===this.plcBase?1e3:1);d=Math.round(d);var e=Math.floor(d/3600);d-=3600*e;var c=Math.floor(d/60);return d-=60*c,{value:a,hour:e,minute:c,second:d}},DiagnosisTimerSecond.prototype.encode=function(a){return"ms"===this.visuBase?(this.data.minute=parseInt(a.minute),this.data.second=parseInt(a.second),this.data.msecond=parseInt(a.msecond),this.data.value=(6e4*this.data.minute+1e3*this.data.second+this.data.msecond)/("ms"===this.plcBase?1:1e3)):(this.data.hour=parseInt(a.hour),this.data.minute=parseInt(a.minute),this.data.second=parseInt(a.second),this.data.value=(3600*this.data.hour+60*this.data.minute+this.data.second)*("ms"===this.plcBase?1e3:1)),this.data.value},DiagnosisTimerSecond.prototype.toString=function(){if("ms"===this.visuBase){var a="",b="";return 0!==this.data.minute&&(a+=this.formatNumber(this.data.minute)+":",b+="m:"),0===this.data.minute&&0===this.data.second||(a+=this.formatNumber(this.data.second)+":",b+="s:"),a+=this.formatNumber(this.data.msecond),b+="ms",a+" "+b}var a="",b="";return 0!==this.data.hour&&(a+=this.formatNumber(this.data.hour)+":",b+="h:"),0===this.data.hour&&0===this.data.minute||(a+=this.formatNumber(this.data.minute)+":",b+="m:"),a+=this.formatNumber(this.data.second),b+="s",a+" "+b};var DiagnosisTimerMinute=function(a){DiagnosisTimer.call(this,a)};DiagnosisTimerMinute.prototype=Object.create(DiagnosisTimer.prototype),DiagnosisTimerMinute.prototype.constructor=DiagnosisTimerMinute,DiagnosisTimerMinute.prototype.decode=function(a){var b=parseInt(a),c=Math.floor(b/1440);b-=1440*c;var d=Math.floor(b/60);return b-=60*d,{value:a,day:c,hour:d,minute:b}},DiagnosisTimerMinute.prototype.encode=function(a){return this.data.day=parseInt(a.day),this.data.hour=parseInt(a.hour),this.data.minute=parseInt(a.minute),this.data.value=1440*this.data.day+60*this.data.hour+this.data.minute,this.data.value},DiagnosisTimerMinute.prototype.toString=function(){var a="",b="";return 0!==this.data.day&&(a+=formatNumber(this.data.day)+":",b+="d:"),(this.data.hour>0||0!==this.data.day)&&(a+=formatNumber(this.data.hour)+":",b+="h:"),a+=formatNumber(this.data.minute),b+="m",a+" "+b};var DiagnosisTimerSiemensDate=function(a){DiagnosisTimer.call(this,a)};DiagnosisTimerSiemensDate.prototype=Object.create(DiagnosisTimer.prototype),DiagnosisTimerSiemensDate.prototype.constructor=DiagnosisTimerSiemensDate,DiagnosisTimerSiemensDate.prototype.decode=function(a){try{var b=1989,c=12,d=30,e=/(.*?)-(.*?)-(.*?)$/,f=a.replace(e,function(a,e,f,g){b=parseInt(e),c=parseInt(f),d=parseInt(g)});return{value:a,year:b,month:c,day:d}}catch(e){return{value:a,year:b,month:c,day:d}}},DiagnosisTimerSiemensDate.prototype.encode=function(a){return this.data.year=a.year,this.data.month=a.month,this.data.day=a.day,this.data.value=a.year+"-"+this.formatNumber(a.month)+"-"+this.formatNumber(a.day),this.data.value},DiagnosisTimerSiemensDate.prototype.toString=function(){var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return(this.data.day<10?"0"+this.data.day:this.data.day)+" "+a[this.data.month-1]+" "+this.data.year};var DiagnosisTimerSiemensTimeOfDate=function(a){DiagnosisTimer.call(this,a)};DiagnosisTimerSiemensTimeOfDate.prototype=Object.create(DiagnosisTimer.prototype),DiagnosisTimerSiemensTimeOfDate.prototype.constructor=DiagnosisTimerSiemensTimeOfDate,DiagnosisTimerSiemensTimeOfDate.prototype.decode=function(a){try{var b=12,c=0,d=0,e=/(.*?):(.*?):(.*?)\.(.*?)$/,f=a.replace(e,function(a,e,f,g,h){b=parseInt(e),c=parseInt(f),d=parseInt(g)});return{value:a,hour:b,minute:c,second:d}}catch(e){return{value:a,hour:b,minute:c,second:d}}},DiagnosisTimerSiemensTimeOfDate.prototype.encode=function(a){return this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.value=a.hour+":"+a.minute+":"+a.second+".0",this.data.value},DiagnosisTimerSiemensTimeOfDate.prototype.toString=function(){var a="AM",b=this.data.hour;return b>12&&(b-=12,a="PM"),b+":"+(this.data.minute<10?"0"+this.data.minute:this.data.minute)+":"+(this.data.second<10?"0"+this.data.second:this.data.second)+" "+a};var DiagnosisTimerSiemensTime=function(a){DiagnosisTimer.call(this,a)};DiagnosisTimerSiemensTime.prototype=Object.create(DiagnosisTimer.prototype),DiagnosisTimerSiemensTime.prototype.constructor=DiagnosisTimerSiemensTime,DiagnosisTimerSiemensTime.prototype.decode=function(a){try{var b=0,c=0,d=0,e=0,f=0,g=/(\d+D)?(\d+H)?(\d+M)?(\d+S)?(\d+MS)?$/,h=this,i=a.replace(g,function(a,g,i,j,k,l){b=h.getNumberFromString(g),c=h.getNumberFromString(i),d=h.getNumberFromString(j),e=h.getNumberFromString(k),f=h.getNumberFromString(l)});return{value:a,day:b,hour:c,minute:d,second:e,ms:f}}catch(g){return{value:a,day:b,hour:c,minute:d,second:e,ms:f}}},DiagnosisTimerSiemensTime.prototype.encode=function(a){return this.data.day=a.days,this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.ms=a.ms,this.data.value=a.days+"D"+a.hour+"H"+a.minute+"M"+a.second+"S"+a.ms+"MS",this.data.value},DiagnosisTimerSiemensTime.prototype.toString=function(){var a="",b="",c=!1;if(0!==this.data.day&&(a+=this.data.day,b+="d",c=!0),!(0===this.data.day&&0===this.data.hour||0===this.data.hour&&0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.hour<10?"0"+this.data.hour:this.data.hour),b+=d+"h",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute||0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.minute<10?"0"+this.data.minute:this.data.minute),b+=d+"m",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute&&0===this.data.second||0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.second<10?"0"+this.data.second:this.data.second),b+=d+"s",c=!0}if(0!==this.data.day||0!==this.data.hour||0!==this.data.minute||0!==this.data.second||0!==this.data.ms){var d=c?":":"";a+=d+(this.data.ms<10?"0"+this.data.ms:this.data.ms),b+=d+"ms"}var e=a+" "+b;return" "===e?"0 s":e},DiagnosisTimerSiemensTime.prototype.getNumberFromString=function(a){var b=0;try{if(void 0!==a){var c=/(\d+)/;b=parseInt(a.match(c)[0])}return b}catch(a){return b}};var DiagnosisTimerSiemensS5Time=function(a){DiagnosisTimerSiemensTime.call(this,a)};DiagnosisTimerSiemensS5Time.prototype=Object.create(DiagnosisTimerSiemensTime.prototype),DiagnosisTimerSiemensS5Time.prototype.constructor=DiagnosisTimerSiemensS5Time,DiagnosisTimerSiemensS5Time.prototype.encode=function(a){return this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.ms=a.ms,this.data.value=a.hour+"H"+a.minute+"M"+a.second+"S"+a.ms+"MS",this.data.value},DiagnosisTimerSiemensS5Time.prototype.toString=function(){var a="",b="",c=!1;if(this.data.day=0,!(0===this.data.day&&0===this.data.hour||0===this.data.hour&&0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.hour<10?"0"+this.data.hour:this.data.hour),b+=d+"h",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute||0===this.data.minute&&0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.minute<10?"0"+this.data.minute:this.data.minute),b+=d+"m",c=!0}if(!(0===this.data.day&&0===this.data.hour&&0===this.data.minute&&0===this.data.second||0===this.data.second&&0===this.data.ms)){var d=c?":":"";a+=d+(this.data.second<10?"0"+this.data.second:this.data.second),b+=d+"s",c=!0}if(0!==this.data.day||0!==this.data.hour||0!==this.data.minute||0!==this.data.second||0!==this.data.ms){var d=c?":":"";a+=d+(this.data.ms<10?"0"+this.data.ms:this.data.ms),b+=d+"ms"}var e=a+" "+b;return" "===e?"0 s":e};var DiagnosisTimerSiemensDateAndTime=function(a){DiagnosisTimer.call(this,a)};DiagnosisTimerSiemensDateAndTime.prototype=Object.create(DiagnosisTimer.prototype),DiagnosisTimerSiemensDateAndTime.prototype.constructor=DiagnosisTimerSiemensDateAndTime,DiagnosisTimerSiemensDateAndTime.prototype.decode=function(a){try{if(!a)return;var b=a.lastIndexOf("-"),c=a.substring(0,b),d=a.substring(b+1);this.date=new DiagnosisTimerSiemensDate(c),this.time=new DiagnosisTimerSiemensTimeOfDate(d);var e=this.date.getData(),f=this.time.getData(),g=$.extend({},e,f);return g.value=a,g}catch(a){console.log("DiagnosisTimerSiemensDateAndTime.prototype.decode failed: "+a)}},DiagnosisTimerSiemensDateAndTime.prototype.encode=function(a){return this.data.year=a.year,this.data.month=a.month,this.data.day=a.day,this.data.hour=a.hour,this.data.minute=a.minute,this.data.second=a.second,this.data.value=a.year+"-"+this.formatNumber(a.month)+"-"+this.formatNumber(a.day)+"-"+a.hour+":"+a.minute+":"+a.second+".0",this.data.value},DiagnosisTimerSiemensDateAndTime.prototype.toString=function(){return this.date.toString()+" "+this.time.toString()};var colorList={G:"green",R:"red",X:"black",B:"blue",O:"lightgrey",P:"pink",Y:"yellow"};function AddDataToSubTab(a,b,c,d,e,f,g,h){this.parent=a,this.data=b,this.valueInSecond=b.valueInSecond,this.writable=b.writable,this.myKey=d,this.objectType=DiagnosisCommon.getObjectType(d),this.textValue="",this.myPrivOverlay=g,this.hoursValue=this.minutesValue=this.secondsValue=null,this.elementCount=h,this.plc=c,this.data.OPCID&&(this.plctag=this.plc+"."+this.data.OPCID),this.data.OPCID2&&(this.plctag2=this.plc+"."+this.data.OPCID2),this.data.LEDOPCID&&(this.plctagLed=this.plc+"."+this.data.LEDOPCID),this.data.writeTagWR1&&(this.writeLeft=this.plc+"."+this.data.writeTagWR1),this.data.readTagRD1&&(this.readLeft=this.plc+"."+this.data.readTagRD1),this.data.writeTagWR2&&(this.writeRight=this.plc+"."+this.data.writeTagWR2),this.data.writeTagWR3&&(this.writeMiddle=this.plc+"."+this.data.writeTagWR2),this.writeRight=this.plc+"."+this.data.writeTagWR3,this.data.readTagRD2&&(this.readRight=this.plc+"."+this.data.readTagRD2),this.data.readTagRD4&&(this.readLeft=!1,this.readRight=!1,this.read1=this.plc+"."+this.data.readTagRD1,this.read2=this.plc+"."+this.data.readTagRD2,this.read3=this.plc+"."+this.data.readTagRD3,this.read4=this.plc+"."+this.data.readTagRD4),this.led=this.LEDValue=this.writeRect=null,this.emosAdviceElement=null,this.myPrivId=f,this.unit=emosWS.getUnit(),this.textPrefixList={1:"T01_",3:"T03_",5:"T05_"},this.icon=this.data.leftIcon?this.data.leftIcon:"on",this.writable&&(this.classelist=this.icon+" emosbutton"),DiagnosisElement.call(this,{data:b,writable:this.writable})}AddDataToSubTab.prototype=Object.create(DiagnosisElement.prototype),AddDataToSubTab.prototype.constructor=AddDataToSubTab,AddDataToSubTab.prototype.setTimerValue=function(){switch(this.type){case timerTypes.Second:this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s",this.timerValue=new DiagnosisTimerSecond(0,this.plcBase,this.visuBase);break;case timerTypes.Minute:this.timerValue=new DiagnosisTimerMinute;break;case timerTypes.SiemensDate:this.timerValue=new DiagnosisTimerSiemensDate;break;case timerTypes.SiemensTimeOfDay:this.timerValue=new DiagnosisTimerSiemensTimeOfDate;break;case timerTypes.SiemensTime:this.timerValue=new DiagnosisTimerSiemensTime;break;case timerTypes.SiemensS5Time:this.timerValue=new DiagnosisTimerSiemensS5Time;break;case timerTypes.SiemensDateAndTime:this.timerValue=new DiagnosisTimerSiemensDateAndTime;break;default:this.timerValue=new DiagnosisTimer}},AddDataToSubTab.prototype.init=function(){try{var id=getElementGlobalID(),ledId=getElementGlobalID();this.ledID=ledId;var ledId1=getElementGlobalID();this.ledID1=ledId1;var ledId2=getElementGlobalID();this.ledID2=ledId2;var ledId3=getElementGlobalID();this.ledID3=ledId3;var ledId4=getElementGlobalID();this.ledID4=ledId4;var ledId5=getElementGlobalID();this.ledID5=ledId5;var ledId6=getElementGlobalID();this.ledID6=ledId6;var ledId7=getElementGlobalID();this.ledID7=ledId7;var textId=getElementGlobalID(),textId1=getElementGlobalID(),plcId=getElementGlobalID(),writeRectId=getElementGlobalID(),writeRectId2=getElementGlobalID(),writeRectId3=getElementGlobalID(),writeRectId4=getElementGlobalID(),writeRectId5=getElementGlobalID(),cancelbuttonId=getElementGlobalID(),savebuttonId=getElementGlobalID(),previewId=getElementGlobalID(),act=getElementGlobalID(),setP=getElementGlobalID(),numberId=getElementGlobalID(),number2Id=getElementGlobalID(),number3Id=getElementGlobalID(),number4Id=getElementGlobalID(),number5Id=getElementGlobalID(),hoursId0=getElementGlobalID(),minutesId0=getElementGlobalID(),secondsId0=getElementGlobalID(),hoursId=getElementGlobalID(),minutesId=getElementGlobalID(),secondsId=getElementGlobalID(),hoursId2=getElementGlobalID(),minutesId2=getElementGlobalID(),secondsId2=getElementGlobalID(),hoursId3=getElementGlobalID(),minutesId3=getElementGlobalID(),secondsId3=getElementGlobalID(),placeholder,hasplc2=!1,hasplcLed=!1,tableValue,elemFormat,multiName,multiGroup=!1;switch(this.objectType){case"AddTextLED":case"AddTextLEDLong":case"AddTextInputLED":case"AddTextLEDInputLong":case"AddTextLEDNiveau":var myWritable=this.data.writable?"writable":"notwritable";placeholder="<span id='"+ledId+"' class='"+this.classelist+" orange "+myWritable+"'></span><div class='textLed'><span id='"+textId+"'>"+this.data.Text+"</span></div><br style='clear:both;' />",this.emosAdviceElement="emosWS.DiagnosisTextLED.prototype",tableValue="<span id='"+ledId1+"' class='orange notwritable'></span>",elemFormat="binary";break;case"AddCommandFeedback1WR1RD":case"AddCommandFeedback2WR1RD":case"AddCommandFeedback2WR2RD":multiGroup=!0,elemFormat="<div>binary</div>",tableValue="<div id='"+ledId3+"' class='orange notwritable' style='display:block;float:none;'></div>",multiName="<div>"+this.data.readTagRD1+"</div>",this.data.readTagRD2&&(multiName+="<div>"+this.data.readTagRD2+"</div>",tableValue+="<div id='"+ledId4+"' class='orange notwritable' style='display:block;float:none;'></div>"),placeholder="<span id='"+ledId+"' class='emosbutton links "+this.data.leftIcon+"'></span><span id='"+ledId2+"' class='emosbutton rechts "+this.data.rightIcon+"'></span><div class='textLed'><span id='"+textId+"'>"+this.data.Text+"</span></div><br style='clear:both;' />",this.emosAdviceElement="emosWS.CommandFeedback2WR2RD.prototype";break;case"AddSpecialPurposeCentralStart":multiGroup=!0,elemFormat="<div>binary</div>",tableValue="<div id='"+ledId4+"' class='orange notwritable' style='display:block;float:none;'></div>",multiName="<div>"+this.data.readTagRD1+"</div>",this.data.readTagRD2&&(multiName+="<div>"+this.data.readTagRD2+"</div>",tableValue+="<div id='"+ledId5+"' class='orange notwritable' style='display:block;float:none;'></div><div id='"+ledId6+"' class='orange notwritable' style='display:block;float:none;'></div>"),placeholder="<span id='"+ledId+"' class='emosbutton halblinks off writable'></span><span id='"+ledId2+"' class='emosbutton mitte off_time writable'></span><span id='"+ledId3+"' class='emosbutton halbrechts plantStartStop writable'></span><div class='textLed smallerText'><span id='"+textId+"'>"+this.data.Text+"</span></div><br class='cl'>",this.emosAdviceElement="emosWS.SpecialPurposeCentralStart.prototype";break;case"AddCommandFeedback1WR2RD":multiGroup=!0,elemFormat="<div>binary</div>",tableValue="<div id='"+ledId3+"' class='orange notwritable' style='display:block;float:none;'></div>",multiName="<div>"+this.data.readTagRD1+"</div>",this.data.readTagRD2&&(multiName+="<div>"+this.data.readTagRD2+"</div>",tableValue+="<div id='"+ledId4+"' class='orange notwritable' style='display:block;float:none;'></div>"),placeholder="<span id='"+ledId+"' class='emosbutton notactive links "+this.data.leftIcon+"'></span><span id='"+ledId2+"' class='emosbutton rechts "+this.data.rightIcon+"'></span><div class='textLed'><span id='"+textId+"'>"+this.data.Text+"</span></div><br style='clear:both;' />",this.emosAdviceElement="emosWS.CommandFeedback1WR2RD.prototype";break;case"AddCommandFeedback3WR4RD":multiGroup=!0,elemFormat="<div>binary</div>",tableValue="<div id='"+ledId4+"' class='orange notwritable' style='display:block;float:none;'></div><div id='"+ledId5+"' class='orange notwritable' style='display:block;float:none;'></div><div id='"+ledId6+"' class='orange notwritable' style='display:block;float:none;'></div>",multiName="<div>"+this.data.readTagRD1+"</div><div>"+this.data.readTagRD2+"</div><div>"+this.data.readTagRD3+"</div><div>"+this.data.readTagRD4+"</div>",placeholder="<span id='"+ledId+"' class='emosbutton halblinks "+this.data.leftIcon+"'></span><span id='"+ledId2+"' class='emosbutton mitte "+this.data.middleIcon+"'></span><span id='"+ledId3+"' class='emosbutton halbrechts "+this.data.rightIcon+"'></span><div class='textLed smallerText'><span id='"+textId+"'>"+this.data.Text+"</span></div><br class='cl'>",this.emosAdviceElement="emosWS.CommandFeedback3WR4RD.prototype";break;case"AddStringInput":case"AddString":case"AddStringLong":case"AddStringInputLong":placeholder="<span class='DiagnosisNumberLRTextTextSVG plcTag'>PLC_Tag:"+this.plctag+"</span><span id='"+savebuttonId+"' class='savebutton  emosbutton'></span><span id='"+cancelbuttonId+"' class='cancelbutton  emosbutton'></span><span id='"+writeRectId+"' class='writebutton getKeypad keyboardInputInitiator emosbutton'></span><br class='cl'>",placeholder+="<span style='display: inline-block;margin-top: 10px;' class='DiagnosisNumberLRTextNumberSVG orange' id='"+textId+"'>"+this.textValue+"</span>",placeholder+="<div class='DiagnosisStringButtons' style='margin-top:20px;padding-top: 0;'>",placeholder+="<input lang='' maxlength="+this.data.StrLen+" pattern='.{"+this.data.StrStart+","+this.data.StrLen+"}' class='DiagnosisNumberLRTextNumberSVG preview keyboardInput' type='text' id='"+previewId+"' required></p>",placeholder+="</div>",this.emosAdviceElement="emosWS.DiagnosisString.prototype",tableValue="<span class='DiagnosisNumberLRTextNumberSVG orange' id='"+textId1+"'>"+this.textValue+"</span>",elemFormat="alphanum";break;case"AddTextDoubleTimerLong":case"AddTextDoubleTimerInputLong":case"AddTextDoubleTimerLongMin":case"AddTextDoubleTimerInputLongMin":placeholder="<span class='DiagnosisNumberLRTextTextSVG' id='"+textId+"'>"+this.data.Text+"</span><span id='"+savebuttonId+"' class='savemebutton emosbutton'></span><span id='"+cancelbuttonId+"' class='cancelbutton emosbutton'></span><span id='"+writeRectId2+"' class='writebutton emosbutton'></span><br class='cl'><div class='grey'><span class='pickertext' id='"+act+"'>Actual Value</span><span class='pickertime' id='"+numberId+"'><span class='pickertime hours orange' id='"+hoursId0+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+minutesId0+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+secondsId0+"'>"+this.secondsValue+"</span></span></div><div style='padding: 3px;'><span class='pickertext' id='"+setP+"'>Setpoint</span><span id='"+number2Id+"' class='pickertime'><span class='pickertime hours orange' id='"+hoursId+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+minutesId+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+secondsId+"'>"+this.secondsValue+"</span></span></div>",this.emosAdviceElement="emosWS.DiagnosisTextDoubleTimer.prototype",this.valueInSecond?(this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s"):this.plcBase=this.visuBase=null,this.timerValue=this.valueInSecond?new DiagnosisTimerSecond(0,this.plcBase,this.visuBase):new DiagnosisTimerMinute,hasplc2=!0,tableValue="&nbsp;<span id='"+hoursId3+"'>"+this.hoursValue+"</span><span>:</span><span id='"+minutesId3+"'>"+this.minutesValue+"</span><span>:</span><span id='"+secondsId3+"'>"+this.secondsValue+"</span><br>",tableValue+="(<span id='"+hoursId2+"'>"+this.hoursValue+"</span><span>:</span><span id='"+minutesId2+"'>"+this.minutesValue+"</span><span>:</span><span id='"+secondsId2+"'>"+this.secondsValue+"</span>)",elemFormat="hh:mm:ss";break;case"AddTextInteger":case"AddTextByte":case"AddTextReal":case"AddTextIntegerLong":case"AddTextRealLong":case"AddTextIntegerInput":case"AddTextByteInput":case"AddTextRealInput":case"AddTextRealInputNiveau":case"AddTextIntegerInputLong":case"AddTextRealInputLong":placeholder="<span class='DiagnosisNumberLRTextTextSVG textfeld' id='"+textId+"'>"+this.data.Text+"</span><span id='"+savebuttonId+"' class='savebutton emosbutton'></span><span id='"+cancelbuttonId+"' class='cancelbutton emosbutton'></span><span id='"+writeRectId3+"' class='writebutton getpad emosbutton'></span><form onsubmit='return false'><span class='DiagnosisNumberLRTextNumberSVG textfeld orange' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+numberId+"' data-value='"+this.numberValue+"'>"+this.value+emosWS.DiagnosisTextNumber.prototype.getUnitSymbol()+"</span><div class='DiagnosisStringButtons'></form></div>",this.emosAdviceElement="emosWS.DiagnosisTextNumber.prototype",tableValue="<span id='"+number4Id+"'>"+this.value+emosWS.DiagnosisTextNumber.prototype.getUnitSymbol()+"</span>",elemFormat="integer","AddTextByteInput"!==this.objectType&&"AddTextByte"!==this.objectType||(elemFormat="byte");break;case"AddLEDTextIntegerLong":case"AddTextLEDIntegerLong":case"AddLEDTextRealLong":case"AddLEDTextIntegerInputLong":case"AddTextLEDIntegerInputLong":case"AddLEDTextRealInputLong":this.writable?(this.inputfield=!0,placeholder="<div style='float: right;position: absolute;right: 20px;'><span style='display: none;' class='DiagnosisNumberLRTextTextSVG'></span><span id='"+savebuttonId+"' class='savebutton emosbutton'></span><span id='"+cancelbuttonId+"' class='cancelbutton emosbutton'></span><span id='"+writeRectId4+"' class='writebutton getpad emosbutton'></span><br class='cl'></div><span class='messageCircle' id='"+ledId+"'></span><span class='DiagnosisNumberLRTextText' id='"+textId+"'>"+this.data.Text+"</span><form onsubmit='return false' style='float:left; padding-top: 5px;'><span class='DiagnosisNumberLRTextNumberSVG textfeld' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+numberId+"' data-value='"+this.numberValue+"'>"+this.value+emosWS.DiagnosisLedTextNumber.prototype.getUnitSymbol()+"</span><div class='DiagnosisStringButtons'></form></div>"):(this.inputfield=!1,placeholder="<span id='"+numberId+"' class='DiagnosisNumbers without'></span><span class='messageCircle without' id='"+ledId+"'></span><span class='DiagnosisNumberLRTextText without' id='"+textId+"'>"+this.data.Text+"</span><span id='"+writeRectId4+"'></span><br class='cl' />"),this.emosAdviceElement="emosWS.DiagnosisLedTextNumber.prototype",hasplcLed=!0,tableValue="<span id='"+number5Id+"'>"+this.value+emosWS.DiagnosisTextNumber.prototype.getUnitSymbol()+"</span>",elemFormat="float";break;case"AddTextIntegerIntegerLong":case"AddTextRealRealLong":case"AddTextIntegerIntegerInputLong":case"AddTextRealRealInputLong":placeholder="<span class='DiagnosisNumberLRTextTextSVG' style='float:none;' id='"+textId+"'>"+this.data.Text+"</span><div style='float:left;margin-right: 55px;'><span style='display: block;' id='"+act+"'>Actual Value</span><span style='display: block;' class='DiagnosisNumberLRTextNumberSVG' id='"+numberId+"' data-value='"+this.numberValue+"'>"+this.numberValue+emosWS.DiagnosisTextNumberNumber.prototype.getUnitSymbol()+"</span></div><form onsubmit='return false' class='textnumnum'><span style='display: block;' id='"+setP+"'>Setpoint</span><span style='display: block; float:left;' class='DiagnosisNumberLRTextNumberSVG textfeld orange' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+number2Id+"' data-value='"+this.number2Value+"'>"+this.number2Value+emosWS.DiagnosisTextNumberNumber.prototype.getUnitSymbol()+"</span><span id='"+savebuttonId+"' class='savebutton second emosbutton'></span><span id='"+cancelbuttonId+"' class='cancelbutton emosbutton'></span><span id='"+writeRectId5+"' class='writebutton getpad emosbutton'></span><br class='cl'><div class='DiagnosisStringButtons'></form></div>",this.emosAdviceElement="emosWS.DiagnosisTextNumberNumber.prototype",hasplc2=!0,tableValue="<span id='"+number3Id+"' data-value='"+this.number2Value+"'>"+this.number2Value+emosWS.DiagnosisTextNumberNumber.prototype.getUnitSymbol()+"</span>",elemFormat="integer";break;case"AddTextTimerInputLong":case"AddTextSiemensDateInputLong":case"AddTextSiemens_TIME_TimerLong":case"AddTextSiemensTimeInputLong":case"AddTextSiemens_TIME_TimerInputLong":case"AddTextSiemens_S5TIME_TimerInputLong":case"AddTextSiemens_DATE_AND_TIME_TimerInputLong":placeholder="<span class='DiagnosisNumberLRTextTextSVG' id='"+textId+"'>"+this.data.Text+"</span><span id='"+savebuttonId+"' class='savemebutton emosbutton'></span><span id='"+cancelbuttonId+"' class='cancelbutton emosbutton'></span><span id='"+writeRectId2+"' class='writebutton emosbutton'></span><br class='cl'><span id='"+numberId+"' class='pickertime'><span class='pickertime hours orange' id='"+hoursId+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+minutesId+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+secondsId+"'>"+this.secondsValue+"</span></span></div>",this.emosAdviceElement="emosWS.DiagnosisTextTimer.prototype",tableValue="<span id='"+number2Id+"' class='pickertime'><span id='"+hoursId2+"'>"+this.hoursValue+"</span><span>:</span><span id='"+minutesId2+"'>"+this.minutesValue+"</span><span>:</span><span id='"+secondsId2+"'>"+this.secondsValue+"</span></span>",elemFormat="hh:mm:ss","AddTextTimerInputLong"===this.objectType?this.type=timerTypes.Second:"AddTextSiemensDateInputLong"===this.objectType?this.type=timerTypes.SiemensDate:"AddTextSiemensTimeInputLong"===this.objectType?this.type=timerTypes.SiemensTimeOfDay:"AddTextSiemens_TIME_TimerInputLong"===this.objectType?this.type=timerTypes.SiemensTime:"AddTextSiemens_S5TIME_TimerInputLong"===this.objectType?this.type=timerTypes.SiemensS5Time:"AddTextSiemens_DATE_AND_TIME_TimerInputLong"===this.objectType&&(this.type=timerTypes.SiemensDateAndTime),this.setTimerValue()}var addClass;addClass=this.parent.find("tr.compact").length%2==0?"odd":"even";var firstTR="<tr data-group="+this.elementCount+" class='parentsbox priv compact "+addClass+"'>",trGroup="<td class='tdFirst'>"+this.plc+" "+this.data.OPCID+"</td>";multiGroup&&(firstTR="<tr data-group="+this.elementCount+" class='parentsbox priv compact noBottom "+addClass+"'><td colspan = '3'>"+this.plc+" "+this.data.OPCID+"</td></tr><tr data-group="+this.elementCount+" class='parentsbox priv subcompact "+addClass+"'>",trGroup="<td class='tdFirst'>"+multiName+"</td>"),this.myPrivOverlay?(firstTR="<tr data-group="+this.elementCount+" class='parentsbox priv compact "+addClass+"'>",trGroup="<td class='tdFirst' colspan = '3'>"+this.plc+" "+this.data.OPCID+"</td>",this.panel=$("<tr data-group="+this.elementCount+" class='dragbox'><td colspan='3' style='border:none;'><table cellpadding='0' cellspacing='0' style='border:none;'>"+firstTR+trGroup+"</tr><tr data-group="+this.elementCount+" class='priv comfort'><td colspan='3'><div data-group="+this.elementCount+" class='Groupbox parentsbox priv' id='"+id+"'>"+placeholder+"</div></td></tr></table></td></tr>"),this.parent.find("colgroup col:nth-child(1)").attr("width","200"),this.parent.find("colgroup col:nth-child(2)").attr("width","55"),this.parent.find("colgroup col:nth-child(3)").attr("width","55"),this.parent.find("tr.noBorder").remove()):this.panel=$(firstTR+trGroup+"<td class='tdSecond'>"+elemFormat+"</td><td class='tdThird'>"+tableValue+"</td></tr><tr data-group="+this.elementCount+" style='display:none;' class='priv comfort'><td colspan='3'><div data-group="+this.elementCount+" class='Groupbox parentsbox priv' id='"+id+"'>"+placeholder+"<br style='clear:both;' /></div></td></tr>"),this.panel[0].myData=this.data,this.panel[0].myKey=this.myKey,this.panel[0].myPLC=this.plc,this.panel[0].myPrivId=this.myPrivId,this.panel.find(".Groupbox")[0].myData=this.data,this.panel.appendTo(this.parent),this.writeRectId=writeRectId,this.writeRectId2=writeRectId2,this.writeRectId3=writeRectId3,this.writeRectId4=writeRectId4,this.writeRectId5=writeRectId5,this.textId=textId,this.led=document.getElementById(ledId),this.led1=document.getElementById(ledId1),this.led2=document.getElementById(ledId2),this.text=document.getElementById(textId),this.text1=document.getElementById(textId1),this.writeRect1=document.getElementById(id),this.id=id,this.cancelbutton=document.getElementById(cancelbuttonId),this.savebutton=document.getElementById(savebuttonId),this.number=document.getElementById(numberId),this.number2=document.getElementById(number2Id),this.number3=document.getElementById(number3Id),this.number4=document.getElementById(number4Id),this.number5=document.getElementById(number5Id),this.hours0=document.getElementById(hoursId0),this.minutes0=document.getElementById(minutesId0),this.seconds0=document.getElementById(secondsId0),this.hours=document.getElementById(hoursId),this.minutes=document.getElementById(minutesId),this.seconds=document.getElementById(secondsId),this.hours2=document.getElementById(hoursId2),this.minutes2=document.getElementById(minutesId2),this.seconds2=document.getElementById(secondsId2),this.hours3=document.getElementById(hoursId3),this.minutes3=document.getElementById(minutesId3),this.seconds3=document.getElementById(secondsId3),this.writeRect=document.getElementById(writeRectId),this.writeRect2=document.getElementById(writeRectId2),this.writeRect3=document.getElementById(writeRectId3),this.writeRect4=document.getElementById(writeRectId4),this.writeRect5=document.getElementById(writeRectId5),this.act=act,this.setP=setP,!this.plctag||this.readLeft||this.read1||emosWS.advise(this.plctag,eval(this.emosAdviceElement).datachangeListener.bind(this),"",emosWS.tagType.IO),hasplc2&&emosWS.advise(this.plctag2,eval(this.emosAdviceElement).datachange2Listener.bind(this),"",emosWS.tagType.IO),hasplcLed&&emosWS.advise(this.plctagLed,eval(this.emosAdviceElement).datachangeLedListener.bind(this),"",emosWS.tagType.IO),this.readLeft&&emosWS.advise(this.readLeft,eval(this.emosAdviceElement).datachangeListenerLeft.bind(this),"",emosWS.tagType.IO),this.readRight&&emosWS.advise(this.readRight,eval(this.emosAdviceElement).datachangeListenerRight.bind(this),"",emosWS.tagType.IO),this.read4&&(emosWS.advise(this.read1,eval(this.emosAdviceElement).datachangeListener1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read2,eval(this.emosAdviceElement).datachangeListener2.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read3,eval(this.emosAdviceElement).datachangeListener4.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read4,eval(this.emosAdviceElement).datachangeListener3.bind(this),"",emosWS.tagType.IO)),this.getAdviceText(),eval(this.emosAdviceElement).getWritable(this)}catch(a){console.log("adddata init failed: "+a)}},AddDataToSubTab.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?$("#"+this.id).find(".emosbutton").removeClass("disabled"):$("#"+this.id).find(".emosbutton").addClass("disabled")},AddDataToSubTab.prototype.getAdviceText=function(){emosWS.sendAdviseText(this.textPrefixList[this.data.DiagnosisLibID]+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),emosWS.sendAdviseText(this.textPrefixList[this.data.DiagnosisLibID]+"Setpoint","name",function(a){$("#"+this.setP).text(a.value+":")},this),emosWS.sendAdviseText(this.textPrefixList[this.data.DiagnosisLibID]+"ActualValue","name",function(a){$("#"+this.act).text(a.value+":")},this)},emosWS.AddDataToSubTab=AddDataToSubTab;function TopTextLED(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass="DiagnosisTopText",this.plctag=this.plc+"."+this.data.OPCID,this.led=this.led1=this.border=this.text=this.text1=null,DiagnosisElement.call(this,{data:b})}TopTextLED.prototype=Object.create(DiagnosisElement.prototype),TopTextLED.prototype.constructor=TopTextLED,TopTextLED.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID();(this.panel=$("<div class='"+this.positionClass+"' id='"+a+"'><span class='messageCircle orange' id='"+b+"'></span><span id='"+d+"'>"+this.data.Text+"</span></div>")).appendTo(this.parent),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("TopTextLED init failed: "+a)}},TopTextLED.prototype.datachangeListener=function(a){try{var b=GetAsBoolean(a.value),c=colorList[b?this.data.OnLED:this.data.OffLED];this.led.className="messageCircle "+c}catch(a){console.log("TopTextLED datachangeListener failed: "+a)}},emosWS.TopTextLED=TopTextLED;function DiagnosisSetpointRampBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"DiagnosisBar parentsbox"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"DiagnosisBar parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"DiagnosisBar parentsbox"}},this.min=0,this.max=100,this.ymin=2,this.percent0=80,this.plctag=this.plc+"."+this.data.OPCID,this.plctagRamp=this.plc+"."+this.data.OPCRampID,this.visibleOPC=this.plc+"."+this.data.OPCRampVisibleID,this.opcvisible=!0,this.parentDiv=this.numberValue=this.bar=this.lineValue=this.lineValue2=this.lineValueR=this.lineValueR2=this.text=this.number=this.numberR=this.unitText=null,this.unit=emosWS.getUnit(),this.panel=null,this.init()}DiagnosisSetpointRampBar.prototype.getBarValue=function(a){return a<this.min?a=this.min:a>this.max&&(a=this.max),this.ymin+(100-(a-this.min)/(this.max-this.min)*100)*this.percent0/100+"%"},DiagnosisSetpointRampBar.prototype.getBarDegreeText=function(a){return"- "+(this.min+(this.max-this.min)*a/100)+this.unitText},DiagnosisSetpointRampBar.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},DiagnosisSetpointRampBar.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m=getElementGlobalID(),n=getElementGlobalID(),o=getElementGlobalID(),p=getElementGlobalID(),q=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var r=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol();(this.panel=$("<div class='"+r.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisRampBarTextSVG' style='display: block;'><text id='"+e+"' x='50%' y='17px' fill='black' text-anchor='middle' font-weight='bold'>"+this.data.Text+"</text></svg><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisRampBarSVG' id='"+m+"' style='margin-left: 20px'><rect class='DiagnosisRampBar' id='"+o+"' x='58%' y='"+this.ymin+"%' width='40%' height='"+this.percent0+"%' /><line id='"+p+"' x1='58.5%' y1='15%' x2='97.5%' y2='15%' style='stroke-width:5;stroke:#95bfd8'/><rect x='1px' width='50px' height='15' y='85%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+n+"' x='30px' y='91%' text-anchor='middle' fill='orange'>"+this.numberValue+"</text></svg><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisRampBarSVG' id='"+b+"'><rect class='DiagnosisRampBar' id='"+d+"' x='1%' y='"+this.ymin+"%' width='40%' height='"+this.percent0+"%' /><line id='"+f+"' x1='1.5%' y1='15%' x2='40.5%' y2='15%' style='stroke-width:5;stroke:#95bfd8'/><rect x='1px' width='50px' height='15' y='85%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+c+"' x='30px' y='91%' text-anchor='middle' fill='orange'>"+this.numberValue+"</text><text class='DiagnosisBarDegreeText' id='"+h+"' x='40%' y='80.5%'>"+this.getBarDegreeText(0)+"</text><text class='DiagnosisBarDegreeText' id='"+i+"' x='40%' y='60.5%'>"+this.getBarDegreeText(25)+"</text><text class='DiagnosisBarDegreeText' id='"+j+"' x='40%' y='41.5%'>"+this.getBarDegreeText(50)+"</text><text class='DiagnosisBarDegreeText' id='"+k+"' x='40%' y='21.5%'>"+this.getBarDegreeText(75)+"</text><text class='DiagnosisBarDegreeText' id='"+l+"' x='40%' y='3.5%'>"+this.getBarDegreeText(100)+"</text></svg></div>")).appendTo(this.parentDiv),this.number=document.getElementById(c),this.numberR=document.getElementById(n),this.text=document.getElementById(e),this.bar=document.getElementById(d),this.lineValue=document.getElementById(f),this.lineValue2=document.getElementById(g),this.lineValueR=document.getElementById(p),this.lineValueR2=document.getElementById(q),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctagRamp,this.datachangeRampListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),emosWS.advise(this.visibleOPC,function(a){this.opcvisible=GetAsBoolean(a.value),this.setVisibility()}.bind(this),"",emosWS.tagType.IO)}catch(a){console.log("DiagnosisBar init failed: "+a)}},DiagnosisSetpointRampBar.prototype.setVisibility=function(){},DiagnosisSetpointRampBar.prototype.datachangeListener=function(a){try{this.data.Precision?this.numberValue=parseFloat(a.value).toFixed(this.data.Precision):this.numberValue=GetAsInteger(a.value),this.number.setAttribute("fill","#6c6c6c"),this.number.textContent=this.numberValue+this.getUnitSymbol();var b=this.getBarValue(this.numberValue);this.lineValue.setAttribute("y1",b),this.lineValue.setAttribute("y2",b),this.lineValue2.setAttribute("y1",b),this.lineValue2.setAttribute("y2",b)}catch(a){console.log("DiagnosisSetpointRampBar datachangeListener failed: "+a)}},DiagnosisSetpointRampBar.prototype.datachangeRampListener=function(a){try{var b=a.value;this.numberR.setAttribute("fill","#6c6c6c"),this.numberR.textContent=b+this.getUnitSymbol();var c=this.getBarValue(b);this.lineValueR.setAttribute("y1",c),this.lineValueR.setAttribute("y2",c),this.lineValueR2.setAttribute("y1",c),this.lineValueR2.setAttribute("y2",c)}catch(a){console.log("DiagnosisSetpointRampBar datachangeRampListener failed: "+a)}},emosWS.DiagnosisSetpointRampBar=DiagnosisSetpointRampBar;function DiagnosisSetpointBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"DiagnosisBar parentsbox"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"DiagnosisBar parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"DiagnosisBar parentsbox"}},this.min=0,this.max=100,this.ymin=15,this.percent0=67,this.plctag=this.plc+"."+this.data.OPCID,this.parentDiv=this.numberValue=this.bar=this.lineValue=this.lineValue2=this.text=this.number=this.unitText=null,this.unit=emosWS.getUnit(),this.init()}DiagnosisSetpointBar.prototype.getBarValue=function(){this.numberValue<this.min?this.numberValue=this.min:this.numberValue>this.max&&(this.numberValue=this.max);var a=this.ymin+(100-(this.numberValue-this.min)/(this.max-this.min)*100)*this.percent0/100+"%";return console.log("plctag="+this.plctag+" / bar value % = "+a),a},DiagnosisSetpointBar.prototype.getBarDegreeText=function(a){return"- "+(this.min+(this.max-this.min)*a/100)+this.unitText},DiagnosisSetpointBar.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},DiagnosisSetpointBar.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var l=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol();$("<div class='"+l.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisBarSVG'><text id='"+d+"' x='50%' y='10%' fill='black' text-anchor='middle' font-weight='bold'>"+this.data.Text+"</text><rect id='"+c+"' x='40%' y='"+this.ymin+"%' width='20%' height='"+this.percent0+"%' style='fill:white;stroke-width:1;stroke:black' /><line id='"+e+"' x1='40.5%' y1='15%' x2='59.5%' y2='15%' style='stroke-width:5;stroke:yellow'/><line id='"+f+"' x1='40%' y1='15%' x2='60%' y2='15%' style='stroke-width:1;stroke:black'/><rect x='20%' width='60%' height='15' y='87%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+b+"' x='50%' y='92%' text-anchor='middle' fill='orange'>"+this.numberValue+"</text><text class='DiagnosisBarDegreeText' id='"+g+"' x='60%' y='83.5%'>"+this.getBarDegreeText(0)+"</text><text class='DiagnosisBarDegreeText' id='"+h+"' x='60%' y='66.75%'>"+this.getBarDegreeText(25)+"</text><text class='DiagnosisBarDegreeText' id='"+i+"' x='60%' y='50%'>"+this.getBarDegreeText(50)+"</text><text class='DiagnosisBarDegreeText' id='"+j+"' x='60%' y='33.25%'>"+this.getBarDegreeText(75)+"</text><text class='DiagnosisBarDegreeText' id='"+k+"' x='60%' y='16.5%'>"+this.getBarDegreeText(100)+"</text></svg></div>").appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.bar=document.getElementById(c),this.lineValue=document.getElementById(e),this.lineValue2=document.getElementById(f),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisBar init failed: "+a)}},DiagnosisSetpointBar.prototype.datachangeListener=function(a){try{this.numberValue=GetAsInteger(a.value),this.number.setAttribute("fill","#6c6c6c"),this.number.textContent=this.numberValue+this.getUnitSymbol();var b=this.getBarValue();this.lineValue.setAttribute("y1",b),this.lineValue.setAttribute("y2",b),this.lineValue2.setAttribute("y1",b),this.lineValue2.setAttribute("y2",b)}catch(a){console.log("TopTextLED datachangeListener failed: "+a)}},emosWS.DiagnosisSetpointBar=DiagnosisSetpointBar;function DiagnosisBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"DiagnosisBar parentsbox"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"DiagnosisBar parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"DiagnosisBar parentsbox"}},this.min=0,this.max=100,this.percent0=67,this.plctag=this.plc+"."+this.data.OPCID,this.parentDiv=this.numberValue=this.bar=this.barValue=this.text=this.number=this.unitText=null,this.unit=emosWS.getUnit(),this.init()}DiagnosisBar.prototype.getBarValue=function(){return this.numberValue<this.min?this.numberValue=this.min:this.numberValue>this.max&&(this.numberValue=max),(100-(this.numberValue-this.min)/(this.max-this.min)*100)*this.percent0/100+"%"},DiagnosisBar.prototype.getBarDegreeText=function(a){return"- "+(this.min+(this.max-this.min)*a/100)+this.unitText},DiagnosisBar.prototype.getUnitSymbol=function(){switch(this.unit){case emosWS.unitID.Metric:return" "+this.data.UnitMetric;case emosWS.unitID.UnitImperial:return" "+this.data.UnitImperial;case emosWS.unitID.UnitLocale:return" "+this.data.UnitLocale;default:return""}},DiagnosisBar.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var k=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol();$("<div class='"+k.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisBarSVG'><text id='"+d+"' x='50%' y='10%' fill='black' text-anchor='middle' font-weight='bold'>"+this.data.Text+"</text><rect id='"+c+"' x='40%' y='15%' width='20%' height='67%' style='fill:#3b4654' /><rect id='"+e+"' x='40%' y='15%' width='20%' height='35%' style='fill:#d9dee2'/><rect x='20%' width='60%' height='15' y='87%' style='fill:white;stroke-width:0.5;stroke:grey'/><text id='"+b+"' x='50%' y='92%' text-anchor='middle' fill='orange'>"+this.numberValue+"</text><text class='DiagnosisBarDegreeText' id='"+f+"' x='60%' y='83.5%'>"+this.getBarDegreeText(0)+"</text><text class='DiagnosisBarDegreeText' id='"+g+"' x='60%' y='66.75%'>"+this.getBarDegreeText(25)+"</text><text class='DiagnosisBarDegreeText' id='"+h+"' x='60%' y='50%'>"+this.getBarDegreeText(50)+"</text><text class='DiagnosisBarDegreeText' id='"+i+"' x='60%' y='33.25%'>"+this.getBarDegreeText(75)+"</text><text class='DiagnosisBarDegreeText' id='"+j+"' x='60%' y='16.5%'>"+this.getBarDegreeText(100)+"</text></svg></div>").appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.bar=document.getElementById(c),this.barValue=document.getElementById(e),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisBar init failed: "+a)}},DiagnosisBar.prototype.datachangeListener=function(a){try{this.data.Precision?this.numberValue=parseFloat(a.value).toFixed(this.data.Precision):this.numberValue=GetAsInteger(a.value),this.number.setAttribute("fill","#6c6c6c"),this.number.textContent=this.numberValue+this.getUnitSymbol(),this.barValue.setAttribute("height",this.getBarValue())}catch(a){console.log("TopTextLED datachangeListener failed: "+a)}},emosWS.DiagnosisBar=DiagnosisBar;function DiagnosisSpace(a,b){this.data=b,this.positionClass={L:{parent:a.LRLeft},R:{parent:a.LRRight},Long:{parent:a.LRLong}},this.init()}DiagnosisSpace.prototype.init=function(){try{var a=this.positionClass[this.data.Position];$("<div class='DiagnosisSpace'></div>").appendTo(a.parent)}catch(a){console.log("DiagnosisSpace init failed: "+a)}},emosWS.DiagnosisSpace=DiagnosisSpace;var valueTypes={Integer:0,Float:1,TimeInSecond:2,TimeInMinute:3,String:4},DiagnosisForm=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;window.addEventListener("load",w,!1);function w(){z()}function x(){switch(b.type){case valueTypes.TimeInSecond:case valueTypes.TimeInMinute:var d=k.val(),e=l.val(),f=m.val(),g=n.val();v=b.value.encode({day:d,hour:e,minute:f,second:g});break;case valueTypes.String:v=u.val();break;default:v=c.val()}emosWS.poke(b.plctag,v),a.dialog("close"),void 0!==b.callback&&b.callback(v)}function y(){return a}function z(){try{var b=getElementGlobalID(),d=getElementGlobalID(),v=getElementGlobalID(),w=getElementGlobalID(),y=getElementGlobalID(),z=getElementGlobalID(),A=getElementGlobalID(),B=getElementGlobalID(),C=getElementGlobalID(),D=getElementGlobalID(),E=getElementGlobalID(),F=getElementGlobalID(),G=getElementGlobalID(),H=getElementGlobalID(),I=getElementGlobalID(),J=getElementGlobalID(),K=getElementGlobalID(),L=getElementGlobalID(),M=getElementGlobalID(),N="<div class='vertical controls' id='"+D+"'>   <span id='"+E+"'><input id='"+I+"'>d</span>   <span id='"+F+"'><input id='"+J+"'>h</span>   <span id='"+G+"'><input id='"+K+"'>m</span>   <span id='"+H+"'><input id='"+L+"'>s</span></div>",O="<div class='DiagnosisStringEdit'><textarea rows='4' id='"+M+"'</textarea></div>",P=$("<div id='"+b+"'>   <div class='DiagnosisExtraContent'>       <p id='"+d+"'>plc.tag</p>       <p id='"+v+"'>text</p>   <table style='width:100%; text-align:center'><tr>       <td id='"+w+"'>Min</td>       <td>..............</td>       <td id='"+y+"'>.</td>       <td>..............</td>       <td id='"+z+"'>Max</td>   <tr></table>   </div>   <form>       <div class='DiagnosisDatePickerContainer'>           <div class='DiagnosisDatePickerCenter'>               <span id='"+C+"'>                   <input name='numberValue' id='"+A+"' value='0'>                   <label id='"+B+"'>unit</label>               </span>"+N+"           </div>       </div>"+O+"       <input type='submit' tabindex='-1' style='position:absolute; top:-1000px'>   </form></div>");$("body").append(P),a=$("#"+b).dialog({modal:!0,autoOpen:!1,width:350,title:"Input dialog",buttons:{Cancel:function(){a.dialog("close")},OK:x},close:function(){Q[0].reset()}}),c=$("#"+A).spinner(),e=$("#"+B),f=$("#"+w),g=$("#"+y),h=$("#"+z),i=$("#"+d),j=$("#"+v),k=$("#"+I).spinner({min:0,step:1,start:1}),l=$("#"+J).spinner({min:0,max:23,step:1,start:1}),m=$("#"+K).spinner({min:0,max:59,step:1,start:0}),n=$("#"+L).spinner({min:0,max:59,step:1,start:0}),p=$("#"+D),q=$("#"+E),r=$("#"+F),s=$("#"+G),t=$("#"+H),o=$("#"+C),u=$("#"+M);var Q=a.find("form").on("submit",function(a){a.preventDefault(),x()})}catch(a){console.log("appendFormNumber failed: "+a)}}function A(c){switch(b=c,I(),B(),b.type){case valueTypes.TimeInSecond:F(),G(),H(),g.text("s"),a.dialog("open");break;case valueTypes.TimeInMinute:E(),F(),G(),g.text("m"),a.dialog("open");break;case valueTypes.String:D(),a.dialog("open");break;default:C(),a.dialog("open")}}function B(){i.text(b.plctag),j.text(b.text),f.text("[  "+b.min),h.text(b.max+"  ]")}function C(){c.spinner("option","min",b.min),c.spinner("option","max",b.max),c.spinner("option","step",Math.pow(10,-1*(b.precision||0))),c.val(b.value),e.text(b.unit),o.show()}function D(){u.val(b.value),u.show()}function E(){q.show();var a=b.value.data;k.val(a.day)}function F(){r.show();var a=b.value.data;l.val(a.hour)}function G(){s.show();var a=b.value.data;m.val(a.minute)}function H(){t.show();var a=b.value.data;n.val(a.second)}function I(){o.hide(),q.hide(),r.hide(),s.hide(),t.hide(),u.hide(),g.text(".")}return{open:A,getFormNumberDialog:y}}(),DiagnosisDateForm=function(){var a,b,c,d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g,h,i,j,k,l,m,n,o,p,q;window.addEventListener("load",r,!1);function r(){u()}function s(){console.log("Value is changed");var d=g.datepicker("getDate"),e=d.getFullYear(),f=d.getMonth()+1,h=d.getDate(),n=i.val(),o=j.val(),p=k.val(),q=l.val(),r=m.val(),s=c.encode({year:e,month:f,day:h,days:n,hour:o,minute:p,second:q,ms:r});emosWS.poke(b.plctag,s),a.dialog("close"),void 0!==b.callback&&b.callback(c)}function t(){return a}function u(){try{var b=getElementGlobalID(),c=getElementGlobalID(),r=getElementGlobalID(),t=getElementGlobalID(),u=getElementGlobalID(),v=getElementGlobalID(),w=getElementGlobalID(),x=getElementGlobalID(),y=getElementGlobalID(),z="<div id='"+e+"'></div>",A="<div class='vertical controls' id='"+x+"'>   <span id='"+b+"'><input id='"+c+"'>d</span>   <input id='"+r+"'>h   <input id='"+t+"'>m   <input id='"+u+"'>s   <span id='"+w+"'><input style='width: 2em' id='"+v+"'>ms</span></div>",B=$("<div id='"+d+"'>   <div class='DiagnosisExtraContent'>       <p id='"+f+"'>plc.tag</p>       <p id='"+y+"'>Adjust Date</p>   </div>   <form><div class='DiagnosisDatePickerContainer'>   <div class='DiagnosisDatePickerCenter'>"+z+A+"   </div></div>           <input type='submit' tabindex='-1' style='position:absolute; top:-1000px'>   </form></div>");$("body").append(B),a=$("#"+d).dialog({modal:!0,autoOpen:!1,width:400,title:"Input dialog",buttons:{Cancel:function(){a.dialog("close")},OK:s},close:function(){}}),g=$("#"+e).datepicker({changeMonth:!0,changeYear:!0}),g.datepicker("option","firstDay",1),g.datepicker("option","yearRange","0:3000"),p=$("#"+b),i=$("#"+c).spinner({min:0,step:1,start:1}),j=$("#"+r).spinner({min:0,max:23,step:1,start:1}),k=$("#"+t).spinner({min:0,max:59,step:1,start:0}),l=$("#"+u).spinner({min:0,max:59,step:1,start:0}),m=$("#"+v).spinner({min:0,max:999,step:1,start:0}),q=$("#"+w),o=$("#"+x),h=$("#"+f),n=$("#"+y);var C=a.find("form").on("submit",function(a){a.preventDefault(),s()})}catch(a){console.log("appendFormNumber failed: "+a)}}function v(d){switch(b=d,c=b.value,h.text(b.plctag),w(),c.constructor){case DiagnosisTimerSiemensDate:x(),n.text("Adjust date (Simens DATE):"),a.dialog("open");break;case DiagnosisTimerSiemensTimeOfDate:n.text("Adjust time (Simens TIME_OF_DAY):"),y(),a.dialog("open");break;case DiagnosisTimerSiemensTime:n.text("Adjust time (Simens TIME):"),z(),y(),A(),a.dialog("open");break;case DiagnosisTimerSiemensS5Time:n.text("Adjust time (Simens S5TIME):"),y(),A(),a.dialog("open");break;case DiagnosisTimerSiemensDateAndTime:n.text("Adjust date and time (Simens DATE/HND_TIME):"),x(),y(),a.dialog("open")}}function w(){g.hide(),p.hide(),o.hide(),q.hide()}function x(){g.show();var a=c.data,b=new Date(a.year,a.month-1,a.day);g.datepicker("setDate",b)}function y(){o.show();var a=c.data;j.val(a.hour),k.val(a.minute),l.val(a.second)}function z(){p.show();var a=c.data;i.val(a.day)}function A(){q.show();var a=c.data;m.val(a.ms)}return{open:v,getDialog:t}}();function DiagnosisTextTimer(a,b,c,d,e,f,g){this.parent=a,this.data=b,this.plc=c,this.type=d,this.writable=e,this.myKey=g,this.diagnosisWindow=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextTimer parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextTimer parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextTimer parentsbox",BorderWidth:"97.5%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",Number2X:"97%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.border=this.text=this.number=this.writeRect2=this.numberValue=this.timerValue=null,this.numberColor=this.writable?"#76a0b5":"black",this.myMobiscroll=null,this.type===timerTypes.Second?(this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s"):this.plcBase=this.visuBase=null,DiagnosisElement.call(this,{data:b,writable:e})}DiagnosisTextTimer.prototype=Object.create(DiagnosisElement.prototype),DiagnosisTextTimer.prototype.constructor=DiagnosisTextTimer,DiagnosisTextTimer.prototype.setTimerValue=function(){switch(this.type){case timerTypes.Second:this.timerValue=new DiagnosisTimerSecond(0,this.plcBase,this.visuBase);break;case timerTypes.Minute:this.timerValue=new DiagnosisTimerMinute;break;case timerTypes.SiemensDate:this.timerValue=new DiagnosisTimerSiemensDate;break;case timerTypes.SiemensTimeOfDay:this.timerValue=new DiagnosisTimerSiemensTimeOfDate;break;case timerTypes.SiemensTime:this.timerValue=new DiagnosisTimerSiemensTime;break;case timerTypes.SiemensS5Time:this.timerValue=new DiagnosisTimerSiemensS5Time;break;case timerTypes.SiemensDateAndTime:this.timerValue=new DiagnosisTimerSiemensDateAndTime;break;default:this.timerValue=new DiagnosisTimer}},DiagnosisTextTimer.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position],g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID();this.setTimerValue();var l=this.panel=$("<div class='"+f.css+"' id='"+a+"'><span class='DiagnosisNumberLRTextTextSVG' id='"+d+"'>"+this.data.Text+"</span><span id='"+k+"' class='savemebutton emosbutton'></span><span id='"+j+"' class='cancelbutton emosbutton'></span><span id='"+e+"' class='writebutton emosbutton'></span><br class='cl'><span id='"+b+"' class='pickertime myPicker'><span class='pickertime hours orange' id='"+g+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+h+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+i+"'>"+this.secondsValue+"</span></span></div></div>");l[0].myData=this.data,l[0].myKey=this.myKey,l[0].myPlc=this.plctag,l[0].myType=this.type,$(this.parentDiv)[0].myData=this.data,l.appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.writeRect2=document.getElementById(e),this.cancelbutton=document.getElementById(j),this.savebutton=document.getElementById(k),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this)}catch(a){console.log("DiagnosisTextTimer init failed: "+a)}},DiagnosisTextTimer.prototype.getWritable=function(a){a.writable&&(a.writeRect2.style.cursor="pointer",a.writeRect2.style.display="block",a.writeRect2.addEventListener("click",DiagnosisTextTimer.prototype.onClick.bind(a)),a.cancelbutton.addEventListener("click",DiagnosisTextTimer.prototype.onButtonCancel.bind(a)),a.savebutton.addEventListener("click",DiagnosisTextTimer.prototype.onButtonSave.bind(a)))},DiagnosisTextTimer.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect2.style.cursor="pointer",this.writeRect2.style.pointerEvents="auto",this.writeRect2.style.display="block",this.number.style.color=this.numberColor="#76a0b5"):(this.writeRect2.style.cursor="auto",this.writeRect2.style.pointerEvents="none",this.number.style.color=this.numberColor="black",this.writeRect2.style.display="none")},DiagnosisTextTimer.prototype.onButtonSave=function(a){var b,c,d,e;if(a.length?(c=a,c.type=a[0].myType,d=a.find(".myPicker"),e=a[0].myPlc,c.writeRect2=document.getElementById(c.find(".writebutton").attr("id")),c.cancelbutton=document.getElementById(c.find(".cancelbutton").attr("id")),c.savebutton=document.getElementById(c.find(".savemebutton").attr("id"))):(d=this.myMobiscroll,e=this.plctag,c=this),3===c.type){var f=d.mobiscroll("getVal",!0).getFullYear(),g=d.mobiscroll("getVal",!0).getMonth()+1,h=d.mobiscroll("getVal",!0).getDate();b=f+"-"+g+"-"+h}else if(1===c.type){var i=d.mobiscroll("getVal",!0).split(" ");b=Number(60*i[0])+Number(i[1])}else if(4===c.type){var j=d.mobiscroll("getVal",!0).getHours(),k=d.mobiscroll("getVal",!0).getMinutes(),l=d.mobiscroll("getVal",!0).getSeconds();l=l.toFixed(1),b=j+":"+k+":"+l}else if(5===c.type){var i=d.mobiscroll("getVal",!0).split(" ");b=i[0]+"D"+i[1]+"H"+i[2]+"M"+i[3]+"S"+i[4]+"MS"}else if(6===c.type){var i=d.mobiscroll("getVal",!0).split(" ");b=i[0]+"H"+i[1]+"M"+i[2]+"S"+i[3]+"MS"}else if(7===c.type){var f=d.mobiscroll("getVal",!0).getFullYear(),g=d.mobiscroll("getVal",!0).getMonth()+1,h=d.mobiscroll("getVal",!0).getDate(),j=d.mobiscroll("getVal",!0).getHours(),k=d.mobiscroll("getVal",!0).getMinutes(),l=d.mobiscroll("getVal",!0).getSeconds();l=l.toFixed(1),b=f+"-"+g+"-"+h+"-"+j+":"+k+":"+l}else if("s"===this.visuBase){var i=d.mobiscroll("getVal",!0).split(" "),j=i[0],k=i[1],l=i[2];b=this.timerValue.encode({hour:j,minute:k,second:l})}else{var i=d.mobiscroll("getVal",!0).split(" "),j=i[0],k=i[1],l=i[2];b=this.timerValue.encode({minute:j,second:k,msecond:l})}emosWS.poke(e,b),d.mobiscroll("destroy"),c.writeRect2.style.display="block",c.cancelbutton.style.display="none",c.savebutton.style.display="none"},DiagnosisTextTimer.prototype.onButtonCancel=function(){this.myMobiscroll.mobiscroll("destroy"),this.writeRect2.style.display="block",this.cancelbutton.style.display="none",this.savebutton.style.display="none"},DiagnosisTextTimer.prototype.onClick=function(a){var b,c,d,e,f,g,h,i,j="HHiiss";switch(console.log(this.type),this.type){case timerTypes.Second:b=this.timerValue,"s"===this.visuBase?(d=this.timerValue.data.hour,e=this.timerValue.data.minute,f=this.timerValue.data.second):(d=this.timerValue.data.minute,e=this.timerValue.data.second,f=this.timerValue.data.msecond),h=this.data.IntTimeMin,i=this.data.IntTimeMax;break;case timerTypes.SiemensDate:case timerTypes.SiemensTimeOfDay:case timerTypes.SiemensDateAndTime:case timerTypes.SiemensS5Time:case timerTypes.SiemensTime:b=this.timerValue,c=this.timerValue.data.day,d=this.timerValue.data.hour,e=this.timerValue.data.minute,f=this.timerValue.data.second,g=this.timerValue.data.ms,h=this.data.IntTimeMin,i=this.data.IntTimeMax;break;case timerTypes.Minute:console.log(this.timerValue),b=this.timerValue,d=this.timerValue.data.hour,e=this.timerValue.data.minute,h=this.data.IntTimeMin,i=this.data.IntTimeMax;break;default:console.log("default")}var k=a.target;$("#"+$(this)[0].id).siblings().children(".dw-inline").length&&($("#"+$(this)[0].id).siblings().animate({height:"45px"}),setTimeout(function(){$("#"+$(this)[0].id).siblings().children("myTime").mobiscroll("destroy")},400));var l=$(k).position().top,m=$(k).closest(".dPage").scrollTop();this.writeRect2.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block",$(k).closest(".dPage").animate({scrollTop:l+m-21});var n=[];n.push(d),n.push(e),n.push(f);var o=Math.floor(i/3600)>0?Math.floor(i/3600):"00";o=o>=24?23:o;var p=(i-3600*o)/60>0?Math.floor((i-3600*o)/60):0;p=p>=60?59:p;var q=i-3600*o-60*p;q=q>=60?59:q;for(var r=o+":"+p+":"+q,s=new Date(b.data.year,b.data.month-1,b.data.day,b.data.hour,b.data.minute,b.data.second),t=[],u=[],v,w=0;w<1e3;w++)t.push(w),u.push(w);if(v="s"===this.visuBase?[[{label:"hour",keys:t,values:u},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]:[[{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"milisec",keys:t,values:u}]],3===this.type){var x=this.timerValue.data.month-1;n=new Date(this.timerValue.data.year,x,this.timerValue.data.day),this.myMobiscroll=$("#"+this.number.id).mobiscroll().date({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,dateOrder:"ddmmyy",dateFormat:"dd/mm/yy",minDate:n,maxDate:new Date(2030,11,31),showLabel:!1}).mobiscroll("setValue",n)}else 5===this.type?(n=[],n.push(c),n.push(d),n.push(e),n.push(f),n.push(g),this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:[[{label:"day",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]},{label:"hrs",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"ms",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]}).mobiscroll("setValue",n)):6===this.type?(n=[],n.push(d),n.push(e),n.push(f),n.push(g),this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:[[{label:"hrs",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"ms",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]}).mobiscroll("setValue",n)):7===this.type?this.myMobiscroll=$("#"+this.number.id).mobiscroll().datetime({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,dateOrder:"ddmmyy",dateFormat:"dd/mm/yy",timeFormat:"HH:ii:ss",timeWheels:j,maxDate:new Date(2030,11,31),showLabel:!1}).mobiscroll("setValue",s):1===this.type?(n=[],n.push(d),n.push(e),this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:[[{label:"hrs",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]}).mobiscroll("setValue",n)):this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,wheels:v,minDate:new Date((new Date).setHours(0,0,0,0)),maxDate:new Date((new Date).setHours(o,p,q,0)),showLabel:!1}).mobiscroll("setValue",n)},DiagnosisTextTimer.prototype.datachangeListener=function(a){try{this.number.style.color=this.numberColor,this.timerValue.setValue(a.value),this.number.textContent=this.timerValue.toString(),this.number2&&(this.number2.textContent=this.timerValue.toString())}catch(a){console.log("datachangeListener datachangeListener failed: "+a)}},emosWS.DiagnosisTextTimer=DiagnosisTextTimer;function DiagnosisOperatingCounter(a,b,c,d,e,f,g){this.parent=a,this.data=b,this.plc=c,this.type=d,this.writable=e,this.myKey=g,this.diagnosisWindow=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextTimer parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextTimer parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextTimer parentsbox",BorderWidth:"97.5%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",Number2X:"97%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.border=this.text=this.number=this.writeRect2=this.numberValue=this.timerValue=null,this.numberColor=this.writable?"#76a0b5":"black",this.myMobiscroll=null,this.type===timerTypes.Second?(this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s"):this.plcBase=this.visuBase=null,DiagnosisElement.call(this,{data:b,writable:e})}DiagnosisOperatingCounter.prototype=Object.create(DiagnosisElement.prototype),DiagnosisOperatingCounter.prototype.constructor=DiagnosisOperatingCounter,DiagnosisOperatingCounter.prototype.setTimerValue=function(){switch(this.type){case timerTypes.Second:this.timerValue=new DiagnosisTimerSecond(0,this.plcBase,this.visuBase);break;case timerTypes.Minute:this.timerValue=new DiagnosisTimerMinute;break;case timerTypes.SiemensDate:this.timerValue=new DiagnosisTimerSiemensDate;break;case timerTypes.SiemensTimeOfDay:this.timerValue=new DiagnosisTimerSiemensTimeOfDate;break;case timerTypes.SiemensTime:this.timerValue=new DiagnosisTimerSiemensTime;break;case timerTypes.SiemensS5Time:this.timerValue=new DiagnosisTimerSiemensS5Time;break;case timerTypes.SiemensDateAndTime:this.timerValue=new DiagnosisTimerSiemensDateAndTime;break;default:this.timerValue=new DiagnosisTimer}},DiagnosisOperatingCounter.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position],g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID();this.setTimerValue();var l=this.panel=$("<div class='"+f.css+"' id='"+a+"'><span class='DiagnosisNumberLRTextTextSVG' id='"+d+"'>"+this.data.Text+"</span><span id='"+k+"' class='savemebutton emosbutton'></span><span id='"+j+"' class='cancelbutton emosbutton'></span><span id='"+e+"' class='writebutton emosbutton'></span><br class='cl'><span id='"+b+"' class='pickertime myPicker'><span class='pickertime hours orange' id='"+g+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+h+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+i+"'>"+this.secondsValue+"</span></span></div></div>");l[0].myData=this.data,l[0].myKey=this.myKey,l[0].myPlc=this.plctag,l[0].myType=this.type,$(this.parentDiv)[0].myData=this.data,l.appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.writeRect2=document.getElementById(e),this.cancelbutton=document.getElementById(j),this.savebutton=document.getElementById(k),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this)}catch(a){console.log("DiagnosisOperatingCounter init failed: "+a)}},DiagnosisOperatingCounter.prototype.getWritable=function(a){a.writable&&(a.writeRect2.style.cursor="pointer",a.writeRect2.style.display="block",a.writeRect2.addEventListener("click",DiagnosisOperatingCounter.prototype.onClick.bind(a)),a.cancelbutton.addEventListener("click",DiagnosisOperatingCounter.prototype.onButtonCancel.bind(a)),a.savebutton.addEventListener("click",DiagnosisOperatingCounter.prototype.onButtonSave.bind(a)))},DiagnosisOperatingCounter.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect2.style.cursor="pointer",this.writeRect2.style.pointerEvents="auto",this.writeRect2.style.display="block",this.number.style.color=this.numberColor="#76a0b5"):(this.writeRect2.style.cursor="auto",this.writeRect2.style.pointerEvents="none",this.number.style.color=this.numberColor="black",this.writeRect2.style.display="none")},DiagnosisOperatingCounter.prototype.onButtonSave=function(a){var b,c,d,e;if(a.length?(c=a,c.type=a[0].myType,d=a.find(".myPicker"),e=a[0].myPlc,c.writeRect2=document.getElementById(c.find(".writebutton").attr("id")),c.cancelbutton=document.getElementById(c.find(".cancelbutton").attr("id")),c.savebutton=document.getElementById(c.find(".savemebutton").attr("id"))):(d=this.myMobiscroll,e=this.plctag,c=this),3===c.type){var f=d.mobiscroll("getVal",!0).getFullYear(),g=d.mobiscroll("getVal",!0).getMonth()+1,h=d.mobiscroll("getVal",!0).getDate();b=f+"-"+g+"-"+h}else if(1===c.type){var i=d.mobiscroll("getVal",!0).split(" ");b=Number(60*i[0])+Number(i[1])}else if(4===c.type){var j=d.mobiscroll("getVal",!0).getHours(),k=d.mobiscroll("getVal",!0).getMinutes(),l=d.mobiscroll("getVal",!0).getSeconds();l=l.toFixed(1),b=j+":"+k+":"+l}else if(5===c.type){var i=d.mobiscroll("getVal",!0).split(" ");b=i[0]+"D"+i[1]+"H"+i[2]+"M"+i[3]+"S"+i[4]+"MS"}else if(6===c.type){var i=d.mobiscroll("getVal",!0).split(" ");b=i[0]+"H"+i[1]+"M"+i[2]+"S"+i[3]+"MS"}else if(7===c.type){var f=d.mobiscroll("getVal",!0).getFullYear(),g=d.mobiscroll("getVal",!0).getMonth()+1,h=d.mobiscroll("getVal",!0).getDate(),j=d.mobiscroll("getVal",!0).getHours(),k=d.mobiscroll("getVal",!0).getMinutes(),l=d.mobiscroll("getVal",!0).getSeconds();l=l.toFixed(1),b=f+"-"+g+"-"+h+"-"+j+":"+k+":"+l}else if("s"===this.visuBase){var m=d.mobiscroll("getVal").split(" ");b=this.timerValue.encode({hour:m[0],minute:m[1],second:"00"})}else b=this.timerValue.encode({minute:d.mobiscroll("getVal",!0).getHours(),second:d.mobiscroll("getVal",!0).getMinutes(),msecond:d.mobiscroll("getVal",!0).getSeconds()});emosWS.poke(e,b),d.mobiscroll("destroy"),c.writeRect2.style.display="block",c.cancelbutton.style.display="none",c.savebutton.style.display="none"},DiagnosisOperatingCounter.prototype.onButtonCancel=function(){this.myMobiscroll.mobiscroll("destroy"),this.writeRect2.style.display="block",this.cancelbutton.style.display="none",this.savebutton.style.display="none"},DiagnosisOperatingCounter.prototype.onClick=function(a){var b,c,d,e,f,g,h,i,j="HHiiss";switch(this.type){case timerTypes.Second:b=this.timerValue,"s"===this.visuBase?(d=this.timerValue.data.hour,e=this.timerValue.data.minute,f=this.timerValue.data.second):(d=this.timerValue.data.minute,e=this.timerValue.data.second,f=this.timerValue.data.msecond),h=this.data.IntTimeMin,i=this.data.IntTimeMax;break;case timerTypes.SiemensDate:case timerTypes.SiemensTimeOfDay:case timerTypes.SiemensDateAndTime:case timerTypes.SiemensS5Time:case timerTypes.SiemensTime:b=this.timerValue,c=this.timerValue.data.day,d=this.timerValue.data.hour,e=this.timerValue.data.minute,f=this.timerValue.data.second,g=this.timerValue.data.ms,h=this.data.IntTimeMin,i=this.data.IntTimeMax;break;case timerTypes.Minute:b=this.timerValue,d=this.timerValue.data.hour,e=this.timerValue.data.minute,h=this.data.IntTimeMin,i=this.data.IntTimeMax;break;default:console.log("default")}self=a.target,$("#"+$(this)[0].id).siblings().children(".dw-inline").length&&($("#"+$(this)[0].id).siblings().animate({height:"45px"}),setTimeout(function(){$("#"+$(this)[0].id).siblings().children("myTime").mobiscroll("destroy")},400));var k=$(self).position().top,l=$(self).closest(".dPage").scrollTop();this.writeRect2.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block",$(self).closest(".dPage").animate({scrollTop:k+l-21});var m=[];m.push(d),m.push(e),m.push(f);var n=Math.floor(i/3600)>0?Math.floor(i/3600):"00";n=n>=24?23:n;var o=(i-3600*n)/60>0?Math.floor((i-3600*n)/60):0;o=o>=60?59:o;var p=i-3600*n-60*o;p=p>=60?59:p;var q=n+":"+o+":"+p,r=new Date(b.data.year,b.data.month-1,b.data.day,b.data.hour,b.data.minute,b.data.second);if(3===this.type){var s=this.timerValue.data.month-1;m=new Date(this.timerValue.data.year,s,this.timerValue.data.day),this.myMobiscroll=$("#"+this.number.id).mobiscroll().date({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,dateOrder:"ddmmyy",dateFormat:"dd/mm/yy",minDate:m,maxDate:new Date(2030,11,31),showLabel:!1}).mobiscroll("setValue",m)}else 5===this.type?(m=[],m.push(c),m.push(d),m.push(e),m.push(f),m.push(g),this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:[[{label:"day",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]},{label:"hrs",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"ms",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]}).mobiscroll("setValue",m)):6===this.type?(m=[],m.push(d),m.push(e),m.push(f),m.push(g),this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:[[{label:"hrs",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"ms",keys:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]}).mobiscroll("setValue",m)):7===this.type?this.myMobiscroll=$("#"+this.number.id).mobiscroll().datetime({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,dateOrder:"ddmmyy",dateFormat:"dd/mm/yy",timeFormat:"HH:ii:ss",timeWheels:j,maxDate:new Date(2030,11,31),showLabel:!1}).mobiscroll("setValue",r):1===this.type||0===this.type?(m=[],m.push(d),m.push(e),this.myMobiscroll=$("#"+this.number.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:[[{label:"hrs",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]}).mobiscroll("setValue",m)):this.myMobiscroll=$("#"+this.number.id).mobiscroll().time({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,timeFormat:"HH:ii:ss",timeWheels:j,minDate:new Date((new Date).setHours(0,0,0,0)),maxDate:new Date((new Date).setHours(n,o,p,0)),showLabel:!1}).mobiscroll("setValue",m)},DiagnosisOperatingCounter.prototype.datachangeListener=function(a){try{this.number.style.color=this.numberColor,this.timerValue.setValue(a.value),this.number.textContent=this.timerValue.formatNumber(this.timerValue.data.hour)+":"+this.timerValue.formatNumber(this.timerValue.data.minute)+" h:m",this.number2&&(this.number2.textContent=this.timerValue.toString())}catch(a){console.log("DiagnosisOperatingCounter datachangeListener failed: "+a)}},emosWS.DiagnosisOperatingCounter=DiagnosisOperatingCounter;function DiagnosisTextDoubleTimer(a,b,c,d,e,f,g){this.parent=a,this.data=b,this.plc=c,this.valueInSecond=d,this.writable=e,this.diagnosisWindow=f,this.myKey=g,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextDoubleTimer parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"50%",NumberY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextDoubleTimer parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"50%",NumberY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextDoubleTimer parentsbox",BorderWidth:"72%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",NumberX:"71.5%",NumberY:"15",Number2X:"97%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctag2=this.plc+"."+this.data.OPCID2,this.border=this.text=this.number=this.number2=this.rect=this.writeRect=this.numberValue=this.number2Value=this.timerValue=null,this.hoursValue=this.minutesValue=this.secondsValue=null,this.numberColor=this.writable?"#76a0b5":"black",this.id=null,this.myMobiscroll=null,d?(this.plcBase=this.data.Base||"s",this.visuBase=this.data.VisuBase||"s"):this.plcBase=this.visuBase=null,DiagnosisElement.call(this,{data:b,writable:e})}DiagnosisTextDoubleTimer.prototype=Object.create(DiagnosisElement.prototype),DiagnosisTextDoubleTimer.prototype.constructor=DiagnosisTextDoubleTimer,DiagnosisTextDoubleTimer.prototype.setTimerValue=function(){this.timerValue=this.valueInSecond?new DiagnosisTimerSecond(0,this.plcBase,this.visuBase):new DiagnosisTimerMinute},DiagnosisTextDoubleTimer.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m=getElementGlobalID(),n=getElementGlobalID(),o=this.positionClass[this.data.Position],p=getElementGlobalID(),q=getElementGlobalID();this.id=a,this.setTimerValue();var r=this.panel=$("<div class='"+o.css+"' id='"+a+"'><span class='DiagnosisNumberLRTextTextSVG' id='"+k+"'>"+this.data.Text+"</span><span id='"+n+"' class='savemebutton emosbutton'></span><span id='"+m+"' class='cancelbutton emosbutton'></span><span id='"+l+"' class='writebutton emosbutton'></span><br class='cl'><div class='grey'><span class='pickertext' id='"+p+"'>Actual Value</span><span class='pickertime' id='"+b+"'><span class='pickertime hours orange' id='"+d+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+e+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+f+"'>"+this.secondsValue+"</span></span></div><div class='timesetter' style='padding: 3px 0;'><span class='pickertext' id='"+q+"'>Setpoint</span><span id='"+c+"' class='pickertime myPicker'><span class='pickertime hours orange' id='"+g+"'>"+this.hoursValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime minutes orange' id='"+h+"'>"+this.minutesValue+"</span><span class='doppelpunkt'>:</span><span class='pickertime seconds orange' id='"+i+"'>"+this.secondsValue+"</span></span></div></div>");r[0].myData=this.data,r[0].myKey=this.myKey,r[0].myPlc=this.plctag2,r[0].valueInSecond=this.valueInSecond,$(this.parentDiv)[0].myData=this.data,r.appendTo(this.parentDiv),this.number=document.getElementById(b),this.number2=document.getElementById(c),this.hours0=document.getElementById(d),this.minutes0=document.getElementById(e),this.seconds0=document.getElementById(f),this.hours=document.getElementById(g),this.minutes=document.getElementById(h),this.seconds=document.getElementById(i),this.text=document.getElementById(k),this.border=document.getElementById(j),this.writeRect2=document.getElementById(l),this.cancelbutton=document.getElementById(m),this.savebutton=document.getElementById(n),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag2,this.datachange2Listener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+"Setpoint","name",function(a){$("#"+q).text(a.value+":")}),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+"ActualValue","name",function(a){$("#"+p).text(a.value+":")}),this.getWritable(this)}catch(a){console.log("DiagnosisTextDoubleTimer init failed: "+a)}},DiagnosisTextDoubleTimer.prototype.getWritable=function(a){a.writable&&(a.writeRect2.style.cursor="pointer",a.writeRect2.style.display="block",a.writeRect2.addEventListener("click",DiagnosisTextDoubleTimer.prototype.onClick.bind(a)),a.cancelbutton.addEventListener("click",DiagnosisTextDoubleTimer.prototype.onButtonCancel.bind(a)),a.savebutton.addEventListener("click",DiagnosisTextDoubleTimer.prototype.onButtonSave.bind(a)))},DiagnosisTextDoubleTimer.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect2.style.cursor="pointer",this.writeRect2.style.pointerEvents="auto",this.writeRect2.style.display="block",$(".timesetter").css("color","#76a0b5")):(this.writeRect2.style.cursor="auto",this.writeRect2.style.pointerEvents="none",this.writeRect2.style.display="none",$(".timesetter").css("color","black"))},DiagnosisTextDoubleTimer.prototype.onButtonSave=function(a){var b,c,d;a.length?(b=a,c=a.find(".myPicker"),d=a[0].myPlc,b.valueInSecond=a[0].valueInSecond,b.writeRect2=document.getElementById(b.find(".writebutton").attr("id")),b.cancelbutton=document.getElementById(b.find(".cancelbutton").attr("id")),b.savebutton=document.getElementById(b.find(".savemebutton").attr("id"))):(c=this.myMobiscroll,d=this.plctag2,b=this),console.log(c.mobiscroll("getVal",!0));var e=c.mobiscroll("getVal",!0).split(" "),f=e[0],g=e[1],h=Number(e[2]),i;if(b.valueInSecond)i="s"===this.visuBase?this.timerValue.encode({hour:f,minute:g,second:h}):this.timerValue.encode({minute:f,second:g,msecond:h});else{i=24*f*60+60*g+h}emosWS.poke(d,i),c.mobiscroll("destroy"),b.writeRect2.style.display="block",b.cancelbutton.style.display="none",b.savebutton.style.display="none"},DiagnosisTextDoubleTimer.prototype.onButtonCancel=function(){this.myMobiscroll.mobiscroll("destroy"),this.writeRect2.style.display="block",this.cancelbutton.style.display="none",this.savebutton.style.display="none"},DiagnosisTextDoubleTimer.prototype.onClick=function(a){var b=a.target;$("#"+$(this)[0].id).siblings().children(".dw-inline").length&&($("#"+$(this)[0].id).siblings().animate({height:"45px"}),setTimeout(function(){$("#"+$(this)[0].id).siblings().children("myTime").mobiscroll("destroy")},400));var c=$(b).position().top,d=$(b).closest(".dPage").scrollTop();this.writeRect2.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block",$(b).closest(".dPage").animate({scrollTop:c+d-21});for(var e=this.timerValue.data.hour,f=this.timerValue.data.minute,g=this.timerValue.data.second,h=[],i,j=[],k=[],l=0;l<1e3;l++)j.push(l),k.push(l);this.valueInSecond?"s"===this.visuBase?(h.push(this.timerValue.data.hour),h.push(this.timerValue.data.minute),h.push(this.timerValue.data.second),i=[[{label:"hour",keys:j,values:k},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]):(h.push(this.timerValue.data.minute),h.push(this.timerValue.data.second),h.push(this.timerValue.data.msecond),i=[[{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"sec",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]},{label:"milisec",keys:j,values:k}]]):(h.push(this.timerValue.data.day),h.push(this.timerValue.data.hour),h.push(this.timerValue.data.minute),i=[[{label:"day",keys:j,values:k},{label:"hour",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]},{label:"min",keys:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],values:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}]]);var m=this.data.IntTimeMin,n=this.data.IntTimeMax,o="HHiiss",p=Math.floor(n/3600)>0?Math.floor(n/3600):"00",q=(n-3600*p)/60>0?Math.floor((n-3600*p)/60):0;q=q>=60?59:q;var r=n-3600*p-60*q;r=r>=60?59:r;var s=p+":"+q+":"+r,t=this.plctag2;this.myMobiscroll=$("#"+this.number2.id).mobiscroll().scroller({theme:"wp",mode:"mixed",display:"inline",lang:"de",scrollLock:!1,cssClass:"longtype",wheels:i,minDate:new Date((new Date).setHours(0,0,0,0)),maxDate:new Date((new Date).setHours(p,q,r,0)),showLabel:!1}).mobiscroll("setValue",h)},DiagnosisTextDoubleTimer.prototype.datachangeListener=function(a){try{$(this.number).find(".pickertime").removeClass("orange"),$(this.number2).find(".pickertime").removeClass("orange"),this.timerValue.setValue(a.value),this.valueInSecond?"s"===this.visuBase?(this.hours0.textContent=(this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour)+" h",this.minutes0.textContent=(this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute)+" m",this.seconds0.textContent=(this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second)+" s",this.seconds3&&(this.hours3.textContent=this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour,this.minutes3.textContent=this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute,this.seconds3.textContent=this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second)):(this.hours0.textContent=(this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute)+" m",this.minutes0.textContent=(this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second)+" s",this.seconds0.textContent=(this.timerValue.data.msecond<10?"0"+this.timerValue.data.msecond:this.timerValue.data.msecond)+" ms",this.seconds3&&(this.hours3.textContent=this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute,this.minutes3.textContent=this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second,this.seconds3.textContent=this.timerValue.data.msecond<10?"0"+this.timerValue.data.msecond:this.timerValue.data.msecond)):(this.hours0.textContent=(this.timerValue.data.day<10?"0"+this.timerValue.data.day:this.timerValue.data.day)+" d",this.minutes0.textContent=(this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour)+" h",this.seconds0.textContent=(this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute)+" m",this.seconds3&&(this.hours3.textContent=this.timerValue.data.day<10?"0"+this.timerValue.data.day:this.timerValue.data.day,this.minutes3.textContent=this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour,this.seconds3.textContent=this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute))}catch(a){console.log("DiagnosisTextDoubleTimer datachangeListener failed: "+a)}},DiagnosisTextDoubleTimer.prototype.datachange2Listener=function(a){try{this.timerValue.setValue(a.value);var b=[];this.valueInSecond?"s"===this.visuBase?(this.hours.textContent=(this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour)+" h",this.minutes.textContent=(this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute)+" m",this.seconds.textContent=(this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second)+" s",this.seconds2&&(this.hours2.textContent=this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour,this.minutes2.textContent=this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute,this.seconds2.textContent=this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second),b=[this.timerValue.data.hour,this.timerValue.data.minute,this.timerValue.data.second]):(this.hours.textContent=(this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute)+" m",this.minutes.textContent=(this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second)+" s",this.seconds.textContent=(this.timerValue.data.msecond<10?"0"+this.timerValue.data.msecond:this.timerValue.data.msecond)+" ms",this.seconds2&&(this.hours2.textContent=this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute,this.minutes2.textContent=this.timerValue.data.second<10?"0"+this.timerValue.data.second:this.timerValue.data.second,this.seconds2.textContent=this.timerValue.data.msecond<10?"0"+this.timerValue.data.msecond:this.timerValue.data.msecond),b=[this.timerValue.data.minute,this.timerValue.data.second,this.timerValue.data.msecond]):(this.hours.textContent=(this.timerValue.data.day<10?"0"+this.timerValue.data.day:this.timerValue.data.day)+" d",this.minutes.textContent=(this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour)+" h",this.seconds.textContent=(this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute)+" m",this.seconds2&&(this.hours2.textContent=this.timerValue.data.day<10?"0"+this.timerValue.data.day:this.timerValue.data.day,this.minutes2.textContent=this.timerValue.data.hour<10?"0"+this.timerValue.data.hour:this.timerValue.data.hour,this.seconds2.textContent=this.timerValue.data.minute<10?"0"+this.timerValue.data.minute:this.timerValue.data.minute),b=[this.timerValue.data.day,this.timerValue.data.hour,this.timerValue.data.minute]),$("#"+this.writeRect2.id).mobiscroll("setValue",b)}catch(a){console.log("DiagnosisTextDoubleTimer datachange2Listener failed: "+a)}},emosWS.DiagnosisTextDoubleTimer=DiagnosisTextDoubleTimer;function DiagnosisTextNumber(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.myKey=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextInteger parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextInteger parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextInteger parentsbox",BorderWidth:"97.5%",WriteRectWidth:"25%",WriteRectX:"72.5%",TextX:"5",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.numberValue=this.border=this.text=this.number=this.writeRect3=0,this.unit=emosWS.getUnit(),this.numberColor=this.writable?"#76a0b5":"black",this.sliderId=null,this.oldTextVal=0,this.inputfield=!1,this.IOObject=null,DiagnosisElement.call(this,{data:b,writable:d})}DiagnosisTextNumber.prototype=Object.create(DiagnosisElement.prototype),DiagnosisTextNumber.prototype.constructor=DiagnosisTextNumber,DiagnosisTextNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position],g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j="";this.inputfield=!0,j="<form onsubmit='return false'><span class='DiagnosisNumberLRTextNumberSVG orange' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+b+"' data-value='"+this.numberValue+"'>"+this.numberValue+"</span><div class='DiagnosisStringButtons'></div><br class='cl'></form>";var k=this.panel=$("<div class='"+f.css+"' id='"+a+"'><span class='DiagnosisNumberLRTextTextSVG' id='"+d+"'>"+this.data.Text+"</span><span id='"+h+"' class='savebutton emosbutton'></span><span id='"+g+"' class='cancelbutton emosbutton'></span><span id='"+e+"' class='writebutton getpad emosbutton'></span>"+j+"</div>");k[0].myData=this.data,k[0].myKey=this.myKey,k[0].poke=this.poke.bind(this),k.appendTo(this.parentDiv),$(this.parentDiv)[0].myData=this.data,this.number=document.getElementById(b),this.numberID=b,this.text=document.getElementById(d),this.border=document.getElementById(c),this.writeRect3=document.getElementById(e),this.cancelbutton=document.getElementById(g),this.savebutton=document.getElementById(h),this.holder=document.getElementById(i),this.IOObject=emosWS.advise(this.plctag,this.datachangeListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this)}catch(a){console.error("DiagnosisTextNumber init failed: "+a)}},DiagnosisTextNumber.prototype.poke=function(a){this.IOObject.setValue(a)},DiagnosisTextNumber.prototype.getWritable=function(a){a.writable?(a.writeRect3.style.cursor="pointer",a.number.setAttribute("pointer-events","none"),a.writeRect3.addEventListener("click",this.onClick.bind(a)),this.writable=a.writable,this.writeRect3=a.writeRect3,this.cancelbutton=a.cancelbutton,this.savebutton=a.savebutton,this.writeRectId3=a.writeRectId3,this.number=a.number,$("#"+this.numberID).addClass("textfeld").removeClass("fl"),this.updateWrite()):($("#"+this.numberID).addClass("notwritable").removeClass("textfeld").addClass("fl"),$("#"+a.number.id).addClass("notwritable").addClass("fl"))},DiagnosisTextNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect3.style.cursor="pointer",this.writeRect3.style.pointerEvents="auto",this.writeRect3.style.display="block",this.number.style.color="#76a0b5"):(this.writeRect3.style.cursor="auto",this.writeRect3.style.pointerEvents="none",$("#"+this.number.id).addClass("notwritable").addClass("fl"),this.writeRect3.style.display="none",this.number.style.color="black")},DiagnosisTextNumber.prototype.onClick=function(){this.writeRect3.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block"},DiagnosisTextNumber.prototype.datachangeListenerB=function(a){try{var b=a.value;$(".textfeld").removeClass("orange"),this.numberValue=b.value,this.number.textContent=this.numberValue+" "+b.unitSymbol,$("#"+this.number.id).attr("data-value",this.numberValue).removeClass("orange"),this.inputfield&&(this.number.value=this.writeRect3.value=this.numberValue,this.oldTextVal=this.number.value),this.number4&&(this.number4.textContent=this.numberValue+" "+b.unitSymbol),this.setInputRange(b.properties,this.data)}catch(a){console.error("DiagnosisTextNumber datachangeListenerB failed: "+a)}},DiagnosisTextNumber.prototype.datachangeListener=function(a){try{this.msg=a,$(".textfeld").removeClass("orange"),this.data.Precision?this.numberValue=parseFloat(a.value).toFixed(this.data.Precision):this.numberValue=GetAsInteger(a.value),this.number.textContent=this.numberValue+this.getUnitSymbol(),$("#"+this.number.id).attr("data-value",this.numberValue),this.inputfield&&(this.number.value=this.writeRect3.value=a.value,this.oldTextVal=this.number.value),this.number4&&(this.number4.textContent=this.numberValue+this.getUnitSymbol())}catch(a){console.error("DiagnosisTextNumber datachangeListener failed: "+a)}},emosWS.DiagnosisTextNumber=DiagnosisTextNumber;function DiagnosisTextNumberNumber(a,b,c,d,e,f,g){this.parent=a,this.data=b,this.plc=c,this.dataType=d,this.writable=e,this.diagnosisWindow=f,this.myKey=g,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextNumberNumber parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextNumberNumber parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextNumberNumber parentsbox",BorderWidth:"97.5%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"5",TextY:"15",NumberX:"71.5%",NumberY:"15",Number2X:"96.5%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctag2=this.plc+"."+this.data.OPCID2,this.border=this.text=this.number=this.number2=this.rect=this.writeRect=this.numberValue=this.number2Value=this.min=this.max=null,this.unit=emosWS.getUnit(),this.unitSymbol=this.getUnitSymbol(),this.IOObject1=this.IOObject2=null,this.numberColor=this.writable?"#76a0b5":"black",DiagnosisElement.call(this,{data:b,writable:e})}DiagnosisTextNumberNumber.prototype=Object.create(DiagnosisElement.prototype),DiagnosisTextNumberNumber.prototype.constructor=DiagnosisTextNumberNumber,DiagnosisTextNumberNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m=getElementGlobalID(),n=getElementGlobalID();switch(this.dataType){case this.diagnosisWindow.dataTypes.Integer:this.min=this.data.IntInputMin,this.max=this.data.IntInputMax;break;case this.diagnosisWindow.dataTypes.Real:this.min=this.data.RealInputMin,this.max=this.data.RealInputMax}var o=this.positionClass[this.data.Position],p=this.panel=$("<div class='"+o.css+"' id='"+a+"'><span class='DiagnosisNumberLRTextTextSVG' style='float:none;' id='"+e+"'>"+this.data.Text+"</span><div style='float:left;margin-right: 55px;'><span style='display: block;' id='"+m+"'>Actual Value</span><span style='display: block; box-shadow:none; background: none;padding-left: 0' class='DiagnosisNumberLRTextNumberSVG' id='"+b+"' data-value='"+this.numberValue+"'>"+this.numberValue+"</span></div><form onsubmit='return false' class='textnumnum'><span style='display: block;' id='"+n+"'>Setpoint</span><span style='display: block; float:left;' class='DiagnosisNumberLRTextNumberSVG textfeld orange' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+c+"' data-value='"+this.number2Value+"'>"+this.number2Value+"</span><span id='"+l+"' class='savebutton second emosbutton'></span><span id='"+k+"' class='cancelbutton emosbutton'></span><span id='"+j+"' class='writebutton getpad emosbutton'></span><br class='cl'><div class='DiagnosisStringButtons'></form></div></div>");p[0].myData=this.data,p[0].myKey=this.myKey,p[0].poke=this.poke.bind(this),p.appendTo(this.parentDiv),$(this.parentDiv)[0].myData=this.data,this.number=document.getElementById(b),this.number2=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.rect=document.getElementById(f),this.writeRect5=document.getElementById(j),this.cancelbutton=document.getElementById(h),this.savebutton=document.getElementById(i),this.IOObject1=emosWS.advise(this.plctag,this.datachangeListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),this.IOObject2=emosWS.advise(this.plctag2,this.datachange2ListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+"Setpoint","name",function(a){$("#"+n).text(a.value+":")}),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+"ActualValue","name",function(a){$("#"+m).text(a.value+":")}),this.getWritable(this)}catch(a){console.log("DiagnosisTextNumberNumber init failed: "+a)}},DiagnosisTextNumberNumber.prototype.poke=function(a){this.IOObject2.setValue(a)},DiagnosisTextNumberNumber.prototype.getWritable=function(a){a.writable&&(a.number2.setAttribute("pointer-events","none"),a.writeRect5.style.cursor="pointer",a.writeRect5.addEventListener("click",DiagnosisTextNumberNumber.prototype.onClick.bind(a)),this.writable=a.writable,this.writeRect5=a.writeRect5,this.cancelbutton=a.cancelbutton,this.savebutton=a.savebutton,this.writeRectId=a.writeRectId,this.number2=a.number2,this.updateWrite())},DiagnosisTextNumberNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect5.style.cursor="pointer",this.writeRect5.style.pointerEvents="auto",this.writeRect5.style.display="block",this.number2.style.color="#76a0b5"):(this.writeRect5.style.cursor="auto",this.writeRect5.style.pointerEvents="none",this.writeRect5.style.display="none",this.number2.style.color="black")},DiagnosisTextNumberNumber.prototype.onClick=function(a){$(a.target).hide().prev().show().prev().show()},DiagnosisTextNumberNumber.prototype.datachangeListenerB=function(a){try{var b=a.value;this.numberValue=b.value,this.number.textContent=this.numberValue+" "+b.unitSymbol,$("#"+this.number.id).attr("data-value",this.numberValue),this.number.value=this.numberValue}catch(a){console.error("DiagnosisTextNumberNumber datachangeListenerB failed: "+a)}},DiagnosisTextNumberNumber.prototype.datachange2ListenerB=function(a){try{var b=a.value;this.number2Value=b.value,this.number2.textContent=this.number2Value+" "+b.unitSymbol,$("#"+this.number2.id).attr("data-value",this.number2Value).removeClass("orange"),this.number3&&(this.number3Value=b.plcValue,this.number3.textContent=this.number2Value+" "+b.unitSymbol,this.number3.value=this.number3Value),this.number2.value=this.number2Value,this.setInputRange(b.properties,this.data)}catch(a){console.error("DiagnosisTextNumberNumber datachange2ListenerB failed: "+a)}},DiagnosisTextNumberNumber.prototype.datachangeListener=function(a){try{this.msg1=a,this.numberValue=GetAsInteger(a.value),this.number.textContent=this.numberValue+" "+this.getUnitSymbol(),$("#"+this.number.id).attr("data-value",this.numberValue),this.number.value=this.numberValue}catch(a){console.error("DiagnosisTextNumberNumber datachangeListener failed: "+a)}},DiagnosisTextNumberNumber.prototype.datachange2Listener=function(a){try{this.msg2=a;var b=a.value;this.number2Value=b.value,this.unitSymbol=b.unitSymbol,this.number2.textContent=this.number2Value+" "+this.unitSymbol,$("#"+this.number2.id).attr("data-value",this.number2Value).removeClass("orange"),this.number3&&(this.number3Value=GetAsInteger(a.value),this.number3.textContent=this.number3Value+this.unitSymbol,this.number3.value=this.number3Value),this.number2.value=this.number2Value}catch(a){console.error("DiagnosisTextNumberNumber datachange2Listener failed: "+a)}},emosWS.DiagnosisTextNumberNumber=DiagnosisTextNumberNumber;function DiagnosisLedTextNumberNumber(a,b,c,d,e){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisLedText parentsbox withborder",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisLedText parentsbox withborder",BorderWidth:"100%",WriteRectWidth:"25%",RectX:"50%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15",Number2X:"99%",Number2Y:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisLedText parentsbox withborder",BorderWidth:"92.4%",WriteRectWidth:"25%",RectX:"47%",WriteRectX:"72.5%",TextX:"27",TextY:"15",NumberX:"71.5%",NumberY:"15",Number2X:"96.5%",Number2Y:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctag2=this.plc+"."+this.data.OPCID2,this.plctagLed=this.plc+"."+this.data.LEDOPCID,this.ledValue=this.border=this.led=this.text=this.number=this.number2=this.writeRect=this.numberValue=this.number2Value=null,this.unit=emosWS.getUnit(),this.unitSymbol=this.getUnitSymbol(),this.IOObject1=this.IOObject2=null,this.numberColor=this.writable?"#76a0b5":"black",DiagnosisElement.call(this,{data:b,writable:d})}DiagnosisLedTextNumberNumber.prototype=Object.create(DiagnosisElement.prototype),DiagnosisLedTextNumberNumber.prototype.constructor=DiagnosisLedTextNumberNumber,DiagnosisLedTextNumberNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=this.positionClass[this.data.Position],i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l="<span class='messageCircle doubleText' id='"+b+"'></span><span class='DiagnosisNumberLRTextText doubleText' id='"+f+"'>"+this.data.Text+"</span><form onsubmit='return false' style='clear:both'><span class='DiagnosisNumberLRTextNumberSVG textfeld' id='"+c+"'>"+this.numberValue+"</span><span class='DiagnosisNumberLRTextNumberSVG textfeld' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+d+"' data-value='"+this.number2Value+"'>"+this.number2Value+"</span><div class='DiagnosisStringButtons cl'></form></div><div style='float: right;position:absolute;right: 20px;'><span style='display: none;' class='DiagnosisNumberLRTextTextSVG'></span><span id='"+k+"' class='savebutton second emosbutton'></span><span id='"+j+"' class='cancelbutton emosbutton'></span><span id='"+i+"' class='writebutton getpad emosbutton'></span><br class='cl'></div>",m=this.panel=$("<div class='"+h.css+"' id='"+a+"'>"+l+"<br class='cl' /></div>");m[0].myData=this.data,m[0].myData.writable=this.writable,m[0].myKey=this.myKey,m[0].poke=this.poke.bind(this),m.appendTo(this.parentDiv),this.number=document.getElementById(c),this.number2=document.getElementById(d),this.text=document.getElementById(f),this.border=document.getElementById(e),this.writeRect4=document.getElementById(i),this.cancelbutton=document.getElementById(j),this.savebutton=document.getElementById(k),this.led=document.getElementById(b),this.IOObject1=emosWS.advise(this.plctag,this.datachangeListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),this.IOObject2=emosWS.advise(this.plctag2,this.datachange2ListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.advise(this.plctagLed,this.datachangeLedListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this)}catch(a){console.error("DiagnosisLedTextNumberNumber init failed: "+a)}},DiagnosisLedTextNumberNumber.prototype.poke=function(a){this.IOObject2.setValue(a)},DiagnosisLedTextNumberNumber.prototype.getWritable=function(a){a.writable&&(this.writable=a.writable,this.writeRect4=a.writeRect4,this.cancelbutton=a.cancelbutton,this.savebutton=a.savebutton,this.writeRectId4=a.writeRectId4,a.writeRect4.style.cursor="pointer",a.writeRect4.addEventListener("click",this.onClick.bind(a)),a.number2.setAttribute("pointer-events","none"))},DiagnosisLedTextNumberNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect4.style.cursor="pointer",this.writeRect4.style.pointerEvents="auto",this.writeRect4.style.display="block",this.number2.style.color=this.numberColor="#76a0b5"):(this.writeRect4.style.cursor="auto",this.writeRect4.style.pointerEvents="none",$("#"+this.number2.id).addClass("notwritable"),this.writeRect4.style.display="none",this.number2.style.color=this.numberColor="black")},DiagnosisLedTextNumberNumber.prototype.onClick=function(){this.writeRect4.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block"},DiagnosisLedTextNumberNumber.prototype.datachangeLedListener=function(a){try{this.ledValue=GetAsBoolean(a.value);var b=colorList[this.ledValue?this.data.OnLED:this.data.OffLED];this.led.setAttribute("class","messageCircle doubleText "+b)}catch(a){console.log("DiagnosisLedTextNumberNumber datachangeLedListener failed: "+a)}},DiagnosisLedTextNumberNumber.prototype.datachangeListenerB=function(a){try{var b=a.value;this.numberValue=b.value,this.number.style.fill="black",this.number.textContent=this.numberValue+" "+b.unitSymbol}catch(a){console.error("DiagnosisLedTextNumberNumber DatachangeListener failed: "+a)}},DiagnosisLedTextNumberNumber.prototype.datachange2ListenerB=function(a){try{var b=a.value;this.number2Value=b.value,this.number2.textContent=this.number2Value+" "+b.unitSymbol,this.writeRect4.value=this.number2Value,this.number2.value=this.number2Value,this.oldTextVal=this.number2.value,$("#"+this.number2.id).attr("data-value",this.number2Value),$(this.number5).length>0&&(this.number5.textContent=this.number2Value+" "+b.unitSymbol,$("#"+this.number5.id).attr("data-value",this.number2Value)),this.setInputRange(b.properties,this.data)}catch(a){console.error("DiagnosisLedTextNumberNumber datachange2ListenerB failed: "+a)}},DiagnosisLedTextNumberNumber.prototype.datachangeListener=function(a){try{this.msg2=a,this.numberValue=GetAsDouble(a.value),this.number.style.fill="black",this.number.textContent=this.numberValue+this.getUnitSymbol()}catch(a){console.error("DiagnosisLedTextNumberNumber datachangeListener failed: "+a)}},DiagnosisLedTextNumberNumber.prototype.datachange2Listener=function(a){try{this.msg2=a,this.data.Precision?this.number2Value=parseFloat(a.value).toFixed(this.data.Precision):this.number2Value=GetAsInteger(a.value),this.number2.textContent=this.number2Value+this.getUnitSymbol(),this.writeRect4.value=this.number2Value,this.number2.value=a.value,this.oldTextVal=this.number2.value,$("#"+this.number2.id).attr("data-value",this.number2Value),$(this.number5).length>0&&(this.number5.textContent=this.number2Value+this.getUnitSymbol(),$("#"+this.number5.id).attr("data-value",this.number2Value))}catch(a){console.error("DiagnosisLedTextNumber datachange2Listener failed: "+a)}},emosWS.DiagnosisLedTextNumberNumber=DiagnosisLedTextNumberNumber;function DiagnosisLedTextNumber(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.myKey=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisLedText parentsbox withborder",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisLedText parentsbox withborder",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisLedText parentsbox withborder",BorderWidth:"92.4%",WriteRectWidth:"12.5%",WriteRectX:"85%",TextX:"27",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.plctagLed=this.plc+"."+this.data.LEDOPCID,this.numberValue=this.ledValue=this.border=this.led=this.text=this.number=this.writeRect4=this.numberValue=null,this.unit=emosWS.getUnit(),this.numberColor=this.writable?"#76a0b5":"black",this.inputfield=!1,this.IOObject=null,DiagnosisElement.call(this,{data:b,writable:d})}DiagnosisLedTextNumber.prototype=Object.create(DiagnosisElement.prototype),DiagnosisLedTextNumber.prototype.constructor=DiagnosisLedTextNumber,DiagnosisLedTextNumber.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=this.positionClass[this.data.Position],h=getElementGlobalID(),i=getElementGlobalID(),j="";this.writable?(this.inputfield=!0,j="<span class='messageCircle orange' id='"+b+"'></span><span style='width: 142px' class='DiagnosisNumberLRTextText' id='"+e+"'>"+this.data.Text+"</span><span id='"+i+"' class='savebutton emosbutton'></span><span id='"+h+"' class='cancelbutton emosbutton'></span><span id='"+f+"' class='writebutton getpad emosbutton'></span><form onsubmit='return false'><span class='DiagnosisNumberLRTextNumberSVG textfeld' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+c+"' data-value='"+this.numberValue+"'>"+this.value+"</span><div class='DiagnosisStringButtons ledtext'></div><br class='cl'></form>"):(this.inputfield=!1,j="<span class='messageCircle orange' id='"+b+"'></span><span class='DiagnosisNumberLRTextText' id='"+e+"'>"+this.data.Text+"</span><form onsubmit='return false'><span class='DiagnosisNumberLRTextNumberSVG textfeld' oninput='this.form.amountRange.value=this.value; this.form.preview.value=this.value' id='"+c+"' data-value='"+this.numberValue+"'>"+this.value+"</span><div class='DiagnosisStringButtons'></form></div><div style='float: right;position: absolute;right: 20px;'><span style='display: none;' class='DiagnosisNumberLRTextTextSVG'></span><br class='cl'></div>");var k=this.panel=$("<div class='"+g.css+"' id='"+a+"'>"+j+"<br class='cl' /></div>");k[0].myData=this.data,k[0].myKey=this.myKey,k[0].poke=this.poke.bind(this),k.appendTo(this.parentDiv),this.number=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.writeRect4=document.getElementById(f),this.cancelbutton=document.getElementById(h),this.savebutton=document.getElementById(i),this.led=document.getElementById(b),this.IOObject=emosWS.advise(this.plctag,this.datachangeListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.UnitMetric,1,this.data.UnitImperial,1,this.data.UnitLocale,1,this.data.UnitInit,this.data.Precision||0),emosWS.advise(this.plctagLed,this.datachangeLedListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this)}catch(a){console.error("DiagnosisLedTextNumber init failed: "+a)}},DiagnosisLedTextNumber.prototype.poke=function(a){this.IOObject.setValue(a)},DiagnosisLedTextNumber.prototype.getWritable=function(a){a.writable&&(a.writeRect4.style.cursor="pointer",a.writeRect4.addEventListener("click",this.onClick.bind(a)),a.number.setAttribute("pointer-events","none"),this.writable=a.writable,this.writeRect4=a.writeRect4,this.cancelbutton=a.cancelbutton,this.savebutton=a.savebutton,this.writeRectId4=a.writeRectId4,this.number=a.number,this.updateWrite())},DiagnosisLedTextNumber.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?($(this.number5).length>0&&(this.number5.style.color=this.numberColor="#76a0b5"),this.number.style.color=this.numberColor="#76a0b5",this.writeRect4.style.cursor="pointer",this.writeRect4.style.pointerEvents="auto",this.writeRect4.style.display="block"):(this.number.style.color=this.numberColor="black",this.writeRect4.style.cursor="auto",this.writeRect4.style.pointerEvents="none",$("#"+this.number.id).addClass("notwritable"),this.writeRect4.style.display="none")},DiagnosisLedTextNumber.prototype.onClick=function(){this.writeRect4.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block"},DiagnosisLedTextNumber.prototype.datachangeLedListener=function(a){try{this.ledValue=GetAsBoolean(a.value);var b=colorList[this.ledValue?this.data.OnLED:this.data.OffLED];this.led.setAttribute("class","messageCircle "+b)}catch(a){console.error("DiagnosisLedTextNumber datachangeLedListener failed: "+a)}},DiagnosisLedTextNumber.prototype.datachangeListenerB=function(a){try{var b=a.value;this.numberValue=b.value,this.number.style.color=this.numberColor,this.number.textContent=b.value+" "+b.unitSymbol,this.number.value=b.value,this.oldTextVal=this.number.value,$("#"+this.number.id).attr("data-value",this.numberValue),$(this.number5).length>0&&(this.number5.textContent=b.value+" "+b.unitSymbol,$("#"+this.number5.id).attr("data-value",this.numberValue)),this.setInputRange(b.properties,this.data)}catch(a){console.error("DiagnosisLedTextNumber atachangeListener failed: "+a)}},DiagnosisLedTextNumber.prototype.datachangeListener=function(a){try{this.msg=a,this.data.Precision?this.numberValue=parseFloat(a.value).toFixed(this.data.Precision):this.numberValue=GetAsInteger(a.value),this.number.textContent=this.numberValue+this.getUnitSymbol(),this.writeRect4.value=this.numberValue,this.number.value=a.value,this.oldTextVal=this.number.value,$("#"+this.number.id).attr("data-value",this.numberValue),$(this.number5).length>0&&(this.number5.textContent=this.numberValue+this.getUnitSymbol(),$("#"+this.number5.id).attr("data-value",this.numberValue))}catch(a){console.error("DiagnosisLedTextNumber datachangeListener failed: "+a)}},emosWS.DiagnosisLedTextNumber=DiagnosisLedTextNumber;function DiagnosisBrowserPage(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisBrowserPage parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisBrowserPage parentsbox"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisBrowserPage parentsbox"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.OPCID=this.data.OPCID,this.url=this.data.URL,this.plctag=this.plc,this.iframe=null,this.init()}DiagnosisBrowserPage.prototype.init=function(){try{var a=getElementGlobalID();this.parent.find(".Groupbox").addClass("browser");var b=this.positionClass[this.data.Position];$("<div class='"+b.css+"'><iframe class='DiagnosisBrowserIFrame' id='"+a+"' src='"+this.url+"'></iframe></div>").appendTo(this.parentDiv),this.iframe=document.getElementById(a),this.url.indexOf("$")>=0&&""!==this.OPCID&&emosWS.advise(this.plc+"."+this.data.OPCID,this.datachangeListener.bind(this),"",emosWS.tagType.IO)}catch(a){console.log("DiagnosisControlNetArray init failed: "+a)}},DiagnosisBrowserPage.prototype.datachangeListener=function(a){var b=this.url;this.iframe.src=b.replace("$",a.value)},emosWS.DiagnosisBrowserPage=DiagnosisBrowserPage;function DiagnosisControlNetArray(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisControlNetArray",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisControlNetArray",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisControlNetArray",BorderWidth:"92.4%",WriteRectWidth:"12.5%",WriteRectX:"85%",TextX:"27",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.aOPCIA=this.data.AOPCID,this.aOPCMidID=this.data.AOPCMidID,this.aOPCEndID=this.data.AOPCEndID,this.sOPCIA=this.data.SOPCID,this.sOPCMidID=this.data.SOPCMidID,this.sOPCEndID=this.data.SOPCEndID,this.start=parseInt(this.data.Start),this.stop=parseInt(this.data.Stop),this.elements=this.stop-this.start+1,this.rows=Math.floor(this.elements/11),this.plctag=this.plc,this.controls={},this.rowElements=11,this.init()}DiagnosisControlNetArray.prototype.init=function(){try{for(var a=getElementGlobalID(),b=this.start,c=this.stop+1;b<c;b++)this.controls[b]={id:getElementGlobalID(),alarmValue:null,statusValue:null,rect:null};for(var d=this.positionClass[this.data.Position],e="",f=0,g=0,h=35,i=40,j=20,k=25,l=k*this.rows,b=0;b<this.rows;b++){for(var c=b===this.rows-1?this.elements-b*this.rowElements:this.rowElements,m=0;m<c;m++){var n=b*this.rowElements+m+this.start;e+="<rect class='DiagnosisControlRectSVG' x='"+(f+m*i)+"' y='"+g+"' width='"+h+"' height='"+j+"' id='"+this.controls[n].id+"'/><text text-anchor='middle' class='DiagnosisControlTextSVG' x='"+(f+h/2+m*i)+"' y='"+(g+15)+"'>"+n+"</text>"}g+=k}$("<div class='"+d.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='"+l+"' class='DiagnosisControlArraySVG'>"+e+"</svg></div>").appendTo(this.parentDiv);for(var b=this.start,c=this.stop+1;b<c;b++)this.controls[b].rect=document.getElementById(this.controls[b].id),emosWS.advise(this.getAlarmPlctag(b),this.datachangeAlarmListener.bind(this),b,emosWS.tagType.IO),emosWS.advise(this.getStatusPlctag(b),this.datachangeStatusListener.bind(this),b,emosWS.tagType.IO)}catch(a){console.log("DiagnosisControlNetArray init failed: "+a)}},DiagnosisControlNetArray.prototype.getAlarmPlctag=function(a){var b=(100+a).toString().substring(1);return this.plctag+"."+this.aOPCIA+b+this.aOPCMidID+a+this.aOPCEndID},DiagnosisControlNetArray.prototype.getStatusPlctag=function(a){var b=(100+a).toString().substring(1);return this.plctag+"."+this.sOPCIA+b+this.sOPCMidID+a+this.sOPCEndID},DiagnosisControlNetArray.prototype.datachangeAlarmListener=function(a,b){try{var c=this.controls[b];c.alarmValue=GetAsBoolean(a.value),c.alarmValue?c.rect.style.fill=colorList.R:c.statusValue||(c.rect.style.fill=colorList.O)}catch(a){console.log("DiagnosisControlNetArray datachangeAlarmListener failed: "+a)}},DiagnosisControlNetArray.prototype.datachangeStatusListener=function(a,b){try{var c=this.controls[b];c.statusValue=GetAsBoolean(a.value),c.alarmValue||(c.statusValue?c.rect.style.fill=colorList.G:c.rect.style.fill=colorList.O)}catch(a){console.log("DiagnosisControlNetArray datachangeStatusListener failed: "+a)}},emosWS.DiagnosisControlNetArray=DiagnosisControlNetArray;function DiagnosisBitBar(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisBitBar parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisBitBar parentsbox",BorderWidth:"100%",WriteRectWidth:"25%",WriteRectX:"75%",TextX:"5",TextY:"15",NumberX:"99%",NumberY:"15"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisBitBar parentsbox",BorderWidth:"92.4%",WriteRectWidth:"12.5%",WriteRectX:"85%",TextX:"27",TextY:"15",NumberX:"96.5%",NumberY:"15"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.numberValue=null,this.barBytes=2,this.leds={},DiagnosisElement.call(this,{data:b})}DiagnosisBitBar.prototype=Object.create(DiagnosisElement.prototype),DiagnosisBitBar.prototype.constructor=DiagnosisBitBar,DiagnosisBitBar.prototype.init=function(){try{for(var a=getElementGlobalID(),b=0,c=8*this.barBytes;b<c;b++)this.leds[b]={id:getElementGlobalID(),value:null,svg:null};for(var d=this.positionClass[this.data.Position],e="",f=0,g=10,h=10,i=12,j=6,b=0;b<this.barBytes;b++){for(var k=0;k<8;k++){var l=8*(this.barBytes-b-1)+(7-k);e+="<text class='DiagnosisNumberNumberTextSVG' x='"+(f+k*g)+"' y='"+h+"'>"+(7-k)+"</text><rect class='DiagnosisBitSVG' x='"+(f+k*g)+"' y='"+i+"' width='"+j+"' height='"+j+"' id='"+this.leds[l].id+"'/>"}f+=9*g}(this.panel=$("<div class='"+d.css+"' id='"+a+"'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' class='DiagnosisBitBarSVG'>"+e+"</svg></div><br class='cl'>")).appendTo(this.parentDiv);for(var b=0,c=8*this.barBytes;b<c;b++)this.leds[b].svg=document.getElementById(this.leds[b].id);emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO)}catch(a){console.log("DiagnosisBitBar init failed: "+a)}},DiagnosisBitBar.prototype.datachangeListener=function(a){try{this.numberValue=GetAsInteger(a.value);for(var b=4294967296,c=(b+this.numberValue).toString(2),d=0,e=8*this.barBytes;d<e;d++){this.leds[d].value=c[c.length-d-1];var f="1"===this.leds[d].value?colorList.G:colorList.O;this.leds[d].svg.style.fill=f}}catch(a){console.log("DiagnosisBitBar datachangeListener failed: "+a)}},emosWS.DiagnosisBitBar=DiagnosisBitBar;function DiagnosisTextLED(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.led=this.border=this.text=this.LEDValue=null,this.icon=this.data.leftIcon?this.data.leftIcon:"on",this.writable&&(this.classelist=this.icon+" emosbutton"),DiagnosisElement.call(this,{data:b,writable:d})}DiagnosisTextLED.prototype=Object.create(DiagnosisElement.prototype),DiagnosisTextLED.prototype.constructor=DiagnosisTextLED,DiagnosisTextLED.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();this.ledID=b;var c=getElementGlobalID(),d=getElementGlobalID(),e=this.positionClass[this.data.Position],f="";this.panel=$("<div class='"+e.css+"' id='"+a+"'><span id='"+b+"' class='"+this.classelist+" orange'></span><div class='textLed'><span id='"+d+"'>"+this.data.Text+"</span></div><br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.writeRect1=document.getElementById(a),this.writable&&this.writeRect1.classList.add("noBottomBorder"),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("DiagnosisTextLED init failed: "+a)}},DiagnosisTextLED.prototype.getWritable=function(a){a.writable?(a.led.style.cursor="pointer",a.led.className=a.led.className+" writable",a.led.addEventListener("click",function(){emosWS.poke(a.plctag,a.LEDValue?"0":"-1")}.bind(a)),a.led1&&(a.led1.style.cursor="pointer")):$("#"+this.ledID).addClass("notwritable")},DiagnosisTextLED.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor="pointer",this.led.style.pointerEvents="auto",this.led.style.opacity=1,$("#"+this.ledID).removeClass("disabled"),this.led1&&(this.led1.style.cursor="pointer",this.led1.style.pointerEvents="auto",this.led1.style.opacity=1,$("#"+this.ledID1).removeClass("disabled"))):(this.led.style.cursor="auto",this.led.style.pointerEvents="none",$("#"+this.ledID).addClass("disabled"),this.led1&&(this.led1.style.cursor="auto",this.led1.style.pointerEvents="none",$("#"+this.ledID1).addClass("disabled")))},DiagnosisTextLED.prototype.datachangeListener=function(a){try{this.icon=this.data.leftIcon?this.data.leftIcon:"on",this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?this.data.OnLED:this.data.OffLED],c=colorList[this.LEDValue?this.data.OffLED:this.data.OnLED];$("#"+this.ledID).addClass(this.icon).addClass(b).removeClass(c).removeClass("orange"),this.led1&&$("#"+this.ledID1).addClass(this.icon).addClass(b).removeClass(c).removeClass("orange"),this.writable?($("#"+this.ledID).addClass("writable"),this.led1&&$("#"+this.ledID1).addClass("writable")):($("#"+this.ledID).removeClass("writable").addClass("notwritable"),this.led1&&$("#"+this.ledID1).removeClass("writable").addClass("notwritable"))}catch(a){console.log("DiagnosisTextLED datachangeListener failed: "+a)}},emosWS.DiagnosisTextLED=DiagnosisTextLED;function DiagnosisDoubleText(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisDoubleText parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisDoubleText parentsbox"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisDoubleText parentsbox"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.text=this.text2=null,DiagnosisElement.call(this,{data:b})}DiagnosisDoubleText.prototype=Object.create(DiagnosisElement.prototype),DiagnosisDoubleText.prototype.constructor=DiagnosisDoubleText,DiagnosisDoubleText.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID();void 0!==this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&(this.plctag=""===this.data.VisibleOPCID?"":this.plc+"."+this.data.OPCID);var d=this.positionClass[this.data.Position];(this.panel=$("<div class='"+d.css+"' id='"+a+"'><div class='DiagnosisDoubleTextDiv' id='"+c+"'>"+this.data.Text2+"</div><div class='DiagnosisDoubleTextDiv' id='"+b+"'>"+this.data.Text+"</div></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b),this.text2=document.getElementById(c),""!==this.plctag&&emosWS.advise(this.plctag,function(a){try{var b=GetAsBoolean(a.value);this.text.style.visibility=b?"visible":"hidden",this.text2.style.visibility=b?"visible":"hidden"}catch(a){console.log("DiagnosisDoubleText datachangeListener failed: "+a)}}.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID2,"name",function(a){""!==a.value&&(this.text2.textContent=a.value)}.bind(this),this)}catch(a){console.log("DiagnosisDoubleText init failed: "+a)}},emosWS.DiagnosisDoubleText=DiagnosisDoubleText;function DiagnosisString(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.diagnosisWindow=e,this.specClass=e.specClass,this.myKey=f,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisString parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisString parentsbox"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisString parentsbox"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.callForString=!1,this.OPCID=this.data.OPCID,this.data.OPCID.replace(/^([^\[\]]*)((\[(.*))?\])?$/,function(a,b,c,d,e){this.OPCID=b,this.callForString=void 0!==c}.bind(this)),this.plctagVisible=this.textValue="",this.plctag=this.plc+"."+this.OPCID,this.text=null,this.textColor=this.writable?"#76a0b5":"black",this.textId=null,this.headline=null,this.oldTextVal=null,this.strLen=parseInt(this.data.StrLen),this.strStart=parseInt(this.data.StrStart),DiagnosisElement.call(this,{data:b,writable:d})}DiagnosisString.prototype=Object.create(DiagnosisElement.prototype),DiagnosisString.prototype.constructor=DiagnosisString,DiagnosisString.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID();this.previewId=f,this.textId=b,this.writeRectId=c;var g=getElementGlobalID();void 0!==this.data.VisibleOPCID&&""!==this.data.VisibleOPCID&&(this.plctagVisible=""===this.data.VisibleOPCID?"":this.plc+"."+this.data.VisibleOPCID),"MS.M1000_Funct"===this.data.OPCID&&$(this.parentDiv).addClass("specClass");var h=this.positionClass[this.data.Position],i=this.data.StrStart?this.data.StrStart-1:0,j=$("<div class='"+h.css+"' id='"+a+"'><span id='"+e+"' class='savebutton emosbutton'></span><span id='"+d+"' class='cancelbutton emosbutton'></span><span id='"+c+"' class='writebutton getKeypad keyboardInputInitiator emosbutton'></span><br class='cl'><div style='font-size: 14px;'><span id='"+g+"'>"+this.data.Text+"</span></div><span style='display: inline-block;margin-top: 10px;' class='DiagnosisNumberLRTextNumberSVG orange' id='"+b+"'>"+this.textValue+"</span><div class='DiagnosisStringButtons' style='margin-top:20px;padding-top: 0;'><textarea lang='' maxlength='"+this.data.StrLen+"' pattern='.{"+i+",}' class='DiagnosisStringFieldTextArea preview keyboardInput' type='textarea' id='"+f+"' required></textarea></p></div></div>");if(j[0].myData=this.data,j[0].myKey=this.myKey,$(this.parentDiv)[0].myData=this.data,j.appendTo(this.parentDiv),this.text=document.getElementById(b),this.writeRect=document.getElementById(c),this.cancelbutton=document.getElementById(d),this.savebutton=document.getElementById(e),this.headline=document.getElementById(g),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&$("#"+g).text(a.value)}),this.callForString)for(var k=[],l="2"===this.diagnosisWindow.PLCType,m=0;m<this.strLen;m++)emosWS.advise(this.plctag+"["+(this.strStart+m)+"]",function(a,b){k[b]=l?String.fromCharCode(a.value):a.value,this.datachangeCharacterStringListener(k.join(""))}.bind(this),m);else""!==this.plctag&&emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO);this.getWritable(this)}catch(a){console.log("DiagnosisString init failed: "+a)}},DiagnosisString.prototype.onClick=function(a){$("#"+this.previewId).val($("#"+this.textId).text()),$("#"+this.previewId).height("1px"),$("#"+this.previewId).height($("#"+this.previewId).prop("scrollHeight")+"px"),$("#"+this.writeRectId).siblings(".DiagnosisStringButtons").animate({height:$("#"+this.previewId).prop("scrollHeight")+10}),this.writeRect.style.display="none",this.cancelbutton.style.display="block",this.savebutton.style.display="block"},DiagnosisString.prototype.getWritable=function(a){a.writable&&(a.writeRect.style.cursor="pointer",a.writeRect.addEventListener("click",DiagnosisString.prototype.onClick.bind(a)),this.writable=a.writable,this.writeRect=a.writeRect,this.cancelbutton=a.cancelbutton,this.savebutton=a.savebutton,this.writeRectId=a.writeRectId,this.text=a.text,this.updateWrite())},DiagnosisString.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.writeRect.style.cursor="pointer",this.writeRect.style.pointerEvents="auto",this.text.style.color=this.textColor="#76a0b5",this.writeRect.style.display="block"):(this.writeRect.style.cursor="auto",this.writeRect.style.pointerEvents="none",this.text.style.color=this.textColor="black",this.writeRect.style.display="none")},DiagnosisString.prototype.datachangeListener=function(a){try{var b=GetAsBoolean(a.value);this.data.StrLen||(this.data.StrLen=a.value.length);var c=a.value.substr(this.data.StrStart-1,this.data.StrLen);$("#"+this.textId).text(c).removeClass("orange"),this.textValue=c,this.text1&&$("#"+this.text1.id).text(c).removeClass("orange")}catch(a){console.log("DiagnosisString datachangeListener failed: "+a)}},DiagnosisString.prototype.datachangeCharacterStringListener=function(a){try{var b=a;$("#"+this.textId).text(b).removeClass("orange"),this.textValue=b,this.text1&&$("#"+this.text1.id).text(b).removeClass("orange")}catch(a){console.log("DiagnosisString datachangeCharacterStringListener failed: "+a)}},emosWS.DiagnosisString=DiagnosisString;function DiagnosisStringField(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisString parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisString parentsbox"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisString parentsbox"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.text=null,this.textValue="",DiagnosisElement.call(this,{data:b})}DiagnosisStringField.prototype=Object.create(DiagnosisElement.prototype),DiagnosisStringField.prototype.constructor=DiagnosisStringField,DiagnosisStringField.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=this.positionClass[this.data.Position];(this.panel=$("<div class='"+c.css+"' id='"+a+"'><textarea class='DiagnosisStringFieldTextArea' id='"+b+"' readonly></p></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b),emosWS.advise(this.plctag,function(a){""!==a.value&&(this.text.value=a.value,this.text.style["background-color"]="white",this.textValue=a.value,this.text.style.height="1px",this.text.style.height=this.text.scrollHeight+"px")}.bind(this))}catch(a){console.log("DiagnosisString init failed: "+a)}},emosWS.DiagnosisStringField=DiagnosisStringField;function DiagnosisStringFieldComment(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisStringComment parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisStringComment parentsbox"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisStringComment parentsbox"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.text=null,this.textValue="",DiagnosisElement.call(this,{data:b})}DiagnosisStringFieldComment.prototype=Object.create(DiagnosisElement.prototype),DiagnosisStringFieldComment.prototype.constructor=DiagnosisStringFieldComment,DiagnosisStringFieldComment.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=this.positionClass[this.data.Position];(this.panel=$("<div class='"+c.css+"' id='"+a+"'><p id='"+b+"'>"+this.data.Comment+"</p></div>")).appendTo(this.parentDiv),this.text=document.getElementById(b),this.text.textContent=this.data.Comment,emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&$("#"+b).val(a.value)}.bind(this),this)}catch(a){console.log("DiagnosisStringFieldComment init failed: "+a)}},emosWS.DiagnosisStringFieldComment=DiagnosisStringFieldComment;function DiagnosisChildWindow(a,b,c,d){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=d,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisText"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisText"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLong"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.dataText=""===this.data.Text?".":this.data.Text,this.plctag="",this.text="",this.init()}DiagnosisChildWindow.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=this.data.Name+" "+this.data.Comment+" - ",d="TextID: "+this.data.TextID;$("<div class='DiagnosisGerneralElement'><svg id='"+a+"' width='100%' height='20'><rect width='100%' height='20' style='fill:white;stroke-width:1;stroke:grey' /><text id='"+b+"' x='5' y='15' fill='black'>"+c+d+"</text></svg></div>").appendTo(this.parentDiv),this.text=document.getElementById(b),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=c+a.value)}.bind(this),this)}catch(a){console.log("DiagnosisChildWindow init failed: "+a)}},emosWS.DiagnosisChildWindow=DiagnosisChildWindow;function CommandFeedback2WR2RD(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.writeLeft=this.plc+"."+this.data.writeTagWR1,this.readLeft=this.plc+"."+this.data.readTagRD1,this.data.writeTagWR2&&(this.writeRight=this.plc+"."+this.data.writeTagWR2),this.data.readTagRD2&&(this.readRight=this.plc+"."+this.data.readTagRD2),this.led=this.led2=this.border=this.text=this.LEDValue=this.LEDValue2=null,this.ledID,this.ledID2,DiagnosisElement.call(this,{data:b,writable:d})}CommandFeedback2WR2RD.prototype=Object.create(DiagnosisElement.prototype),CommandFeedback2WR2RD.prototype.constructor=CommandFeedback2WR2RD,CommandFeedback2WR2RD.prototype.init=function(){try{var a=getElementGlobalID(),b=this.ledID=getElementGlobalID(),c=this.ledID2=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];this.panel=$("<div class='"+f.css+"' id='"+a+"'><span id='"+b+"' class='emosbutton orange links "+this.data.leftIcon+"'></span><span id='"+c+"' class='emosbutton orange rechts "+this.data.rightIcon+"'></span><div class='textLed'><span id='"+e+"'>"+this.data.Text+"</span></div><br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.led2=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.writeRect1=document.getElementById(a),emosWS.advise(this.readLeft,this.datachangeListenerLeft.bind(this),"",emosWS.tagType.IO),this.readRight&&emosWS.advise(this.readRight,this.datachangeListenerRight.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerWriteLeft.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeRight,this.datachangeListenerWriteRight.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("CommandFeedback2WR2RD init failed: "+a)}},CommandFeedback2WR2RD.prototype.getWritable=function(a){a.writable?(a.led.style.cursor=a.led2.style.cursor="pointer",$("#"+a.ledID).addClass("writable"),$("#"+a.ledID2).addClass("writable"),$("#"+a.ledID).on("click",function(){$(this).addClass("switchmode"),a.writeRight?emosWS.poke(a.writeLeft,"-1"):emosWS.poke(a.writeLeft,"0")}),$("#"+a.ledID2).on("click",function(){$(this).addClass("switchmode"),a.writeRight?emosWS.poke(a.writeRight,"-1"):emosWS.poke(a.writeLeft,"-1")})):($("#"+a.ledID).addClass("notwritable"),$("#"+a.ledID2).addClass("notwritable"))},CommandFeedback2WR2RD.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor=this.led2.style.cursor="pointer",this.led.style.pointerEvents=this.led2.style.pointerEvents="auto",$("#"+this.ledID).removeClass("disabled"),$("#"+this.ledID2).removeClass("disabled")):($("#"+this.ledID).addClass("disabled"),$("#"+this.ledID2).addClass("disabled"),this.led.style.cursor=this.led2.style.cursor="auto",this.led.style.pointerEvents=this.led2.style.pointerEvents="none")},CommandFeedback2WR2RD.prototype.datachangeListenerLeft=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=this.LEDValue?"onMode":"offMode",c=this.LEDValue?"offMode":"onMode",d=colorList[this.LEDValue?"G":"O"],e=colorList[this.LEDValue?"O":"G"];this.readRight?($("#"+this.ledID).addClass(b).removeClass(c).removeClass("switchmode"),$("#"+this.ledID3).addClass(d).removeClass(e).removeClass("orange")):this.readRight||this.writeRight?($("#"+this.ledID2).addClass(b).removeClass(c).removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).addClass(c).removeClass(b).removeClass("switchmode").removeClass("orange"),$("#"+this.ledID4).addClass(d).removeClass(e).removeClass("orange"),$("#"+this.ledID3).addClass(e).removeClass(d).removeClass("orange")):this.LEDValue?($("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).addClass("offMode").removeClass("onMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID4).addClass(d).removeClass(e).removeClass("orange"),$("#"+this.ledID3).addClass(e).removeClass(d).removeClass("orange")):($("#"+this.ledID).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).addClass("offMode").removeClass("onMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID3).addClass(d).removeClass(e).removeClass("orange"),$("#"+this.ledID4).addClass(e).removeClass(d).removeClass("orange")),this.writable?$("#"+this.ledID).addClass("writable").removeClass("notwritable").removeClass("orange"):$("#"+this.ledID).addClass("notwritable").removeClass("writable").removeClass("orange")}catch(a){console.log("CommandFeedback2WR2RD datachangeListener failed: "+a)}},CommandFeedback2WR2RD.prototype.datachangeListenerRight=function(a){try{this.LEDValue2=GetAsBoolean(a.value);var b=this.LEDValue2?"onMode":"offMode",c=this.LEDValue2?"offMode":"onMode",d=colorList[this.LEDValue2?"G":"O"],e=colorList[this.LEDValue2?"O":"G"];$("#"+this.ledID2).addClass(b).removeClass(c).removeClass("switchmode").removeClass("orange"),$("#"+this.ledID4).addClass(d).removeClass(e).removeClass("orange"),this.writable?$("#"+this.ledID2).addClass("writable").removeClass("notwritable").removeClass("orange"):$("#"+this.ledID2).addClass("notwritable").removeClass("writable").removeClass("orange")}catch(a){console.log("CommandFeedback2WR2RD datachangeListener failed: "+a)}},CommandFeedback2WR2RD.prototype.datachangeListenerWriteLeft=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},CommandFeedback2WR2RD.prototype.datachangeListenerWriteRight=function(a){try{this.LEDValueW2=GetAsBoolean(a.value),this.LEDValueW2||$("#"+this.ledID2).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},emosWS.CommandFeedback2WR2RD=CommandFeedback2WR2RD;function CommandFeedback1WR2RD(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.writeLeft=this.plc+"."+this.data.writeTagWR1,this.readLeft=this.plc+"."+this.data.readTagRD1,this.readRight=this.plc+"."+this.data.readTagRD2,this.led=this.led2=this.border=this.text=this.LEDValue=this.LEDValue2=null,this.ledID,this.ledID2,DiagnosisElement.call(this,{data:b,writable:d})}CommandFeedback1WR2RD.prototype=Object.create(DiagnosisElement.prototype),CommandFeedback1WR2RD.prototype.constructor=CommandFeedback1WR2RD,CommandFeedback1WR2RD.prototype.init=function(){try{var a=getElementGlobalID(),b=this.ledID=getElementGlobalID(),c=this.ledID2=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];this.panel=$("<div class='"+f.css+"' id='"+a+"'><span id='"+b+"' class='emosbutton notactive links "+this.data.leftIcon+"'></span><span id='"+c+"' class='emosbutton orange rechts "+this.data.rightIcon+"'></span><div class='textLed'><span id='"+e+"'>"+this.data.Text+"</span></div><br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.led2=document.getElementById(c),this.text=document.getElementById(e),this.border=document.getElementById(d),this.writeRect1=document.getElementById(a),emosWS.advise(this.readLeft,this.datachangeListenerLeft.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.readRight,this.datachangeListenerRight.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerW1.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("CommandFeedback1WR2RD init failed: "+a)}},CommandFeedback1WR2RD.prototype.getWritable=function(a){a.writable?(a.led.style.cursor="auto",a.led2.style.cursor="pointer",$("#"+a.ledID2).addClass("writable"),$("#"+a.ledID2).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeLeft,"-1")})):($("#"+a.ledID).addClass("notwritable"),$("#"+a.ledID2).addClass("notwritable"))},CommandFeedback1WR2RD.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor="auto",this.led2.style.cursor="pointer",this.led2.style.pointerEvents="auto",this.led2.style.opacity=1,$("#"+this.ledID).removeClass("disabled"),$("#"+this.ledID2).removeClass("disabled")):($("#"+this.ledID).addClass("disabled"),$("#"+this.ledID2).addClass("disabled"),this.led2.style.cursor="auto",this.led2.style.pointerEvents="none")},CommandFeedback1WR2RD.prototype.datachangeListenerLeft=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?"G":"O"],c=colorList[this.LEDValue?"O":"G"];this.LEDValue?($("#"+this.ledID).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).addClass("offMode").removeClass("onMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID3).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange")):$("#"+this.ledID3).addClass(b).removeClass(c).removeClass("orange"),this.writable?$("#"+this.ledID2).addClass("writable").removeClass("notwritable").removeClass("orange"):$("#"+this.ledID2).addClass("notwritable").removeClass("writable").removeClass("orange")}catch(a){console.log("CommandFeedback1WR2RD datachangeListener failed: "+a)}},CommandFeedback1WR2RD.prototype.datachangeListenerRight=function(a){try{this.LEDValue2=GetAsBoolean(a.value);var b=colorList[this.LEDValue2?"G":"O"],c=colorList[this.LEDValue2?"O":"G"];this.LEDValue2?($("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).addClass("offMode").removeClass("onMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID3).addClass(c).removeClass(b).removeClass("orange")):$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),this.writable?$("#"+this.ledID2).addClass("writable").removeClass("notwritable").removeClass("orange"):$("#"+this.ledID2).addClass("notwritable").removeClass("writable").removeClass("orange")}catch(a){console.log("CommandFeedback1WR2RD datachangeListener failed: "+a)}},CommandFeedback1WR2RD.prototype.datachangeListenerW1=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID2).removeClass("switchmode")}catch(a){console.log("CommandFeedback1WR2RD datachangeListenerw1 failed: "+a)}},emosWS.CommandFeedback1WR2RD=CommandFeedback1WR2RD;function CommandFeedback1B1WR1RD(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.writeLeft=this.plc+"."+this.data.writeTagWR1,this.readLeft=this.plc+"."+this.data.readTagRD1,this.led=this.text=this.LEDValue=null,this.ledID,DiagnosisElement.call(this,{data:b,writable:d})}CommandFeedback1B1WR1RD.prototype=Object.create(DiagnosisElement.prototype),CommandFeedback1B1WR1RD.prototype.constructor=CommandFeedback1B1WR1RD,CommandFeedback1B1WR1RD.prototype.init=function(){try{var a=getElementGlobalID(),b=this.ledID=getElementGlobalID(),c=getElementGlobalID(),d=this.positionClass[this.data.Position];this.panel=$("<div class='"+d.css+"' id='"+a+"'><span id='"+b+"' class='emosbutton orange "+this.data.leftIcon+"'></span><div class='textLed'><span id='"+c+"'>"+this.data.Text+"</span></div><br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.text=document.getElementById(c),emosWS.advise(this.readLeft,this.datachangeListenerLeft.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerWriteLeft.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("CommandFeedback1B1WR1RD init failed: "+a)}},CommandFeedback1B1WR1RD.prototype.getWritable=function(a){a.writable?(a.led.style.cursor="pointer",$("#"+a.ledID).addClass("writable"),$("#"+a.ledID).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeLeft,"0")})):$("#"+a.ledID).addClass("notwritable")},CommandFeedback1B1WR1RD.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor="pointer",this.led.style.pointerEvents="auto",$("#"+this.ledID).removeClass("disabled")):($("#"+this.ledID).addClass("disabled"),this.led.style.cursor="auto",this.led.style.pointerEvents="none")},CommandFeedback1B1WR1RD.prototype.datachangeListenerLeft=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=this.LEDValue?"onMode":"offMode",c=this.LEDValue?"offMode":"onMode";$("#"+this.ledID).removeClass(c).addClass(b).removeClass("switchmode").removeClass("orange"),this.writable?$("#"+this.ledID).addClass("writable").removeClass("notwritable").removeClass("orange"):$("#"+this.ledID).addClass("notwritable").removeClass("writable").removeClass("orange")}catch(a){console.log("CommandFeedback1B1WR1RD datachangeListener failed: "+a)}},CommandFeedback1B1WR1RD.prototype.datachangeListenerWriteLeft=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID).removeClass("switchmode")}catch(a){console.log("CommandFeedback1B1WR1RD datachangeListener failed: "+a)}},emosWS.CommandFeedback1B1WR1RD=CommandFeedback1B1WR1RD;function ShowExternalContent(a,b,c,d,e,f){this.parent=a,this.data=b,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed minHeight parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed minHeight parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed minHeight parentsbox",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),DiagnosisElement.call(this,{data:b,writable:d})}ShowExternalContent.prototype=Object.create(DiagnosisElement.prototype),ShowExternalContent.prototype.constructor=ShowExternalContent,ShowExternalContent.prototype.init=function(){try{var a=getElementGlobalID(),b=this,c=this.positionClass[this.data.Position],d;if(1===this.data.Text.length){var e=getElementGlobalID();d='<span id="'+e+'" data-url="'+this.data.URLarray+'" class="extContentLinktext">show '+this.data.Text+"</span>"}else{var f=getElementGlobalID(),g=this.data.URLarray;d='<div class="inputGroup fl linkselector"><span class="dropdown emosbutton noicon"><span class="">Select...</span></span><ul class="dropdownlist noicon selectUrl" id="'+f+'"></ul></div>',$.each(this.data.Text,function(a,b){$("#"+f).append('<li class="breadoverlay_li" data-url="'+g[a]+'">'+b+"</li>")})}this.panel=$("<div class='"+c.css+"'><span id='"+a+"' class='emosbutton extContent fl "+this.data.leftIcon+"'></span><div class='contentOverlay'><div class='closeTabs closeSubTabs emosbutton'></div></div>"+d+"<br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),1===this.data.Text.length?(this.text=document.getElementById(e),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this)):$.each(this.data.Text,function(a,b){$("#"+f).append('<li class="breadoverlay_li" data-url="'+g[a]+'">'+b+"</li>")}),$("#"+a).on("click",function(){if($(".extContent").removeClass("active"),$(".contentOverlayHtml").remove(),1===b.data.Text.length){$(".modal").show(),$(this).next().show(),$(this).addClass("active");var a=$(this).nextAll(".extContentLinktext").attr("data-url");$('<iframe class="contentOverlayHtml" name="plants" src="'+a+'">').appendTo(".contentOverlay")}else{if($(this).nextAll(".linkselector").find(".breadoverlay_li.active").length<1)return;$(this).addClass("active"),$(".modal").show(),$(this).next().show();var a=$(this).nextAll(".linkselector").find(".breadoverlay_li.active").attr("data-url");$('<iframe class="contentOverlayHtml" name="plants" src="'+a+'">').appendTo(".contentOverlay")}}),$(".closeSubTabs").on("click",function(){$(".extContent").removeClass("active"),$(".contentOverlayHtml").remove(),$(".contentOverlay").hide(),$(".modal").hide()})}catch(a){console.log("ShowExternalContent init failed: "+a)}},emosWS.ShowExternalContent=ShowExternalContent;function ControllerElement(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LMRLeft,css:"ControllerElement parentsbox"},M:{parent:this.diagnosisWindow.divTypes.LMRMiddle,css:"ControllerElement parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LMRRight,css:"ControllerElement parentsbox"}},this.plctag1=this.plc+"."+this.data.actualValueTag,this.plctag2=this.plc+"."+this.data.setpointActualValueTag,this.plctag21=this.plc+"."+this.data.setpointRampValueTag,this.plctag3=this.plc+"."+this.data.outputValueTag,this.parentDiv=this.numberValue=this.numberValue1=this.numberValue2=this.numberValue3=this.barValue=this.text=this.number=this.unitText=null,this.unit=emosWS.getUnit(),this.actalUnit=[],this.actalUnit.actualMetricalUnit=this.data.actualMetricalUnit,this.actalUnit.actualImperialUnit=this.data.actualImperialUnit,this.actalUnit.actualLocalUnit=this.data.actualLocalUnit,this.setpointUnit=[],this.setpointUnit.actualMetricalUnit=this.data.setpointMetricalUnit,this.setpointUnit.actualImperialUnit=this.data.setpointImperialUnit,this.setpointUnit.actualLocalUnit=this.data.setpointLocalUnit,this.outputUnit=[],this.outputUnit.actualMetricalUnit=this.data.outputMetricalUnit,this.outputUnit.actualImperialUnit=this.data.outputImperialUnit,this.outputUnit.actualLocalUnit=this.data.outputLocalUnit,this.init()}ControllerElement.prototype.getUnitSymbol=function(a){switch(this.unit){case emosWS.unitID.Metric:return" "+a.actualMetricalUnit;case emosWS.unitID.UnitImperial:return" "+a.actualImperialUnit;case emosWS.unitID.UnitLocale:return" "+a.actualLocalUnit;default:return""}},ControllerElement.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m=getElementGlobalID(),n=getElementGlobalID(),o=getElementGlobalID(),p=getElementGlobalID(),q=getElementGlobalID(),r=getElementGlobalID(),s=getElementGlobalID(),t=getElementGlobalID(),u=getElementGlobalID(),v=getElementGlobalID(),w=getElementGlobalID(),x=getElementGlobalID(),y=getElementGlobalID(),z=getElementGlobalID(),A=getElementGlobalID(),B=getElementGlobalID(),C=getElementGlobalID(),D=getElementGlobalID();this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent);var E=this.positionClass[this.data.Position];this.unitText=this.getUnitSymbol(this.actalUnit),this.unitText1=this.getUnitSymbol(this.setpointUnit),this.unitText2=this.getUnitSymbol(this.outputUnit);$("<div class='"+E.css+"' id='"+a+"'><div class='actual'><div class='barhead' id='"+c+"'>"+this.data.actualText+this.unitText+"</div><div class='tempratureouterbox'><div id='"+d+"' class='tempratureinnerbox'></div><div id='"+j+"' class='valuepointerbox'><span id='"+b+"'>"+this.numberValue+"</span><div class='valuepointer'></div></div></div><div class='scala'><span id='"+e+"' class='bartext bartext0'>0</span><span id='"+f+"' class='bartext bartext25'>25</span><span id='"+g+"' class='bartext bartext50'>50</span><span id='"+h+"' class='bartext bartext75'>75</span><span id='"+i+"' class='bartext bartext100'>100</span></div><br class='cl'></div><div class='actual'><div class='barhead' id='"+l+"'>"+this.data.setpointText+this.unitText1+"</div><div class='tempratureouterbox'><div id='"+m+"' class='tempratureinnerbox'></div><div id='"+s+"' class='valuepointerbox'><span id='"+k+"'>"+this.numberValue1+"</span><div class='valuepointer'></div></div><div id='"+t+"' class='setpointbar'></div><div id='"+u+"' class='setpointbarvalue'></div></div><div class='scala'><span id='"+n+"' class='bartext bartext0'>0</span><span id='"+o+"' class='bartext bartext25'>25</span><span id='"+p+"' class='bartext bartext50'>50</span><span id='"+q+"' class='bartext bartext75'>75</span><span id='"+r+"' class='bartext bartext100'>100</span></div><br class='cl'></div><div class='actual output'><div class='barhead' id='"+w+"'>"+this.data.outputText+this.unitText2+"</div><div class='tempratureouterbox'><div id='"+x+"' class='tempratureinnerbox'></div><div id='"+D+"' class='valuepointerbox'><span id='"+v+"'>"+this.numberValue3+"</span><div class='valuepointer'></div></div></div><div class='scala'><span id='"+y+"' class='bartext bartext0'>0</span><span id='"+z+"' class='bartext bartext25'>25</span><span id='"+A+"' class='bartext bartext50'>50</span><span id='"+B+"' class='bartext bartext75'>75</span><span id='"+C+"' class='bartext bartext100'>100</span></div><br class='cl'></div><br class='cl'></div>").appendTo(this.parentDiv),this.number=document.getElementById(b),this.text=document.getElementById(c),this.barValue=document.getElementById(d),this.valuepointerbox=document.getElementById(j),this.number1=document.getElementById(k),this.text1=document.getElementById(l),this.barValue1=document.getElementById(m),this.valuepointerbox1=document.getElementById(s),this.setpointbar=document.getElementById(t),this.setpointbarvalue=document.getElementById(u),this.number2=document.getElementById(v),this.text2=document.getElementById(w),this.barValue2=document.getElementById(x),this.valuepointerbox2=document.getElementById(D),emosWS.advise(this.plctag1,function(a){if(a){this.plcmin=a.value&&a.value.plc_min?Number(a.value.plc_min):0,this.plcmax=a.value&&a.value.plc_max?Number(a.value.plc_max):100;var b=(this.plcmax-this.plcmin)/4;document.getElementById(e).textContent=this.plcmin,document.getElementById(f).textContent=this.plcmax-this.plcmin>10?Math.round(b+this.plcmin):b+this.plcmin,document.getElementById(g).textContent=this.plcmax-this.plcmin>10?Math.round(2*b+this.plcmin):2*b+this.plcmin,document.getElementById(h).textContent=this.plcmax-this.plcmin>10?Math.round(3*b+this.plcmin):3*b+this.plcmin,document.getElementById(i).textContent=this.plcmax}}.bind(this),"",emosWS.tagType.Property),emosWS.advise(this.plctag2,function(a){if(a){this.plcmin1=a.value&&a.value.plc_min?Number(a.value.plc_min):0,this.plcmax1=a.value&&a.value.plc_max?Number(a.value.plc_max):100;var b=(this.plcmax1-this.plcmin1)/4;document.getElementById(n).textContent=this.plcmin1,document.getElementById(o).textContent=this.plcmax1-this.plcmin1>10?Math.round(b+this.plcmin1):b+this.plcmin1,document.getElementById(p).textContent=this.plcmax1-this.plcmin1>10?Math.round(2*b+this.plcmin1):2*b+this.plcmin1,document.getElementById(q).textContent=this.plcmax1-this.plcmin1>10?Math.round(3*b+this.plcmin1):3*b+this.plcmin1,document.getElementById(r).textContent=this.plcmax1}}.bind(this),"",emosWS.tagType.Property),emosWS.advise(this.plctag3,function(a){if(a){this.plcmin2=0,this.plcmax2=100;var b=(this.plcmax2-this.plcmin2)/4;document.getElementById(y).textContent=this.plcmin2,document.getElementById(z).textContent=this.plcmax2-this.plcmin2>10?Math.round(b+this.plcmin2):b+this.plcmin2,document.getElementById(A).textContent=this.plcmax2-this.plcmin2>10?Math.round(2*b+this.plcmin2):2*b+this.plcmin2,document.getElementById(B).textContent=this.plcmax2-this.plcmin2>10?Math.round(3*b+this.plcmin2):3*b+this.plcmin2,document.getElementById(C).textContent=this.plcmax2}}.bind(this),"",emosWS.tagType.Property),emosWS.advise(this.plctag1,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag2,this.datachangeListener1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag21,this.datachangeListener12.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag3,this.datachangeListener3.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag1,this.datachangeListenerB.bind(this),"",emosWS.tagType.IOObject,this.data.actualMetricalUnit,1,this.data.actualUnitImperial,1,this.data.actualUnitLocale,1),emosWS.advise(this.plctag2,this.datachangeListener1B.bind(this),"",emosWS.tagType.IOObject,this.data.setpointMetricalUnit,1,this.data.setpointUnitImperial,1,this.data.setpointUnitLocale,1),emosWS.advise(this.plctag3,this.datachangeListener2B.bind(this),"",emosWS.tagType.IOObject,this.data.outputMetricalUnit,1,this.data.outputUnitImperial,1,this.data.outputUnitLocale,1),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.actualTextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value+this.unitText)}.bind(this),this),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.setpointTextID,"name",function(a){""!==a.value&&(this.text1.textContent=a.value+this.unitText1)}.bind(this),this),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.outputTextID,"name",function(a){""!==a.value&&(this.text2.textContent=a.value+this.unitText2)}.bind(this),this)}catch(a){console.log("ControllerElement init failed: "+a)}},ControllerElement.prototype.datachangeListener=function(a){try{this.data.actualDecimalDigits?this.numberValue=parseFloat(a.value).toFixed(this.data.actualDecimalDigits):this.numberValue=GetAsInteger(a.value),this.number.textContent=this.numberValue;var b=this.plcmax-this.plcmin,c=160/b,d=(this.numberValue-this.plcmin)*c;d<3?(this.barValue.style.height=d+"px",this.valuepointerbox.style.bottom=d-3+"px"):(this.barValue.style.height=d-3+"px",this.valuepointerbox.style.bottom=d-6+"px")}catch(a){console.log("ControllerElement datachangeListener failed: "+a)}},ControllerElement.prototype.datachangeListenerB=function(a){try{this.text.textContent=""!==a.value.unitSymbol?this.data.actualText+" "+a.value.unitSymbol:this.data.actualText+" "+this.getUnitSymbol(this.actalUnit)}catch(a){console.log("ControllerElement datachangeListenerB failed: "+a)}},ControllerElement.prototype.datachangeListener1B=function(a){try{this.text1.textContent=""!==a.value.unitSymbol?this.data.setpointText+" "+a.value.unitSymbol:this.data.setpointText+" "+this.getUnitSymbol(this.setpointUnit)}catch(a){console.log("ControllerElement datachangeListenerB failed: "+a)}},ControllerElement.prototype.datachangeListener2B=function(a){try{this.text2.textContent=""!==a.value.unitSymbol?this.data.outputText+" "+a.value.unitSymbol:this.data.outputText+" "+this.getUnitSymbol(this.outputUnit)}catch(a){console.log("ControllerElement datachangeListenerB failed: "+a)}},ControllerElement.prototype.datachangeListener1=function(a){try{this.data.actualDecimalDigits?this.numberValue1=parseFloat(a.value).toFixed(this.data.actualDecimalDigits):this.numberValue1=GetAsInteger(a.value),this.number1.textContent=this.numberValue1;var b=this.plcmax1-this.plcmin1,c=160/b,d=(this.numberValue1-this.plcmin1)*c;d<3?(this.barValue1.style.height=d+"px",this.valuepointerbox1.style.bottom=d-3+"px"):(this.barValue1.style.height=d-3+"px",this.valuepointerbox1.style.bottom=d-6+"px")}catch(a){console.log("ControllerElement datachangeListener failed: "+a)}},ControllerElement.prototype.datachangeListener12=function(a){try{this.data.setpointDecimalDigits?this.numberValue2=parseFloat(a.value).toFixed(this.data.setpointDecimalDigits):this.numberValue2=GetAsInteger(a.value),this.setpointbarvalue.textContent=this.numberValue2;var b=this.plcmax1+-1*this.plcmin1,c=160/b,d=(this.numberValue2-this.plcmin1)*c;this.setpointbar.style.bottom=d-4+"px",this.setpointbarvalue.style.bottom=d-4+"px"}catch(a){console.log("ControllerElement datachangeListener failed: "+a)}},ControllerElement.prototype.datachangeListener3=function(a){try{this.data.outputDecimalDigits?this.numberValue3=parseFloat(a.value).toFixed(this.data.outputDecimalDigits):this.numberValue3=GetAsInteger(a.value),this.number2.textContent=this.numberValue3;var b=this.plcmax2-this.plcmin2,c=160/b,d=(this.numberValue3-this.plcmin2)*c;d<3?(this.barValue2.style.height=d+"px",this.valuepointerbox2.style.bottom=d-3+"px"):(this.barValue2.style.height=d-3+"px",this.valuepointerbox2.style.bottom=d-6+"px")}catch(a){console.log("ControllerElement datachangeListener failed: "+a)}},emosWS.ControllerElement=ControllerElement;function SpecialPurposeCentralStart(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.writeLeft=this.plc+"."+this.data.writeTagWR1,this.writeMiddle=this.plc+"."+this.data.writeTagWR2,this.writeRight=this.plc+"."+this.data.writeTagWR3,this.read1=this.plc+"."+this.data.readTagRD1,this.read2=this.plc+"."+this.data.readTagRD2,this.led=this.led2=this.border=this.text=this.LEDValue=this.LEDValue2=null,this.ledID,this.ledID2,this.ledID3,DiagnosisElement.call(this,{data:b,writable:d})}SpecialPurposeCentralStart.prototype=Object.create(DiagnosisElement.prototype),SpecialPurposeCentralStart.prototype.constructor=SpecialPurposeCentralStart,SpecialPurposeCentralStart.prototype.init=function(){try{var a=getElementGlobalID(),b=this.ledID=getElementGlobalID(),c=this.ledID2=getElementGlobalID(),d=this.ledID3=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];this.panel=$("<div class='"+f.css+"' id='"+a+"'><span id='"+b+"' class='emosbutton orange halblinks off'></span><span id='"+c+"' class='emosbutton orange mitte off_time'></span><span id='"+d+"' class='emosbutton orange halbrechts plantStartStop'></span><div class='textLed smallerText'><span id='"+e+"'>"+this.data.Text+"</span></div><br class='cl'></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.led2=document.getElementById(c),this.led3=document.getElementById(d),this.text=document.getElementById(e),emosWS.advise(this.read1,this.datachangeListenerLeft.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read2,this.datachangeListenerRight.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerW1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeMiddle,this.datachangeListenerW2.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeRight,this.datachangeListenerW3.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this)}catch(a){console.log("SpecialPurposeCentralStart init failed: "+a)}},SpecialPurposeCentralStart.prototype.getWritable=function(a){a.writable?(a.led.style.cursor=a.led2.style.cursor="pointer",$("#"+a.ledID).addClass("writable"),$("#"+a.ledID2).addClass("writable"),$("#"+a.ledID3).addClass("writable"),$("#"+a.ledID).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeLeft,"-1")}),$("#"+a.ledID2).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeMiddle,"-1")}),$("#"+a.ledID3).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeRight,"-1")})):($("#"+a.ledID).addClass("notwritable"),$("#"+a.ledID2).addClass("notwritable"),$("#"+a.ledID3).addClass("notwritable"))},SpecialPurposeCentralStart.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor=this.led2.style.cursor=this.led3.style.cursor="pointer",this.led.style.pointerEvents=this.led2.style.pointerEvents=this.led3.style.pointerEvents="auto",$("#"+this.ledID).removeClass("disabled"),$("#"+this.ledID2).removeClass("disabled"),$("#"+this.ledID3).removeClass("disabled")):($("#"+this.ledID).addClass("disabled"),$("#"+this.ledID2).addClass("disabled"),$("#"+this.ledID3).addClass("disabled"),this.led.style.cursor=this.led2.style.cursor=this.led3.style.cursor="auto",this.led.style.pointerEvents=this.led2.style.pointerEvents=this.led3.style.pointerEvents="none")},SpecialPurposeCentralStart.prototype.datachangeListenerLeft=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?"G":"O"],c=colorList[this.LEDValue?"O":"G"];this.LEDValue?($("#"+this.ledID3).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&($("#"+this.ledID).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?($("#"+this.ledID).addClass("writable").removeClass("notwritable").removeClass("orange"),$("#"+this.ledID2).addClass("writable").removeClass("notwritable").removeClass("orange"),$("#"+this.ledID3).addClass("writable").removeClass("notwritable").removeClass("orange")):($("#"+this.ledID).addClass("notwritable").removeClass("writable").removeClass("orange"),$("#"+this.ledID2).addClass("notwritable").removeClass("writable").removeClass("orange"),$("#"+this.ledID3).addClass("notwritable").removeClass("writable").removeClass("orange"))}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},SpecialPurposeCentralStart.prototype.datachangeListenerRight=function(a){try{this.LEDValue1=GetAsBoolean(a.value);var b=colorList[this.LEDValue1?"G":"O"],c=colorList[this.LEDValue1?"O":"G"];this.LEDValue1?($("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(b).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&($("#"+this.ledID).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?($("#"+this.ledID).addClass("writable").removeClass("notwritable").removeClass("orange"),$("#"+this.ledID2).addClass("writable").removeClass("notwritable").removeClass("orange"),$("#"+this.ledID3).addClass("writable").removeClass("notwritable").removeClass("orange")):($("#"+this.ledID).addClass("notwritable").removeClass("writable").removeClass("orange"),$("#"+this.ledID2).addClass("notwritable").removeClass("writable").removeClass("orange"),$("#"+this.ledID3).addClass("notwritable").removeClass("writable").removeClass("orange"))}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},SpecialPurposeCentralStart.prototype.datachangeListenerW1=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},SpecialPurposeCentralStart.prototype.datachangeListenerW2=function(a){try{this.LEDValueW2=GetAsBoolean(a.value),this.LEDValueW2||$("#"+this.ledID2).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},SpecialPurposeCentralStart.prototype.datachangeListenerW3=function(a){try{this.LEDValueW3=GetAsBoolean(a.value),this.LEDValueW3||$("#"+this.ledID3).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},emosWS.SpecialPurposeCentralStart=SpecialPurposeCentralStart;function CommandFeedback3WR4RD(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.writeLeft=this.plc+"."+this.data.writeTagWR3,this.writeMiddle=this.plc+"."+this.data.writeTagWR2,this.writeRight=this.plc+"."+this.data.writeTagWR1,this.read1=this.plc+"."+this.data.readTagRD1,this.read2=this.plc+"."+this.data.readTagRD2,this.read3=this.plc+"."+this.data.readTagRD3,this.read4=this.plc+"."+this.data.readTagRD4,this.led=this.led2=this.led3=this.text=this.LEDValue=this.LEDValue2=null,this.ledID,this.ledID2,this.ledID3,DiagnosisElement.call(this,{data:b,writable:d})}CommandFeedback3WR4RD.prototype=Object.create(DiagnosisElement.prototype),CommandFeedback3WR4RD.prototype.constructor=CommandFeedback3WR4RD,CommandFeedback3WR4RD.prototype.init=function(){try{var a=getElementGlobalID(),b=this.ledID=getElementGlobalID(),c=this.ledID2=getElementGlobalID(),d=this.ledID3=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];this.panel=$("<div class='"+f.css+"' id='"+a+"'><span id='"+b+"' class='emosbutton orange halblinks "+this.data.leftIcon+"'></span><span id='"+c+"' class='emosbutton orange mitte "+this.data.middleIcon+"'></span><span id='"+d+"' class='emosbutton orange halbrechts "+this.data.rightIcon+"'></span><div class='textLed smallerText'><span id='"+e+"'>"+this.data.Text+"</span></div><br class='cl'></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.led2=document.getElementById(c),this.led3=document.getElementById(d),this.text=document.getElementById(e),emosWS.advise(this.read1,this.datachangeListener1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read2,this.datachangeListener2.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read3,this.datachangeListener4.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read4,this.datachangeListener3.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerWrite1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeMiddle,this.datachangeListenerWrite2.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeRight,this.datachangeListenerWrite3.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("CommandFeedback3WR4RD init failed: "+a)}this.data.visibilityStop&&""!==this.data.visibilityStop&&this.parseVisibilityOPCTags(this.data.visibilityStop,function(a){a.value&&null!==a.value?this.led2.style.display="block":this.led2.style.display="none"}.bind(this))},CommandFeedback3WR4RD.prototype.getWritable=function(a){a.writable?(a.led.style.cursor=a.led2.style.cursor="pointer",$("#"+a.ledID).addClass("writable"),$("#"+a.ledID2).addClass("writable"),$("#"+a.ledID3).addClass("writable"),$("#"+a.ledID).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeLeft,"-1")}),$("#"+a.ledID2).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeMiddle,"-1")}),$("#"+a.ledID3).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeRight,"-1")})):($("#"+a.ledID).addClass("notwritable"),$("#"+a.ledID2).addClass("notwritable"),$("#"+a.ledID3).addClass("writable"))},CommandFeedback3WR4RD.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor=this.led2.style.cursor=this.led3.style.cursor="pointer",this.led.style.pointerEvents=this.led2.style.pointerEvents=this.led3.style.pointerEvents="auto",$("#"+this.ledID).removeClass("disabled"),$("#"+this.ledID2).removeClass("disabled"),$("#"+this.ledID3).removeClass("disabled")):($("#"+this.ledID).addClass("disabled"),$("#"+this.ledID2).addClass("disabled"),$("#"+this.ledID3).addClass("disabled"),this.led.style.cursor=this.led2.style.cursor=this.led3.style.cursor="auto",this.led.style.pointerEvents=this.led2.style.pointerEvents=this.led3.style.pointerEvents="none")},CommandFeedback3WR4RD.prototype.datachangeListener1=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?"G":"O"],c=colorList[this.LEDValue?"O":"G"];this.LEDValue?($("#"+this.ledID3).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),clearInterval(this.blinkInterval),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&!1===this.LEDValue3&&(clearInterval(this.blinkInterval),$("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR4RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR4RD.prototype.datachangeListener2=function(a){try{var b=this;this.LEDValue1=GetAsBoolean(a.value);var c=colorList[this.LEDValue1?"G":"O"],d=colorList[this.LEDValue1?"O":"G"];this.LEDValue1?($("#"+this.ledID3).removeClass("offMode").removeClass("switchmode").removeClass("orange"),clearInterval(this.blinkInterval),this.blinkInterval=setInterval(function(){$("#"+b.ledID3).toggleClass("onMode"),$("#"+b.ledID6).toggleClass("green")},500),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(d).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(d).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&!1===this.LEDValue3&&(clearInterval(this.blinkInterval),$("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(d).removeClass("orange"),$("#"+this.ledID5).addClass(d).removeClass(c).removeClass("orange"),$("#"+this.ledID6).addClass(c).removeClass(d).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR4RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR4RD.prototype.datachangeListener3=function(a){try{this.LEDValue2=GetAsBoolean(a.value);var b=colorList[this.LEDValue2?"G":"O"],c=colorList[this.LEDValue2?"O":"G"];this.LEDValue2?(clearInterval(this.blinkInterval),$("#"+this.ledID).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID6).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&!1===this.LEDValue3&&(clearInterval(this.blinkInterval),$("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR4RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR4RD.prototype.datachangeListener4=function(a){try{this.LEDValue3=GetAsBoolean(a.value);var b=colorList[this.LEDValue3?"G":"O"],c=colorList[this.LEDValue3?"O":"G"],d=this;this.LEDValue3?($("#"+this.ledID).removeClass("offMode").removeClass("switchmode").removeClass("orange"),clearInterval(this.blinkInterval),this.blinkInterval=setInterval(function(){$("#"+d.ledID).toggleClass("onMode"),$("#"+d.ledID4).toggleClass("green")},500),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(c).removeClass(b).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&!1===this.LEDValue3&&(clearInterval(this.blinkInterval),$("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR4RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR4RD.prototype.datachangeListenerWrite1=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},CommandFeedback3WR4RD.prototype.datachangeListenerWrite2=function(a){try{this.LEDValueW2=GetAsBoolean(a.value),this.LEDValueW2||$("#"+this.ledID2).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},CommandFeedback3WR4RD.prototype.datachangeListenerWrite3=function(a){try{this.LEDValueW3=GetAsBoolean(a.value),this.LEDValueW3||$("#"+this.ledID3).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},emosWS.CommandFeedback3WR4RD=CommandFeedback3WR4RD;function CommandFeedback3WR3RD(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox noBottomBorder",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.writeLeft=this.plc+"."+this.data.writeTagWR3,this.writeMiddle=this.plc+"."+this.data.writeTagWR2,this.writeRight=this.plc+"."+this.data.writeTagWR1,this.read1=this.plc+"."+this.data.readTagRD1,this.read2=this.plc+"."+this.data.readTagRD2,this.data.readTagRD3&&(this.read3=this.plc+"."+this.data.readTagRD3),this.led=this.led2=this.led3=this.text=this.LEDValue=this.LEDValue1=this.LEDValue2=null,this.ledID,this.ledID2,this.ledID3,DiagnosisElement.call(this,{data:b,writable:d})}CommandFeedback3WR3RD.prototype=Object.create(DiagnosisElement.prototype),CommandFeedback3WR3RD.prototype.constructor=CommandFeedback3WR3RD,CommandFeedback3WR3RD.prototype.init=function(){try{var a=getElementGlobalID(),b=this.ledID=getElementGlobalID(),c=this.ledID2=getElementGlobalID(),d=this.ledID3=getElementGlobalID(),e=getElementGlobalID(),f=this.positionClass[this.data.Position];this.panel=$("<div class='"+f.css+"' id='"+a+"'><span id='"+b+"' class='emosbutton orange halblinks "+this.data.leftIcon+"'></span><span id='"+c+"' class='emosbutton orange mitte "+this.data.middleIcon+"'></span><span id='"+d+"' class='emosbutton orange halbrechts "+this.data.rightIcon+"'></span><div class='textLed smallerText'><span id='"+e+"'>"+this.data.Text+"</span></div><br class='cl'></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.led=document.getElementById(b),this.led2=document.getElementById(c),this.led3=document.getElementById(d),this.text=document.getElementById(e),emosWS.advise(this.read1,this.datachangeListener1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.read2,this.datachangeListener2.bind(this),"",emosWS.tagType.IO),this.data.readTagRD3&&emosWS.advise(this.read3,this.datachangeListener3.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerWrite1.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeMiddle,this.datachangeListenerWrite2.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeRight,this.datachangeListenerWrite3.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("CommandFeedback3WR3RD init failed: "+a)}},CommandFeedback3WR3RD.prototype.getWritable=function(a){a.writable?(a.led.style.cursor=a.led2.style.cursor="pointer",$("#"+a.ledID).addClass("writable"),$("#"+a.ledID2).addClass("writable"),$("#"+a.ledID3).addClass("writable"),$("#"+a.ledID).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeLeft,"-1")}),$("#"+a.ledID2).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeMiddle,"-1")}),$("#"+a.ledID3).on("click",function(){$(this).addClass("switchmode"),emosWS.poke(a.writeRight,"-1")})):($("#"+a.ledID).addClass("notwritable"),$("#"+a.ledID2).addClass("notwritable"),$("#"+a.ledID3).addClass("writable"))},CommandFeedback3WR3RD.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor=this.led2.style.cursor=this.led3.style.cursor="pointer",this.led.style.pointerEvents=this.led2.style.pointerEvents=this.led3.style.pointerEvents="auto",$("#"+this.ledID).removeClass("disabled"),$("#"+this.ledID2).removeClass("disabled"),$("#"+this.ledID3).removeClass("disabled")):($("#"+this.ledID).addClass("disabled"),$("#"+this.ledID2).addClass("disabled"),$("#"+this.ledID3).addClass("disabled"),this.led.style.cursor=this.led2.style.cursor=this.led3.style.cursor="auto",this.led.style.pointerEvents=this.led2.style.pointerEvents=this.led3.style.pointerEvents="none")},CommandFeedback3WR3RD.prototype.datachangeListener1=function(a){try{this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?"G":"O"],c=colorList[this.LEDValue?"O":"G"];this.LEDValue?($("#"+this.ledID3).addClass("onMode").removeClass("offMode").removeClass("switchmode"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode"),$("#"+this.ledID).removeClass("onMode").addClass("offMode"),$("#"+this.ledID4).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&($("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode"),$("#"+this.ledID).removeClass("onMode").addClass("offMode"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR3RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR3RD.prototype.datachangeListener2=function(a){try{var b=this;this.LEDValue1=GetAsBoolean(a.value);var c=colorList[this.LEDValue1?"G":"O"],d=colorList[this.LEDValue1?"O":"G"];this.LEDValue1?($("#"+this.ledID3).removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(d).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(d).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&($("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(c).removeClass(d).removeClass("orange"),$("#"+this.ledID5).addClass(d).removeClass(c).removeClass("orange"),$("#"+this.ledID6).addClass(c).removeClass(d).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR3RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR3RD.prototype.datachangeListener3=function(a){try{this.LEDValue2=GetAsBoolean(a.value);var b=colorList[this.LEDValue2?"G":"O"],c=colorList[this.LEDValue2?"O":"G"];this.LEDValue2?($("#"+this.ledID).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID2).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID6).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange")):!1===this.LEDValue&&!1===this.LEDValue1&&!1===this.LEDValue2&&($("#"+this.ledID2).addClass("onMode").removeClass("offMode").removeClass("switchmode").removeClass("orange"),$("#"+this.ledID).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID3).removeClass("onMode").addClass("offMode").removeClass("orange"),$("#"+this.ledID4).addClass(b).removeClass(c).removeClass("orange"),$("#"+this.ledID5).addClass(c).removeClass(b).removeClass("orange"),$("#"+this.ledID6).addClass(b).removeClass(c).removeClass("orange")),this.writable?$("#"+this.ledID3).addClass("writable").removeClass("notwritable"):$("#"+this.ledID3).addClass("notwritable").removeClass("writable")}catch(a){console.log("CommandFeedback3WR3RD datachangeListenerLeft failed: "+a)}},CommandFeedback3WR3RD.prototype.datachangeListenerWrite1=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},CommandFeedback3WR3RD.prototype.datachangeListenerWrite2=function(a){try{this.LEDValueW2=GetAsBoolean(a.value),this.LEDValueW2||$("#"+this.ledID2).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},CommandFeedback3WR3RD.prototype.datachangeListenerWrite3=function(a){try{this.LEDValueW3=GetAsBoolean(a.value),this.LEDValueW3||$("#"+this.ledID3).removeClass("switchmode")}catch(a){console.log("SpecialPurposeCentralStart datachangeListener failed: "+a)}},emosWS.CommandFeedback3WR3RD=CommandFeedback3WR3RD;function Multibutton(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed multibutton parentsbox"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed multibutton parentsbox"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed multibutton parentsbox"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.led=this.border=this.text=this.LEDValue=null,this.icon=this.data.leftIcon?this.data.leftIcon:"on",this.read1=this.plc+"."+this.data.readTagRD1,this.writeLeft=this.plc+"."+this.data.writeTagWR1,DiagnosisElement.call(this,{data:b,writable:d})}Multibutton.prototype=Object.create(DiagnosisElement.prototype),Multibutton.prototype.constructor=Multibutton,Multibutton.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();this.ledID=b;var c=getElementGlobalID(),d=getElementGlobalID(),e=this.positionClass[this.data.Position],f="";this.data.TextID&&""!==this.data.TextID?this.classelist=" emosbutton":this.classelist=this.icon+" emosbutton",this.panel=$("<div class='"+e.css+"' id='"+a+"'><span id='"+b+"' class='"+this.classelist+" orange'></span><br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.writeRect1=document.getElementById(a),this.writable&&this.writeRect1.classList.add("noBottomBorder"),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),emosWS.advise(this.read1,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.writeLeft,this.datachangeListenerWrite1.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&$("#"+this.ledID).removeClass(this.icon).addClass("textButton").text(a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("Multibutton init failed: "+a)}},Multibutton.prototype.getWritable=function(self){self.writable?(self.led.style.cursor="pointer",self.led.className=self.led.className+" writable","0"===self.func?self.led.addEventListener("click",function(){$("#"+this.ledID).addClass("switchmode"),emosWS.poke(self.writeLeft,"-1")}.bind(self)):"1"===self.func?self.led.addEventListener("click",function(){$("#"+this.ledID).addClass("switchmode"),emosWS.poke(self.writeLeft,self.LEDValue?"0":"-1")}.bind(self)):"2"===self.func&&self.led.addEventListener("click",function(){$("#"+this.ledID).addClass("switchmode");var tempFunc="("+self.data.funcField+")";eval(tempFunc)}.bind(self)),self.led1&&(self.led1.style.cursor="pointer")):$("#"+this.ledID).addClass("notwritable")},Multibutton.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor="pointer",this.led.style.pointerEvents="auto",this.led.style.opacity=1,$("#"+this.ledID).removeClass("disabled"),this.led1&&(this.led1.style.cursor="pointer",this.led1.style.pointerEvents="auto",this.led1.style.opacity=1,$("#"+this.ledID1).removeClass("disabled"))):(this.led.style.cursor="auto",this.led.style.pointerEvents="none",$("#"+this.ledID).addClass("disabled"),this.led1&&(this.led1.style.cursor="auto",this.led1.style.pointerEvents="none",$("#"+this.ledID1).addClass("disabled")))},Multibutton.prototype.datachangeListener=function(a){try{this.data.TextID&&""!==this.data.TextID?this.icon="":this.icon=this.data.leftIcon?this.data.leftIcon:"on",this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?this.data.OnLED:this.data.OffLED],c=colorList[this.LEDValue?this.data.OffLED:this.data.OnLED];$("#"+this.ledID).addClass(this.icon).addClass(b).removeClass(c).removeClass("orange"),this.led1&&$("#"+this.ledID1).addClass(this.icon).addClass(b).removeClass(c).removeClass("orange"),this.writable?($("#"+this.ledID).addClass("writable"),this.led1&&$("#"+this.ledID1).addClass("writable")):($("#"+this.ledID).removeClass("writable").addClass("notwritable"),this.led1&&$("#"+this.ledID1).removeClass("writable").addClass("notwritable"))}catch(a){console.log("Multibutton datachangeListener failed: "+a)}},Multibutton.prototype.datachangeListenerWrite1=function(a){try{this.LEDValueW1=GetAsBoolean(a.value),this.LEDValueW1||$("#"+this.ledID).removeClass("switchmode")}catch(a){console.log("Multibutton datachangeListener failed: "+a)}},emosWS.Multibutton=Multibutton;function LED_Text_Value_Unit(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.LEDplctag=this.plc+"."+this.data.LEDOPCID,this.led=this.border=this.text=this.LEDValue=null,DiagnosisElement.call(this,{data:b,writable:d})}LED_Text_Value_Unit.prototype=Object.create(DiagnosisElement.prototype),LED_Text_Value_Unit.prototype.constructor=LED_Text_Value_Unit,LED_Text_Value_Unit.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();this.ledID=b;var c=getElementGlobalID(),d=getElementGlobalID();this.textId2=getElementGlobalID();var e=this.positionClass[this.data.Position],f="",g="";this.data.showLED&&""!==this.data.showLED&&(g="<span id='"+b+"' class='"+this.classelist+" orange'></span>"),this.panel=$("<div class='cl "+e.css+"' id='"+a+"'>"+g+"<div class='textLed'><span style='display: inline-block; margin-right: 10px;' id='"+d+"'>"+this.data.Text+"</span><span style='display: inline-block;' id='"+this.textId2+"'></span></div><br style='clear:both;' /></div><br style='clear:both;' />"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.writeRect1=document.getElementById(a),this.writable&&this.writeRect1.classList.add("noBottomBorder"),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.data.showLED&&""!==this.data.showLED&&emosWS.advise(this.LEDplctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag,this.datachangeListenerValue.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("LED_Text_Value_Unit init failed: "+a)}},LED_Text_Value_Unit.prototype.getWritable=function(a){a.writable?(a.led.style.cursor="pointer",a.led.className=a.led.className+" writable",a.led.addEventListener("click",function(){emosWS.poke(a.plctag,a.LEDValue?"0":"-1")}.bind(a)),a.led1&&(a.led1.style.cursor="pointer")):$("#"+this.ledID).addClass("notwritable")},LED_Text_Value_Unit.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor="pointer",this.led.style.pointerEvents="auto",this.led.style.opacity=1,$("#"+this.ledID).removeClass("disabled"),this.led1&&(this.led1.style.cursor="pointer",this.led1.style.pointerEvents="auto",this.led1.style.opacity=1,$("#"+this.ledID1).removeClass("disabled"))):(this.led.style.cursor="auto",this.led.style.pointerEvents="none",$("#"+this.ledID).addClass("disabled"),this.led1&&(this.led1.style.cursor="auto",this.led1.style.pointerEvents="none",$("#"+this.ledID1).addClass("disabled")))},LED_Text_Value_Unit.prototype.datachangeListener=function(a){try{this.icon=this.data.leftIcon?this.data.leftIcon:"on",this.LEDValue=GetAsBoolean(a.value);var b=colorList[this.LEDValue?this.data.OnLED:this.data.OffLED],c=colorList[this.LEDValue?this.data.OffLED:this.data.OnLED];$("#"+this.ledID).addClass(this.icon).addClass(b).removeClass(c).removeClass("orange"),this.led1&&$("#"+this.ledID1).addClass(this.icon).addClass(b).removeClass(c).removeClass("orange"),this.writable?($("#"+this.ledID).addClass("writable"),this.led1&&$("#"+this.ledID1).addClass("writable")):($("#"+this.ledID).removeClass("writable").addClass("notwritable"),this.led1&&$("#"+this.ledID1).removeClass("writable").addClass("notwritable"))}catch(a){console.log("LED_Text_Value_Unit datachangeListener failed: "+a)}},LED_Text_Value_Unit.prototype.datachangeListenerValue=function(a){try{var b=a.value;$("#"+this.textId2).text(b+" "+this.data.Unit)}catch(a){console.error("DiagnosisLedTextNumber atachangeListener failed: "+a)}},emosWS.LED_Text_Value_Unit=LED_Text_Value_Unit;function SliderElement(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,this.border=this.text=null,DiagnosisElement.call(this,{data:b,writable:d})}SliderElement.prototype=Object.create(DiagnosisElement.prototype),SliderElement.prototype.constructor=SliderElement,SliderElement.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();this.ledID=b;var c=getElementGlobalID(),d=getElementGlobalID();this.sliderId=getElementGlobalID(),this.sliderTextId=getElementGlobalID();var e=this.positionClass[this.data.Position];this.panel=$("<div class='"+e.css+"' id='"+a+"'><div class='textHolder'><span id='"+d+"'>"+this.data.Text+'</span></div><div class=\'sliderHolder\'><form oninput="numerisch.value=amountRange.value" onchange="emosWS.SliderElement.prototype.pokeData(this, amountRange.value);"><input id="'+this.sliderId+'" value="" name="amountRange" type="range" min="'+this.data.InputMin+'" max="'+this.data.InputMax+'" step="'+this.data.step+'" /><span class="datalist">'+this.data.InputMin+'</span><span class="datalist labelline">|</span><span class="datalist">25%</span><span class="datalist labelline">|</span><span class="datalist">50%</span><span class="datalist labelline">|</span><span class="datalist">75%</span><span class="datalist labelline">|</span><span class="datalist">'+this.data.InputMax+'</span><output id="'+this.sliderTextId+'" class="iText" type="text" name="numerisch" /><span>'+this.data.Unit+"</span></form></div><br style='clear:both;' /></div>"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.writeRect1=document.getElementById(a),this.writable&&this.writeRect1.classList.add("noBottomBorder"),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("SliderElement init failed: "+a)}},SliderElement.prototype.pokeData=function(a,b){emosWS.poke(a.plctag,b)},SliderElement.prototype.getWritable=function(a){a.writable?(a.led.style.cursor="pointer",a.led.className=a.led.className+" writable",a.led.addEventListener("click",function(){emosWS.poke(a.plctag,a.LEDValue?"0":"-1")}.bind(a)),a.led1&&(a.led1.style.cursor="pointer")):$("#"+this.ledID).addClass("notwritable")},SliderElement.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)?(this.led.style.cursor="pointer",this.led.style.pointerEvents="auto",this.led.style.opacity=1,$("#"+this.ledID).removeClass("disabled"),this.led1&&(this.led1.style.cursor="pointer",this.led1.style.pointerEvents="auto",this.led1.style.opacity=1,$("#"+this.ledID1).removeClass("disabled"))):(this.led.style.cursor="auto",this.led.style.pointerEvents="none",$("#"+this.ledID).addClass("disabled"),this.led1&&(this.led1.style.cursor="auto",this.led1.style.pointerEvents="none",$("#"+this.ledID1).addClass("disabled")))},SliderElement.prototype.datachangeListener=function(a){try{a&&($("#"+this.sliderId).attr("value",a.value),$("#"+this.sliderTextId).val(a.value))}catch(a){console.log("SliderElement datachangeListener failed: "+a)}},emosWS.SliderElement=SliderElement;function GhostModus(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed ghostmode parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed ghostmode parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed ghostmode parentsbox",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,DiagnosisElement.call(this,{data:b,writable:d})}GhostModus.prototype=Object.create(DiagnosisElement.prototype),GhostModus.prototype.constructor=GhostModus,GhostModus.prototype.init=function(){try{var a=getElementGlobalID();this.extButton=getElementGlobalID();var b=getElementGlobalID();this.ledID=b;var c=getElementGlobalID(),d=getElementGlobalID(),e=this.positionClass[this.data.Position],f=getElementGlobalID(),g=getElementGlobalID(),h='<div class="inputGroup fl " style="margin: 10px 10px 0 0;"><label class="smallText aptDropdownlabel">Type</label><span class="dropdown aptdropdown emosbutton noicon"></span><ul class="dropdownlist noicon selectUrl" id="'+f+'"></ul></div>',i='<div class="inputGroup fl " style="margin: 10px 10px 0 0;"><label class="smallText aptDropdownlabel">Color</label><span class="dropdown aptdropdown emosbutton noicon"></span><ul class="dropdownlist noicon selectUrl" id="'+g+'"></ul></div>';this.panel=$("<div class='"+e.css+"' id='"+a+'\'><div class="inputGroup fl " style="margin: 0 10px 0 0;"><label class="smallText aptDropdownlabel">&nbsp;</label><span id=\''+this.extButton+"' class='emosbutton extContent fl'></span><div class='contentOverlay'><div class='closeTabs closeSubTabs emosbutton'></div><div class='optionsButtons'></div><div class='variantsButtons'></div><div class='partialsButtons'></div></div></div>"+h+i+'<div class="inputGroup fl " style="margin: 0 10px 0 0;"><label class="smallText aptDropdownlabel">&nbsp;</label><span id=\''+b+"' class='emosbutton fl'></span></div><br style='clear:both;' /></div>");var j=this;$.ajax({url:APTTyplist,type:"post",dataType:"json",async:!1,cache:!1,success:function(a){$.each(a,function(a,b){b.Name&&""!==b.Name&&j.panel.find("#"+f).append('<li class="breadoverlay_li" data-num="'+a.replace("Type","")+'">'+b.Name+"</li>")}),j.panel.find("#"+f).prev(".aptdropdown").text($(j.panel.find("#"+f+" li")[0]).text())},error:function(a){console.log(a)}}),$.ajax({url:APTColorlist,type:"post",dataType:"json",async:!1,cache:!1,success:function(a){console.log(a),$.each(a,function(a,b){b.Code&&""!==b.Code&&j.panel.find("#"+g).append('<li class="breadoverlay_li" data-num="'+a.replace("Color","")+'">'+b.Code+"</li>")}),j.panel.find("#"+g).prev(".aptdropdown").text($(j.panel.find("#"+g+" li")[0]).text())},error:function(a){console.log(a)}}),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.writeRect1=document.getElementById(a),this.writable&&this.writeRect1.classList.add("noBottomBorder"),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),emosWS.advise(this.plctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv"),$("#"+this.ledID).text($(".DiagnosisTextLed.ghostmode").index(document.getElementById(a))+1)}catch(a){console.log("GhostModus init failed: "+a)}},GhostModus.prototype.getWritable=function(a){console.log(a.writable,"jappa"),a.writable?(a.led.addEventListener("click",function(){emosWS.poke(a.plctag,a.LEDValue?"0":"-1")}.bind(a)),a.led1,$("#"+this.extButton).on("click",function(){$(".extContent").removeClass("active"),$(".modal").show(),$(this).next().show(),$(this).addClass("active"),0===$(".contentOverlay .optionsButtons .emosbutton").length&&a.loadOverlayButtons(a)}),$(".closeSubTabs").on("click",function(){$(".extContent").removeClass("active"),$(".contentOverlay").hide(),$(".modal").hide()})):$("#"+this.ledID).addClass("notwritable")},GhostModus.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)},GhostModus.prototype.loadOverlayButtons=function(a){$("<span/>",{class:"emosbutton",text:"N - No Paint",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons")),$("<span/>",{class:"emosbutton",text:"R - Zweitl\xe4ufer",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons")),$("<span/>",{class:"emosbutton",text:"C - Zerst\xe4uber reinigen",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons")),$("<span/>",{class:"emosbutton",text:"S - Kurzsp\xfclen",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons")),$("<span/>",{class:"emosbutton",text:"Cc - Luftklappe reinigen",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons")),$("<span/>",{class:"emosbutton",text:"L - Langsp\xfclen",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons")),$("<span/>",{class:"emosbutton",text:"E - Elektroden reinigen",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .optionsButtons"));for(var b=1,c=33;b<c;b++)$("<span/>",{class:"emosbutton",text:"Variant"+b,click:function(){emosWS.poke(a.plctag+"_OPT",a.LEDValue?"0":"-1")}}).appendTo(a.panel.find(".contentOverlay .variantsButtons")),$("<span/>",{class:"emosbutton",text:"Part"+b,click:function(){console.log("hallo_x2")}}).appendTo(a.panel.find(".contentOverlay .partialsButtons"));a.panel.find(".contentOverlay .optionsButtons").prepend("<div class='HeadText'>Options</div>"),a.panel.find(".contentOverlay .variantsButtons").prepend("<div class='HeadText'>Variants</div>"),a.panel.find(".contentOverlay .partialsButtons").prepend("<div class='HeadText'>Partial areas</div>"),$("<span/>",{class:"emosbutton",text:"Deselect All",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .variantsButtons .HeadText")),$("<span/>",{class:"emosbutton",text:"Select All",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .variantsButtons .HeadText")),a.panel.find(".contentOverlay .variantsButtons .HeadText").append("<br style='clear:both;' />"),$("<span/>",{class:"emosbutton",text:"Deselect All",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .partialsButtons .HeadText")),$("<span/>",{class:"emosbutton",text:"Select All",click:function(){console.log("hallo")}}).appendTo(a.panel.find(".contentOverlay .partialsButtons .HeadText")),a.panel.find(".contentOverlay .partialsButtons .HeadText").append("<br style='clear:both;' />"),a.panel.find(".contentOverlay .optionsButtons").append("<br style='clear:both;' />"),a.panel.find(".contentOverlay .variantsButtons").append("<br style='clear:both;' />"),a.panel.find(".contentOverlay .partialsButtons").append("<br style='clear:both;' />")},GhostModus.prototype.datachangeListener=function(a){},emosWS.GhostModus=GhostModus;function SercosChain(a,b,c,d,e,f){this.parent=a,this.data=b,this.plc=c,this.writable=d,this.myKey=f,this.diagnosisWindow=e,this.positionClass={L:{parent:this.diagnosisWindow.divTypes.LRLeft,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},R:{parent:this.diagnosisWindow.divTypes.LRRight,css:"DiagnosisTextLed parentsbox",rectWidth:"100%",rectHeight:"20",writeRectX:"91%",writeRectY:"10",writeRectWidth:"20",ledX:"95.5%",ledY:"10",ledR:"7"},Long:{parent:this.diagnosisWindow.divTypes.Long,css:"DiagnosisTextLed parentsbox",rectWidth:"97.5%",rectHeight:"20",writeRectX:"93.1%",writeRectY:"10",writeRectWidth:"20",ledX:"95.4%",ledY:"10",ledR:"7"}},this.parentDiv=this.parent.getDiv(this.positionClass[this.data.Position].parent),this.plctag=this.plc+"."+this.data.OPCID,DiagnosisElement.call(this,{data:b,writable:d})}SercosChain.prototype=Object.create(DiagnosisElement.prototype),SercosChain.prototype.constructor=SercosChain,SercosChain.prototype.init=function(){try{var a=getElementGlobalID(),b=getElementGlobalID();this.ledID=b;var c=getElementGlobalID(),d=getElementGlobalID();this.textId2=getElementGlobalID();for(var e=this.positionClass[this.data.Position],f="<span class='chainholder'>",g=1,h=this.data.NumberOfChain;g<=h;g++)f+='<span class="sercosChain">'+g+"</span>";f+="</span>",this.panel=$("<div class='cl "+e.css+"' id='"+a+"'><div class='textLed'><span style='display: inline-block; margin-right: 10px;' id='"+d+"'>"+this.data.Text+"</span>"+f+"</div><br style='clear:both;' /></div><br style='clear:both;' />"),this.panel[0].myData=this.data,this.panel[0].myData.writable=this.writable,this.panel[0].myKey=this.myKey,this.panel.appendTo(this.parentDiv),this.writeRect1=document.getElementById(a),this.writable&&this.writeRect1.classList.add("noBottomBorder"),this.led=document.getElementById(b),this.text=document.getElementById(d),this.border=document.getElementById(c),this.data.showLED&&""!==this.data.showLED&&emosWS.advise(this.LEDplctag,this.datachangeListener.bind(this),"",emosWS.tagType.IO),emosWS.advise(this.plctag,this.datachangeListenerValue.bind(this),"",emosWS.tagType.IO),emosWS.sendAdviseText(this.diagnosisWindow.getTextPrefix()+this.data.TextID,"name",function(a){""!==a.value&&(this.text.textContent=a.value)}.bind(this),this),this.getWritable(this),$(this.parentDiv).children().length>4&&$(this.parentDiv).addClass("higherDiv")}catch(a){console.log("SercosChain init failed: "+a)}},SercosChain.prototype.getWritable=function(a){a.writable?a.led1:$("#"+this.ledID).addClass("notwritable")},SercosChain.prototype.updateWrite=function(){emosWS.login.au.hasPaintShopRight(this.userRight)},SercosChain.prototype.datachangeListener=function(a){try{console.log("SercosChain listen")}catch(a){console.log("SercosChain datachangeListener failed: "+a)}},SercosChain.prototype.datachangeListenerValue=function(a){try{var b=a.value;$("#"+this.textId2).text(b+" "+this.data.Unit)}catch(a){console.error("SercosChain atachangeListener failed: "+a)}},emosWS.SercosChain=SercosChain;function HDiagnosisWindow(a,b,c,d,e){console.log(a),this.newParent=d||"#center",this.onReady=b,this.onAlarmReady=c,this.switcher=e,this.listeners={},this.requestId=a.id,this.DiagnosisLibID=a.DiagnosisLibID,this.PLCArray=a.PLC,this.PLC=Array.isArray(a.PLC)?a.PLC[0]:a.PLC,this.ID=a.Tag,this.DiagnosisControl=a.DiagnosisControl,this.dc=this.DiagnosisControl,this.GroupRightIndex=a.GroupRightIndex,this.additionalClass=a.additionalClass?a.additionalClass:"",this.myText=a.myText,this.Counter=a.myCounter?a.myCounter:0,this.headControls=a.HeadControls,this.Private=a.Private,this.Summary=a.Summary,this.childWindows=null,this.Enabled=!0,this.divTypes={None:0,LRLeft:1,LRRight:2,Long:3,LMRLeft:4,LMRMiddle:5,LMRRight:6},this.dataTypes={Integer:0,Real:1},this.windowData=null,this.childWindowsData={},this.qualityGood=!1,this.badQualityTagList={},this.winName="",this.OPCVersionID="",this.OPCVersion="",this.versionList=[],this.rootVersion=null,this.plcVersion="",this.run=!1,this.data=a.data,this.msg=a,this.specClass="",this.data&&(this.childWindows=this.data.childWindows,this.childWindowsData=this.data.childWindowsData,this.windowData=this.data.windowData,this.winName=this.data.winName),this.diaheadId=getElementGlobalID(),this.textPrefixList={1:"T01_",3:"T03_",5:"T05_"},this.PLCType=a.PLCType,this.initialize()}HDiagnosisWindow.prototype=Object.create(ADiagnosisWindow.prototype),HDiagnosisWindow.prototype.constructor=HDiagnosisWindow,HDiagnosisWindow.prototype.addEventListener=function(a,b){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},HDiagnosisWindow.prototype.fireEvent=function(a){var b=this.listeners[a];b&&b.forEach(function(a){try{a()}catch(a){console.error(a)}})},HDiagnosisWindow.prototype.appendWindow=function(a){try{this.myid=a,this.appendChildData();var b=this,c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=function(){var a={type:"DiagnosisWindowClosed",id:this.requestId}}.bind(this),i=this.ID.split("_");2===this.DiagnosisLibID?(this.anlage=this.PLC,this.machine=this.ID):(this.anlage_part2=i[i.length-2]?i[i.length-2]:"",this.device=(i[i.length-3]?i[i.length-3]:"").replace(".",""),this.anlage=(i[i.length-3]?i[i.length-3]+"_":"")+(i[i.length-2]?i[i.length-2]:""),this.machine=i[i.length-1]?i[i.length-1]:"");var j,k=this.headControls&&"false"===this.headControls?"":'<div class="diahead_right"><ul class="dieahead_head"><li class="copyTab emosbutton"></li><li class="arrangeTabs emosbutton"></li><li class="closeTabs emosbutton"></li></ul></div>';"statusWelcome"===this.additionalClass||"statusWelcome act"===this.additionalClass?(j='<div class="diahead_left"><span class="processname">Summaries</span></div><div class="diahead_right"><ul class="dieahead_head"><li class="pin emosbutton '+("statusWelcome act"===this.additionalClass?"act":"")+'"></li></ul></div>',emosWS.sendAdviseText("T04_Summaries","name",function(a){a&&$("#center").find(".statusWelcome").find(".processname").text(a.value)})):j="privateOverlay"===this.additionalClass?'<div class="diahead_left"><span class="processname">'+this.myText+"</span></div>":'<div class="diahead_left"><span class="processname">'+this.machine+'</span><span class="partname">'+this.anlage+"</span></div>"+k+'<br class="cl" />';var l=$('<div class ="diagnose '+this.additionalClass+" "+this.Counter+'"><div class="diahead" id="'+this.diaheadId+'">'+j+'</div><div class="DiagnosisContent" id="'+a+'"><div class="DiagnoseBody" role="main"></div></div></div>'),m=$('<div class="DiagnosisFooter"><span class="footerHead" id="'+g+'"></span><span id="'+c+'" class="scrollLeft"></span><span id="'+d+'" class="scrollRight"></span><span id="'+e+'" class="scrollUp"></span><span id="'+f+'" class="scrollDown active"></span></div>)');this.dc.match(/.htm/)?l.addClass("apt"):m.appendTo(l);var n=l.find(".DiagnoseBody");if($(n)[0].msg=b.msg,l.appendTo(this.newParent),this.dc.match(/.htm/)||this.appendBody(n),this.fireEvent("UIReady"),this.onReady&&this.onReady(this.switcher),this.windowData){var o=!1,p=function(a){console.log("showWrongVersion: "+a),a?($("#"+this.myid).find(".diatabs ul li.Duerr").addClass("alert"),$("#"+this.myid).find(".diatabs ul div .scrollTabAlert").addClass("alert"),$("#"+this.myid).find(".plcversion").addClass("versionerror"),$("#"+this.myid).find(".hmiversions").addClass("versionerror")):($("#"+this.myid).find(".diatabs ul li.Duerr").removeClass("alert"),$("#"+this.myid).find(".diatabs ul div .scrollTabAlert").removeClass("alert"),$("#"+this.myid).find(".plcversion").removeClass("versionerror"),$("#"+this.myid).find(".hmiversions").removeClass("versionerror"))}.bind(this);emosWS.advise(this.PLC+this.ID+"."+this.windowData.OPCVersionID,function(a){var b=a.value;o=!0,this.PLCType=b.replace(/(.)..../,"$1"),$("#"+this.myid).find(".plcversion").text(b.replace(/(.)(..)(..)/,"0$1 $2 $3")),p(""===b||""===this.windowData.Version||b&&this.windowData.Version&&b.replace(/(.)(..)(..)/,"$2")!==this.windowData.Version.replace(/(..)-(..)/,"$1"))}.bind(this),""),setTimeout(function(){o||p(!0)},200)}}catch(a){console.log("appendWindow failed: "+a)}},HDiagnosisWindow.prototype.appendHead=function(a){try{var b=this.windowData.Head;for(var c in b){var d=b[c];if("object"==typeof d){switch(DiagnosisCommon.getObjectType(c)){case"TopTextLED":a.length>0&&new TopTextLED(a,d,this.PLC+this.ID,this)}}}}catch(a){console.log("appendHead failed: "+a)}},HDiagnosisWindow.prototype.appendBody=function(a){this.appendPageControl(a,this.windowData.PageControl)},HDiagnosisWindow.prototype.appendPageControl=function(a,b){try{new PageControl(a,b,this)}catch(a){console.log("appendPageControl failed: "+a)}},HDiagnosisWindow.prototype.appendPage=function(a,b,c,d,e,f){try{var a=a,b=b,d=d;a.LRLeft=null,a.LRRight=null,a.LRLong=null,a.LMRLeft=null,a.LMRMiddle=null,a.LMRRight=null,a.getDiv=function(b){switch(b){case this.divTypes.LRLeft:if(!a.LRLeft){var c=getElementGlobalID(),d=$("<div class='DiagnosisLRLeft' id='"+c+"'></div>");d.appendTo(a),a.LRLeft=document.getElementById(c),a.LRLong=null}return a.LRLeft;case this.divTypes.LRRight:if(!a.LRRight){var e=getElementGlobalID(),d=$("<div class='Groupbox' id='"+e+"'><span class='emosbutton showhideblockbutton'></span></div>");d.appendTo(a),a.LRRight=document.getElementById(e),a.LRLong=null}return a.LRRight;case this.divTypes.Long:if(!a.LRLong){var f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),d=$("<div class='Groupbox' id='"+f+"'><span class='emosbutton showhideblockbutton'></span><div id='"+g+"'></div><div id='"+h+"'></div><div id='"+i+"'></div></div>");d.appendTo(a),a.LRLong=document.getElementById(g),a.LRLeft=document.getElementById(h),a.LRRight=document.getElementById(i),a.LMRLeft=document.getElementById(h),a.LMRMiddle=document.getElementById(f),a.LMRRight=document.getElementById(i)}return a.LRLong;case this.divTypes.LMRLeft:if(!a.LMRLeft){var j=getElementGlobalID(),d=$("<div class='DiagnosisLMRLeft' id='"+j+"'></div>");d.appendTo(a),a.LMRLeft=document.getElementById(j),a.LRLong=null}return a.LMRLeft;case this.divTypes.LMRMiddle:if(!a.LMRMiddle){var k=getElementGlobalID(),d=$("<div class='DiagnosisLMRMiddle' id='"+k+"'></div>");d.appendTo(a),a.LMRMiddle=document.getElementById(k),a.LRLong=null}return a.LMRMiddle;case this.divTypes.LMRRight:if(!a.LMRRight){var l=getElementGlobalID(),d=$("<div class='DiagnosisLMRRight' id='"+l+"'></div>");d.appendTo(a),a.LMRRight=document.getElementById(l),a.LRLong=null}return a.LMRRight;case this.divTypes.Groupbox:var m=getElementGlobalID(),d=$("<div class='Groupbox' id='"+m+"'><span class='emosbutton showhideblockbutton'></span></div>");return d.appendTo(a),a.LMRRight=document.getElementById(m),a.LRLong=document.getElementById(m),a.LRLeft=document.getElementById(m),a.LRRight=document.getElementById(m),a.LMRLeft=document.getElementById(m),a.LMRMiddle=document.getElementById(m),a.LRLong;default:return null}}.bind(this);var g=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1},h=function(){g(a.get(0),"DiagnosisPageBlank")||g(a.get(0),"DiagnosisSubPageBlank")||(emosWS.login.au.hasPaintShopRight(d)?a.hasClass("subsubpageOverlay")||a.hasClass("subsubsubpageOverlay")||(a.get(0).style.display="block"):a.get(0).style.display="none")};sortHashArray(b).forEach(function(d){var e=b[d];if("object"==typeof e){var f=DiagnosisCommon.getObjectType(d);switch(f){case"AlarmClient":new AlarmClient(a,e,this.PLCArray,this.ID,c,null,this.onAlarmReady);break;case"ChronologyHistory":$(a).attr("PLC",this.PLCArray,this.ID);break;case"AddText":e.Position="L",new DiagnosisText(a,e,this.PLC+this.ID,this);break;case"AddString":e.Position="L",new DiagnosisString(a,e,this.PLC+this.ID,!1,this,d);break;case"AddStringInput":e.Position="L",new DiagnosisString(a,e,this.PLC+this.ID,!0,this,d);break;case"AddStringLong":e.Position="Long",new DiagnosisString(a,e,this.PLC+this.ID,!1,this,d);break;case"AddStringInputLong":e.Position="Long",new DiagnosisString(a,e,this.PLC+this.ID,!0,this,d);break;case"AddStringFieldLong":e.Position="Long",new DiagnosisStringField(a,e,this.PLC+this.ID,this);break;case"AddStringFieldComment":e.Position="Long",new DiagnosisStringFieldComment(a,e,this.PLC+this.ID,this);break;case"AddTextLong":case"AddHeadLine":e.Position="L",new DiagnosisText(a,e,this.PLC+this.ID,this);break;case"AddTextLED":e.Position="L",new DiagnosisTextLED(a,e,this.PLC+this.ID,!1,this,d);break;case"AddTextLEDLong":e.Position="Long",new DiagnosisTextLED(a,e,this.PLC+this.ID,!1,this,d);break;case"AddTextInputLED":e.Position="L",new DiagnosisTextLED(a,e,this.PLC+this.ID,!0,this,d);break;case"AddTextLEDInputLong":e.Position="Long",new DiagnosisTextLED(a,e,this.PLC+this.ID,!0,this,d);break;case"AddTextLEDNiveau":e.Position="L",new DiagnosisTextLED(a,e,this.PLC+this.ID,!1,this,d);break;case"AddTextByte":case"AddTextInteger":case"AddTextReal":e.Position="L",new DiagnosisTextNumber(a,e,this.PLC+this.ID,!1,this,d);break;case"AddTextIntegerLong":case"AddTextRealLong":e.Position="Long",new DiagnosisTextNumber(a,e,this.PLC+this.ID,!1,this,d);break;case"AddTextByteInput":case"AddTextIntegerInput":case"AddTextRealInput":case"AddTextRealInputNiveau":e.Position="L",new DiagnosisTextNumber(a,e,this.PLC+this.ID,!0,this,d);break;case"AddTextIntegerInputLong":case"AddTextRealInputLong":e.Position="Long",new DiagnosisTextNumber(a,e,this.PLC+this.ID,!0,this,d);break;case"AddTextIntegerIntegerLong":e.Position="Long",new DiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Integer,!1,this,d);break;case"AddTextRealRealLong":e.Position="Long",new DiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Real,!1,this,d);break;case"AddTextIntegerIntegerInputLong":e.Position="Long",new DiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Integer,!0,this,d);break;case"AddTextRealRealInputLong":e.Position="Long",new DiagnosisTextNumberNumber(a,e,this.PLC+this.ID,this.dataTypes.Real,!0,this,d);break;case"AddLEDTextIntegerLong":case"AddTextLEDIntegerLong":case"AddLEDTextRealLong":e.Position="Long",new DiagnosisLedTextNumber(a,e,this.PLC+this.ID,!1,this,d);break;case"AddLEDTextIntegerInputLong":case"AddTextLEDIntegerInputLong":case"AddLEDTextRealInputLong":e.Position="Long",new DiagnosisLedTextNumber(a,e,this.PLC+this.ID,!0,this,d);break;case"AddLEDTextRealRealLong":e.Position="Long",new DiagnosisLedTextNumberNumber(a,e,this.PLC+this.ID,!1,this);break;case"AddLEDTextRealRealInputLong":e.Position="Long",new DiagnosisLedTextNumberNumber(a,e,this.PLC+this.ID,!0,this);break;case"AddSpace":case"AddSpaceLong":break;case"AddBar":e.Position="L",new DiagnosisBar(a,e,this.PLC+this.ID,this);break;case"AddBitBar":e.Position="L",new DiagnosisBitBar(a,e,this.PLC+this.ID,this);break;case"CreateControlNetArray":e.Position="Long",new DiagnosisControlNetArray(a,e,this.PLC+this.ID,this);break;case"AddBrowserPage":e.Position="Long",new DiagnosisBrowserPage(a,e,this.PLC+this.ID,this);break;case"AddSetpointBar":e.Position="L",new DiagnosisSetpointBar(a,e,this.PLC+this.ID,this);break;case"AddSetpointRampBar":e.Position="M",new DiagnosisSetpointRampBar(a,e,this.PLC+this.ID,this);break;case"AddPageControl":if(new SubPageControl(a,e,this,!0,this.plcVersion),a.hasClass("Duerr")){var g=a.parent().find(".addMess");this.appendHead(g);var h=a.parent().find(".addMess1");this.appendHead(h)}break;case"AddDoubleTextLong":e.Position="Long",new DiagnosisDoubleText(a,e,this.PLC+this.ID,this);break;case"AddTextOperatingCounterLong":e.Position="Long",new DiagnosisOperatingCounter(a,e,this.PLC+this.ID,timerTypes.Second,!1,this,d);break;case"AddTextOperatingCounterInputLong":e.Position="Long",new DiagnosisOperatingCounter(a,e,this.PLC+this.ID,timerTypes.Second,!0,this,d);break;case"AddTextTimerLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.Second,!1,this,d);break;case"AddTextTimerInputLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.Second,!0,this,d);break;case"AddTextSiemensDateLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensDate,!1,this,d);break;case"AddTextSiemensDateInputLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensDate,!0,this,d);break;case"AddTextSiemensTimeLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensTimeOfDay,!1,this,d);break;case"AddTextSiemensTimeInputLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensTimeOfDay,!0,this,d);break;case"AddTextSiemens_TIME_TimerLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensTime,!1,this,d);break;case"AddTextSiemens_TIME_TimerInputLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensTime,!0,this,d);break;case"AddTextSiemens_S5TIME_TimerLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensS5Time,!1,this,d);break;case"AddTextSiemens_S5TIME_TimerInputLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensS5Time,!0,this,d);break;case"AddTextSiemens_DATE_AND_TIME_TimerLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensDateAndTime,!1,this,d);break;case"AddTextSiemens_DATE_AND_TIME_TimerInputLong":e.Position="Long",new DiagnosisTextTimer(a,e,this.PLC+this.ID,timerTypes.SiemensDateAndTime,!0,this,d);break;case"AddTextDoubleTimerLong":e.Position="Long",new DiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!0,!1,this,d);break;case"AddTextDoubleTimerInputLong":e.Position="Long",new DiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!0,!0,this,d);break;case"AddTextDoubleTimerLongMin":e.Position="Long",new DiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!1,!1,this,d);break;case"AddTextDoubleTimerInputLongMin":e.Position="Long",new DiagnosisTextDoubleTimer(a,e,this.PLC+this.ID,!1,!0,this,d);break;case"AddChildWindow":e.Position="Long";break;case"AddCommandFeedback1WR1RD":case"AddCommandFeedback2WR1RD":case"AddCommandFeedback2WR2RD":e.Position="L",new CommandFeedback2WR2RD(a,e,this.PLC+this.ID,!0,this,d);break;case"AddShowExternalContent":e.Position="L",new ShowExternalContent(a,e,this.PLC+this.ID,!0,this,d);break;case"AddControllerElement":e.Position="L",new ControllerElement(a,e,this.PLC+this.ID,!0,this,d);break;case"AddCommandFeedback3WR4RD":e.Position="L",new CommandFeedback3WR4RD(a,e,this.PLC+this.ID,!0,this,d);break;case"AddCommandFeedback3WR2RD":case"AddCommandFeedback3WR3RD":e.Position="L",new CommandFeedback3WR3RD(a,e,this.PLC+this.ID,!0,this,d);break;case"AddCommandFeedback1WR2RD":e.Position="L",new CommandFeedback1WR2RD(a,e,this.PLC+this.ID,!0,this,d);break;case"AddCommandFeedback1B1WR1RD":e.Position="L",new CommandFeedback1B1WR1RD(a,e,this.PLC+this.ID,!0,this,d);break;case"AddSpecialPurposeCentralStart":e.Position="L",new SpecialPurposeCentralStart(a,e,this.PLC+this.ID,!0,this,d);break;case"AddLine":var i=$("<div class='DiagnosisLine parentsbox'></div>"),j=a.getDiv(this.divTypes.LRLeft);i.appendTo(j);break;case"AddMultibutton":e.Position="L",new Multibutton(a,e,this.PLC+this.ID,!0,this,d);break;case"AddLED_Text_Value_Unit":e.Position="L",new LED_Text_Value_Unit(a,e,this.PLC+this.ID,!1,this,d);break;case"AddSliderElement":e.Position="L",new SliderElement(a,e,this.PLC+this.ID,!1,this,d);break;case"AddGhostModus":e.Position="L",new GhostModus(a,e,this.PLC+this.ID,!0,this,d);break;case"AddSercosChain":e.Position="L",new SercosChain(a,e,this.PLC+this.ID,!0,this,d);break;default:new GeneralElement(a,{Text:f},this)}}}.bind(this)),h(),emosWS.addEventListener("UserRight",h)}catch(a){console.log("appendPage failed: "+a)}},HDiagnosisWindow.prototype.appendElement=function(a,b){try{var c=getElementGlobalID(),d=$("<div id='"+c+"'><ul></ul></div>");d.appendTo(a);var e=d.tabs(),f=e.find("ul");sortHashArray(b).forEach(function(a){if("object"==typeof b[a]){var d=c+a;$("<li><a href='#"+d+"'>"+d+"</a></li>").appendTo(f);var g=$("<div id='"+d+"'></div>");g.appendTo(e),this.appendElement(g,b[a])}else $("<p>"+a+" = "+b[a]+"</p>").appendTo(e)}.bind(this)),e.tabs("refresh")}catch(a){console.log("appendElement failed: "+a)}},HDiagnosisWindow.prototype.doCondition=function(){try{if(this.data)this.startAnimate(),this.buildSubMenueForChildWin();else if(jsonFile){var a=this;getStatusWindowData(this.DiagnosisLibID,this.DiagnosisControl,this.PLC,this.ID,function(b){a.windowData=b.windowData,a.winName=b.windowData.Name,a.PLCType=b.PLCType,a.startAnimate()})}else this.adviseDiagnosisData(this.DiagnosisControl,this.startAnimate.bind(this))}catch(a){console.log("HDiagnosisWindow doCondition failed: "+a)}},HDiagnosisWindow.prototype.buildSubMenueForChildWin=function(){try{if(this.childWindows){$(".copyTab ").addClass("hasChild");var a=this.data.childWindowsData,b=[],c="T0"+this.DiagnosisLibID+"_";b.push("<li class='sub'>duplicate this Window</li>"),$.each(this.childWindows,function(d,e){if(a[e]){var f=a[e].Comment,g=d+"_"+Date.now(),h=function(a){var b=f+" - "+a.value;$("#cSubMenue"+g).text(b)},i=function(){var b=c+a[e].TextID;h({value:b}),emosWS.sendAdviseText(b,"name",h)};b.push("<li id='cSubMenue"+g+"' class='sub' data-obj='"+e+"'>"+f+" - "+(c+a[e].TextID)+"</li>");var j=0,k=function(){++j<10?a[e].TextID&&(j=10,i()):clearInterval(l)},l=setInterval(k,1e3);k()}}),$("<ul/>",{class:"subMenu",html:b.join("")}).appendTo("#"+this.diaheadId)}}catch(a){console.log("buildSubMenueForChildWin: "+a)}},HDiagnosisWindow.prototype.startAnimate=function(){if(!this.run){var a=getElementGlobalID();this.appendWindow(a),this.run=!0}},HDiagnosisWindow.prototype.initialize=function(){try{this.doCondition()}catch(a){console.log("HDiagnosisWindow initialize failed: "+a)}},emosWS.HTMLDiagnosisWindow=HDiagnosisWindow;var privateCallback;function EmosAlarm(a,b){this.placeholderName=a,this.configuration=b,this.table=null,this.headerList=[["T04_Time.name","dateTime"],["T04_AlarmServer.name","alarmServer"],["T04_AlarmGroup.name","alarmGroup"],["T04_Type.name","alarmType"],["T04_Field.name","location"],["T04_ClassID.name","classID"],["T04_Priority.name","priority"],["T04_Text.name","alarmText"],["T04_Tagname.name","tagname"],["T04_Duration.name","duration"]],this.data=[],this.headerCells=[],this.dataLength=0,this.typeIndex=this.indexOfAHeader("T04_Type.name"),this.classIDIndex=this.indexOfAHeader("T04_ClassID.name"),this.tagnameIndex=this.indexOfAHeader("T04_Tagname.name"),this.typeIndex=this.indexOfAHeader("T04_Type.name"),this.updateJob=null,this.updateBusy=!1,this.otable=null,$.fn.dataTableExt.oApi.fnAddDataAndDisplay=function(a,b){var c=this.oApi._fnAddData(a,b),d=a.aoData[c].nTr;this.oApi._fnReDraw(a);for(var e=-1,f=0,g=a.aiDisplay.length;f<g;f++)if(a.aoData[a.aiDisplay[f]].nTr===d){e=f;break}return e>=0&&(a._iDisplayStart=Math.floor(f/a._iDisplayLength)*a._iDisplayLength,this.oApi._fnCalculateEnd(a)),this.oApi._fnDraw(a),{nTr:d,iPos:c}}}EmosAlarm.prototype.indexOfAHeader=function(a){for(var b=0,c=this.headerList.length;b<c;b++)if(this.headerList[b][0]===a)return b;return-1},EmosAlarm.prototype.empty=function(){this.otable.fnClearTable()},EmosAlarm.prototype.update=function(a,b){try{var c=b;if("alarmText"===a.type&&"internal"!==a.tagname)switch(a.alarmType){case"3RTN":case"2ACK":for(var d=c.otable.fnGetData(),e=0,f=d.length;e<f;e++)if(d[e][c.tagnameIndex]===a.tagname){c.otable.fnDeleteRow(e);break}if("3RTN"===a.alarmType)break;default:var g=c.getLocalTime(a.date,a.time);a.date=g[0],a.time=g[1],a.dateTime=a.date+" "+a.time,a.beginTime=c.convertToTimestamp(a.date,a.time),a.duration=c.convertToDate(a.beginTime),c.dataLength++,a.id=c.dataLength,c.data.unshift(a);for(var h=[],e=0,f=c.headerList.length;e<f;e++)h[e]=a[c.headerList[e][1]];c.otable.fnAddData(h)}else if("dataChange"===a.type){var i=c.indexOfAHeader(a.tag);i>=0&&(c.headerCells[i].innerHTML=a.value)}}catch(a){console.log("update() failed: "+a)}},EmosAlarm.prototype.updateAlarmList=function(){var a=this;this.updateJob=setInterval(function(){if(!a.updateBusy){a.updateBusy=!0;for(var b=a.table.getElementsByTagName("tr"),c=1;c<b.length;c++){var d=b[c].getElementsByTagName("td");d[d.length-1].innerHTML=convertToDate(a.data[c-1].beginTime)}a.updateBusy=!1}},5e3)},EmosAlarm.prototype.convertToTimestamp=function(a,b){try{if(""===a)return"";var c=a.split("-"),d=b.split(":"),e=d[2].split(",");return new Date(c[1]+"/"+c[2]+"/"+c[0]+" "+d[0]+":"+d[1]+":"+e[0]).getTime()}catch(a){console.log("convertToTime() failed: "+a)}},EmosAlarm.prototype.getLocalTime=function(a,b){try{if(""===a)return["",""];var c=a.split("."),d=b.split(":"),e=d[2].split(","),f=new Date(c[1]+"/"+c[0]+"/"+c[2]+" "+d[0]+":"+d[1]+":"+e[0]+" UTC"),g=f.getDate();g=g<10?"0"+g:g;var h=f.getMonth()+1;h=h<10?"0"+h:h;var i=f.getHours();i=i<10?"0"+i:i;var j=f.getMinutes();j=j<10?"0"+j:j;var k=f.getSeconds();k=k<10?"0"+k:k;return[f.getFullYear()+"-"+h+"-"+g,i+":"+j+":"+k+","+e[1]]}catch(a){console.log("getLocalTime() failed: "+a)}},EmosAlarm.prototype.render=function(){try{var a=this;this.table=document.getElementById(this.placeholderName);var b=this.table.createTHead().insertRow();b.className="alarmTable header";for(var c=0,d=this.headerList.length;c<d;c++)b.insertCell().innerHTML=this.headerList[c][0];this.headerCells=b.getElementsByTagName("td"),$("#"+this.placeholderName+" tbody tr").live("click",function(){var b="",c=$("td",this);b+="Time:   \t"+$(c[a.indexOfAHeader("T04_Time.name")]).text()+"\n",b+="Text:   \t"+$(c[a.indexOfAHeader("T04_Text.name")]).text()+"\n",b+="Tagname:\t"+$(c[a.indexOfAHeader("T04_Tagname.name")]).text()+"\n",alert(b)}),this.otable=$("#"+this.placeholderName).dataTable({sScrollY:"400px",oLanguage:{sSearch:"Search all columns:"},fnCreatedRow:function(b,c,d){switch(c[a.classIDIndex]){case"1":$(b).addClass("1NEW"===c[a.typeIndex]?"alarmTable alarmnew":"alarmTable alarmack");break;case"2":$(b).addClass("1NEW"===c[a.typeIndex]?"alarmTable warningnew":"alarmTable warningack");break;default:$(b).addClass("1NEW"===c[a.typeIndex]?"alarmTable othernew":"alarmTable otherack")}},aaSorting:[[0,"dsc"]]});var e=this.otable,f=new Array;$("tfoot input").keyup(function(){e.fnFilter(this.value,$("tfoot input").index(this))}),$("tfoot input").each(function(a){f[a]=this.value}),$("tfoot input").focus(function(){"search_init"==this.className&&(this.className="",this.value="")}),$("tfoot input").blur(function(a){""==this.value&&(this.className="search_init",this.value=f[$("tfoot input").index(this)])})}catch(a){console.log("Alarm render failed: "+a)}},EmosAlarm.prototype.convertToDate=function(a){try{if(""===a)return"";var b=(new Date).getTime(),c=parseInt((b-a)/1e3),d=parseInt(c/86400),e=parseInt(c/3600)%24,f=parseInt(c/60)%60,g=c%60;return d+":"+(e<10?"0"+e:e)+":"+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g)}catch(a){console.log("convertToDate() failed: "+a)}},emosWS.EmosAlarm=EmosAlarm;function ForeignObject(a){this.placeholderVisible=void 0!==a.placeholderVisible&&a.placeholderVisible,this.targetId=a.uiID,this.name=a.name||this.targetId,this.id=this.targetId+"_div",this.elementId=this.getElementId(),this.placeHolder=getSVGElement(this.targetId),this.placeHolder&&(this.width=this.placeHolder.getAttribute("width"),this.height=this.placeHolder.getAttribute("height"),this.x=this.placeHolder.getAttribute("x"),this.y=this.placeHolder.getAttribute("y")),this.divElement=null,this.divJElement=null,this.element=null,this.isSVGForeignObject=this.useHTMLElement&&emosWS.attr.supportForeignObject,this.render()}ForeignObject.prototype.render=function(){try{if(this.isSVGForeignObject){var a=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");setTimeout(function(){""!==a.parentNode.style.visibility&&a.setAttribute("style","visibility: "+a.parentNode.style.visibility)},500);var b=document.createElementNS("http://www.w3.org/1999/xhtml","body");b.setAttribute("style","margin:0; width:100%; height:100%"),a.appendChild(b),a.setAttribute("width",this.width),a.setAttribute("height",this.height),a.setAttribute("x",this.x),a.setAttribute("y",this.y),a.setAttribute("id",this.targetId),a.setAttribute("display",this.placeHolder.style.display),a.setAttribute("overflow","visible"),this.placeHolder.parentNode.replaceChild(a,this.placeHolder);var c=emosWS.shapes[this.targetId];c&&(c.shape=a),this.divElement=b,this.renderMore()}else{var d=document.createElementNS("http://www.w3.org/2000/svg","rect");this.placeHolder.appendChild(d),d.setAttribute("width",this.width),d.setAttribute("height",this.height),d.setAttribute("x",this.x),d.setAttribute("y",this.y);var e=this.placeHolder.style.display;this.placeHolder.style.display="block";var f=$('<div class="PlaceHolder" id="'+this.id+'"></div>');$("body").append(f),this.divElement=document.getElementById(this.id),this.divJElement=$("#"+this.id),this.divElement.style.display=e,this.divElement.style.overflow="visible",this.placeHolder.style.visibility="none"===e?"hidden":"visible",this.divJElement=$("#"+this.id);var c=emosWS.shapes[this.targetId];c&&(c.shape=this.divElement),this.renderMore(),this.placeholderVisible||this.hidePlaceHolder();var g=this,h=function(){g.onResize()};window.attachEvent?window.attachEvent("onresize",h):window.addEventListener&&window.addEventListener("resize",h,!0),h()}window[this.name]=this.element,emosWS.addLanguageChangeListener(function(a){this.onLanguage(a)}.bind(this))}catch(a){console.log("ForeignObject render failed: "+a)}},ForeignObject.prototype.renderMore=function(){},ForeignObject.prototype.elementInViewport=function(a){var b=a.offsetTop,c=a.offsetLeft,d=a.offsetWidth,e=a.offsetHeight;while(a.offsetParent)a=a.offsetParent,b+=a.offsetTop,c+=a.offsetLeft;return b>=window.pageYOffset&&c>=window.pageXOffset&&b+e<=window.pageYOffset+window.innerHeight&&c+d<=window.pageXOffset+window.innerWidth},ForeignObject.prototype.setStyle=function(a){this.isSVGForeignObject?(a.style.width="100%",a.style.height="100%"):a.setAttribute("class","ForeignObject")},ForeignObject.prototype.onResize=function(){try{var a=this.placeHolder.getBoundingClientRect();this.divElement.style.top=a.top+"px",this.divElement.style.left=a.left+"px",this.divElement.style.width=a.width-1+"px",this.divElement.style.height=a.height-1+"px";var b=a.width/this.width;this.element&&(this.element.style.fontSize=b+"em"),this.onResizeMore()}catch(a){console.log("ForeignObject onResize failed: "+a)}},ForeignObject.prototype.onLanguage=function(a){},ForeignObject.prototype.onResizeMore=function(){},ForeignObject.prototype.getElementId=function(){return this.targetId+"_"+this.constructor.name},ForeignObject.prototype.hidePlaceHolder=function(){this.placeHolder.setAttribute("visibility","hidden")},ForeignObject.prototype.getElement=function(){return this.isSVGForeignObject?getSVGElement(this.elementId):document.getElementById(this.elementId)},emosWS.ForeignObject=ForeignObject;function AlarmFilterReport(a){this.wrapperCSS=this.wrapperCSS||"AlarmFilterWrapper",this.tableCSS=this.tableCSS||"AlarmFilterReport",this.placeholderID=a.uiID,this.alarmGroup=a.Advise_AlarmGroup,this.useSingleLine=a.Display_SingleLine,this.dateWidth=a.Width01_Date,this.timeWidth=a.Width02_Time,this.alarmServerWidth=a.Width03_AlarmServer,this.alarmGroupWidth=a.Width04_AlarmGroup,this.groupAliaseWidth=a.Width05_GroupAlias,this.typeWidth=a.Width06_Type,this.fieldWidth=a.Width07_Field,this.classWidth=a.Width08_Class,this.priorityWidth=a.Width09_Priority,this.textWidth=a.Width10_Text,this.tagWidth=a.Width11_Tagname,this.durationWidth=a.Width12_Duration,this.alarmNewTextColor=a.Color01_AlmNewText,this.alarmNewBGColor=a.Color02_AlmNewBkgr,this.alarmAckTextColor=a.Color03_AlmAckText,this.alarmAckBGColor=a.Color04_AlmAckBkgr,this.warnNewTextColor=a.Color05_WrnNewText,this.warnNewBGColor=a.Color06_WrnNewBkgr,this.warnAckTextColor=a.Color07_WrnAckText,this.warnAckBGColor=a.Color08_WrnAckBkgr,this.otherNewTextColor=a.Color09_OthNewText,this.otherNewBGColor=a.Color10_OthNewBkgr,this.otherAckTextColor=a.Color11_OthAckText,this.otherAckBGColor=a.Color12_OthAckBkgr,this.useBold=a.Display_BoldFont,this.filterClass=a.Filter_Class,this.filterPrioFrom=a.Filter_PriorityFrom,this.filterPrioTo=a.Filter_PriorityTo,this.columnsSize=[a.Width01_Date,a.Width02_Time,a.Width03_AlarmServer,a.Width04_AlarmGroup,a.Width05_GroupAlias,a.Width06_Type,a.Width07_Field,a.Width08_Class,a.Width09_Priority,a.Width10_Text,a.Width11_Tagname,a.Width12_Duration];for(var b=0,c=0,d=this.columnsSize.length;c<d;c++)b+=this.columnsSize[c];for(var c=0,d=this.columnsSize.length;c<d;c++)this.columnsSize[c]=parseInt(this.columnsSize[c]/b*100);this.texIDList={date:"T04_Date",time:"T04_Time",alarmServer:"T04_AlarmServer",alarmGroup:"T04_AlarmGroup",alias:"T04_AlarmAlias",alarmType:"T04_Type",location:"T04_Field",classID:"T04_ClassID",priority:"T04_Priority",alarmText:"T04_Text",tagname:"T04_Tagname",duration:"T04_Duration"},this.columns=["date","time","alarmServer","alarmGroup","alias","alarmType","location","classID","priority","alarmText","tagname","duration"],this.commandText={T04_Acknowledge:""},this.alarmTable={object:null,id:null},ForeignObject.call(this,a),ESAnimation.call(this)}AlarmFilterReport.prototype=Object.create(ForeignObject.prototype),AlarmFilterReport.prototype=emosWS.fn.emosExtend(AlarmFilterReport.prototype,ESAnimation.prototype),AlarmFilterReport.prototype.constructor=AlarmFilterReport,AlarmFilterReport.prototype.initializeMore=function(){this.adviseData()},AlarmFilterReport.prototype.renderMore=function(){this.createCSS(),this.createTable(),this.adviseText()},AlarmFilterReport.prototype.createCSS=function(){var a=document.createElement("style");a.type="text/css",a.innerHTML="            .alarmTable.alarmnew tr, .alarmTable.alarmnew td{\n                background-color:"+this.alarmNewBGColor+";\n                color:"+this.alarmNewTextColor+";\n                white-space: nowrap;\n                overflow: hidden;\n            }\n            .alarmTable.alarmack tr, .alarmTable.alarmack td{\n                background-color:"+this.alarmAckBGColor+";\n                color:"+this.alarmAckTextColor+";\n                white-space: nowrap;\n                overflow: hidden;\n            }\n            .alarmTable.warningnew tr, .alarmTable.warningnew td{\n                background-color:"+this.warnNewBGColor+";\n                color:"+this.warnNewTextColor+";\n                white-space: nowrap;\n                overflow: hidden;\n            }\n            .alarmTable.warningack tr, .alarmTable.warningack td{\n                background-color:"+this.warnAckBGColor+";\n                color:"+this.warnAckTextColor+";\n                white-space: nowrap;\n                overflow: hidden;\n            }\n            .alarmTable.othernew tr, .alarmTable.othernew td{\n                background-color:"+this.otherNewBGColor+";\n                color:"+this.otherNewTextColor+";\n                white-space: nowrap;\n                overflow: hidden;\n            }\n            .alarmTable.otherack tr, .alarmTable.otherack td{\n                background-color:"+this.otherAckBGColor+";\n                color:"+this.otherAckTextColor+";\n                white-space: nowrap;\n                overflow: hidden;\n            }\n            ",document.getElementsByTagName("head")[0].appendChild(a)},AlarmFilterReport.prototype.createTable=function(){this.alarmTable.id=getElementGlobalID();for(var a='<div class="'+this.wrapperCSS+'" id="'+this.elementId+'">\n            <table border="0" class="'+this.tableCSS+'" id="'+this.alarmTable.id+'">',b=0,c=this.columns.length;b<c;b++)a+='<col style="width:'+this.columnsSize[b]+'%">';a+="</table></div>";var d=$(a);this.divJElement.append(d),this.element=document.getElementById(this.elementId),this.table=document.getElementById(this.alarmTable.id),this.createTableHeader()},AlarmFilterReport.prototype.createTableHeader=function(){try{var a=this.table.createTHead().insertRow();a.className="AlarmFilterHeader",a.myCells={};for(var b in this.texIDList){var c=a.insertCell();c.innerHTML=this.texIDList[b],a.myCells[this.texIDList[b]+".name"]=c,emosWS.sendAdviseText(this.texIDList[b],"name",function(b){a.myCells[b.tag].innerHTML=b.value})}}catch(a){console.log("createTableHeader() failed: "+a)}},AlarmFilterReport.prototype.validateMsg=function(a){try{if("alarmText"!==a.type||"internal"===a.tagname)return!1;var b=parseInt(a.classID),c=parseInt(a.priority);return!(this.filterPrioFrom[b]>c||this.filterPrioTo[b]<c)&&(a.newClassID=this.filterClass[b],!0)}catch(a){console.log("validateMsg() failed: "+a)}},AlarmFilterReport.prototype.adviseText=function(){try{var a=this;for(var b in this.commandText)emosWS.sendAdviseText(b,"name",function(b){var c=b.tag.split(".name")[0];c&&(a.commandText[c]=b.value)})}catch(a){console.log("adviseText() failed: "+a)}},AlarmFilterReport.prototype.adviseData=function(){try{var a=this;emosWS.sendAdviseAlarmText(this.alarmGroup,emosWS.getLanguage(),function(b){a.validateMsg(b)&&a.updateTable(b)})}catch(a){console.log("adviseData() failed: "+a)}},AlarmFilterReport.prototype.updateTable=function(a){try{for(var b=this.table.rows,c=1;c<b.length;c++){if(b[c].myMsg.tagname===a.tagname){this.table.deleteRow(c);break}}this.addRow(a,1)}catch(a){console.log("updateTable() failed: "+a)}},AlarmFilterReport.prototype.addRow=function(a,b){try{if(a&&"3RTN"!==a.alarmType){var c=this.table.insertRow(b);c.myMsg=a;var d="";switch(a.newClassID){case 0:d="1NEW"===a.alarmType?"alarmTable alarmnew":"alarmTable alarmack";break;case 1:d="1NEW"===a.alarmType?"alarmTable warningnew":"alarmTable warningack";break;default:d="1NEW"===a.alarmType?"alarmTable othernew":"alarmTable otherack"}c.className=d,c.title="";for(var e=0,f=this.columns.length;e<f;e++){var g=a[this.columns[e]]||"N/A";if(c.title+=this.columns[e]+":   "+g+"\n",g){c.insertCell(-1).innerHTML=g}}c.addEventListener("click",this.onRowClick.bind(this,c),!1)}}catch(a){console.log("updateTable() failed: "+a)}},AlarmFilterReport.prototype.onRowClick=function(a){if("1NEW"===a.myMsg.alarmType){var b=a.title+"\n\n"+this.commandText.T04_Acknowledge+"?";confirm(b)&&emosWS.poke(a.myMsg.alarmGroup+".Alarm","-1")}else alert(a.title)},AlarmFilterReport.prototype.onLanguage=function(a){this.clearTable()},AlarmFilterReport.prototype.clearTable=function(){$("#"+this.alarmTable.id+"tbody tr").remove()},emosWS.AlarmFilterReport=AlarmFilterReport;function AlarmFilterSingleLine(a){this.wrapperCSS="AlarmFilterSingleLineWrapper",this.tableCSS="AlarmFilterSingleLine",this.table=null,this.alarmState={activeClass:null,activeAlarmGroup:null,list:{},alarms:{}},this.clearTable(),AlarmFilterReport.call(this,a)}AlarmFilterSingleLine.prototype=Object.create(AlarmFilterReport.prototype),AlarmFilterSingleLine.prototype.constructor=AlarmFilterSingleLine,AlarmFilterSingleLine.prototype.adviseData=function(){try{var a=this;emosWS.sendAdviseAlarmText(this.alarmGroup,emosWS.getLanguage(),function(b){a.validateMsg(b)&&(a.updateAlarmState(b),a.updateTable())})}catch(a){console.log("adviseData() failed: "+a)}},AlarmFilterSingleLine.prototype.createTableHeader=function(){},AlarmFilterSingleLine.prototype.updateTable=function(){try{this.table.rows.length>0&&this.table.deleteRow(0),this.addRow(this.alarmState.activeAlarmGroup,0)}catch(a){console.log("updateTable() failed: "+a)}},AlarmFilterSingleLine.prototype.onRowClick=function(){loadHREF("ActualAlarm.htm","ifContent")},AlarmFilterSingleLine.prototype.updateAlarmState=function(a){try{var b=a.tagname,c=parseInt(a.alarmType),d=a.newClassID;if(this.alarmState.list[b]&&3===c?(delete this.alarmState.list[b],delete this.alarmState.alarms[d][b],this.alarmState.activeAlarmGroup&&this.alarmState.activeAlarmGroup.tagname===b&&(this.alarmState.activeAlarmGroup=null)):(this.alarmState.list[b]=c,this.alarmState.alarms[d][b]={alarmType:c,msg:a},this.alarmState.activeAlarmGroup&&this.alarmState.activeAlarmGroup.tagname===b&&(this.alarmState.activeAlarmGroup.alarmType=c)),this.alarmState.activeAlarmGroup)(d<this.alarmState.activeClass||d===this.alarmState.activeClass&&c<=parseInt(this.alarmState.activeAlarmGroup.alarmType))&&(this.alarmState.activeAlarmGroup=a,this.alarmState.activeClass=d);else if(0===Object.keys(this.alarmState.list).length)this.alarmState.activeClass=1e3,this.alarmState.activeAlarmGroup=null;else{var e=1e3,f=null;this.alarmState.activeClass=1e3===this.alarmState.activeClass?0:this.alarmState.activeClass;for(var g=this.alarmState.activeClass;g<3;g++)if(Object.keys(this.alarmState.alarms[g]).length>0){var h=4;for(var i in this.alarmState.alarms[g])if(this.alarmState.alarms[g][i].alarmType<h){h=this.alarmState.alarms[g][i].alarmType,f=this.alarmState.alarms[g][i].msg,e=g;break}}this.alarmState.activeClass=e,this.alarmState.activeAlarmGroup=f}}catch(a){console.log("updatealarmState() failed: "+a)}},AlarmFilterSingleLine.prototype.clearTable=function(){this.alarmState.activeClass=1e3,this.alarmState.activeAlarmGroup=null;for(var a=0;a<3;a++)this.alarmState.alarms[a]={}},emosWS.AlarmFilterSingleLine=AlarmFilterSingleLine;function AlarmFilter(a){1===parseInt(a.Display_SingleLine)?new AlarmFilterSingleLine(a):new AlarmFilterReport(a)}emosWS.AlarmFilter=AlarmFilter;var EmosGraph=function(a,b){this.placeholderName=a,this.configuration=b,this.m=[20,20,20,40],this.w=400-this.m[1]-this.m[3],this.h=200-this.m[0]-this.m[2],this.initData=function(){for(var a=140,b=[],c=0;c<a;c++)b[c]=0;return b},this.data=this.initData(),this.x=d3.scale.linear().domain([0,this.data.length]).range([0,this.w]),this.y=d3.scale.linear().domain([-100,100]).range([this.h,0]);var c=this;this.line=d3.svg.line().x(function(a,b){return this.x(b)}).y(function(a){return this.y(a)}),this.render=function(){this.body=d3.select("#"+this.placeholderName).append("svg:svg").attr("class","EmosGraph").attr("width",this.w+this.m[1]+this.m[3]).attr("height",this.h+this.m[0]+this.m[2]).append("svg:g").attr("transform","translate("+this.m[3]+","+this.m[0]+")");var a=d3.svg.axis().scale(this.x).tickSize(-this.h).tickSubdivide(!0);this.body.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+this.h+")").call(a);var b=d3.svg.axis().scale(this.y).tickSize(-this.w).tickSubdivide(!0).orient("left");this.body.append("svg:g").attr("class","y axis").attr("transform","translate(0,0)").call(b),this.body.append("svg:path").attr("d",this.line(this.data))},this.redraw=function(a){try{for(var b=[],d=0;d<c.data.length-1;d++)b[d]=c.data[d+1];b[c.data.length-1]=parseFloat(a.value),c.data=b,c.body.selectAll("path").attr("d",c.line(c.data))}catch(a){console.log("redraw() failed: "+a)}}};emosWS.EmosGraph=EmosGraph;var Gauge=function(a,b){this.placeholderName=a;var c=this;this.configure=function(a){this.config=a,this.config.size=.9*this.config.size,this.config.raduis=.97*this.config.size/2,this.config.cx=this.config.size/2,this.config.cy=this.config.size/2,this.config.min=void 0!=a.min?a.min:0,this.config.max=void 0!=a.max?a.max:100,this.config.range=this.config.max-this.config.min,this.config.majorTicks=a.majorTicks||5,this.config.minorTicks=a.minorTicks||2,this.config.greenColor=a.greenColor||"#109618",this.config.yellowColor=a.yellowColor||"#FF9900",this.config.redColor=a.redColor||"#DC3912",this.config.transitionDuration=a.transitionDuration||500},this.render=function(){this.body=d3.select("#"+this.placeholderName).append("svg:svg").attr("class","gauge").attr("width",this.config.size).attr("height",this.config.size),this.body.append("svg:circle").attr("cx",this.config.cx).attr("cy",this.config.cy).attr("r",this.config.raduis).style("fill","#ccc").style("stroke","#000").style("stroke-width","0.5px"),this.body.append("svg:circle").attr("cx",this.config.cx).attr("cy",this.config.cy).attr("r",.9*this.config.raduis).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width","2px");for(var a in this.config.greenZones)this.drawBand(this.config.greenZones[a].from,this.config.greenZones[a].to,c.config.greenColor);for(var a in this.config.yellowZones)this.drawBand(this.config.yellowZones[a].from,this.config.yellowZones[a].to,c.config.yellowColor);for(var a in this.config.redZones)this.drawBand(this.config.redZones[a].from,this.config.redZones[a].to,c.config.redColor);if(void 0!==this.config.label){var b=Math.round(this.config.size/9);this.body.append("svg:text").attr("x",this.config.cx).attr("y",this.config.cy/2+b/2).attr("dy",b/2).attr("text-anchor","middle").text(this.config.label).style("font-size",b+"px").style("fill","#333").style("stroke-width","0px")}for(var b=Math.round(this.config.size/16),d=this.config.range/(this.config.majorTicks-1),e=this.config.min;e<=this.config.max;e+=d){for(var f=d/this.config.minorTicks,g=e+f;g<Math.min(e+d,this.config.max);g+=f){var h=this.valueToPoint(g,.75),i=this.valueToPoint(g,.85);this.body.append("svg:line").attr("x1",h.x).attr("y1",h.y).attr("x2",i.x).attr("y2",i.y).style("stroke","#666").style("stroke-width","1px")}var h=this.valueToPoint(e,.7),i=this.valueToPoint(e,.85);if(this.body.append("svg:line").attr("x1",h.x).attr("y1",h.y).attr("x2",i.x).attr("y2",i.y).style("stroke","#333").style("stroke-width","2px"),e===this.config.min||e===this.config.max){var j=this.valueToPoint(e,.63);this.body.append("svg:text").attr("x",j.x).attr("y",j.y).attr("dy",b/3).attr("text-anchor",e===this.config.min?"start":"end").text(e).style("font-size",b+"px").style("fill","#333").style("stroke-width","0px")}}var k=this.body.append("svg:g").attr("class","pointerContainer"),l=(this.config.min+this.config.max)/2,m=this.buildPointerPath(l),n=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("basis");k.selectAll("path").data([m]).enter().append("svg:path").attr("d",n).style("fill","#dc3912").style("stroke","#c63310").style("fill-opacity",.7),k.append("svg:circle").attr("cx",this.config.cx).attr("cy",this.config.cy).attr("r",.12*this.config.raduis).style("fill","#4684EE").style("stroke","#666").style("opacity",1);var b=Math.round(this.config.size/10);k.selectAll("text").data([l]).enter().append("svg:text").attr("x",this.config.cx).attr("y",this.config.size-this.config.cy/4-b).attr("dy",b/2).attr("text-anchor","middle").style("font-size",b+"px").style("fill","#000").style("stroke-width","0px"),this.redraw(this.config.min,0)},this.buildPointerPath=function(a){var b=this.config.range/13,d=j(a,.85),e=j(a-b,.12),f=j(a+b,.12),g=a-this.config.range*(1/.75)/2,h=j(g,.28),i=j(g-b,.12);return[d,e,j(g+b,.12),h,i,f,d];function j(a,b){var d=c.valueToPoint(a,b);return d.x-=c.config.cx,d.y-=c.config.cy,d}},this.drawBand=function(a,b,d){0>=b-a||this.body.append("svg:path").style("fill",d).attr("d",d3.svg.arc().startAngle(this.valueToRadians(a)).endAngle(this.valueToRadians(b)).innerRadius(.65*this.config.raduis).outerRadius(.85*this.config.raduis)).attr("transform",function(){return"translate("+c.config.cx+", "+c.config.cy+") rotate(270)"})},this.redraw=function(a,b){var d=this.body.select(".pointerContainer");d.selectAll("text").text(Math.round(a)+" %"),d.selectAll("path").transition().duration(void 0!==b?b:this.config.transitionDuration).attrTween("transform",function(){var b=a;a>c.config.max?b=c.config.max+.02*c.config.range:a<c.config.min&&(b=c.config.min-.02*c.config.range);var d=c.valueToDegrees(b)-90,e=c._currentRotation||d;return c._currentRotation=d,function(a){var b=e+(d-e)*a;return"translate("+c.config.cx+", "+c.config.cy+") rotate("+b+")"}})},this.valueToDegrees=function(a){return a/this.config.range*270-(this.config.min/this.config.range*270+45)},this.valueToRadians=function(a){return this.valueToDegrees(a)*Math.PI/180},this.valueToPoint=function(a,b){return{x:this.config.cx-this.config.raduis*b*Math.cos(this.valueToRadians(a)),y:this.config.cy-this.config.raduis*b*Math.sin(this.valueToRadians(a))}},this.configure(b)};emosWS.Gauge=Gauge;function InputText(a){this.useHTMLElement=!0,this.text=a.text||"",this.pattern=a.pattern||"",this.maxlength=void 0!==a.maxlength?a.maxlength:0,this.fontSize=a["font-size"],this.onchange=a.onchange,this.onkeypress=a.onkeypress,ForeignObject.call(this,a)}InputText.prototype=Object.create(ForeignObject.prototype),InputText.prototype.constructor=InputText,InputText.prototype.renderMore=function(){var a=document.createElement("input");a.setAttribute("type","text"),this.setStyle(a),a.setAttribute("id",this.elementId),this.pattern&&a.setAttribute("pattern",this.pattern),this.maxlength&&a.setAttribute("maxlength",this.maxlength),this.divElement.appendChild(a),this.element=this.getElement(),this.addEditXFunctionality(),this.element.value=this.text,this.fontSize&&(this.element.style["font-size"]=this.fontSize),this.element.value=this.text;var b=this;this.onchange&&this.element.addEventListener("change",function(){b.onchange(this.value,this)},!1),this.onkeypress&&this.element.addEventListener("keypress",function(a){b.onkeypress(a,this)},!0)},InputText.prototype.addEditXFunctionality=function(){var a=this.element,b=function(a){return a>>>=0,"rgb("+[255&a,(65280&a)>>>8,(16711680&a)>>>16].join(",")+")"};Object.defineProperty(a,"Text",{get:function(){return a.value},set:function(b){a.value=b}}),Object.defineProperty(a,"BackColor",{get:function(){return a.style["background-color"]},set:function(c){a.style["background-color"]=b(c)}})},emosWS.InputText=InputText;function ComboBox(a){this.useHTMLElement=!0,this.optionTexts=a.options,this.onchange=a.onchange,ForeignObject.call(this,a)}ComboBox.prototype=Object.create(ForeignObject.prototype),ComboBox.prototype.constructor=ComboBox,ComboBox.prototype.renderMore=function(){try{var a=document.createElement("select");this.setStyle(a),a.setAttribute("id",this.elementId),this.divElement.appendChild(a),this.element=this.getElement();for(var b=0,c=this.optionTexts.length;b<c;b++)this.element.options.add(new Option(this.optionTexts[b],b));var d=this;this.onchange&&this.element.addEventListener("change",function(){d.onchange(this[this.value].label,this.value,this)},!1)}catch(a){console.log("ComboBox renderMore() failed: "+a)}},emosWS.ComboBox=ComboBox;function Checkbox(a){this.useHTMLElement=!0,this.onclick=a.onclick,ForeignObject.call(this,a)}Checkbox.prototype=Object.create(ForeignObject.prototype),Checkbox.prototype.constructor=Checkbox,Checkbox.prototype.renderMore=function(){try{var a=document.createElement("input");a.setAttribute("type","checkbox"),this.setStyle(a),a.setAttribute("id",this.elementId),this.divElement.appendChild(a),this.element=this.getElement();var b=this;this.onclick&&this.element.addEventListener("click",function(){b.onclick(this.checked,this)},!1)}catch(a){console.log("Checkbox renderMore() failed: "+a)}},emosWS.Checkbox=Checkbox;function InputButton(a){this.useHTMLElement=!0,this.text=a.text,this.onclick=a.onclick,ForeignObject.call(this,a)}InputButton.prototype=Object.create(ForeignObject.prototype),InputButton.prototype.constructor=InputButton,InputButton.prototype.renderMore=function(){try{var a=document.createElement("input");a.setAttribute("type","button"),this.setStyle(a),a.setAttribute("id",this.elementId),this.divElement.appendChild(a),this.element=this.getElement(),this.element.value=this.text;var b=this;b.onclick&&this.element.addEventListener("click",function(){b.onclick()},!1)}catch(a){console.log("InputButton renderMore() failed: "+a)}},emosWS.InputButton=InputButton;function InputRadio(a){this.optionTexts=a.options,this.onclick=a.onclick,this.horizontal=void 0===a.horizontal||a.horizontal,ForeignObject.call(this,a)}InputRadio.prototype=Object.create(ForeignObject.prototype),InputRadio.prototype.constructor=InputRadio,InputRadio.prototype.renderMore=function(){try{this.element=[];for(var a=this,b=this.horizontal?"foRadioHorizonal":"foRadioVertial",c=0,d=this.optionTexts.length;c<d;c++){var e=this.optionTexts[c],f=this.elementId+c,g=document.createElement("radio");this.setStyle(g),g.setAttribute("id",this.elementId),g.setAttribute("name",this.targetId),g.setAttribute("value",e),this.divElement.appendChild(g),this.element.push(g);var h=document.createElement("label");h.innerHTML=e,this.divElement.appendChild(h),this.element.push(h),this.onclick&&g.addEventListener("click",function(){a.onclick(this)},!1)}}catch(a){console.log("InputRadio renderMore() failed: "+a)}},emosWS.InputRadio=InputRadio;function VariableDialog(){this.divElement=null,this.ui=null,this.tree=null,this.treeId=null,this.trendId=null,this.PLCListName="emosTrendPLCList",this.PLCList=this.retrievePLCList(),this.createGUI(),window.TrendPageVariableDialog=this}VariableDialog.prototype.createGUI=function(){try{var a=getElementGlobalID();this.treeId=getElementGlobalID();var b='<div id="'+a+'" class="VariableDialog">\n                    <div id="'+this.treeId+'" class="css-treeview"></div>\n                </div>',c=$(b);$("body").append(c),this.ui=$("#"+a).dialog({title:"Variable dialog",width:200,height:400,resizable:!0}),this.ui.dialog("close"),this.tree=$("#"+this.treeId),this.divElement=document.getElementById(a)}catch(a){console.log("VariableDialog createGUI() failed: "+a)}},VariableDialog.prototype.setPosition=function(a){this.ui.dialog("option","position",{my:"left top+30",at:"left top",of:a})},VariableDialog.prototype.setTrendId=function(a){this.trendId||(this.trendId=a,this.getPlanList())},VariableDialog.prototype.storePLCList=function(){"undefined"!=typeof Storage&&localStorage.setItem(this.PLCListName,JSON.stringify(this.PLCList))},VariableDialog.prototype.retrievePLCList=function(){if("undefined"!=typeof Storage)return JSON.parse(localStorage.getItem(this.PLCListName))||{}},VariableDialog.prototype.getPlanList=function(){emosWS.sendTrendGetPlantList(this.trendId)},VariableDialog.prototype.onDataTrendPlantList=function(a){try{for(var b=JSON.parse(a.data).PLC,c=0,d=b.length;c<d;c++)void 0===this.PLCList[b[c]]&&(this.PLCList[b[c]]=null);this.storePLCList(),this.updatePLC()}catch(a){console.log("VariableDialog onDataTrendPlantList() failed: "+a)}},VariableDialog.prototype.onDataTrendItemList=function(a){try{var b=JSON.parse(a.data),c=b.Items,d=b.PLC;this.PLCList[d]=[];for(var e=0,f=c.length;e<f;e++){var g=c[e];this.PLCList[d].push(g)}this.storePLCList(),this.updateTag(d)}catch(a){console.log("VariableDialog onDataTrendItemList() failed: "+a)}},VariableDialog.prototype.updatePLC=function(){try{for(var a in this.PLCList){var b=this.treeId+a,c='<li id="'+b+'li"><input type="checkbox" id="'+b+'" /><label for="'+b+'">'+a+"</label>",d=$(c);this.tree.append(d),this.PLCList[a]?this.updateTag(a):document.getElementById(b).addEventListener("click",function(a){console.log(a+" cliked!"),this.PLCList[a]?this.PLCList[a]=[]:emosWS.sendTrendGetItemList(this.trendId,a)}.bind(this,a),!1)}}catch(a){console.log("VariableDialog updatePLC() failed: "+a)}},VariableDialog.prototype.updateTag=function(a){try{if(this.PLCList[a]){for(var b=this.treeId+a+"li",c="<ul>",d=0,e=this.PLCList[a].length;d<e;d++){var f=b+d,g=this.PLCList[a][d],h="";for(var i in g)h+=i+":  "+g[i]+"\n";c+='<li><p id="'+f+'" draggable="true" title="'+h+'">'+g.Tag+"</p></li>"}c+="</ul>";var j=$(c);$("#"+b).append(j);for(var d=0,e=this.PLCList[a].length;d<e;d++){var f=b+d;document.getElementById(f).addEventListener("dragstart",function(b){b.dataTransfer.setData("text",a+b.target.textContent)},!1)}}}catch(a){console.log("VariableDialog updateTag() failed: "+a)}},emosWS.VariableDialog=VariableDialog;function Diagram(a){this.divElement=null,this.id=null,this.chartId=null,this.timeLineId=null,this.previewId=null,this.backId=null,this.nextId=null,this.seriesData=[],this.ui=null,this.chart=null,this.graph=null,this.tagList={},this.chartDataX=["x"],this.chartDataYList={},this.liveInterval=1e3,this.historicInterval=120,this.jitter=5,this.nullValue=.1122,this.lastUpdate=null,this.legends=["x"],this.rowsData=[this.legends],this.liveDuration=1,this.useShowAllData=!0,this.resolution=1,this.stopLive=!1,this.chartData={xs:{},columns:[]},this.tagDataIndex={},this.tagDataLength=0,this.callbackList={},this.timestampList=[],this.useLive=a.useLive,this.usePoint=a.usePoint,this.useDataInterpolated=a.useDataInterpolated,this.backgroundColor="transparent",this.droptBackgroundColor="#2E64FE",this.blackhole=null,this.trendRegisteredListeners=[],this.trendPage=a,a.diagramList.push(this),this.createGUI()}Diagram.prototype.getXAxisID=function(a){return"x"+a},Diagram.prototype.addNewTag=function(a){var b=this.getXAxisID(this.tagDataLength),c=2*this.tagDataLength;this.chartData.xs[a]=b,this.tagDataIndex[a]={x:c,y:c+1},this.chartData.columns.splice(this.tagDataIndex[a].x,0,[b]),this.chartData.columns.splice(this.tagDataIndex[a].y,0,[a]),this.tagDataLength++},Diagram.prototype.getTS=function(a){var b=new Date(a),c=b.getTime()/this.resolution;return parseInt(c)},Diagram.prototype.getValue=function(a){return parseFloat(a)},Diagram.prototype.addNewTagValue=function(a,b){this.chartData.columns[this.tagDataIndex[a].x].push(this.getTS(b.ts)),this.chartData.columns[this.tagDataIndex[a].y].push(this.getValue(b.value))},Diagram.prototype.joinData=function(a,b){var c={};[a,b].forEach(function(a){a.x.forEach(function(b,d){c[b.toString()]={x:b,y:a.y[d]}})});var d=[];for(var e in c)d.push(e);d.sort();var f={x:[],y:[]};return d.forEach(function(a){f.x.push(c[a].x),f.y.push(c[a].y)}),f},Diagram.prototype.addNewTagValues=function(a,b){var c={x:[],y:[]};b.Values.forEach(function(a){c.x.push(this.getTS(a.TS)),c.y.push(this.getValue(a.Value))}.bind(this));var d=this.chartData.columns[this.tagDataIndex[a].x].slice(),e=this.chartData.columns[this.tagDataIndex[a].y].slice(),f=d.shift(),g=e.shift(),h={x:d,y:e},i=this.joinData(h,c);i.x.unshift(f),i.y.unshift(g),this.chartData.columns[this.tagDataIndex[a].x]=i.x,this.chartData.columns[this.tagDataIndex[a].y]=i.y},Diagram.prototype.clearChartData=function(){this.chartData.columns.forEach(function(a){a.splice(1,a.length-1)})},Diagram.prototype.createGUI=function(){try{this.id=getElementGlobalID(),this.chartId=this.id+"chart",this.timeLineId=this.id+"tl",this.previewId=this.id+"pre",this.backId=this.id+"back",this.nextId=this.id+"next",this.id=getElementGlobalID();var a='<div id="'+this.id+'" class="TrendPageRow TrendPageDiagram">\n                        <div id="'+this.backId+'" class="TrendPageDiagramBackNext TrendPageDiagramBack"></div>\n                        <div id="'+this.chartId+'" class="TrendPageDiagramChart"></div>\n                        <div id="'+this.nextId+'" class="TrendPageDiagramBackNext TrendPageDiagramNext"></div>\n                    </div>',b=$(a);this.trendPage.diagrams.append(b),this.ui=document.getElementById(this.id),this.backgroundColor=this.ui.style.backgroundColor,this.chart=document.getElementById(this.chartId);var c=this;this.ui.addEventListener("drop",function(a){c.drop(a)},!1),this.ui.addEventListener("dragover",function(a){c.allowDrop(a)},!1),this.ui.addEventListener("dragleave",function(a){c.ui.style.backgroundColor=c.backgroundColor},!1),this.chart.addEventListener("dblclick",function(){this.trendPage.filterDateDialog.show(this)}.bind(this),!1),document.getElementById(this.backId).addEventListener("click",function(){this.loadDataBack()}.bind(this),!1),document.getElementById(this.nextId).addEventListener("click",function(){this.loadDataNext()}.bind(this),!1)}catch(a){console.log("Diagram createGUI() failed: "+a)}},Diagram.prototype.addTrendRegisteredListener=function(a){this.trendPage.trendId?a():this.trendRegisteredListeners.push(a)},Diagram.prototype.onTrendRegistered=function(){this.trendRegisteredListeners.forEach(function(a){a()})},Diagram.prototype.onDataTrendItemValueList=function(a){try{var b=a.PLC+a.Tag;console.log("onDataTrendItemValueList: plctag = "+b),void 0!==this.tagDataIndex[b]&&(this.addNewTagValues(b,a),this.loadChart())}catch(a){console.log("Diagram onDataTrendItemValueList() failed: "+a)}},Diagram.prototype.refreshSize=function(a){this.ui.style.height=a+"px",this.graph&&this.graph.resize({height:a})},Diagram.prototype.createChart=function(){try{var a=this,b="#"+this.chartId;this.graph=c3.generate({bindto:b,data:this.chartData,axis:{x:{tick:{count:3,format:function(a){var b=new Date(a*this.resolution);return b.toLocaleString()+" ."+b.getMilliseconds()}.bind(this)}}},subchart:{show:this.trendPage.advanced},zoom:{enabled:!0},point:{show:this.usePoint},transition:{duration:0},type:this.useDataInterpolated?"line":"step"});var c=setInterval(function(){this.useLive&&this.loadChart()}.bind(this),this.liveInterval)}catch(a){console.log("Diagram createChart() failed: "+a)}},Diagram.prototype.showAllData=function(){this.useShowAllData=!0,this.setLive(!1),this.loadChart()},Diagram.prototype.setLive=function(a){this.useLive=a,this.stopLive=!a&&this.stopLive},Diagram.prototype.setDataInterpolated=function(a){this.useDataInterpolated!==a&&(this.useDataInterpolated=a),this.graph.transform(a?"line":"step")},Diagram.prototype.getLiveData=function(){var a=parseInt((new Date).getTime()/this.resolution)-6e4*this.liveDuration/this.resolution,b={xs:this.chartData.xs,columns:[]};for(var c in this.tagDataIndex){for(var d=this.chartData.columns[this.tagDataIndex[c].x],e=this.chartData.columns[this.tagDataIndex[c].y],f=1,g=d.length-1,h=g;h>0;h--){if(d[h]<a)break;f=h}var i=d.slice(f,d.length),j=e.slice(f,e.length);i.unshift(d[0]),j.unshift(e[0]),b.columns.push(i),b.columns.push(j)}return b},Diagram.prototype.setPoint=function(a){this.usePoint=this.graph.internal.config.point_show=a,this.graph.internal.redraw()},Diagram.prototype.refreshChart=function(){this.graph=c3.generate({bindto:"#"+this.chartId,data:{rows:this.rowsData},axis:{x:{tick:{count:3,format:function(a){return new Date(a).toLocaleString()}}}},subchart:{show:this.trendPage.advanced},zoom:{enabled:!0},point:{show:this.usePoint}})},Diagram.prototype.processNewData=function(a,b){try{console.log("------processNewData-------");for(var c={},d=null,e=[],f=0,g=this.legends.length;f<g;f++)e.push(this.nullValue),a===this.legends[f]&&(d=f);if(d){for(var f=1,g=this.rowsData.length;f<g;f++)c[this.rowsData[f][0].toString()]=this.rowsData[f];b.forEach(function(a){var b=parseInt(new Date(a.TS).getTime()/1e3),f=c[b]||e.slice();f[0]=b,f[d]=parseFloat(a.Value),c[b.toString()]=f});var h=[];for(var i in c)h.push(i);h.sort();var j=[this.legends];h.forEach(function(a){j.push(c[a])});for(var k=1,l=this.legends.length;k<l;k++)for(var m=this.nullValue,f=1,g=j.length;f<g;f++)j[f][k]===this.nullValue?j[f][k]=m:m=j[f][k];this.rowsData=j}}catch(a){console.log("Diagram processNewData() failed: "+a)}},Diagram.prototype.loadChart=function(){var a=this.chartData;this.useLive&&(a=this.getLiveData()),this.graph.load(a)},Diagram.prototype.getActualTagValue=function(){if(void 0!==this.tagList.ts){for(var a=[this.tagList.ts],b=1,c=this.legends.length;b<c;b++)a.push(this.tagList[this.legends[b]]);return a}return null},Diagram.prototype.getDataBeginDate=function(){return this.getDataDate(!0)},Diagram.prototype.getDataEndDate=function(){return this.getDataDate(!1)},Diagram.prototype.getDataDate=function(a){var b=null;for(var c in this.tagDataIndex){var d=this.chartData.columns[this.tagDataIndex[c].x],e=d[a?1:d.length-1];e&&(null===b&&(b=e),b=(a?e<b:e>b)?e:b)}var f=new Date(b*this.resolution);return console.log("getDataDate "+(a?"begin":"end")+" = "+f.toLocaleString()),null===b?b:f},Diagram.prototype.loadMoreData=function(a,b){var c=b||this.getDataBeginDate(),d=a||new Date(c);a||d.setMinutes(c.getMinutes()-this.historicInterval);for(var e in this.tagDataIndex)this.loadMoreTagData(e,d,c)},Diagram.prototype.loadMoreTagData=function(a,b,c){var d=emosWS.getPLCTag(a),e=d.plc,f=d.tag,g=b.getUTCFullYear(),h=b.getUTCMonth()+1,i=b.getUTCDate(),j=b.getUTCHours(),k=b.getUTCMinutes(),l=b.getUTCSeconds(),m=c.getUTCFullYear(),n=c.getUTCMonth()+1,o=c.getUTCDate(),p=c.getUTCHours(),q=c.getUTCMinutes(),r=c.getUTCSeconds();this.addTrendRegisteredListener(function(){emosWS.sendTrendGetItemValueList(this.trendPage.trendId,e,f,g,h,i,j,k,l,m,n,o,p,q,r)}.bind(this))},Diagram.prototype.adviseData=function(a){try{this.tagList[a]=0,this.addNewTag(a);var b=new Date,c=new Date(b);c.setMinutes(b.getMinutes()-this.historicInterval),b.setMinutes(b.getMinutes()+this.jitter);var d=this.getDataBeginDate();d&&(c=c.getTime()>d.getTime()?d:c),this.loadMoreTagData(a,c,b),this.callbackList[a]=emosWS.advise(a,function(b){this.stopLive||this.addNewTagValue(a,b)}.bind(this),"",emosWS.tagType.IO),this.loadChart()}catch(a){console.log("Diagram adviseData() failed: "+a)}},Diagram.prototype.drop=function(a){try{this.ui.style.backgroundColor=this.backgroundColor,a.preventDefault();var b=a.dataTransfer.getData("text");console.log("dropped: tag="+b),this.initializeChart(b)}catch(a){console.log("Diagram drop() failed: "+a)}},Diagram.prototype.initializeChart=function(a){a&&(this.graph||this.createChart()),this.tagList[a]||this.adviseData(a)},Diagram.prototype.allowDrop=function(a){this.ui.style.backgroundColor=this.droptBackgroundColor,a.preventDefault(),a.stopPropagation()},Diagram.prototype.getExportSVG=function(){return this.ui.innerHTML},Diagram.prototype.getExportData=function(){var a=this.getSetting();return a.chartData=this.chartData,a},Diagram.prototype.getSetting=function(){return{tagDataIndex:this.tagDataIndex,useLive:this.useLive,usePoint:this.usePoint,useDataInterpolated:this.useDataInterpolated,advanced:this.trendPage.advanced}},Diagram.prototype.reset=function(){for(var a in this.callbackList)emosWS.unadvise(a,this.callbackList[a])},Diagram.prototype.onFilterDateSelected=function(a,b){this.loadData(a,b)},Diagram.prototype.loadDataNext=function(){var a=this.getDataEndDate(),b=new Date(a);b.setMinutes(a.getMinutes()+this.historicInterval),this.loadData(a,b)},Diagram.prototype.loadDataBack=function(){var a=this.getDataBeginDate(),b=new Date(a);b.setMinutes(a.getMinutes()-this.historicInterval),this.loadData(b,a)},Diagram.prototype.loadData=function(a,b){this.stopLive=!0,this.clearChartData(),this.loadMoreData(a,b)},emosWS.Diagram=Diagram;function TrendList(){this.trendList=null,this.trendListSize=10,this.createGUI(),this.trendPage=null,window.TrendListDialog=this}TrendList.prototype.createGUI=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c='<div id="'+a+'">\n                        <form>\n                            <select id="'+b+'" class="TrendListOption"></select>\n                            <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">\n                        </form>\n                    </div>',d=$(c);$("body").append(d),this.ui=$("#"+a).dialog({modal:!0,autoOpen:!1,title:"Select a trend",width:400,resizable:!0,buttons:{Cancel:function(){this.ui.dialog("close")}.bind(this),OK:this.onSelected.bind(this)}}),this.ui.find("form").on("submit",function(a){a.preventDefault(),this.onSelected()}.bind(this)),this.trendList=document.getElementById(b),this.trendList.size=this.trendListSize,this.trendList.addEventListener("dblclick",function(){this.onSelected()}.bind(this),!1)}catch(a){console.log("TrendList createGUI() failed: "+a)}},TrendList.prototype.onSelected=function(){this.trendList.value&&this.trendPage.openTrendFromLocalStorage(this.trendList.value),this.ui.dialog("close")},TrendList.prototype.show=function(a){try{this.trendPage=a;while(this.trendList.options.length>0)this.trendList.remove(0);var b=a.retrieveTrends();for(var c in b){var d=document.createElement("option");d.text=c,c===a.trendName&&(d.selected="true"),this.trendList.add(d)}this.ui.dialog("open")}catch(a){console.log("TrendList createGUI() failed: "+a)}},emosWS.TrendList=TrendList;function FilterDate(){this.trendPage=null,this.date1HTML=null,this.hour1HTML=null,this.minute1HTML=null,this.second1HTML=null,this.date2HTML=null,this.hour2HTML=null,this.minute2HTML=null,this.second2HTML=null,this.date1=null,this.date2=null,this.createGUI(),window.FilterDateDialog=this}FilterDate.prototype.createGUI=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=getElementGlobalID(),i=getElementGlobalID(),j=getElementGlobalID(),k=getElementGlobalID(),l='<div id="'+a+'">\n                        <form>\n                            <div class="FilterDateLeft">\n                                <div id="'+b+'"></div>\n                                <div class="vertical controls" id="'+c+'">\n                                    <input id="'+d+'">h\n                                    <input id="'+e+'">m\n                                    <input id="'+f+'">s\n                                </div>\n                            </div>\n                            <div class="FilterDateRight">\n                                <div id="'+g+'"></div>\n                                <div class="vertical controls" id="'+h+'">\n                                    <input id="'+i+'">h\n                                    <input id="'+j+'">m\n                                    <input id="'+k+'">s\n                                </div>\n                            </div>\n                            <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">\n                        </form>\n                    </div>',m=$(l);$("body").append(m),this.ui=$("#"+a).dialog({modal:!0,autoOpen:!1,title:"Select start and end date",width:540,resizable:!0,buttons:{Cancel:function(){this.ui.dialog("close")}.bind(this),OK:this.onSelected.bind(this)}}),this.ui.find("form").on("submit",function(a){a.preventDefault(),this.onSelected()}.bind(this)),this.date1HTML=$("#"+b).datepicker({changeMonth:!0,changeYear:!0}),this.date1HTML.datepicker("option","firstDay",1),this.date1HTML.datepicker("option","yearRange","0:3000"),this.hour1HTML=$("#"+d).spinner({min:0,max:23,step:1,start:1}),this.minute1HTML=$("#"+e).spinner({min:0,max:59,step:1,start:0}),this.second1HTML=$("#"+f).spinner({min:0,max:59,step:1,start:0}),this.date1={date:this.date1HTML,hour:this.hour1HTML,minute:this.minute1HTML,second:this.second1HTML},this.date2HTML=$("#"+g).datepicker({changeMonth:!0,changeYear:!0}),this.date2HTML.datepicker("option","firstDay",1),this.date2HTML.datepicker("option","yearRange","0:3000"),this.hour2HTML=$("#"+i).spinner({min:0,max:23,step:1,start:1}),this.minute2HTML=$("#"+j).spinner({min:0,max:59,step:1,start:0}),this.second2HTML=$("#"+k).spinner({min:0,max:59,step:1,start:0}),this.date2={date:this.date2HTML,hour:this.hour2HTML,minute:this.minute2HTML,second:this.second2HTML}}catch(a){console.log("FilterDate createGUI() failed: "+a)}},FilterDate.prototype.onSelected=function(){var a=this.getTime(this.date1),b=this.getTime(this.date2);a<=b&&this.diagram.onFilterDateSelected(a,b),this.ui.dialog("close")},FilterDate.prototype.show=function(a){try{this.diagram=a,this.setTimeControl(this.date1,a.getDataBeginDate()),this.setTimeControl(this.date2,new Date),this.ui.dialog("open")}catch(a){console.log("FilterDate show() failed: "+a)}},FilterDate.prototype.setTimeControl=function(a,b){try{a.date.datepicker("setDate",b),a.hour.val(b.getHours()),a.minute.val(b.getMinutes()),a.second.val(b.getSeconds())}catch(a){console.log("FilterDate setTimeControl() failed: "+a)}},FilterDate.prototype.getTime=function(a){try{var b=a.date.datepicker("getDate");return b.setHours(a.hour.val()),b.setMinutes(a.minute.val()),b.setSeconds(a.second.val()),b.setMilliseconds(0),b}catch(a){console.log("FilterDate getTime() failed: "+a)}},emosWS.FilterDate=FilterDate;function TrendPage(a){emosWS.require({css:["/lib/css/c3.css"],js:["/lib/js/d3.min.js","/lib/js/c3.min.js","/lib/js/FileSaver.min.js"]},function(){this.advanced=void 0===a.advanced||a.advanced,this.trendData=void 0===a.data?[]:a.data,this.src=a.advanced,this.toolbar=null,this.variableDialog=window.TrendPageVariableDialog||new VariableDialog,this.trendListDialog=window.TrendListDialog||new TrendList,this.filterDateDialog=window.FilterDateDialog||new FilterDate,this.diagrams=null,this.diagramsElement=null,this.diagramList=[],this.trendId=null,this.useLive=!this.advanced,this.usePoint=!1,this.useDataInterpolated=!0,this.tbVariableDialog=null,this.tbPrint=null,this.tbSaveData=null,this.tbDelete=null,this.tbHundred=null,this.tbRealtime=null,this.tbRealtimeId=null,this.tbSlider=null,this.tbDataInterpolated=null,this.tbDataInterpolatedId=null,this.tbDataPoint=null,this.tbDataPointId=null,this.tbSaveDiagram=null,this.tbDeleteDiagram=null,this.tbFetchDiagram=null,this.tbNewDiagram=null,this.trendListName="emosDiagramList",this.trendName=null,ForeignObject.call(this,a),ESAnimation.call(this)}.bind(this))}TrendPage.prototype=Object.create(ForeignObject.prototype),TrendPage.prototype=emosWS.fn.emosExtend(TrendPage.prototype,ESAnimation.prototype),TrendPage.prototype.constructor=TrendPage,TrendPage.prototype.initializeMore=function(){emosWS.sendTrendRegister(function(a){switch(a.type){case"trendInfo":this.trendId=a.value,this.variableDialog.setTrendId(this.trendId),this.diagramList.forEach(function(a){a.onTrendRegistered()});break;case"trendPlantList":this.variableDialog.onDataTrendPlantList(a);break;case"trendItemList":this.variableDialog.onDataTrendItemList(a);break;case"trendItemValueList":this.diagramList.forEach(function(b){var c=JSON.parse(a.data);b.onDataTrendItemValueList(c)})}}.bind(this))},TrendPage.prototype.renderMore=function(){this.createGUI()},TrendPage.prototype.createGUI=function(){try{var a=getElementGlobalID(),b=getElementGlobalID(),c=getElementGlobalID(),d=getElementGlobalID(),e=getElementGlobalID(),f=getElementGlobalID(),g=getElementGlobalID(),h=this.tbRealtimeId=getElementGlobalID(),i=this.tbDataInterpolatedId=getElementGlobalID(),j=this.tbDataPointId=getElementGlobalID(),k=getElementGlobalID(),l=getElementGlobalID(),m=getElementGlobalID(),n=getElementGlobalID(),o=getElementGlobalID(),p=this.advanced?'<div id="'+a+'" class="ui-widget-header ui-corner-all TrendPageRow">\n                <button id="'+b+'">Variable dialog</button>\n                <button id="'+d+'">Save / Export Data</button>\n                <button id="'+e+'">Delete Variables in the Diagram</button>\n                <button id="'+f+'">Show all data to a 100 %</button>\n                <button id="'+g+'">Load more historic data</button>\n                <input type="checkbox" id="'+h+'"'+(this.useLive?" checked":"")+'><label for="'+h+'" title="Real Time Trend">Live</label>\n                <input type="checkbox" id="'+i+'"'+(this.useDataInterpolated?" checked":"")+'><label for="'+i+'" title="Show data interpolated">Interpolated</label>\n                <input type="checkbox" id="'+j+'"'+(this.usePoint?" checked":"")+'><label for="'+j+'" title="Show data points (Measuring point)">Point</label>\n                <button id="'+k+'">Save Diagram settings</button>\n                <button id="'+l+'">Delete Diagram settings</button>\n                <button id="'+m+'">Fetch Diagram settings</button>\n                <button id="'+n+'">New diagram</button>\n            </div>':"",q='<div class="TrendPageWrapper" id="'+this.elementId+'">\n                        <div class="TrendPageTable">'+p+'\n                            <div class="TrendPageDiagramsWrapper TrendPageRow">\n                                <div class="TrendPageDiagrams">\n                                    <div id="'+o+'" class="TrendPageTable">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>',r=$(q);this.divJElement.append(r),this.element=document.getElementById(this.elementId),this.diagrams=$("#"+o),this.diagramsElement=document.getElementById(o),this.tbVariableDialog=document.getElementById(b),this.tbPrint=document.getElementById(c),this.tbSaveData=document.getElementById(d),this.tbDelete=document.getElementById(e),this.tbHundred=document.getElementById(f),this.tbRealtime=document.getElementById(h),this.tbDataInterpolated=document.getElementById(i),this.tbDataPoint=document.getElementById(j),this.tbSaveDiagram=document.getElementById(k),this.tbDeleteDiagram=document.getElementById(l),this.tbFetchDiagram=document.getElementById(m),this.tbNewDiagram=document.getElementById(n);var s=this;this.advanced&&($("#"+b).button({text:!1,icons:{primary:"ui-icon-tag"}}).click(function(){s.variableDialog.ui.dialog("open"),s.variableDialog.setPosition(this)}),$("#"+d).button({text:!1,icons:{primary:"ui-icon-clipboard"}}).click(function(){s.save()}),$("#"+e).button({text:!1,icons:{primary:"ui-icon-trash"}}).click(function(){s.reset()}),$("#"+g).button({text:!1,icons:{primary:"ui-icon-transferthick-e-w"}}).click(function(){s.loadMoreData()}),$("#"+f).button({text:!1,icons:{primary:"ui-icon-image"}}).click(function(){s.showAllData()}),this.tbRealtime.addEventListener("click",function(){s.setLive(this.checked)},!1),$("#"+h).button(),this.tbDataInterpolated.addEventListener("click",function(){s.setDataInterpolated(this.checked)},!1),$("#"+i).button(),this.tbDataPoint.addEventListener("click",function(){s.setPoint(this.checked)},!1),$("#"+j).button(),$("#"+k).button({text:!1,icons:{primary:"ui-icon-disk"}}).click(function(){s.saveToLocalStorage()}),$("#"+l).button({text:!1,icons:{primary:"ui-icon-close"}}).click(function(){s.deleteTrend()}),$("#"+m).button({text:!1,icons:{primary:"ui-icon-folder-open"}}).click(function(){s.trendListDialog.show(s)}),$("#"+n).button({text:!1,icons:{primary:"ui-icon-plus"}}).click(function(){new Diagram(s),s.refreshSize()})),this.createDiagrams()}catch(a){console.log("TrendPage createGUI() failed: "+a)}},TrendPage.prototype.showAllData=function(){$("#"+this.tbRealtimeId).prop("checked",!1).button("refresh"),this.diagramList.forEach(function(a){a.showAllData()})},TrendPage.prototype.loadMoreData=function(){this.diagramList.forEach(function(a){a.loadMoreData()})},TrendPage.prototype.setDataInterpolated=function(a){this.useDataInterpolated=a,this.diagramList.forEach(function(b){b.setDataInterpolated(a)})},TrendPage.prototype.setLive=function(a){this.useLive=a,this.diagramList.forEach(function(b){b.setLive(a)})},TrendPage.prototype.setPoint=function(a){this.usePoint=a,this.diagramList.forEach(function(b){b.setPoint(a)})},TrendPage.prototype.createDiagrams=function(){if(0===this.trendData.length)new Diagram(this);else{for(var a=[],b=0,c=this.trendData.length;b<c;b++)a.push(new Diagram(this));for(var b=0,c=this.trendData.length;b<c;b++)setTimeout(function(b){for(var c=this.trendData[b],d=0,e=c.length;d<e;d++)a[b].initializeChart(c[d])}.bind(this,b),1);this.refreshSize()}},TrendPage.prototype.saveToLocalStorage=function(){var a=this.trendName||prompt("Please enter diagram name to save","diagram_"+(new Date).toLocaleString());null!==a&&(this.storeTrend({name:a,setting:this.getSetting()}),this.trendName=a)},TrendPage.prototype.openTrendFromLocalStorage=function(a){var b=this.retrieveTrends()[a];b&&(this.reset(!0),this.trendData=[],b.diagrams.forEach(function(a){this.useLive=a.useLive,this.usePoint=a.usePoint,this.useDataInterpolated=a.usePoint;var b=[];for(var c in a.tagDataIndex)b.push(c);this.trendData.push(b)}.bind(this)),this.createDiagrams(),$("#"+this.tbRealtimeId).prop("checked",this.useLive).button("refresh"),$("#"+this.tbDataInterpolatedId).prop("checked",this.useDataInterpolated).button("refresh"),$("#"+this.tbDataPointId).prop("checked",this.usPoint).button("refresh"),this.trendName=a)},TrendPage.prototype.getSetting=function(){var a={diagrams:[]};return this.diagramList.forEach(function(b){a.diagrams.push(b.getSetting())}),a},TrendPage.prototype.storeTrend=function(a){var b=this.retrieveTrends();"undefined"!=typeof Storage&&(b[a.name]=a.setting),this.storeTrends(b)},TrendPage.prototype.storeTrends=function(a){"undefined"!=typeof Storage&&localStorage.setItem(this.trendListName,JSON.stringify(a))},TrendPage.prototype.deleteTrend=function(){if(this.trendName&&confirm("Do you want to delete this trend from browser local storage?")){var a=this.retrieveTrends();"undefined"!=typeof Storage&&(delete a[this.trendName],this.storeTrends(a)),this.reset()}},TrendPage.prototype.retrieveTrends=function(){if("undefined"!=typeof Storage)return JSON.parse(localStorage.getItem(this.trendListName))||{}},TrendPage.prototype.save=function(){var a=(new Date).toLocaleString(),b="trend_html_",c="trend_data_",d=[{name:b+a,ext:".html",text:this.getExportSVG()},{name:c+a,ext:".txt",text:this.getExportData()}];$.when($.get("/lib/css/c3.css")).done(function(a){d.push({name:"c3",ext:".css",text:a}),this.saveNext(d)}.bind(this))},TrendPage.prototype.saveNext=function(a){a.forEach(function(a){var b=this.getBlob(a.text);saveAs(b,a.name+a.ext)}.bind(this))},TrendPage.prototype.getExportSVG=function(){var a='<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="c3.css"></head><body>';return this.diagramList.forEach(function(b){a+=b.getExportSVG()}),a+="</body></html>"},TrendPage.prototype.getExportData=function(){var a={time:new Date,diagrams:[]};return this.diagramList.forEach(function(b){a.diagrams.push(b.getExportData())}),JSON.stringify(a)},TrendPage.prototype.getBlob=function(a){return new Blob([a],{type:"text/plain;charset=utf-8"})},TrendPage.prototype.reset=function(a){this.diagramList.forEach(function(a){a.reset()}),this.diagramList=[],this.diagrams.empty(),a||new Diagram(this)},TrendPage.prototype.refreshSize=function(){var a=parseInt(this.diagramsElement.clientHeight/this.diagramList.length);this.diagramList.forEach(function(b){b.refreshSize(a)})},emosWS.TrendPage=TrendPage;function UserRight(a){this.def={act_ur:20,apt_ur:150,esm_ur:50,ext_ur:50,psa_ur:20,act_gr:50,apt_gr:50,esm_gr:50,ext_gr:50,psa_gr:50,sys_sr:20},this.rights=JSON.parse(a)}UserRight.prototype.hasRight=function(a,b){return"1"===this.rights[a].charAt(b)},UserRight.prototype.hasPaintShopRight=function(a){return 0===a||this.hasRight("psa_ur",a-1)};function LoginDialog(){this.userName=null,this.userId=null,this.status=null,this.message={status:"out"},this.usernameHTML=null,this.passwordHTML=null,this.loginHTML=null,this.logoffHTML=null,this.statusHTML=null,this.iframeHTML=null,this.accessToken=null,this.userright=null,this.profile=null,this.loginDate=null,this.wscookie=null,this.LCTokenKey="emosLoginKey",this.GET_USER_INFO="GETUSERINFO",this.USER_INFO="USERINFO",this.listeners=[],this.ui=null,this.authWindow=null,this.langs={70:"de",71:"en",72:"es",73:"pt_PT",74:"fr",75:"zh_CN",76:"en",77:"en"},this.createGUI(),this.init(),window.LoginDialog=this}LoginDialog.prototype.getLanguage=function(){return this.langs[emosWS.getLanguage()]||"en"},LoginDialog.prototype.createGUI=function(){try{var a=(new Date).getUTCMilliseconds(),b=a+"iframe",c=$("<div id='"+a+"'> <iframe id='"+b+"' class='emoslogin' src=''></iframe></div>");$("body").append(c),this.iframeHTML=document.getElementById(b),this.ui=$("#"+a).dialog({autoOpen:!1,width:500,height:500,open:function(){$(this).siblings(".ui-dialog-titlebar").removeClass("ui-widget-header"),$(this).css("overflow","hidden")},dialogClass:"noTitleStuff"})}catch(a){console.log("Login createGUI() failed: "+a)}},LoginDialog.prototype.register=function(a){this.listeners.forEach(function(a){}),this.listeners.push(a)},LoginDialog.prototype.retrieveAccessToken=function(){if("undefined"!=typeof Storage){if(localStorage.getItem(this.LCTokenKey))return new AccessToken(JSON.parse(localStorage.getItem(this.LCTokenKey)))}return null},LoginDialog.prototype.onLocalStorageChange=function(a){a.key===this.LCTokenKey&&(!this.accessToken&&a.newValue?setTimeout(function(){this.loginByKey(this.retrieveAccessToken())}.bind(this),1):"PASSED"!==this.status||a.newValue||this.logoff())},LoginDialog.prototype.removeAccessToken=function(){return"undefined"!=typeof Storage&&delete localStorage[this.LCTokenKey],null},LoginDialog.prototype.setAccessToken=function(a){this.accessToken=a||this.accessToken,"undefined"!=typeof Storage&&localStorage.setItem(this.LCTokenKey,a.toString())},LoginDialog.prototype.init=function(){emosWS.addEventListener("authentication",this.onMessage.bind(this),!0),emosWS.addEventListener("UserRight",function(){}),emosWS.addEventListener("language",function(){this.ui.dialog("isOpen")&&(this.ui.dialog("close"),this.showUI())}.bind(this)),this.loginByKey(this.retrieveAccessToken()),window.addEventListener("storage",this.onLocalStorageChange.bind(this),!1),window.addEventListener("message",function(a){try{switch(JSON.parse(a.data).type){case this.GET_USER_INFO:this.iframeHTML.contentWindow.postMessage(JSON.stringify({type:this.USER_INFO,UserId:this.userId,UserName:this.userName,UserRight:this.userright,LoginDate:this.loginDate,Profiles:this.profile,WebSocketServer:emosWS.getWSHostname(),CasServer:emosWS.Cas.casServerURL}),"*")}}catch(a){}}.bind(this),!1)},LoginDialog.prototype.login=function(){var a=this.usernameHTML.value,b=this.passwordHTML.value;""!==a&&""!==b&&emosWS.sendLogin(a,b,this.onMessage.bind(this))},LoginDialog.prototype.loginByKey=function(a){a&&emosWS.sendLoginByKey(a.getToken(),this.onMessage.bind(this))},LoginDialog.prototype.loginByCasKey=function(a){a&&emosWS.sendLoginByKey(a,this.onMessage.bind(this))},LoginDialog.prototype.logoff=function(){emosWS.sendLogoff()},LoginDialog.prototype.onMessage=function(a){try{switch(this.status=a.status,this.status){case"PASSED":this.onPassed(a);break;case"FAILED":console.log("Authentication failed"),this.onFailed(a);break;case"LOGOFF":this.onLogoff()}}catch(a){console.log("LoginDialog onMessage failed: "+a)}},LoginDialog.prototype.onAccesToken=function(a){var b=new AccessToken(a);this.accessToken&&b.equals(this.accessToken)||(this.ui&&this.ui.dialog("close"),this.setAccessToken(b),this.loginByKey(b),emosWS.propagateMessage(JSON.stringify(a)))},LoginDialog.prototype.onLogoff=function(){this.userright=null,this.loginDate=null,this.userName=null,this.userId=null,this.removeAccessToken(),this.accessToken=null,emosWS.Cas.onLogoff(),this.ui&&this.ui.dialog("close"),this.listeners.forEach(function(a){a.onLogoff()}),this.message={status:"out"},emosWS.dispatchEvent({type:"UserRight",message:this.message})},LoginDialog.prototype.onPassed=function(a){this.status="PASSED",this.userName=a.username,this.userId=a.userid,this.userright=new UserRight(a.userright),this.profile=JSON.parse(a.profile),this.loginDate=a.logindate,emosWS.Cas.onPassed(a),this.ui&&this.ui.dialog("close"),this.listeners.forEach(function(a){a.onPassed(this.userName)}.bind(this)),this.message={status:"in",username:this.userName,userid:this.userId,userright:this.userright},emosWS.dispatchEvent({type:"UserRight",message:this.message})},LoginDialog.prototype.onFailed=function(a){this.status="FAILED",emosWS.Cas.onFailed(a)},LoginDialog.prototype.show=function(){if("PASSED"===this.status)confirm("Do you want to sign out?")&&this.logoff();else{var a=function(a,b,c,d){c+=32,d+=96;var e=(screen.width-c)/2,f=(screen.height-d)/2;e<0&&(c=screen.width,e=0),f<0&&(d=screen.height,f=0);var g=window.open(a,b,"width="+c+", height="+d+", left="+e+", top="+f+", location=no, menubar=no, status=no, toolbar=no, scrollbars=no, resizable=no");return g.resizeTo(c,d),g.moveTo(e,f),g.focus(),g};this.authWindow&&this.authWindow.close(),this.authWindow=a(emosWS.Cas.casLoginURL,"_blank",420,750),this.authWindow.focus()}},LoginDialog.prototype.getStatus=function(){return this.message},LoginDialog.prototype.showUI=function(){this.ui.dialog("isOpen")||this.ui.dialog("open"),this.iframeHTML.src=emosWS.Cas.casLoginURL+"&locale="+this.getLanguage()},LoginDialog.prototype.showDialog=function(){"PASSED"===this.status?confirm("Do you want to sign out?")&&this.logoff():this.showUI()},LoginDialog.prototype.checkInit=function(){emosWS.animationData.stillInit&&emosWS.addEventListener("UserRight",emosWS.animationData.callback.datachangeListener.bind(emosWS.animationData.callback),!0)},LoginDialog.prototype.hasRight=function(a,b){return this.checkInit(),!!this.userright&&this.userright.hasRight(a.toLowerCase(),b)},LoginDialog.prototype.hasPaintShopRight=function(a){return this.checkInit(),this.userright?this.userright.hasPaintShopRight(a):0===a},emosWS.LoginDialog=LoginDialog;function Login(a){ForeignObject.call(this,a),this.loginDialog=window.LoginDialog,this.loginDialog.register(this)}Login.prototype=Object.create(ForeignObject.prototype),Login.prototype.constructor=Login,Login.prototype.renderMore=function(){try{var a=$('<div class="ForeignObject LoginText" id="'+this.elementId+'"></div>');this.divJElement.append(a),this.element=document.getElementById(this.elementId),this.element.addEventListener("click",function(){this.loginDialog.show(this)}.bind(this),!1)}catch(a){console.log("Login renderMore() failed: "+a)}},Login.prototype.onLogoff=function(){this.loggedIn=!1,this.element.innerHTML=""},Login.prototype.onPassed=function(a){this.loggedIn=!0,this.element.innerHTML=a},emosWS.Login=Login;function HTMLElements(a){this.useHTMLElement="1"!==a.domType,this.html=a.html||"",this.js=JSON.parse(a.js)||[],this.css=JSON.parse(a.css)||[],this.onready=a.onready,ForeignObject.call(this,a)}HTMLElements.prototype=Object.create(ForeignObject.prototype),HTMLElements.prototype.constructor=HTMLElements,HTMLElements.prototype.renderMore=function(){try{""!==this.html&&($(this.divElement).append($('<div id="'+this.elementId+'"> '+this.html+"</div>")),this.element=this.getElement());var a=function(){this.onready&&this.onready()}.bind(this);0===this.js.length&&0===this.css.length?a():(emosWS.require({js:this.js},a),this.css.forEach(function(a){var b=emosWS.attr.svg.createElementNS("http://www.w3.org/1999/xhtml","link");b.setAttribute("href",a),b.setAttribute("type","text/css"),b.setAttribute("rel","stylesheet"),this.divElement.appendChild(b)}.bind(this)))}catch(a){console.error(a)}},emosWS.HTMLElements=HTMLElements});
//# sourceMappingURL=durr.emos.min.map